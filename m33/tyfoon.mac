;       THIS IS THE TYMSHARE-FOONLY TAPE AND DISK EXERCISER.
;       IT WAS WRITTEN TO BE RUN ON THE F-4 PRIMARILLY
;       BUT I DO NOT SEE ANY REASON WHY IT SHOULD NOT
;       RUN ON THE F-3 OR ANY OTHER FOONLY PRODUCT.
;
;       THE EXERCISER IS BROKEN UP INTO 8 TESTS.
;
;       TEST1 WRITES A PATTERN = 000000000000
;       TEST2 WRITES A PATTERN = 777777777777
;       TEST3 WRITES A PATTERN = 070707070707
;       TEST4 WRITES A PATTERN = 707070707070
;       TEST5 WRITES A PATTERN = 525252525252
;       TEST6 WRITES A PATTERN = 252525252525
;       TEST7 WRITES A PATTERN = ???????????? (RANDOM)
;       TEST8 DISK - READ ONLY RANDOM CYL HEAD AND SECTOR
;             TAPE - NOT DEFINED AS OF YET
;
;       ALL TESTS FOR TAPE READ BACK INTO BUFFER LOCATIONS 1 GREATER
;       THAN THE LAST WRITE BUFFER ADDRESS. BUFFER DELIMITERS
;       ARE INSERTED AT THE BEGINNING AND END OF THE READ
;       BUFFER BEFORE READING. YOU WILL RECEIVE A BUFFER
;       DELIMITER ERROR IF THE READ BUFFER UNDERFLOWS OR OVER-
;       FLOWS.
;
;       ALL TESTS FOR TAPE INCREMENT THE BUFFER ADDRESS AND MEMORY
;       ADDRESS BY 1 UNTIL MAX. WORD COUNT AND MAX. MEMORY
;       HAVE BEEN ACHIEVED, AT WHICH TIME THEY ARE RESTORED
;       TO THEIR BEGINNING ADDRESSES AGAIN. YOU WILL RECEIVE
;       A MEMORY RAP AROUND MESSAGE WHEN EACH TEST CALCULATES
;       IT'S WRITE BUFFER ADDRESS PLUS READ BUFFER ADDRESS
;       WILL GO BEYOND MAX. MEMORY.
;
;       ALL TEST FOR DISK USE FIXED BUFFER ADDRESSES.
;
;       ALL TESTS WILL REPORT ANY BUFFER MISCOMPARE'S. THE
;       BUFFER STARTING ADDRESSES, FIRST FAILING ADDRESSES,
;       WHAT THE DATA SHOULD BE, WHAT THE DATA IS, THE RECORD
;       COUNT, AND HOW MANY TOTAL MISCOMPARES ARE IN THE RECORD.

;                       VERSION REPORT
;                       ______________
;
;       VERSION 1.0 - MARCH 1, 1982
;        1. ORIGINAL RELEASE.
;       VERSION 1.1 - SEPTEMBER 6, 1982
;        1. ADDED CODE TO ABORT TEST IF A TAPE ERROR IS DETECTED
;        2. ADDED CODE TO SIZE MEMORY
;        3. MOVED EDDT TO 100000 SO IT WOULD NOT INTERFER WITH
;           MAP CODE.
;       VERSION 1.2 - NOVEMBER 22,1982
;        1. ADDED CONTROL T AND CONTROL C FUNCTIONS.
;       VERSION 1.3 - NOVEMBER 23,1982
;        1. ADDED TTY INPUT ROUTINE SO WE CAN HAVE A LITTLE
;           BETTER HUMAN INTERFACE.
;        2. MODIFIED WAITINT TO SCAN ALL OF AVAILABLE MEMORY
;           USING MEMORY MAP.
;       VERSION 2.0 - DECEMBER 01,1982
;        1. ADDED DISK PORTION OF DIAGNOSTIC.
;       VERSION 2.1 - DECEMBER 15,1982
;        1. FIXED ERROR MESSAGE TO OUTPUT APPROPRIATE FUNCTION.
;        2. ADDED MORE WRITE PROTECT FEATURES WHEN YOUR IN EDDT.
;        3. ADDED ANOTHER COMMAND TO TEST WHOLE DISK. WHEN TAPE IS 
;           FIRST BOOTED IN, IT WILL TEST ONLY CE CYLINDER.
;        4. CHANGED FBUF ADDRESS SO IT WOULD NOT COINCIDE WITH RBUF.
;        5. INSTALLED AUTON AND AUTOFF.
;        6. ENHANCED FORMAT TO TRY AND RESTORE BAT BLOCKS.
;        7. STARTED STORING AMPEX BAT BLOCK INFO IN DIAG.
;       VERSION 2.2 - JANUARY 26, 1983
;        1. ADDED CODE TO HANDLE NEW WAY OF SIZING MEMORY BECAUSE OF
;           MICRO-CODE CHANGE.
;        2. ADDED CODE TO HANDLE ECC ERRORS WHILE RUNNING TESTS.
;        3. FIXED DWAIT AND TWAIT TO ABORT WITH ^C.
;        4. FIXED TIMEOUT MESSAGE SO IT WOULD NOT HANG UP.
;        5. REPLACED MEMORY CLEAR AT BEGINNING OF PROGRAM TO JUST A
;           MEMORY SCAN FOR SIZING.
;       VERSION 2.3 - FEB. 3, 1983
;        1. ADDED FEATURE THAT WOULD ALLOW YOU TO RUN ON A F3 CPU.
;        2. ADDED SOMEMORE BATBLK INFO.
;       VERSION 2.4 - FEB. 6, 1983
;        1. ADDED DECIMAL OUTPUT ROUTINE.
;        2. USED DECIMAL OUTPUT ROUTINE TO DO PRIBAT. THIS WILL MAKE
;           LOOKING AT BATBLK INFO A LITTLE EASIER.
;       VERSION 2.5 - FEB. 14, 1983
;        1. ADDED TEST8 FOR KENNEDY TAPE DRIVE START/STOP ADJ.
;        2. FIXED TEST 8 SO IT WOULD START AT THE POINT OF LAST EXECUTE.
;        3. ALTERED TEST 8 TO ASK YOU IF YOU WANT TO CONTINUE AFTER
;           DISK HAS RAPPED AROUND.
;        4. FIXED MEMORY SIZING ROUTINE TO CLEAR ALL OF MEMORY AND
;           PRINT OUT ACTUAL SIZE OF MEMORY, EVEN IF IT IS AN ODD BALL
;           SIZE.
;        5. MADE TEST 8 TO LOOK AT DISK LIMITS.
;        6. FORMAT NOW LOOKS AT DISK LIMITS ALSO.
;        7. FIXED LOGICAL ERROR IN COMPUTING FIRST DISK ADDRESSES FOR
;           TESTS. THIS CAUSED TEST0 TO FAIL SOMETIMES WHEN CE CYLINDER
;           ONLY USED.
;        8. FIXED THE INSBAT ROUTINE TO GET THE HDA. IT FAILED BECAUSE
;           OF A STUPID ERROR ON MY PART. BELIEVE ME, I DON'T MAKE MANY.
;       VERSION 2.6 - FEB. 22, 1983
;        1. FIXED FLAW MAP INFO ON A2125 A1012 AND A319. THIS WAS A
;           SCREW UP ON AMPEX'S NOT PRINTING THE 8 CORRECTLY. LOOKED LIKE
;           0'S.
;        2. FIXED INSBAT, THE HDA SERIAL NUMBER WOULD NOT BE ECHOED BACK
;           BECAUSE OF THE SILENT FLAG WAS SET BY ACCIDENT.
;        3. MODIFIED GETBAT AND TSTBAT TO LOOK AT VIRTUAL DISK ADDRESSES.
;           THIS ALLOWED ME TO DO BETTER CHECKING OF THE BATBLK'S.
;           LAST BUT NOT LEAST, MADE GETBAT LOOK FOR DUPLICATE ENTRIES.
;        4. FIXED THE SOFT ECC ERROR ROUTINE BECAUSE WHEN THERE WAS AN
;           ERROR IN BOARD LOCATION C10, PAINT WOULD NOT SHOW IT.
;        5. ADDED CODE TO OUTPUT RUNNING TIME IN DAYS, HOURS, MINUTES AND
;           SECONDS.
;       VERSION 2.7 - MAR. 02,1983
;        1. ADDED MEM TO COMMAND LIST. THIS WILL EXERCISE MEMORY WITHOUT
;           HAVING TO EXERCISE ANY I/O.
;        2. ENHANCED HARD ECC ERROR TO OUTPUT THE BOARD PAIR AND ROW.
;           IT IS IMPOSSIBLE TO DETECT THE BAD CHIP BECAUSE THE ECC SYNDROME
;           IS INVALID.
;        3. MOVED EDDT TO 160000 SO I COULD GET MORE FLAW MAPS IN.
;        4. MADE ALL TESTS USE DIFFERENT MEMORY BUFFERS.
;        5. FOUND A FLAW IN TSTBAT, IF NO ENTRIES WERE RECEIVED IT JUST
;           HUNG THERE.
;        6. MODIFIED THE ERROR TESTING NOT TO CHECK JUST B.ANY. IF THE ERROR
;           SUMMARY BIT DID NOT GET SET DUE TO A HARDWARE FLAW, THEN NO ERROR
;           WAS DETECTED.
;        7. ADDED WARNING TO THE GETBAT COMMAND TO TELL YOU THAT THE WRITE
;           PROTECT SWITCH IS NOT ON.
;       VERSION 2.8 MAR-08-1983
;        1. ADDED ROUTINES TO MANUALLY ACCESS THE DISK. EX. RD$G, WR$G, AND
;           RECAL$G ETC. THIS WILL BE COMPATIBLE WITH OLD DT TEST SO MR. POOLE
;           MAY BE HAPPY.
;        2. MOVED WARNING DISK NOT PROTECT MESSAGE FROM GETBAT TO INITIAL
;           SELECT ROUTINE.
;        3. MOVED ALL BUFFERS UP TO 200000 OR BETTER. THIS CURED SYMBOLS
;           DISAPPEARING.
;       VERSION 2.9 MAR-17-1983
;        1. FIXED SCANNR ROUTINE SO IT WOULD NOT CLOBBER THE WRITE BUFFER
;           DURING DISK TESTS. ONLY SHOWED UP ONCE IN AWHILE.
;        2. ADDED TWO FUNCTIONS TO TURN ON THE 60 HZ CLOCK AND TO TURN IT OFF.
;       VERSION 3.0 MAR-24-1983
;        1. FIXED HANGUP IN CONTROL T INFO BY ELIMINATING THE DISK INTERRUPT
;           IF CEHLD SET AND TEST8 ALTERED. NOTE: THIS CAUSES THE SCANNR NOT
;           TO SCAN.
;       VERSION 3.1 APR-14-1983
;        1. FIXED PAKCPY ROUTINE WITH PARAMETERS FROM A REAL LIVE PAKCPY
;           SITUATION.
;        2. MODIFIED GETBAT TO USE PRIMARY OR SECONDARY BATBLK.
;        3. MADE ECC ERROR ROUTINE TO USE TABLES INSTEAD OF LONG CODE METHOD.
;       VERSION 3.2 MAY-18-1983
;        1. ADDED FUJITSU DRIVE TO CONFIGURATION.
;        2. CORRECTED MISC BITS IN DISK STATUS ROUTINE.
;        3. FIXED INSBAT TO WORK WITH MORE THAN 8 SECTORS.
;        4. MODIFIED DSK TO ONLY ASK FOR DRIVE TYPE ON DEMAND.
;        5. FIXED SCANNR SO IT WON'T CLOBBER THE DATA BUFFERS.
;       VERSION 3.3 JUNE-07-1983
;        1. NOTICED THAT WHEN AUTON WAS ENABLED, WE DID NOT GET THE OVERLAP
;           SEEK TEST. THIS IS NOW FIXED.
;        2. ADDED AMPEX DM9300 PARAMETERS TO EXERCISER.
;       VERSION 3.4 OCT.-10-1983
;        1. MODIFIED PRITIME ROUTINE TO NOT PRINT DAY.
;        2. ADDED ROUTINE TO SET TIME UPON START UP.
;        3. PUT IN 64K OPTION FOR NEW MEMORY BDS. THIS WILL ALLOW
;           THE ERROR ROUTINE TO PICK THE CORRECT CHIP.
;        4. FIXED BUG IN MEMORY PORTION OF DIAG. IT DID NOT CHECK FOR
;           MEMORY PARITY ERRORS UNLESS WE HAD READ VERIFY ON.
;       Version 3.5 Nov.-21-1983
;        1. Added somemore Batblk for CDC drives.
;        2. Fixed the GETBAT problem of not coming up with 0 batblk entries
;           when there were really zero entries.

TITLE DANS EXER. FOR THE TAPE
SEARCH STENEX
        ;HERE ARE SOME SPECIAL DEFINITIONS.
        OPDEF XAM[107000,,0]

        ;HERE ARE THE DISK IOT'S
        ;
        OPDEF LA[723000,,0]
        OPDEF RA[717000,,0]
        OPDEF LC[721000,,0]
        OPDEF RC[715000,,0]
        OPDEF LE[724000,,0]
        OPDEF LM[722000,,0]
        OPDEF RM[716000,,0]
        OPDEF DCONO[740000,,0]
        OPDEF DCONI[741000,,0]
        OPDEF DCONSO[742000,,0]
        OPDEF DCONSZ[743000,,0]

        ;HERE ARE THE TAPE IOT'S
        ;
        OPDEF   DEACT[734000,,120]      ;CLEAR FORMATTER, INT. FLAG, PI SYS
        OPDEF   ACTIVATE[734000,,MTACH] ;PUT TAPE ON PI SYSTEM
        OPDEF   MTCONI[733000,,0]
        OPDEF   MTCONO[734000,,0]
        OPDEF   MTCNSO[735000,,0]
        OPDEF   MTDATI[736000,,0]
        OPDEF   UNLD[726000,,11]        ;REWIND AND UNLOAD
        OPDEF   WRTGAP[726000,,13]      ;WRITE TAPE GAP
        OPDEF   WRTEOF[726000,,3]       ;WRITE END OF FILE
        OPDEF   FWSPFIL[726000,,16]     ;FORWARD SPACE FILE
        OPDEF   BKSPFIL[726000,,17]     ;BACK SPACE FILE
        OPDEF   REW[726000,,0]          ;REWIND TAPE
        OPDEF   BKSP[726000,,6]         ;BACKSPACE RECORD
        OPDEF   FWSP[726000,,5]         ;FORWARD SPACE RECORD
        OPDEF   STAT[727000,,0]         ;READ TAPE STATUS
        OPDEF   RDF[732000,,0]          ;READ RECORD FORWARD
        OPDEF   WRT[731000,,0]          ;WRITE RECORD

        ;PAGER DEVICE DEFINITION
        PGR==24

        ;PAGER OPDEFS
        OPDEF   PGRCLD  [CONO PGR,0]            ;PAGER CLEAR DEVICE
        OPDEF   MONCLR  [CONO PGR,1]            ;CLEAR MONITOR PORTION OF MAP
        OPDEF   USRCLR  [CONO PGR,3]            ;CLEAR USER PORTION OF MAP
        OPDEF   PGROFF  [CONO PGR,4]            ;TURNS OFF PAGING SYSTEM
        OPDEF   PGRON   [CONO PGR,6]            ;TURNS ON PAGING SYSTEM
        OPDEF   PGRSET  [BLKO PGR,@RESEND]      ;EXEC MAPS UP TO
        OPDEF   PGRRET  [BLKI PGR,0]            ;RET FROM PAGER TRAP



        ;HERE ARE SOME EQUATED VALUES
        ;FOR DATAI INSTRUCTION TO TAPE CONTROLLER
        MICFLG==400000                  ;SOME FLAG IS BEING REPORTED
        MICEOF==200000                  ;EOF FLAG SEEN BY MICROCODE
        MICTPE==100000                  ;TAPE PARITY ERROR
        MICLNE==040000                  ;LENGTH ERROR

        ;SOME EQUATED VLAUES FOR DISK
        S.SERR==400000                  ;SELECT ERROR
        S.WRLK==200000                  ;WRITELOCKED
        S.NRDY==100000                  ;NOT READY
        S.ONCY==40000                   ;ON CYLINDER
        S.SEEK==20000                   ;SEEK ERROR
        S.DFLT==10000                   ;DRIVE FAULT
        S.HDECC==4000                   ;HEADER ECC ERROR
        S.HCER==2000                    ;HEADER COMPARE ERROR
        S.NBSY==1000                    ;NOT BUSY
        s.hecc==400                     ;hard ecc error
        s.secc==200                     ;soft ecc error
        S.ROVR==100                     ;READ OVERUN
        S.WOVR==40                      ;WRITE OVERUN
        S.SOVR==20                      ;SECTOR OVERUN
        S.SPAR==10                      ;INTERNAL PARITY ERROR
        S.ANY==1B28                     ;ANY ERROR
        S.OCMP==1B31                    ;COMPLETE
        GODDT==160000
        RBUF==GODDT+20000
        WBUF==RBUF+2000
        FBUF==WBUF+1000                 ;FORMAT BUFFER ADDRESS
        ECCBUF==FBUF

        ;GENERAL EQUATED VALUES
        APRCHN=1
        APRLOC=40+<2*APRCHN>
        DINTCHN=4
        INTLOC=40+<2*DINTCHN>
        DNTLOC==INTLOC
        TNTLOC==56
        TTY==120
        T.OBSY==1B31
        RAN==1
        NORAN==0
        MTACH==7                        ;PI INT 7
        CHECK==1
        NOCHECK==0
        READ==2
        WRITE==1
        NODELIM==0
        COMDAT==260000000000
        R==16
        P==17                           ;STACK POINTER REG.
        T1==1
        T2==2
        T3==3
        T4==4
        T5==5
        T6==6
        T7==7
        T1STCT==10                      ;START WORD COUNT FOR TEST1
        T1MAXCT==301                    ;MAX WORD COUNT FOR TEST1
        T2STCT==63                      ;START WORD COUNT FOR TEST2
        T2MAXCT==201                    ;MAX WORD COUNT FOR TEST2
        T3STCT==102                     ;START WORD COUNT FOR TEST3
        T3MAXCT==401                    ;MAX WORD COUNT FOR TEST3
        T4STCT==1                       ;START WORD COUNT FOR TEST5
        T4MAXCNT==11
        T5STCT==15
        T5MAXCNT==41                    ;MAX WORD COUNT FOR TEST5
        T6STCT==24                      ;START WORD COUNT FOR TEST6
        T6MAXCNT==501                   ;MAX WORD COUNT FOR TEST6
        T7STCT==106                     ;START WORD COUNT FOR TEST7
        T7MAXCNT==1001                  ;MAX WORD COUNT FOR TEST7
        CRLF==064240000000
        FRSTPG==200                     ;CHANGE THIS VALUE FOR SCANNR MOD.

        EXTERNAL DDT,DDTEND                     ;THIS TO GET DDT IN


        ;THESE ARE DEFINED OPERATIONS TO HELP MAKE ASSEMBLY
        ;A LITTLE EASIER. I HOPE.
        ;

DEFINE MSG (STR,%END1)
<       CAIA
        JRST    %END1
        HRROI   1,STR
        PSOUT                   ;;OUTPUT STRING TO TERMINAL
%END1:>

        DEFINE OUTOCT,(PRTADD,CHARNUM)<
           MOVEI 2,PRTADD
           MOVEI 3,CHARNUM
           PUSHJ P,OCTOUT>

        DEFINE PRTBUFER,(TST,BEGWRT,BEGRD,WDCNT)<
           MOVEI 1,TST
           MOVE  2,BEGWRT
           MOVE  3,BEGRD
           MOVE  6,WDCNT
           PUSHJ P,ERRBUF>

        DEFINE CMPBUF,(LIMCK,ADDR1,ADDR2,HOWMANY)<
           MOVEI 0,LIMCK
           MOVE  1,ADDR1
           MOVE  2,ADDR2
           MOVE  3,HOWMANY
           PUSHJ P,BUFCMP>

        DEFINE SETUPBUF,(TYPE,DATA,ADDRESS,COUNT,DELIM)<
           MOVEI 0,TYPE
           MOVE  1,DATA
           MOVE  2,ADDRESS
           MOVE  3,COUNT
           MOVEI 4,DELIM
           PUSHJ P,BUFSPR>

        DEFINE PRINT,(TXT)<
           MOVEI 2,[ASCIZ TXT]
           PUSHJ P,STROUT>

        DEFINE CARRET<
           MOVEI 2,[CRLF]
           PUSHJ P,STROUT>

        LOC     140
        JRST    INIT
        LOC     3000            ;THIS IS WHERE THE MONITOR MAP RESIDES
MMAP:   0
        LOC     4000            ;THIS IS WHERE THE CORE STATUS TABLE RESIDES
CST:    0
        LOC     21000           ;START IT HERE
BEGPRG:
INIT:   ;THIS IS THE INITIALIZER. THIS IS THE FIRST
        ;THING THAT HAS TO BE EXECUTED, EVEN BEFORE
        ;USING EDDT TO EXAMINE MEMORY. IF NOT AND
        ;YOU TRY TO ALTER A MEMORY LOCATION, YOU
        ;BLOW EDDT RIGHT OUT OF THE WATER.

        MOVE    P,SAVEIT
        setom   clkbit          ;this will determine if 60hz clk is running
        SETZM   CLKGO
        setom   clkflg
        MOVE    116
        MOVE    1,[20,,21]
        SETZM   20
        BLT     1,137
        MOVEM   36
        MOVEM   116
        MOVE    1,[JSR TRAP]    ;BEGIN SET UP PAGER COM WORDS
        MOVEM   1,70            ;      .
        MOVE    1,[11,,12]      ;      .
        MOVEM   1,71            ;      .
        MOVE    1,[456000,,10]  ;      .
        MOVEM   1,72            ;END SET UP PAGER COM WORDS
        MOVE    1,[400000,,0]   ;BEGIN INIT CST FOR PAGES 10,11,12
        MOVEM   1,4010          ;      .
        MOVEM   1,4011          ;      .
        MOVEM   1,4012          ;END INIT CST FOR PAGES 10,11,,12
        MOVE    1,[160040,,10]  ;ACCESS FOR PAGE 10
        MOVEM   1,12775         ;XUACPG
        MOVE    1,[160040,,11]  ;ACCESS FOR PAGE 11
        MOVEM   1,12776         ;XUPTPG
        MOVE    1,[160040,,12]  ;ACCESS FOR PAGE 12
        MOVEM   1,12777         ;XPSBPG
        setom   memhlt          ;default to memory halt on start up
        SETOM   ERRHALT         ;SET ERROR HALT STATUS
        MOVE    1,[BLKSTR,,BLKSTR+1]    ;THIS WILL CLEAR OUT IN CASE OF RES
        SETZM   BLKSTR
        BLT     1,BLKEND                ;DONE
        MOVEI   1,200
        MOVEM   1,SAVPG
        MOVEI   1,200000
        MOVEM   1,SAVADD
        SETZM   CEHLD
        MOVE    1,[POINT 7,INBUF]
        MOVEM   1,SAVEPT        ;START OUT RIGHT
        SETOM   BUFFUL
        MOVE    1,[JSR APRINT]
        MOVEM   1,APRLOC
        MOVE    1,[JSR DSKINT]
        MOVEM   1,DNTLOC
        MOVE    1,[JSR TAPINT]
        MOVEM   1,TNTLOC
        CONO    0,1000          ;TURN OFF CLOCK FLAG TO START WITH
        CONO    PI,10400        ;CLEAR PI SYSTEM AND TURN IT OFF
        CONO    PI,42377        ;TURN ON PI LEVEL 1 FOR APR
        CONO    0,3001          ;PUT APR ON CHANNEL 1
        MOVEI   2,[ASCIZ /
**********************************************
*                                            *
*  This is the TYMSHARE-FOONLY Co-operative  *
*       Tape & Disk Exerciser (TYFOON)       *
*                                            *
*  Nov.-21-1983                 Version 3.5  *
*                                            *
/]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /*  Author: Charles D. Martin                 *
*          Senior Product Support Engineer   *
*          Fremont, Ca.          Ext. 2573   *
**********************************************
/]
        PUSHJ   P,STROUT
        PUSHJ   P,GTPASS
        movei   1,7
        pushj   p,doyou
        skipe   no
        jrst    [setzm  f3
                 movei  1,1000
            movem  1,lstpg
                 MOVE   1,116           ;GET SYMBOL TABLE COUNT
                 HLRZ   1,1             ;SHIFT RIGHT 18 BITS
                 MOVE   2,SUB           ;NUMBER TO SUBTRACT FROM
                 SUB    2,1             ;NOW HAVE COUNT OF SYMBOLS
                 MOVEM  2,COUNT         ;SAVE RESULT
                 MOVE   1,116           ;GET SYMBOL BASE ADDRESS NOW
                 HRRZ   1,1             ;CLEAR LEFT HALF
                 ADD    1,COUNT         ;THIS IS NOW BEGINNING OF BUFFERS
                 ADDI   1,2             ;JUST TO MAKE SURE
                 MOVEI  2,0
                 LSHC   1,-10
                 CAIE   2,0             ;SEE IF EVEN PAGE
                 ADDI   1,1             ;ADD 1 TO PAGE NUMBER
                 LSH    1,10            ;WE NOW HAVE FIXED BUFFER ADD.
                 jrst   bufset]
        MOVEI   1,16
        PUSHJ   P,DOYOU
        SKIPE   NO
        jrst    [setom  chp64k  ;if we have the big chips then this will be 0
                 setzm  chp16k  ;if we have the big chips then this will be -1
                 jrst   chpsel]
        jrst    [setzm  chp64k  ;if we have the small chips this will be 0
                 setom  chp16k  ;if we have the small chips this will be -1
                 jrst   chpsel]
chpsel: movei   1,17
        pushj   p,doyou
        skipe   no
        jrst    [setom  kltype
                 setzm  tenex
                 movei  2,[asciz /
*** The type of paging selected will be of the KL variety. ***
/]
                 pushj  p,strout
                 jrst   inicnt]
        jrst    [setzm  kltype
                 setom  tenex
                 movei  2,[asciz /
*** The type of paging selected will be of the Tenex varitey. ***
/]
                 pushj  p,strout
                 jrst   inicnt]
inicnt: setom   f3
        MOVE    1,116           ;GET SYMBOL TABLE COUNT
        HLRZ    1,1             ;SHIFT RIGHT 18 BITS
        MOVE    2,SUB           ;NUMBER TO SUBTRACT FROM
        SUB     2,1             ;NOW HAVE COUNT OF SYMBOLS
        MOVEM   2,COUNT         ;SAVE RESULT
        MOVE    1,116           ;GET SYMBOL BASE ADDRESS NOW
        HRRZ    1,1             ;CLEAR LEFT HALF
        ADD     1,COUNT         ;THIS IS NOW BEGINNING OF BUFFERS
        ADDI    1,2             ;JUST TO MAKE SURE
        MOVEI   2,0
        LSHC    1,-10
        CAIE    2,0             ;SEE IF EVEN PAGE
        ADDI    1,1             ;ADD 1 TO PAGE NUMBER
        LSH     1,10            ;WE NOW HAVE FIXED BUFFER ADD.
        JRST    INIMEM
f3:     0

INIMEM: ;THIS IS THE INIMEM. IT IS SET ASIDE FROM
        ;INIT SO YOU CAN CLEAR MEMORY AND START
        ;THE TEST BUFFERS OVER AGAIN WITHOUT GOING
        ;THROUGH AN INIT.

        CONO    0,675550        ;DO MISC CLEARS TO THE APR.
        pgroff
        pgrset
        SETZM   GOTINT          ;CLEAR INT. FLAG
        SETZM   COUNTER         ;CLEAR ITERATION COUNTER FOR INT.
        MOVEI   2,[ASCIZ /Starting to size memory
/]
        PUSHJ   P,STROUT
        MOVEI   13,200000       ;USED FOR VIRTUAL ADDRESSING
        MOVE    10,[0,,200]     ;PAGE 400 - FIRST LOCATION OF UPPER 128K
PGON:   PGRON                   ;TURN ON THE PAGER
        MOVE    11,[0,,200]
PGSET:  PGRCLD
        MOVE    1,[400000,,0]   ;USED TO INIT CST
        MOVEM   1,CST(10)       ;PUT IN CST 
        HRRZ    1,10            ;GET THE PAGE NUMBER
        HRLI    1,160040        ;PUT IN ACCESS
        MOVEM   1,MMAP(11)      ;PUT IN MONITOR MAP LOCATION
        SETZM   EXPTRP
        SETOM   EXPNXM
        SETOM   MEMHLT          ;WE DON'T WANT TO HALT UNLESS ^C
        SETZM   USEINT          ;THIS WILL KEEP SCANNR OFF
        SETZM   NXM             ;CLEAR NXM TRAP FLAG
CLEAR:  SETZM   0(13)           ;CLEAR MEMORY LOCATION INDEXED BY 13
        PUSHJ   P,TSTMEM
        SKIPE   NXM             ;IF NXM GET OUT WE ARE DONE
        JRST    DONECK
        MOVE    1,0(13)         ;THIS TO GET NXM TRAP IN MICRO CODE
        movem   1,datclr
        move    1,13
        andi    1,777
        move    2,10
        lsh     2,11
        ior     1,2
        movem   1,addclr
        PUSHJ   P,TSTMEM
        SKIPE   NXM
        JRST    DONECK
        skipe   datclr
        jrst    [carret
                 print /Data at physical address /
                 outoct addclr,7
                 print / is /
                 outoct datclr,14
                 print / should be /
                 setzm datclr
                 outoct datclr,14
                 carret]
        MOVE    13,[200000,,200001] ;THIS WILL CLEAR PAGE AFTER
        SETZM   200000              ;WE TESTED FOR NXM
        BLT     13,200777
        ADDI    10,1            ;INC THE PAGE NUMBERS
        CAIN    10,4000         ;LAST POSSIBLE PAGE +1 OF AN F4
        JRST    DONECK          ;NO SENSE IN CAUSING TROUBLE HERE
        MOVEI   13,200000       ;INIT THE INDEX
        PUSHJ   P,TTYIN
        SKIPE   ABO
        JRST    [SETZM  ABO
                 JRST   DISPAT]
        JRST    PGSET
DONECK: SETZM   EXPNXM
        MOVEI   2,[ASCIZ /Memory size = /]
        PUSHJ   P,STROUT
        SETOM   SIZED
        PGROFF                  ;TURN OFF THE PAGER FOR NOW
        MOVEM   10,LSTPG        ;SAVE THIS LAST PAGE
        MOVE    1,LSTPG         ;GET THE PAGE THAT TRAPPED FROM TRAPPER
        LSH     1,-1            ;A CHEAP DIVIDE BY 2
        MOVEI   2,1             ;NO DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /K
/]
        PUSHJ   P,STROUT
BUFSET: MOVEI   1,200000                ;SET UP BUFFER STARTS FOR TESTS
        MOVEM   1,T1WBUF
        MOVEI   1,770000
        MOVEM   1,T2WBUF
        MOVE    1,T1WBUF        
        ADDI    1,100000
        MOVEM   1,T3WBUF
        ADDI    1,100000
        MOVEM   1,T4WBUF
        ADDI    1,100000
        MOVEM   1,T5WBUF
        ADDI    1,100000
        MOVEM   1,T6WBUF
        ADDI    1,100000
        MOVEM   1,T7WBUF
        MOVEI   1,T1STCT                ;SET UP START COUNTS
        MOVEM   1,T1CNT
        MOVEI   1,T2STCT
        MOVEM   1,T2CNT
        MOVEI   1,T3STCT
        MOVEM   1,T3CNT
        MOVEI   1,T4STCT
        MOVEM   1,T4CNT
        MOVEI   1,T5STCT
        MOVEM   1,T5CNT
        MOVEI   1,T6STCT
        MOVEM   1,T6CNT
        MOVEI   1,T7STCT
        MOVEM   1,T7CNT
        skipe   f3
        pushj   p,[MOVEI        2,[ASCIZ /Pager sytem is enabled.
/]
                   PUSHJ        P,STROUT
                   popj p,]
        movei   2,[asciz /*** Warning *** The 60 hz. clock is not running. 
/]
        SKIPE   CLKGO           ;this should be turned off by now
        movei   2,[asciz /The 60 hz. clock is running.
/]
        pushj   p,strout
        MOVEI   2,[ASCIZ /
*** Try HELP if you are not sure what to do ***
/]
        PUSHJ   P,STROUT
        CONO    PI,10400        ;CLEAR PI SYSTEM AND TURN IT OFF
        CONO    PI,42377        ;TURN ON PI LEVEL 1 FOR APR
        CONO    0,3001          ;PUT APR ON CHANNEL 1
        JRST    DISPAT          ;GO DO THE TEST DAN

APRINT: ;COMES TO HERE EVERYTIME APR IS TRYING TO INTERRUPT THE
        ;THE PROCESS.

        0                       ;THIS IS WHERE THE PC GOES
        PUSH    P,0
        PUSH    P,1
        PUSH    P,2
        SKIPn   F3
        JRST    NOHRDT          ;DON'T DO THIS IF AN F3
        CONI    PI,SAVPI
        MOVE    1,SAVPI
        TRNE    1,1B19
        PUSHJ   P,[PUSH P,0
                   PUSH P,1
                   PUSH P,2
                   XAM  0,305
                   XAM  1,306
                   HLRZ 1,1
                   XAM  2,307
                   MOVEM 0,SAV305
                   HRLI 1,-1
                   IORI 1,777700
                   MOVEM 1,SAV306
                   SETCM 1,SAV306
                   MOVEM 1,SAV306
                   MOVEM 2,SAV307
                   CONO PI,1B19
                   SETOM HRDINT
                   POP  P,2
                   POP  P,1
                   POP  P,0
                   POPJ P,]
NOHRDT: CONI    0,APRBIT
        MOVE    1,APRBIT
        TRNE    1,1B26          ;SEE IF CLOCK BIT
        JRST    [SKIPN  CLKBIT
                 SETOM  CLKGO
                 SETZM  CLKBIT
                 CONO   0,1000  ;TURN OFF THE CLOCK FLAG, DON'T NEED NOW
                 MOVE   1,MILLI 
                 ADDI   1,1
                 CAIN   1,74            
                 JRST   [MOVEI  1,0
                         MOVEM  1,MILLI
                         MOVE   1,SECOND
                         ADDI   1,1
                         CAIN   1,74
                         JRST   [MOVEI  1,0
                                 MOVEM  1,SECOND
                                 MOVE   1,MINUTE
                                 ADDI   1,1
                                 CAIN   1,74
                                 JRST   [MOVEI  1,0
                                         MOVEM  1,MINUTE
                                         MOVE   1,HOUR
                                         ADDI   1,1
                                         CAIN   1,30
                                         JRST   [MOVEI  1,0
                                                 MOVEM  1,HOUR
                                                 MOVE   1,DAYS
                                                 ADDI   1,1
                                                 MOVEM  1,DAYS
                                                 JRST   APREXT]
                                         MOVEM  1,HOUR
                                         JRST   APREXT]
                                 MOVEM  1,MINUTE
                                 JRST   APREXT]
                         MOVEM  1,SECOND
                         JRST   APREXT]
                 MOVEM  1,MILLI
                 JRST   APREXT]
APREXT: POP     P,2
        POP     P,1
        POP     P,0
        skipe   clkflg
        JRST    12,@APRINT
        jrst    @aprint
MILLI:  0
SECOND: 0
MINUTE: 0
HOUR:   0
DAYS:   0
APRBIT: 0

        ;COMES TO HERE IF WE HAVE A CORRECTABLE ECC

SOFERR: PUSH    P,0
        PUSH    P,1
        PUSH    P,2
        XAM     311
        XAM     1,312
        HLRZ    1,1
        XAM     2,313
        CONO    0,1B22
        MOVEM   SAV311
        HRLI    1,-1
        IORI    1,777700
        MOVEM   1,SAV312
        SETCM   1,SAV312
        MOVEM   1,SAV312
        MOVEM   2,SAV313
        MOVEI   2,[ASCIZ /
   *** MEMORY PARITY ERROR - CORRECTABLE ECC ***

/]
        pushj   p,strout
        skipe clkflg
        pushj   p,teltim
        MOVEI   2,[ASCIZ /Soft Memory Error Count is  /]
        pushj   p,strout
        OUTOCT  SAV311,14
        pushj   p,strout
        movei   2,[asciz /
Phys. Address from AMEM 313 /]
        pushj   p,strout
        OUTOCT  SAV313,14
        carret
        carret
        move    1,sav311
        movem   1,mer1
        move    1,sav312
        movem   1,mer2
        move    1,sav313
        movem   1,mer3
        pushj   p,merrep
        SKIPE   MEMHLT                  ;GO BACK TO DISPAT IF HALT FLAG
        JRST    [MOVEI  2,[ASCIZ /
        *** Memory Error Halt ***
/]
                 pushj  p,strout
                 jrst   dispat]
        POP     P,2
        POP     P,1
        POP     P,0
        POPJ    P,                      ;RETURN TO CALLING ROUTINE

merrep: push    p,1
        push    p,2
        push    p,3
        push    p,7
testst: MOVE    1,mer2
        movei   7,0                     ;used as index into tables
        setom   low                     ;reset low flag to start with
lowcnt: camn    1,lowtab(7)             ;see if in table
        setzm   low                     ;yes it is in the table
        addi    7,1                     ;no it is not in the table
        caie    7,26                    ;see if last entry in this table
        jrst    lowcnt                  ;no more entries to do
        movei   7,0                     ;yes start the next table look up
        setom   mult                    ;reset mult flag to start with
mulcnt: camn    1,multab(7)             ;see if in table
        setzm   mult                    ;yes it is in the table
        addi    7,1                     ;no it is not in the table
        caie    7,26                    ;see if last entry in this table
        jrst    mulcnt                  ;no more entrie to do
X1:     MOVE    2,BITTAB(1)
        MOVEM   2,BITERR
        movei   2,[asciz/Ecc Syndrome = /]
        pushj   p,strout
        OUTOCT  mer2,2
        skipe   hrdent
        pushj   p,[movei 2,[asciz /  Invalid due to hard ecc error/]
                   pushj p,strout
                   popj p,]
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        MOVE    1,mer2
        MOVE    2,MESSTAB(1)
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        skipe   chp64k
        jrst    [move   1,[bd064k,,bd0]
                 blt    1,bd7
                 move   1,[bd64ad,,bd0h]
                 blt    1,bd7hl
                 jrst   selret]
        jrst    [move   1,[bd016k,,bd0]
                 blt    1,bd7
                 move   1,[bd16ad,,bd0h]
                 blt    1,bd7hl
                 jrst   selret]
selret: MOVE    1,mer3
        CAMG    1,BD0
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD0HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD0H
                         PUSHJ  P,STROUT
                         SETOM  BRD26H
                         MOVEI  1,CHPTAB
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD0L
                 PUSHJ  P,STROUT
                 SETOM  BRD17L
                 MOVEI  1,CHPTAB+260
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD1
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD1HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD1H
                         PUSHJ  P,STROUT
                         SETOM  BRD25H
                         MOVEI  1,CHPTAB+260*2
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD1L
                 PUSHJ  P,STROUT
                 SETOM  BRD16L
                 MOVEI  1,CHPTAB+260*3
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD2
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD2HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD2H
                         PUSHJ  P,STROUT
                         SETOM  BRD24H
                         MOVEI  1,CHPTAB+260*4
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD2L
                 PUSHJ  P,STROUT
                 SETOM  BRD15L
                 MOVEI  1,CHPTAB+260*5
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD3
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD3HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD3H
                         PUSHJ  P,STROUT
                         SETOM  BRD23H
                         MOVEI  1,CHPTAB+260*6
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD3L
                 PUSHJ  P,STROUT
                 SETOM  BRD14L
                 MOVEI  1,CHPTAB+260*7
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD4
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD4HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD4H
                         PUSHJ  P,STROUT
                         SETOM  BRD22H
                         MOVEI  1,CHPTAB+260*10
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD4l
                 PUSHJ  P,STROUT
                 SETOM  BRD13L
                 MOVEI  1,CHPTAB+260*11
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD5
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD5HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD5H
                         PUSHJ  P,STROUT
                         SETOM  BRD21H
                         MOVEI  1,CHPTAB+260*12
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD5L
                 PUSHJ  P,STROUT
                 SETOM  BRD12L
                 MOVEI  1,CHPTAB+260*13
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD6
        JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD6HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD6H
                         PUSHJ  P,STROUT
                         SETOM  BRD20H
                         MOVEI  1,CHPTAB+260*14
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD6L
                 PUSHJ  P,STROUT
                 SETOM  BRD11L
                 MOVEI  1,CHPTAB+260*15
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVE    1,mer3
        CAMG    1,BD7
X2:     JRST    [SKIPN  MULT
                 JRST   [MOVE   2,BD7HL
                         PUSHJ  P,STROUT
                         SETOM  BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 SKIPN  LOW
                 JRST   [MOVE   2,BD7H
                         PUSHJ  P,STROUT
                         SETOM  BRD19H
                         MOVEI  1,CHPTAB+260*16
                         MOVEM  1,BDBIAS
                         PUSHJ  P,FNDROW
                         JRST   SOFEX]
                 MOVE   2,BD7L
                 PUSHJ  P,STROUT
                 SETOM  BRD10L
X3:              MOVEI  1,CHPTAB+260*17
                 MOVEM  1,BDBIAS
                 PUSHJ  P,FNDROW
                 JRST   SOFEX]
        MOVEI   2,BDX
        PUSHJ   P,STROUT
SOFEX:  MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        pop     p,7
        pop     p,3
        pop     p,2
        pop     p,1
        popj    p,
lowtab: 6
        12
        14
        16
        22
        24
        26
        30
        32
        34
        41
        42
        44
        46
        50
        52
        54
        60
        62
        64
        70
        74
multab: 0
        7
        17
        27
        33
        35
        36
        37
        47
        53
        55
        56
        57
        63
        65
        66
        67
        71
        72
        73
        76
        77

BITERR: 0                               ;POINTS TO THE BIT IN ERROR
RADIX   ^D10
BITTAB: -1      ;NO ERROR
        19      ;ECC5
        18      ;ECC4
        10      ;32
        17      ;ECC3
        5       ;27
        17      ;17
        -1      ;MULT
        16      ;ECC2
        2       ;24
        14      ;14
        13      ;35
        7       ;7
        8       ;30
        20      ;20
        -1      ;MULT
        15      ;ECC1
        0       ;22
        12      ;12
        12      ;34
        5       ;5
        7       ;29
        19      ;19
        -1      ;MULT
        2       ;2
        4       ;26
        16      ;16
        -1      ;MULT
        9       ;9
        -1      ;MULT
        -1      ;MULT
        -1      ;MULT
        14      ;ECC0
        21      ;21
        11      ;11
        11      ;33
        4       ;4
        6       ;28
        18      ;18
        -1      ;MULT
        1       ;1
        3       ;25
        15      ;15
        -1      ;MULT
        8       ;8
        -1      ;MULT
        -1      ;MULT
        -1      ;MULT
        0       ;0
        1       ;23
        13      ;13
        -1      ;MULT
        6       ;6
        -1      ;MULT
        -1      ;MULT
        -1      ;MULT
        3       ;3
        -1      ;NEX
        -1      ;MULT
        -1      ;MULT
        10      ;10
        9       ;31
        -1      ;MULT
        -1      ;MULT
RADIX   ^D8
FNDROW: MOVE    1,SAV313
        skipe   chp16k
        jrst    [AND    1,[340000]
                 jrst   rowret]
        jrst    [and    1,[1600000]
                 lsh    1,-2
                 jrst   rowret]
rowret: MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        CAIN    1,0
DBG1:   JRST    [MOVEI  2,[ASCIZ /Row 0/]
                 pushj p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,232
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,40000
        jrst    [movei  2,[asciz /Row 1/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,204
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,100000
        jrst    [movei  2,[asciz /Row 2/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,156
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,140000
        jrst    [movei  2,[asciz /Row 3/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,130
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,200000
        jrst    [movei  2,[asciz /Row 4/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,102
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,240000
        jrst    [movei  2,[asciz /Row 5/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,54
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,300000
        jrst    [movei  2,[asciz /Row 6/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 ADDI   1,26
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        cain    1,340000
        jrst    [movei  2,[asciz /Row 7/]
                 pushj  p,strout
                 MOVE   1,ONES
                 CAMN   1,BITERR
                 JRST   FNDEX
                 CAMN   1,BDBIAS
                 JRST   FNDEX
                 MOVE   1,BITERR
                 ADD    1,BDBIAS
                 MOVEM  1,DEBUG1
                 SETOM  0(1)
                 jrst   fndex]
        movei   2,[asciz /Row ???/]
        pushj   p,strout
FNDEX:  POPJ    P,
CHPTAB: BLOCK   260*20                  ;A BIG TABLE FOR HISTORY OF BAD CHIPS
ZROTAB: BLOCK   260                     ;DUMMY TABLE
BDBIAS: 0                               ;JUST AS IT SOUNDS
BRD26H: 0
BRD25H: 0
BRD24H: 0
BRD23H: 0
BRD22H: 0
BRD21H: 0
BRD20H: 0
BRD19H: 0
BRD17L: 0
BRD16L: 0
BRD15L: 0
BRD14L: 0
BRD13L: 0
BRD12L: 0
BRD11L: 0
BRD10L: 0
TMP26H: 0
TMP25H: 0
TMP24H: 0
TMP23H: 0
TMP22H: 0
TMP21H: 0
TMP20H: 0
TMP19H: 0
TMP17L: 0
TMP16L: 0
TMP15L: 0
TMP14L: 0
TMP13L: 0
TMP12L: 0
TMP11L: 0
TMP10L: 0
bd0:    0
bd1:    0
bd2:    0
bd3:    0
bd4:    0
bd5:    0
bd6:    0
bd7:    0
BD016k: 377777
BD116k: 777777
BD216k: 1377777
BD316k: 1777777
BD416k: 2377777
BD516k: 2777777
BD616k: 3377777
BD716k: 3777777
BD064k: 1777777
BD164k: 2777777
BD264k: 3777777
BD364k: 4777777
BD464k: 5777777
BD564k: 6777777
BD664k: 7777777
BD764k: 17777777
SAV311: 0
SAV312: 0
SAV313: 0
MULT:   0
LOW:    0
MESSTAB: MESS0
        MESS1
        MESS2
        MESS3
        MESS4
        MESS5
        MESS6
        MESS7
        MESS10
        MESS11
        MESS12
        MESS13
        MESS14
        MESS15
        MESS16
        MESS17
        MESS20
        MESS21
        MESS22
        MESS23
        MESS24
        MESS25
        MESS26
        MESS27
        MESS30
        MESS31
        MESS32
        MESS33
        MESS34
        MESS35
        MESS36
        MESS37
        MESS40
        MESS41
        MESS42
        MESS43
        MESS44
        MESS45
        MESS46
        MESS47
        MESS50
        MESS51
        MESS52
        MESS53
        MESS54
        MESS55
        MESS56
        MESS57
        MESS60
        MESS61
        MESS62
        MESS63
        MESS64
        MESS65
        MESS66
        MESS67
        MESS70
        MESS71
        MESS72
        MESS73
        MESS74
        MESS75
        MESS76
        MESS77
MESS0:  ASCIZ   /No error/
mess1:  asciz   /Ecc 5/
mess2:  asciz   /Ecc 4/
mess3:  asciz   /Data bit 32/
mess4:  asciz   /Ecc 3/
mess5:  asciz   /Data bit 27/
mess6:  asciz   /Data bit 17/
mess7:  asciz   /Multiple error/
mess10: asciz   /Ecc 2/
mess11: asciz   /Data bit 24/
mess12: asciz   /Data bit 14/
mess13: asciz   /Data bit 35/
mess14: asciz   /Data bit 7/
mess15: asciz   /Data bit 30/
mess16: asciz   /Data bit 20/
mess17: asciz   /Multiple error/
mess20: asciz   /Ecc 1/
mess21: asciz   /Data bit 22/
mess22: asciz   /Data bit 12/
mess23: asciz   /Data bit 34/
mess24: asciz   /Data bit 5/
mess25: asciz   /Data bit 29/
mess26: asciz   /Data bit 19/
mess27: asciz   /Multiple error/
mess30: asciz   /Data bit 2/
mess31: asciz   /Data bit 26/
mess32: asciz   /Data bit 16/
mess33: asciz   /Multiple error/
mess34: asciz   /Data bit 9/
mess35: asciz   /Multiple error/
mess36: asciz   /Multiple error/
mess37: asciz   /Multiple error/
mess40: asciz   /Ecc 0/
mess41: asciz   /Data bit 21/
mess42: asciz   /Data bit 11/
mess43: asciz   /Data bit 33/
mess44: asciz   /Data bit 4/
mess45: asciz   /Data bit 28/
mess46: asciz   /Data bit 18/
mess47: asciz   /Multiple error/
mess50: asciz   /Data bit 1/
mess51: asciz   /Data bit 25/
mess52: asciz   /Data bit 15/
mess53: asciz   /Multiple error/
mess54: asciz   /Data bit 8/
mess55: asciz   /Multiple error/
mess56: asciz   /Multiple error/
mess57: asciz   /Multiple error/
mess60: asciz   /Data bit 0/
mess61: asciz   /Data bit 23/
mess62: asciz   /Data bit 13/
mess63: asciz   /Multiple error/
mess64: asciz   /Data bit 6/
mess65: asciz   /Multiple error/
mess66: asciz   /Multiple error/
mess67: asciz   /Multiple error/
mess70: asciz   /Data bit 3/
mess71: asciz   /No board responded/
mess72: asciz   /Multiple error/
mess73: asciz   /Multiple error/
mess74: asciz   /Data bit 10/
mess75: asciz   /Data bit 31/
mess76: asciz   /Multiple error/
mess77: asciz   /Multiple error/
bs0h:   asciz   /Board location B26/
bs1h:   asciz   /Board location B25/
bs2h:   asciz   /Board location B24/
bs3h:   asciz   /Board location B23/
bs4h:   asciz   /Board location B22/
bs5h:   asciz   /Board location B21/
bs6h:   asciz   /Board location B20/
bs7h:   asciz   /Board location B19/
bs0l:   asciz   /Board location C17/
bs1l:   asciz   /Board location C16/
bs2l:   asciz   /Board location C15/
bs3l:   asciz   /Board location C14/
bs4l:   asciz   /Board location C13/
bs5l:   asciz   /Board location C12/
bs6l:   asciz   /Board location C11/
bs7l:   asciz   /Board location C10/
bsX:    asciz   /Board location ???/
bs0hl:  asciz   /Board location B26 or C17/
bs1hl:  asciz   /Board location B25 or C16/
bs2hl:  asciz   /Board location B24 or C15/
bs3hl:  asciz   /Board location B23 or C14/
bs4hl:  asciz   /Board location B22 or C13/
bs5hl:  asciz   /Board location B21 or C12/
bs6hl:  asciz   /Board location B20 or C11/
bs7hl:  asciz   /Board location B19 or C10/
bb0h:   asciz   /Board location C26/
bb1h:   asciz   /Board location C24/
bb2h:   asciz   /Board location C22/
bb3h:   asciz   /Board location C20/
bb4h:   asciz   /Impossible to have this bd. loc./
bb5h:   asciz   /Impossible to have this bd. loc./
bb6h:   asciz   /Impossible to have this bd. loc./
bb7h:   asciz   /Impossible to have this bd. loc./
bb0l:   asciz   /Board location C08/
bb1l:   asciz   /Board location C06/
bb2l:   asciz   /Board location C04/
bb3l:   asciz   /Board location C02/
bb4l:   asciz   /Impossible to have this bd. loc./
bb5l:   asciz   /Impossible to have this bd. loc./
bb6l:   asciz   /Impossible to have this bd. loc./
bb7l:   asciz   /Impossible to have this bd. loc./
bbX:    asciz   /Board location ???/
bb0hl:  asciz   /Board location C26 or C08/
bb1hl:  asciz   /Board location C24 or C06/
bb2hl:  asciz   /Board location C22 or C04/
bb3hl:  asciz   /Board location C20 or C02/
bb4hl:  asciz   /Impossible to have this bd. loc./
bb5hl:  asciz   /Impossible to have this bd. loc./
bb6hl:  asciz   /Impossible to have this bd. loc./
bb7hl:  asciz   /Impossible to have this bd. loc./

;tables of addresses for printing out

bd64ad: bb0h
        bb1h
        bb2h
        bb3h
        bb4h
        bb5h
        bb6h
        bb7h
        bb0l
        bb1l
        bb2l
        bb3l
        bb4l
        bb5l
        bb6l
        bb7l
        bbx
        bb0hl
        bb1hl
        bb2hl
        bb3hl
        bb4hl
        bb5hl
        bb6hl
        bb7hl

bd16ad: bs0h
        bs1h
        bs2h
        bs3h
        bs4h
        bs5h
        bs6h
        bs7h
        bs0l
        bs1l
        bs2l
        bs3l
        bs4l
        bs5l
        bs6l
        bs7l
        bsx
        bs0hl
        bs1hl
        bs2hl
        bs3hl
        bs4hl
        bs5hl
        bs6hl
        bs7hl

;table used for printing out the correct bd location
;due to them changing because of 64k eco.

bd0h:   0
bd1h:   0
bd2h:   0
bd3h:   0
bd4h:   0
bd5h:   0
bd6h:   0
bd7h:   0
bd0l:   0
bd1l:   0
bd2l:   0
bd3l:   0
bd4l:   0
bd5l:   0
bd6l:   0
bd7l:   0
bdx:    0
bd0hl:  0
bd1hl:  0
bd2hl:  0
bd3hl:  0
bd4hl:  0
bd5hl:  0
bd6hl:  0
bd7hl:  0

        ;COMES TO HERE IF WE HAVE A HARD ECC

HRDERR: PUSH    P,0
        PUSH    P,1
        PUSH    P,2
        SKIPE   HRDINT
        JRST    [MOVEI  2,[ASCIZ /
   *** MEMORY PARITY ERROR INTERRUPT - HARD ECC ***

/]
                 PUSHJ  P,STROUT
                 JRST   HRDPAS]
        XAM     0,305
        XAM     1,306
        HLRZ    1,1
        XAM     2,307
        CONO    PI,1B19                 ;TURN OFF ERROR FLAG
        MOVEM   SAV305
        hrli    1,-1
        iori    1,777700
        movem   1,sav306
        setcm   1,sav306
        MOVEM   1,SAV306
        MOVEM   2,SAV307
        movei   2,[asciz /
   *** MEMORY PARITY ERROR - HARD ECC ***

/]
        pushj   p,strout
hrdpas: skipe clkflg
        pushj   p,teltim
        movei   2,[asciz /
Hard Memory Error Count is  /]
        pushj   p,strout
        OUTOCT  SAV305,14
        movei   2,[asciz /
Phys. Address from AMEM 307 /]
        pushj   p,strout
        OUTOCT  SAV307,14
        carret
        carret
        move    1,sav305
        movem   1,mer1
        move    1,sav306
        movem   1,mer2
        move    1,sav307
        LSH     1,20                    ;STRIP OFF UNWANTED BITS
        LSH     1,-20
        movem   1,mer3
        setom   hrdent
        pushj   p,merrep
        setzm   hrdent
        SKIPE   MEMHLT                  ;GO BACK TO DISPAT IF HALT FLAG
        JRST    [MOVEI  2,[ASCIZ /
        *** Memory Error Halt ***
/]
                 pushj  p,strout
                 SETZM  HRDINT
                 jrst   dispat]
        POP     P,2
        POP     P,1
        POP     P,0
        POPJ    P,                      ;RETURN TO CALLING ROUTINE
SAV305: 0
SAV306: 0
SAV307: 0

        ;COMES TO HERE IF WE HAVE A NON-EXISTANT MEMORY

NXMERR: PUSH    P,0
        PUSH    P,1
        PUSH    P,2
        XAM     301
        XAM     1,302
        XAM     2,303
        CONO    0,1B23                  ;TURN OFF ERROR FLAG
        MOVEM   0,SAV301
        MOVEM   1,SAV302
        LSH     2,20
        LSH     2,-20
        MOVEM   2,SAV303
        SKIPE   EXPNXM
        JRST    [SETOM  NXM
                 JRST NXMEXT]
        movei   2,[asciz /
   *** NON-EXISTANT MEMORY ERROR ***

/]
        pushj   p,strout
        skipe clkflg
        pushj   p,teltim
        movei   2,[asciz /
Nex Memory Error Count is   /]
        pushj   p,strout
        OUTOCT  SAV301,14
        movei   2,[asciz /
Memory Status from AMEM 302 /]
        pushj   p,strout
        OUTOCT  SAV302,14
        movei   2,[asciz /
Phys. Address from AMEM 303 /]
        pushj   p,strout
        OUTOCT  SAV303,14
        movei   2,[asciz /

/]
        pushj   p,strout
        SKIPE   MEMHLT                  ;GO BACK TO DISPAT IF HALT FLAG
        JRST    [MOVEI  2,[ASCIZ /
        *** Memory Error Halt ***
/]
                 pushj  p,strout
                 jrst   dispat]
NXMEXT: POP     P,2
        POP     P,1
        POP     P,0
        POPJ    P,                      ;RETURN TO CALLING ROUTINE
SAV301: 0
SAV302: 0
SAV303: 0
NXM:    0
EXPNXM: 0

TSTMEM: ;THIS IS THE CODE THAT TESTS TO SEE IF WE HAVE ANY MEMORY
        ;PROBLEMS.

        skipn   f3
        jrst    tstex
        PUSH    P,1
        PUSH    P,2
        SKIPE   HRDINT
        PUSHJ   P,HRDERR                ;WE HAVE RECEIVED A HRD ERR INT.
        CONI    PI,SAVPI
        MOVE    1,SAVPI
        TRNE    1,1B19
        PUSHJ   P,HRDERR
        CONI    0,SAVAPR
        MOVE    1,SAVAPR
        TRNE    1,1B22
        PUSHJ   P,SOFERR
        TRNE    1,1B23
        PUSHJ   P,NXMERR
        SETZM   HRDINT                  ;CLEAR THE HARD ERR INT FLAG
        POP     P,2
        POP     P,1
tstex:  POPJ    P,
SAVPI:  0
SAVAPR: 0

SCNMEM: ;THIS ROUTINE WILL JUST SIT AND SCAN MEMORY UNTIL
        ;YOU DO A CONTROL C OR CONTROL T.

        SKIPN   F3
        JRST    [MOVEI 2,[ASCIZ /
You can not do this function on a F3.
/]
                 pushj p,strout
                 jrst dispat]
        SKIPN   PGFLG
        JRST    [movei 2,[asciz /
You turned off the pager, remember.
/]
                 pushj  p,strout
                 jrst dispat]
        setzm   verify
        movei   1,12
        pushj   p,doyou
        skipe   no
        setom   verify
        MOVEI   3,17            ;LETS SCAN PROGRAM AREA FIRST
SCNCNT: SETZM   PGDONE
        MOVE    1,0(3)          ;GET A LOCATION, JUST LOOKING FOR ERRORS.
        ADDI    3,1
        CAIE    3,200000        ;START OF OUR PAGING PROCESS
        JRST    SCNCNT          ;GO DO THE REST OF THE PROG AREA.
PGCNT:  MOVE    13,[200000,,200001]
        MOVE    10,SAVPG
        MOVE    7,DATSAV        ;LETS GET CURRENT DATA PATTERN
        PGRON                   ;TURN ON THE PAGER
        MOVE    11,[0,,200]
        PGRCLD
        MOVE    1,[400000,,0]   ;USED TO INIT CST
        MOVEM   1,CST(10)       ;PUT IN CST 
        HRRZ    1,10            ;GET THE PAGE NUMBER
        HRLI    1,160040        ;PUT IN ACCESS
        MOVEM   1,MMAP(11)      ;PUT IN MONITOR MAP LOCATION
        MOVE    1,0(7)          ;GET THE CURRENT PATTERN
        movem   1,patwrd
        MOVEM   1,200000        ;SPREAD THIS SHIT
        BLT     13,200777       
        move    0,200777
        MOVEI   13,200000
        skipn   verify
        jrst    verpas
RDMR:   MOVE    1,0(13)
        MOVEM   1,RDWRD         ;SAVE IT FOR ERROR ROUTINE
        move    1,13
        andi    1,777
        move    2,10
        lsh     2,11
        ior     1,2
        movem   1,scnadd
        move    1,rdwrd
        came    1,patwrd
        jrst    [carret
                 print /   *** Data Compare Error ***/
                 carret
                 carret
                 print /Data at physical address /
                 outoct scnadd,7
                 print / is /
                 outoct rdwrd,14
                 print / should be /
                 outoct patwrd,14
                 carret]
        ADDI    13,1
        CAIG    13,200777
        JRST    RDMR
VERPAS: PUSHJ   P,TSTMEM
        ADDI    10,1
        CAML    10,LSTPG
        PUSHJ   P,[SETOM PGDONE
                   aos mrap
                   MOVEI 10,200
                   ADDI 7,1     ;NEW DATA PATTERN PLEASE
                   CAIN 7,DATEND
                   pushj p,[MOVEI 7,DATTAB
                            AOS MRAP
                            movei 2,[asciz /All data patterns used  /]
                            pushj p,strout
                            pushj p,pritim
                            carret
                            popj p,]
                   POPJ P,]
        PUSHJ   P,TTYIN
        SKIPE   ABO
        JRST    getout
        SKIPE   REPORT
        PUSHJ   P,[MOVEI 2,[ASCIZ /Page = /]
                   pushj p,strout
                   outoct savpg,4
                   movei 2,[asciz /  Pattern = /]
                   pushj p,strout
                   OUTOCT PATWRD,14
                   movei 2,[asciz /  Passes = /]
                   pushj p,strout
                   OUTOCT MRAP,14
                   MOVEI 2,[ASCIZ /  /]
                   PUSHJ P,STROUT
                   PUSHJ P,PRITIM
                   CARRET
                   SETZM REPORT
                   popj p,]
        MOVEM   10,SAVPG
        MOVEM   7,DATSAV
        SKIPE   PGDONE
        JRST    SCNcnt-1
        jrst    PGCNT

SCANNR: ;THIS IS THE SCANNR ROUTINE. IT WILL USE THE MEMORY
        ;MAP TO SCAN ALL OF MEMORY. THIS IS TO PROVIDE A
        ;LITTLE FBUS INTERFERENCE WHILE THE IO IS GOING.

        skipn   f3
        jrst    SCOUT
        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        PUSH    P,7
        PUSH    P,10
        PUSH    P,11
        PUSH    P,12
        PUSH    P,13
        SETOM   EXPTRP
        SKIPN   PGFLG
        JRST    PGEX
;       SKIPE   PGDONE
;       JRST    [       MOVE    13,SAVADD
;                       MOVE    7,DATSAV
;                       MOVE    10,SAVPG
;                LITRT: MOVE    2,0(13) ;GET THE WORD, SEE IF ANY ECC'S
;                       pushj   p,tstmem
;                       ADDI    13,1
;                       CAIE    13,FRSTPG*1000
;                       JRST    [SKIPN GOTINT
;                                JRST   LITRT
;                                JRST   SCNEXT]
;                       SETZM   PGDONE
;                       MOVEM   13,SAVADD
;                       MOVEI   10,FRSTPG
;                       MOVEM   10,SAVPG
;                       JRST    STPGR]
STPGR:  MOVE    13,SAVADD
        MOVE    10,SAVPG
        CAMN    10,SKIP
        JRST    [BUFH0: AOS     BUFHIT
                        ADDI    10,5
                        CAML    10,LSTPG
                        JRST    ENDM
                        JRST    SKIPOK]
        CAMN    10,SKIP1
        JRST    [BUFH1: AOS     BUFHIT
                        ADDI    10,4
                        CAML    10,LSTPG
                        JRST    ENDM
                        JRST    SKIPOK]
        CAMN    10,SKIP2
        JRST    [BUFH2: AOS     BUFHIT
                        ADDI    10,3
                        CAML    10,LSTPG
                        JRST    ENDM
                        JRST    SKIPOK]
        CAMN    10,SKIP3
        JRST    [BUFH3: AOS     BUFHIT
                        ADDI    10,2
                        CAML    10,LSTPG
                        JRST    ENDM
                        JRST    SKIPOK]
        CAMN    10,SKIP4
        JRST    [BUFH4: AOS     BUFHIT
                        ADDI    10,1
                        CAML    10,LSTPG
                        JRST    ENDM
                        JRST    SKIPOK]
SKIPOK: MOVE    7,DATSAV        ;LETS GET CURRENT PATTERN INDEX
PGON1:  PGRON                   ;TURN ON THE PAGER
        MOVE    11,[0,,FRSTPG]
PGSET1: PGRCLD
        MOVE    1,[400000,,0]   ;USED TO INIT CST
        MOVEM   1,CST(10)       ;PUT IN CST 
        HRRZ    1,10            ;GET THE PAGE NUMBER
        HRLI    1,160040        ;PUT IN ACCESS
        MOVEM   1,MMAP(11)      ;PUT IN MONITOR MAP LOCATION
SCNALL: MOVE    1,0(7)          ;GET THE CURRENT PATTERN
        movem   1,patwrd
        MOVEM   1,0(13)
        MOVE    1,0(13)
        MOVEM   1,RDWRD         ;SAVE IT FOR ERROR ROUTINE
        PUSHJ   P,TSTMEM
        ADDI    13,1            ;ADD ONE TO THE INDEX
        CAIG    13,200777       ;THIS IS THE LAST LOC OF THIS PAGE
        JRST    [SKIPN GOTINT
                 JRST  scnall           ;GO FINISH THE PAGE
                 JRST  SCNEXT]
        MOVEI   13,200000
        ADDI    10,1
        CAML    10,LSTPG
        JRST    [ENDM:  SETOM   PGDONE
                        MOVEI   10,FRSTPG ;(*to keep out of buffers for now*)
                        ADDI    7,1     ;NEW DATA PATTERN PLEASE
                        CAIN    7,DATEND
                        MOVEI   7,DATTAB
                        Aos     RAPS
                        SKIPN   DEVICE
                        JRST    NMSGS
                        MOVEI   2,[ASCIZ /Memory has wrapped around, pass number /]
                        pushj   p,strout
                        MOVE    1,RAPS
                        MOVEI   2,1             ;NO DECIMAL POINT
                        MOVEI   3,0
                        PUSHJ   P,DECOUT
                        MOVEI   2,[ASCIZ /  /]
                        PUSHJ   P,STROUT
                        PUSHJ   P,PRITIM
                        movei   2,[asciz /
/]
                        pushj   p,strout
                 NMSGS: JRST    SCNEXT]
SCNEXT: MOVEM   13,SAVADD
        MOVEM   10,SAVPG
        MOVEM   7,DATSAV
PGEX:   PGROFF                  ;TURN OFF THE PAGER FOR NOW
        POP     P,13
        POP     P,12
        POP     P,11
        POP     P,10
        POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
SCOUT:  POPJ    P,0
SAVWRD: 0
DATSAV: DATTAB
DATTAB: 0
        -1
        525252,,525252
        252525,,252525
        707070,,707070
        070707,,070707
        1B35
        1B34
        1B33
        1B32
        1B31
        1B30
        1B29
        1B28
        1B27
        1B26
        1B25
        1B24
        1B23
        1B22
        1B21
        1B20
        1B19
        1B18
        1B17
        1B16
        1B15
        1B14
        1B13
        1B12
        1B11
        1B10
        1B9
        1B8
        1B7
        1B6
        1B5
        1B4
        1B3
        1B2
        1B1
        1B0
DATEND: 0               ;END OF DATA TABLE
SAVPG:  FRSTPG
BLTBUF: BLOCK   100
SAVADD: 200000

WRGDEV: MOVEI 2,[ASCIZ /
You must select correct device first
/]
        PUSHJ   P,STROUT
        JRST    DISPAT
SFTPRO: MOVEI   2,[ASCIZ /
Disk is software write protected
/]
        PUSHJ   P,STROUT
        JRST    DISPAT

TEST0:  ;THIS IS THE TEST0 ROUTINE. IT WILL TURN OFF
        ;THE SINGLET FLAG AND JUMP TO TEST1.

        MOVE    P,SAVEIT
        SETZM   SINGLET
        JRST    TEST1

TEST1:  ;THIS IS TEST1. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL ZEROES,
        ;USING VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS LOADED WITH ALL 7'S TO START
        ;WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP1
        JRST    NOREP1
REP1:   MOVEI   2,[ASCIZ /Starting to execute TEST 1  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP1: PUSHJ   P,TSTMEM
        MOVEI   1,1
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST        ;GO SET UP TEST
        MOVE    1,T1WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T1CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T1RBUF        ;NOW THIS IS READ BUFFER ADDRESS
        SETUPBUF NORAN,T1DATA,T1WBUF,T1CNT,WRITE
        SETUPBUF NORAN,ONES,T1RBUF,T1CNT,READ
        MOVE    3,T1CNT         ;WORD COUNT TO WRITE
        MOVE    1,T1WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT
T1WRT:  WRT     1,0(3)          ;WORD COUNT
        PUSHJ   P,TWAIT         ;GO WAIT FOR INT.
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;GO SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T1WRER
                 JRST   T1EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT         ;GO WAIT FOR INT.
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;GO SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T1RDER
                 JRST   T1EXIT]
        MOVE    3,T1CNT         ;READ BUFFER ADDRESS
        MOVE    1,T1RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT
T1RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT         ;GO WAIT FOR INT.
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;GO SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T1RDER
                 JRST   T1EXIT]
T1CMP:  CMPBUF  CHECK,T1WBUF,T1RBUF,T1CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T1CPER
                 JRST   T1PR]
        JRST    T1CONT
T1PR:   PRTBUFER 1,T1WBUF,T1RBUF,T1CNT
T1CONT: CAIE    0,0             ;SEE IF DELIMITER ERROR
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T1CPER
                   movei 1,1
                   move 2,t1wbuf
                   move 3,t1rbuf
                   move 6,t1cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T1CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T1MAXCT       ;SEE IF MAX COUNT
        JRST    T1ST            ;DO IT AGAIN
        MOVEI   3,T1STCT        ;START OVER AGAIN
T1ST:   MOVE    1,OPER          ;GET TEST COUNTER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T1CNT
        MOVE    1,T1WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T1WBUF
        MOVE    1,T1WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T1CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T1CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T1EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T1WBUF
        JRST    T1EXIT
T1EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T1PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST2
        JRST    TEST1
T1WBUF: 0
T1RBUF: 0
T1DATA: 0                       ;THE TEST PATTERN
T1CNT:  0

TEST2:  ;THIS IS TEST2. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL 7'S.
        ;IT USES A VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS FILLED WITH ALL ZEROES TO
        ;START WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP2
        JRST    NOREP2
REP2:   MOVEI   2,[ASCIZ /Starting to execute TEST 2  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP2: PUSHJ   P,TSTMEM
        MOVEI   1,2
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T2WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T2CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T2RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF NORAN,T2DATA,T2WBUF,T2CNT,WRITE
        SETUPBUF NORAN,ZEROES,T2RBUF,T2CNT,READ
        MOVE    3,T2CNT         ;WRITE COUNT
        MOVE    1,T2WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T2WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T2WRER
                 JRST   T2EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T2RDER
                 JRST   T2EXIT]
        MOVE    3,T2CNT         ;READ BUFFER ADDRESS
        MOVE    1,T2RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T2RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T2RDER
                 JRST   T2EXIT]
T2CMP:  CMPBUF  CHECK,T2WBUF,T2RBUF,T2CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T2CPER
                 JRST   T2PR]
        JRST    T2CONT
T2PR:   PRTBUFER T2,T2WBUF,T2RBUF,T2CNT
T2CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T2CPER
                   movei 1,2
                   move 2,t2wbuf
                   move 3,t2rbuf
                   move 6,t2cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T2CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T2MAXCT       ;SEE IF MAX COUNT
        JRST    T2ST            ;DO IT AGAIN
        MOVEI   3,T2STCT        ;START OVER AGAIN
T2ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T2CNT
        MOVE    1,T2WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T2WBUF
        MOVE    1,T2WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T2CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T2CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T2EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T2WBUF
        JRST    T2EXIT
T2EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T2PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST3
        JRST    TEST2
T2WBUF: 0
T2RBUF: 0
T2DATA: 777777777777            ;THE TEST PATTERN
T2CNT:  0

TEST3:  ;THIS IS TEST3. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL 07'S.
        ;IT USES A VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS FILLED WITH ALL ZEROES TO
        ;START WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP3
        JRST    NOREP3
REP3:   MOVEI   2,[ASCIZ /Starting to execute TEST 3  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP3: PUSHJ   P,TSTMEM
        MOVEI   1,3
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T3WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T3CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T3RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF NORAN,T3DATA,T3WBUF,T3CNT,WRITE
        SETUPBUF NORAN,ZEROES,T3RBUF,T3CNT,READ
        MOVE    3,T3CNT         ;WRITE COUNT
        MOVE    1,T3WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T3WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T3WRER
                 JRST   T3EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T3RDER
                 JRST   T3EXIT]
        MOVE    3,T3CNT         ;READ BUFFER ADDRESS
        MOVE    1,T3RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T3RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T3RDER
                 JRST   T3EXIT]
T3CMP:  CMPBUF  CHECK,T3WBUF,T3RBUF,T3CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T3CPER
                 JRST   T3PR]
        JRST    T3CONT
T3PR:   PRTBUFER T3,T3WBUF,T3RBUF,T3CNT
T3CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T3CPER
                   movei 1,3
                   move 2,t3wbuf
                   move 3,t3rbuf
                   move 6,t3cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T3CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T3MAXCT       ;SEE IF MAX COUNT
        JRST    T3ST            ;DO IT AGAIN
        MOVEI   3,T3STCT        ;START OVER AGAIN
T3ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T3CNT
        MOVE    1,T3WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T3WBUF
        MOVE    1,T3WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T3CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T3CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T3EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T3WBUF
        JRST    T3EXIT
T3EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T3PASS
        MOVE    1,ONES
        CAMN    1,ABO
        jrst    getout
        CAME    1,SINGLET
        JRST    TEST4
        JRST    TEST3
T3WBUF: 0
T3RBUF: 0
T3DATA: 070707070707            ;THE TEST PATTERN
T3CNT:  0

TEST4:  ;THIS IS TEST4. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL 70'S.
        ;IT USES A VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS FILLED WITH ALL ZEROES TO
        ;START WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP4
        JRST    NOREP4
REP4:   MOVEI   2,[ASCIZ /Starting to execute TEST 4  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP4: PUSHJ   P,TSTMEM
        MOVEI   1,4
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T4WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T4CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T4RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF NORAN,T4DATA,T4WBUF,T4CNT,WRITE
        SETUPBUF NORAN,ZEROES,T4RBUF,T4CNT,READ
        MOVE    3,T4CNT         ;WRITE COUNT
        MOVE    1,T4WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T4WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T4WRER
                 JRST   T4EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T4RDER
                 JRST   T4EXIT]
        MOVE    3,T4CNT         ;READ BUFFER ADDRESS
        MOVE    1,T4RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T4RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T4RDER
                 JRST   T4EXIT]
T4CMP:  CMPBUF  CHECK,T4WBUF,T4RBUF,T4CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T4CPER
                 JRST   T4PR]
        JRST    T4CONT
T4PR:   PRTBUFER T4,T4WBUF,T4RBUF,T4CNT
T4CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T4CPER
                   movei 1,4
                   move 2,t4wbuf
                   move 3,t4rbuf
                   move 6,t4cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T4CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T4MAXCT       ;SEE IF MAX COUNT
        JRST    T4ST            ;DO IT AGAIN
        MOVEI   3,T4STCT        ;START OVER AGAIN
T4ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T4CNT
        MOVE    1,T4WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T4WBUF
        MOVE    1,T4WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T4CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T4CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T4EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T4WBUF
        JRST    T4EXIT
T4EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T4PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST5
        JRST    TEST4
T4WBUF: 0
T4RBUF: 0
T4DATA: 707070707070            ;THE TEST PATTERN
T4CNT:  0

TEST5:  ;THIS IS TEST5. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL 52'S.
        ;IT USES A VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS FILLED WITH ALL ZEROES TO
        ;START WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP5
        JRST    NOREP5
REP5:   MOVEI   2,[ASCIZ /Starting to execute TEST 5  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP5: PUSHJ   P,TSTMEM
        MOVEI   1,5
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T5WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T5CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T5RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF NORAN,T5DATA,T5WBUF,T5CNT,WRITE
        SETUPBUF NORAN,ZEROES,T5RBUF,T5CNT,READ
        MOVE    3,T5CNT         ;WRITE COUNT
        MOVE    1,T5WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T5WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T5WRER
                 JRST   T5EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T5RDER
                 JRST   T5EXIT]
        MOVE    3,T5CNT         ;READ BUFFER ADDRESS
        MOVE    1,T5RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T5RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T5RDER
                 JRST   T5EXIT]
T5CMP:  CMPBUF  CHECK,T5WBUF,T5RBUF,T5CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T5CPER
                 JRST   T5PR]
        JRST    T5CONT
T5PR:   PRTBUFER T5,T5WBUF,T5RBUF,T5CNT
T5CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T5CPER
                   movei 1,5
                   move 2,t5wbuf
                   move 3,t5rbuf
                   move 6,t5cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T5CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T5MAXCT       ;SEE IF MAX COUNT
        JRST    T5ST            ;DO IT AGAIN
        MOVEI   3,T5STCT        ;START OVER AGAIN
T5ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T5CNT
        MOVE    1,T5WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T5WBUF
        MOVE    1,T5WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T5CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T5CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T5EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T5WBUF
        JRST    T5EXIT
T5EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T5PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST6
        JRST    TEST5
T5WBUF: 0
T5RBUF: 0
T5DATA: 525252525252            ;THE TEST PATTERN
T5CNT:  0

TEST6:  ;THIS IS TEST6. IT WILL WRITE OUT TO TAPE AND
        ;READ BACK FOR COMPARE A PATTERN OF ALL 25'S.
        ;IT USES A VARIABLE WORD COUNT AND MEMORY ADDRESS.
        ;THE READ BUFFER IS FILLED WITH ALL ZEROES TO
        ;START WITH.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP6
        JRST    NOREP6
REP6:   MOVEI   2,[ASCIZ /Starting to execute TEST 6  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP6: PUSHJ   P,TSTMEM
        MOVEI   1,6
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T6WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T6CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T6RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF NORAN,T6DATA,T6WBUF,T6CNT,WRITE
        SETUPBUF NORAN,ZEROES,T6RBUF,T6CNT,READ
        MOVE    3,T6CNT         ;WRITE COUNT
        MOVE    1,T6WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T6WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T6WRER
                 JRST   T6EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T6RDER
                 JRST   T6EXIT]
        MOVE    3,T6CNT         ;READ BUFFER ADDRESS
        MOVE    1,T6RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T6RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T6RDER
                 JRST   T6EXIT]
T6CMP:  CMPBUF  CHECK,T6WBUF,T6RBUF,T6CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T6CPER
                 JRST   T6PR]
        JRST    T6CONT
T6PR:   PRTBUFER T6,T6WBUF,T6RBUF,T6CNT
T6CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T6CPER
                   movei 1,6
                   move 2,t6wbuf
                   move 3,t6rbuf
                   move 6,t6cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T6CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T6MAXCT       ;SEE IF MAX COUNT
        JRST    T6ST            ;DO IT AGAIN
        MOVEI   3,T6STCT        ;START OVER AGAIN
T6ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER  
        MOVEM   3,T6CNT
        MOVE    1,T6WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T6WBUF
        MOVE    1,T6WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T6CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T6CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T6EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T6WBUF
        JRST    T6EXIT
T6EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T6PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST7
        JRST    TEST6
T6WBUF: 0
T6RBUF: 0
T6DATA: 252525252525            ;THE TEST PATTERN
T6CNT:  0

TEST7:  ;THIS IS TEST7. IT WILL WRITE OUT TO TAPE
        ;AND READ BACK FOR COMPARE A RANDOM PATTERN
        ;OF DATA. IT WILL USE A VARIABLE WORD COUNT
        ;AND MEMORY ADDRESS.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP7
        JRST    NOREP7
REP7:   MOVEI   2,[ASCIZ /Starting to execute TEST 7  /]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP7: PUSHJ   P,TSTMEM
        MOVEI   1,7
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,T7WBUF        ;GET THE WRITE BUFFER ADDRESS
        PUSHJ   P,MEMLIM
        ADD     1,T7CNT         ;NOW POINTS TO WRITE BUFFER +1
        ADDI    1,1             ;ADD 1 TO IT
        MOVEM   1,T7RBUF        ;NOW THIS IS READ BUFFER ADDRESS 
        SETUPBUF RAN,T7DATA,T7WBUF,T7CNT,WRITE
        SETUPBUF NORAN,ZEROES,T7RBUF,T7CNT,READ
        MOVE    3,T7CNT         ;WRITE COUNT
        MOVE    1,T7WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T7WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T7WRER
                 JRST   T7EXIT]
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        BKSP                    ;BACKSPACE ONE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T7RDER
                 JRST   T7EXIT]
        MOVE    3,T7CNT         ;READ BUFFER ADDRESS
        MOVE    1,T7RBUF        ;WORD COUNT
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T7RD:   RDF     1,0(3)          ;READ THE RECORD
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,TPERR
        JRST    [MOVEI  1,1
                 ADDM   1,T7RDER
                 JRST   T7EXIT]
T7CMP:  CMPBUF  CHECK,T7WBUF,T7RBUF,T7CNT
        CAIE    7,0             ;SEE IF BUFFER COMPARE ERRORS
        JRST    [MOVEI  1,1
                 ADDM   1,T7CPER
                 JRST   T7PR]
        JRST    T7CONT
T7PR:   PRTBUFER T7,T7WBUF,T7RBUF,T7CNT
T7CONT: CAIE    0,0             ;SEE IF DELIMITERS OK
        PUSHJ   P,[MOVEI 1,1
                   ADDM 1,T7CPER
                   movei 1,7
                   move 2,t7wbuf
                   move 3,t7rbuf
                   move 6,t7cnt
                   PUSHJ P,DELIMER
                   POPJ P,]
        MOVE    3,T7CNT         ;GET WORD COUNT
        ADDI    3,1             ;ADD ONE TO IT
        CAIE    3,T7MAXCT       ;SEE IF MAX COUNT
        JRST    T7ST            ;DO IT AGAIN
        MOVEI   3,T7STCT        ;START OVER AGAIN
T7ST:   MOVE    1,OPER
        ADDI    1,1
        MOVEM   1,OPER
        MOVEM   3,T7CNT
        MOVE    1,T7WBUF        ;LETS WALK MEMORY
        ADDI    1,1
        MOVEM   1,T7WBUF
        MOVE    1,T7WBUF        ;SEE IF READ BUFFER WILL GO BEYOND
        ADD     1,T7CNT         ;MAX. MEMORY
        ADDI    1,1             ;ADD THE WRITE DELIMITER
        ADD     1,T7CNT         ;ADD THE READ BUFFER
        ADDI    1,1             ;ADD THE READ DELIMITER
        CAMG    1,MAXMEM
        JRST    T7EXIT
        PUSHJ   P,MEMRAP
        MOVE    1,BUFST         ;START OVER
        MOVEM   1,T7WBUF
        JRST    T7EXIT
T7EXIT: SKIPE   TPERR
        JRST    .+3
        MOVEI   1,1
        ADDM    1,T7PASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        CAME    1,SINGLET
        JRST    TEST1
        JRST    TEST7
T7WBUF: 0
T7RBUF: 0
T7DATA: 0                       ;THE TEST PATTERN
T7CNT:  0

TEST8:  ;THIS WILL BE THE START STOP TEST. YOU CAN USE IT TO SETUP
        ;START STOP TIMING WITH THE SCOPE.

        MOVE    P,SAVEIT        ;SET UP STACK POINTER
        MOVE    1,DEVICE
        CAIE    1,1
        JRST    WRGDEV
        SKIPE   REPORT
        JRST    REP8
        JRST    NOREP8
REP8:   MOVEI   2,[ASCIZ /Starting to execute TEST 8 
 /]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP8: PUSHJ   P,TSTMEM
        MOVEI   1,10
        MOVEM   1,NUMBER
        PUSHJ   P,STTEST
        MOVE    1,[T8WBUF,,T8WBUF+1]
        MOVE    2,T8DAT1
        MOVE    3,T8DAT2
        MOVEI   4,0
T8SPR:  MOVEM   2,T8WBUF(4)
        MOVEM   3,T8WBUF+1(4)
        ADDI    4,1
        CAIE    4,T8CNT
        JRST    T8SPR
        MOVE    3,T8CNT         ;WRITE COUNT
        MOVE    1,T8WBUF        ;WRITE BUFFER ADDRESS
        ACTIVATE                ;PUT TAPE ON PI SYSTEM
        SETZM   GOTINT          ;CLEAR INT. FLAG
T8WRT:  WRT     1,0(3)
        PUSHJ   P,TWAIT
        PUSHJ   P,TSTAT         ;GET TAPE STATUS
        PUSHJ   P,DETERM        ;SEE IF BAD ERRORS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        JRST    TEST8

MEMLIM: ;THIS ROUTINE WILL SET UP SCANNR LIMITITATION PAGE ADDRESS

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        LSH     1,-11           ;STRIP OFF THE LOW ORDER BITS
        movem   1,skip
        addi    1,1
        MOVEM   1,SKIP1
        ADDI    1,1
        MOVEM   1,SKIP2
        ADDI    1,1
        MOVEM   1,SKIP3
        ADDI    1,1
        MOVEM   1,SKIP4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,

;       format of a disk sector as created by the formatting routines

;         Region Mnemonic       # Bytes         Description
;       +----------------+
;       !     Gap 1      !        48.
;       !----------------!
;       !     Sync       !         1.
;       !----------------!
;       !  Disk Address  !         4.
;       !----------------!
;       !     ECC 1      !         4.
;       !----------------!
;       !     Splice     !         1.
;       !----------------!
;       !     Gap 2      !        16. FOR CDC160 AND AMP330
;       !                !        56. FOR M2351A
;       !----------------!        
;       !     Sync       !         1.
;       !----------------!
;       !                !
;       /     Data       /
;       /   512 36-bit   /      2304.
;       /     words      /
;       !                !
;       !----------------!
;       !     ECC 2      !         4.
;       !----------------!
;       !     Splice     !         1.
;       !----------------!
;       !     Gap 3      !       136.
;       +----------------+


CLRFMT: SETZM   FBUF
        MOVE    1,[FBUF,,FBUF+1]
        BLT     1,FBUF+31000            ;SHOULD BE ENOUGH CLEARING
        POPJ    P,
COMFMB: MOVE    10,[POINT 8,FBUF]
        SETZM   SECTOR
        MOVEI   11,0
COMFL1: MOVEI   1,60
        IDPB    11,10   ;GAP1
        SOJG    1,.-1
        MOVEI   12,1
        IDPB    12,10   ;SYNC
        PUSHJ   P,SETDA
        MOVE    3,DA
        LSH     3,4                     ;CLEARS OUT UNUSED BITS
        TLZ     3,740000                ;CLEAR HIGH ORDER BITS, THIS SHOULD BE UNIT #
        MOVEM   3,FDA#
        PUSHJ   P,[CML5:        MOVEI 1,4
                   CML6:        LSHC 2,10
                                IDPB 2,10
                                SOJG 1,CML6
                                POPJ P,]
        MOVE    4,FDA           ;GET ADDRESS AGAIN.
        MOVEI   1,40            ;GENERATE 32 BITS OF ECC
        MOVEI   3,0
        LSHC    3,4
COMFL2: TLNE    3,400000
        XORI    3,10
        LSHC    3,1
        TRNE    3,20
        XOR     3,[1B8!1B10!1B20!1B29]
        SOJG    1,COMFL2
        PUSHJ   P,CML5          ;OUTPUT THE ECC BYTES.
        MOVE    1,SPLGP2
        IDPB    11,10   ;DO REQUIRED BYTES FOR SPLICE AND GAP2
        SOJG    1,.-1
        MOVEI   1,1     ;SYNC BYTE
        IDPB    1,10
;;      MOVEI   1,=2304+4+1+=136        ;512 WORDS OF DATA, 4 ECC BYTES,
;;      IDPB    11,10   ; 1 SPLICE, 136 GAP3 (ALL ZEROES).
;;      SOJG    1,.-1
;       ADDI    10,1143 ;SKIP OVER DATA, ECC, SPLICE, AND GAP3,
        ADD     10,DESGP3       ;SKIP OVER DATA, ECC, SPLICE AND GAP3
        IBP     10              ; ALL OF WHICH ARE ZEROES.
        AOS     4,SECTOR
        CAMGE   4,CALCSC
        JRST    COMFL1          ;GO DO ANOTHER SECTOR'S WORTH.
        SETZM   SECTOR
        POPJ    P,

FMT:    MOVEI   1,20
        MOVEM   1,TESTNUM
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        PUSHJ   P,CLRFMT
        PUSHJ   P,GTPASS
        PUSHJ   P,RCAL          ;RECALIBRATE THE DRIVE
        MOVE    1,MINCYL
        CAIE    1,0
        JRST    [MOVEI  2,[ASCIZ /
Because Mincyl is not zero, no attempt to retrieve
and restore BATBLK will be done.
/]
                 pushj  p,strout
                 JRST   FMTRET]
        SETZM   AUTBAT          ;TURN OFF AUTO BAT MODE JUST IN CASE
        MOVEI   2,[asciz /
If this is an old drive, it may be possible to
retrieve the Bat Blocks off of the drive.

/]
        PUSHJ   P,STROUT
        MOVEI   1,2
        PUSHJ   P,DOYOU
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SKIPE   NO
        JRST    [MOVEI 2,[ASCIZ /It is assummed that you know for sure that the Bat Blocks are valid.
/]
                 PUSHJ  P,STROUT
                 MOVEI 2,[ASCIZ /No verification will be performed.
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /Auto bat is disabled.

/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /Trying to retrieve primary Bat Block  -  /]
                 PUSHJ  P,STROUT
                 MOVEI  1,0
                 MOVEM  1,CYL
                 MOVEI  1,1
                 MOVEM  1,HEAD
                 MOVEI  1,4
                 MOVEM  1,SECTOR
                 MOVEI  1,RBUF
                 PUSHJ  P,RDSUB
                 MOVEI  2,[ASCIZ /Got it
/]
                 PUSHJ  P,STROUT
                 MOVE   1,[RBUF,,SAVPRI]
                 BLT    1,SAVPRI+777
                 MOVEI  1,0
                 MOVEM  1,HEAD
                 MOVEI  2,[ASCIZ /Trying to retrieve secondary Bat Block-  /]
                 PUSHJ  P,STROUT
                 MOVEI  1,RBUF
                 PUSHJ  P,RDSUB
                 MOVEI  2,[ASCIZ /Got it

/]
                 PUSHJ  P,STROUT
                 MOVE   1,[RBUF,,SAVSEC]
                 BLT    1,SAVSEC+777
                 JRST   FMTRET]
FMTRET: SETZM   USEINT          ;DONT INT PROCESS
        SETZM   SING
        SETZM   SECTOR          ;NOT USED BUT WHY NOT
        skipe   clkflg
        pushj   p,[movei 2,[asciz /Formatting started at /]
                   pushj p,strout
                   pushj p,pritim
                   carret
                   popj p,]
        MOVE    1,MINHED
        MOVEM   1,HEAD
        MOVE    1,MINCYL
        MOVEM   1,CYL
FMT1:   MOVE    1,MINCYL
        CAIE    1,0
        JRST    FMT2
        MOVEI   1,1
        ADDM    1,SING
        MOVE    1,SING
        CAIN    1,3
        JRST    [SKIPN NO
                 JRST   FMT2
                 MOVEI  1,0
                 MOVEM  1,CYL
                 MOVEI  1,1
                 MOVEM  1,HEAD
                 MOVEI  1,4
                 MOVEM  1,SECTOR
                 MOVE   1,[SAVPRI,,WBUF]
                 BLT    1,WBUF+777
                 MOVEI  2,[ASCIZ /Restoring primary Bat Block  -  /]
                 PUSHJ  P,STROUT
                 MOVEI  1,WBUF
                 PUSHJ  P,WRSUB
                 MOVEI  2,[ASCIZ /Done
/]
                 pushj  p,strout
                 MOVEI  1,0
                 MOVEM  1,HEAD
                 STOPF: MOVE    1,[SAVSEC,,WBUF]
                 BLT    1,WBUF+777
                 movei  2,[asciz /Restoring secondary Bat Block-  /]
                 pushj  p,strout
                 MOVEI  1,WBUF
                 PUSHJ  P,WRSUB
                 movei  2,[asciz /Done
/]
                 pushj  p,strout
                 MOVEI  1,2
                 MOVEM  1,HEAD
                 JRST   FMT2]
fmt2:   MOVE    1,ONES
        CAMN    1,ABO
        JRST    [SETZM  ABO
                 skipe  clkflg
                 pushj p,[movei 2,[asciz /

Aborted at /]
                          pushj p,strout
                          pushj p,pritim
                          popj p,]
                 carret
                 movei  2,[asciz /  *** WARNING - Entire disk NOT formatted ***
/]
                 pushj  p,strout
                 JRST   DISPAT]
        PUSHJ   P,COMFMB
        SKIPE   REPORT
        JRST    REPF
        JRST    NOREPF
REPF:   MOVEI   2,[ASCIZ /Formatting Unit=/]
        PUSHJ   P,STROUT
        MOVE    1,unit
        MOVEI   2,0             ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /  Cyl=/]
        pushj   p,strout
        move    1,cyl
        movei   2,0
        movei   3,0
        pushj   p,decout
        MOVEI   2,[ASCIZ /  Head=/]
        PUSHJ   P,STROUT
        MOVE    1,HEAD
        MOVEI   2,0             ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /   /]
        pushj   p,strout
        pushj   p,pritim
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREPF: PUSHJ   P,TSTMEM
        MOVE    1,[13400,,FBUF]
        MOVEI   4,13400
        PUSHJ   P,DOOP
        PUSHJ   P,INCDAX        ;INCDAX INCREMENTS HEAD,CYL
        JRST    FMT1
        skipe   clkflg
        jrst    [movei  2,[asciz /
Formatting complete at /]
                 jrst   prtit]
        jrst    [movei  2,[asciz /
Formatting complete./]
                 jrst   prtit]
prtit:  pushj   p,strout
        pushj   p,pritim
        movei   2,[asciz/
Be sure to install or verify Bat Blocks.
/]
        pushj   p,strout
        JRST    DISPAT          ;INCDAX SKIPS WHEN DA INCR'D TO 0

FUJI:   MOVE    P,SAVEIT
        MOVEI   1,0
        MOVEM   1,MINCYL
        MOVEI   1,1511
        MOVEM   1,MAXCYL
        MOVE    1,FUCYL1
        MOVEM   1,CYL
        MOVE    1,FUHD1
        MOVEM   1,HEAD
        MOVE    1,FUSEC1
        MOVEM   1,SECTOR
        SETOM   USEINT
        MOVE    2,FUJID1
        MOVE    1,[WBUF,,WBUF+1]
        MOVEM   2,WBUF
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW1: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR1: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 1/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL1
        MOVE    1,HEAD
        MOVEM   1,FUHD1
        MOVE    1,SECTOR
        MOVEM   1,FUSEC1
FUJIS2: MOVE    2,FUJID2
        MOVEM   2,WBUF
        MOVE    1,FUCYL2
        MOVEM   1,CYL
        MOVE    1,FUHD2
        MOVEM   1,HEAD
        MOVE    1,FUSEC2
        MOVEM   1,SECTOR
        MOVE    1,[WBUF,,WBUF+1]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW2: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR2: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 2/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL2
        MOVE    1,HEAD
        MOVEM   1,FUHD2
        MOVE    1,SECTOR
        MOVEM   1,FUSEC2
FUJIS3: MOVE    2,FUJID3
        MOVEM   2,WBUF
        MOVE    1,FUCYL3
        MOVEM   1,CYL
        MOVE    1,FUHD3
        MOVEM   1,HEAD
        MOVE    1,FUSEC3
        MOVEM   1,SECTOR
        MOVE    1,[WBUF,,WBUF+1]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW3: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR3: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 3/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL3
        MOVE    1,HEAD
        MOVEM   1,FUHD3
        MOVE    1,SECTOR
        MOVEM   1,FUSEC3
FUJIS4: MOVE    2,FUJID4
        MOVEM   2,WBUF
        MOVE    1,FUCYL4
        MOVEM   1,CYL
        MOVE    1,FUHD4
        MOVEM   1,HEAD
        MOVE    1,FUSEC4
        MOVEM   1,SECTOR
        MOVE    1,[WBUF,,WBUF+1]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW4: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR4: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 4/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL4
        MOVE    1,HEAD
        MOVEM   1,FUHD4
        MOVE    1,SECTOR
        MOVEM   1,FUSEC4
FUJIS5: MOVE    2,FUJID5
        MOVEM   2,WBUF
        MOVE    1,FUCYL5
        MOVEM   1,CYL
        MOVE    1,FUHD5
        MOVEM   1,HEAD
        MOVE    1,FUSEC5
        MOVEM   1,SECTOR
        MOVE    1,[WBUF,,WBUF+1]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW5: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR5: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 5/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL5
        MOVE    1,HEAD
        MOVEM   1,FUHD5
        MOVE    1,SECTOR
        MOVEM   1,FUSEC5
FUJIS6: MOVE    2,FUJID6
        MOVEM   2,WBUF
        MOVE    1,FUCYL6
        MOVEM   1,CYL
        MOVE    1,FUHD6
        MOVEM   1,HEAD
        MOVE    1,FUSEC6
        MOVEM   1,SECTOR
        MOVE    1,[WBUF,,WBUF+1]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
FUJIW6: PUSHJ   P,WRSUB
        SETZM   RBUF
        MOVE    1,[RBUF,,RBUF+1]
        BLT     1,RBUF+777
        MOVEI   1,RBUF
FUJIR6: PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEI   1,WBUF
        MOVEI   2,RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        PUSHJ   P,[CARRET
                   PRINT        /BUFFER COMPARE ERROR FOR PATTERN 6/
                   CARRET
                   POPJ P,]
        PUSHJ   P,INCDA
        JFCL    0
        JFCL    0
        MOVE    1,CYL
        MOVEM   1,FUCYL6
        MOVE    1,HEAD
        MOVEM   1,FUHD6
        MOVE    1,SECTOR
        MOVEM   1,FUSEC6
        JRST    FUJI
FUCYL1: 100
FUHD1:  1
FUSEC1: 4
FUCYL2: 300
FUHD2:  5
FUSEC2: 4
FUCYL3: 1200
FUHD3:  2
FUSEC3: 10
FUCYL4: 10
FUHD4:  10
FUSEC4: 3
FUCYL5: 1400
FUHD5:  4
FUSEC5: 7
FUCYL6: 20
FUHD6:  4       
FUSEC6: 3
FUJID1: 525252525252
FUJID2: 252525252525
FUJID3: 707070707070
FUJID4: 070707070707
FUJID5: 0
FUJID6: -1

TESTD0: MOVE    P,SAVEIT
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        SETOM   ZEROFLG
        MOVE    1,MINCYL
        CAIE    1,0
        JRST    [ABOTST: MOVEI  2,[ASCIZ /
TEST 0 aborted due to the fact that you have the mincyl, minhed,
minsec or maxcyl, maxhed, maxsec set to values other than the
original values. This will present some logic difficulties to
the exerciser.
/]
                         pushj  p,strout
                         jrst   dispat]
        MOVE    1,MINHED
        CAIE    1,0
        JRST    ABOTST
        MOVE    1,MINSEC
        CAIE    1,0
        JRST    ABOTST
        MOVE    1,CALCCY
        SUBI    1,1
        CAME    1,MAXCYL
        JRST    ABOTST
        MOVE    1,CALCHD
        SUBI    1,1
        CAME    1,MAXHED
        JRST    ABOTST
        MOVE    1,CALCSC
        SUBI    1,1
        CAME    1,MAXSEC
        JRST    ABOTST
        SETOM   USEINT
        JRST    TESTD1
DPRINT: 0

TESTD1: ;WRITES THEN READS A PATTERN OF ZEROES

        MOVE    P,SAVEIT
        MOVEI   1,1
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T1ENT:  MOVE    P,SAVEIT
        MOVEI   1,1
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T1CYL
                   POPJ P,]
        MOVE    1,T1CYL
        MOVEM   1,CYL
        MOVE    1,T1HED
        MOVEM   1,HEAD
        MOVE    1,T1SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T1SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d1wbuf
        pushj   p,memlim
        movei   0,0
        MOVE    1,D1DATA
        MOVE    2,D1WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D1RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D1WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D1RD
        JRST    T2ENT
D1RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D1RBUF
        PUSHJ   P,RDSUB                 ;Call read routine
        MOVEI   0,0
        MOVE    1,D1WBUF
        MOVE    2,D1RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D1CPER
                 JRST   D1PR]
        JRST    D1CONT
D1PR:   PRTBUFER 1,D1WBUF,D1RBUF,D1CNT
D1CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D1PASS
        MOVE    1,CYL
        MOVEM   1,T1CYL
        MOVE    1,HEAD
        MOVEM   1,T1HED
        MOVE    1,SECTOR
        MOVEM   1,T1SEC
        SKIPE   ZEROFLG
        JRST    T2ENT
        SKIPN   PHASEW                          ;SKIP IF WRITE PHASE
        JRST    TESTD1
        SETZM   PHASEW
        JRST    T1ENT
D1DATA: 0
T1CYL:  0
T1HED:  0
T1SEC:  0
D1RDER: 0
D1PASS: 0
D1WBUF: 200000
D1RBUF: 201000
D1CPER: 0
D1CNT:  1000


TESTD2: ;WRITES THEN READS A PATTERN OF -1

        MOVE    P,SAVEIT
        MOVEI   1,2
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DON'T NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T2ENT:  MOVE    P,SAVEIT
        MOVEI   1,2
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T2CYL
                   POPJ P,]
        MOVE    1,T2CYL
        MOVEM   1,CYL
        MOVE    1,T2HED
        MOVEM   1,HEAD
        MOVE    1,T2SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T2SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d2wbuf
        pushj   p,memlim
        movei   0,0
        MOVE    1,D2DATA
        MOVE    2,D2WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D2RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D2WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D2RD
        JRST    T3ENT
D2RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D2RBUF
        PUSHJ   P,RDSUB                 ;Call read routine
        MOVEI   0,0
        MOVE    1,D2WBUF
        MOVE    2,D2RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D2CPER
                 JRST   D2PR]
        JRST    D2CONT
D2PR:   PRTBUFER 2,D2WBUF,D2RBUF,D2CNT
D2CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D2PASS
        MOVE    1,CYL
        MOVEM   1,T2CYL
        MOVE    1,HEAD
        MOVEM   1,T2HED
        MOVE    1,SECTOR
        MOVEM   1,T2SEC
        SKIPE   ZEROFLG
        JRST    T3ENT
        SKIPN   PHASEW
        JRST    TESTD2
        SETZM   PHASEW
        JRST    T2ENT
D2DATA: -1
T2CYL:  0
T2HED:  2
T2SEC:  1
D2RDER: 0
D2PASS: 0
D2WBUF: 202000
D2RBUF: 203000
D2CPER: 0
D2CNT:  1000

TESTD3: ;WRITE THEN READS A PATTERN OF 707070707070

        MOVE    P,SAVEIT
        MOVEI   1,3
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DON'T NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T3ENT:  MOVE    P,SAVEIT
        MOVEI   1,3
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T3CYL
                   POPJ P,]
        MOVE    1,T3CYL
        MOVEM   1,CYL
        MOVE    1,T3HED
        MOVEM   1,HEAD
        MOVE    1,T3SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T3SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d3wbuf
        pushj   p,memlim
        MOVEI   0,0
        MOVE    1,D3DATA
        MOVE    2,D3WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D3RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D3WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D3RD
        JRST    T4ENT
D3RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D3RBUF
        PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVE    1,D3WBUF
        MOVE    2,D3RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D3CPER
                 JRST   D3PR]
        JRST    D3CONT
D3PR:   PRTBUFER 3,D3WBUF,D3RBUF,D3CNT
D3CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D3PASS
        MOVE    1,CYL
        MOVEM   1,T3CYL
        MOVE    1,HEAD
        MOVEM   1,T3HED
        MOVE    1,SECTOR
        MOVEM   1,T3SEC
        SKIPE   ZEROFLG
        JRST    T4ENT
        SKIPN   PHASEW
        JRST    TESTD3
        SETZM   PHASEW
        JRST    T3ENT
D3DATA: 707070707070
T3CYL:  0
T3HED:  4
T3SEC:  2
D3RDER: 0
D3PASS: 0
D3WBUF: 204000
D3RBUF: 205000
D3CPER: 0
D3CNT:  1000

TESTD4: ;WRITE THEN READ A PATTERN OF 070707070707

        MOVE    P,SAVEIT
        MOVEI   1,4
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DON'T NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T4ENT:  MOVE    P,SAVEIT
        MOVEI   1,4
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T4CYL
                   POPJ P,]
        MOVE    1,T4CYL
        MOVEM   1,CYL
        MOVE    1,T4HED
        MOVEM   1,HEAD
        MOVE    1,T4SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T4SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d4wbuf
        pushj   p,memlim
        MOVEI   0,0
        MOVE    1,D4DATA
        MOVE    2,D4WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D4RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D4WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D4RD
        JRST    T5ENT
D4RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D4RBUF
        PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVE    1,D4WBUF
        MOVE    2,D4RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D4CPER
                 JRST   D4PR]
        JRST    D4CONT
D4PR:   PRTBUFER 4,D4WBUF,D4RBUF,D4CNT
D4CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D4PASS
        MOVE    1,CYL
        MOVEM   1,T4CYL
        MOVE    1,HEAD
        MOVEM   1,T4HED
        MOVE    1,SECTOR
        MOVEM   1,T4SEC
        SKIPE   ZEROFLG
        JRST    T5ENT
        SKIPN   PHASEW
        JRST    TESTD4
        SETZM   PHASEW
        JRST    T4ENT
D4DATA: 070707070707
T4CYL:  0
T4HED:  6
T4SEC:  3
D4RDER: 0
D4PASS: 0
D4WBUF: 206000
D4RBUF: 207000
D4CPER: 0
D4CNT:  1000

TESTD5: ;WRITE THEN READ A PATTERN OF 525252525252

        MOVE    P,SAVEIT
        MOVEI   1,5
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DON'T NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T5ENT:  MOVE    P,SAVEIT
        MOVEI   1,5
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T5CYL
                   POPJ P,]
        MOVE    1,T5CYL
        MOVEM   1,CYL
        MOVE    1,T5HED
        MOVEM   1,HEAD
        MOVE    1,T5SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T5SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d5wbuf
        pushj   p,memlim
        MOVEI   0,0
        MOVE    1,D5DATA
        MOVE    2,D5WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D5RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D5WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D5RD
        JRST    T6ENT
D5RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D5RBUF
        PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVE    1,D5WBUF
        MOVE    2,D5RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D5CPER
                 JRST   D5PR]
        JRST    D5CONT
D5PR:   PRTBUFER 5,D5WBUF,D5RBUF,D5CNT
D5CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D5PASS
        MOVE    1,CYL
        MOVEM   1,T5CYL
        MOVE    1,HEAD
        MOVEM   1,T5HED
        MOVE    1,SECTOR
        MOVEM   1,T5SEC
        SKIPE   ZEROFLG
        JRST    T6ENT
        SKIPN   PHASEW
        JRST    TESTD5
        SETZM   PHASEW
        JRST    T5ENT
D5DATA: 525252525252
T5CYL:  0
T5HED:  7
T5SEC:  4
D5RDER: 0
D5PASS: 0
D5WBUF: 210000
D5RBUF: 211000
D5CPER: 0
D5CNT:  1000

TESTD6: ;WRITE THEN READ A PATTERN OF 252525252525

        MOVE    P,SAVEIT
        MOVEI   1,6
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DONT NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T6ENT:  MOVE    P,SAVEIT
        MOVEI   1,6
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPN   CEHLD
        PUSHJ   P,[MOVE 1,CALCCY
                   SUBI 1,1
                   MOVEM 1,T6CYL
                   POPJ P,]
        MOVE    1,T6CYL
        MOVEM   1,CYL
        MOVE    1,T6HED
        MOVEM   1,HEAD
        MOVE    1,T6SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T6SAV                 ;SAVE VIRTUAL ADDRESS
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO SEE IF ANY MEMORY ERRORS
        move    1,d6wbuf
        pushj   p,memlim
        MOVEI   0,0
        MOVE    1,D6DATA
        MOVE    2,D6WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D6RD
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D6WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        SKIPN   ZEROFLG
        JRST    D6RD
        JRST    T7ENT
D6RD:   SETZM   PHASEW
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D6RBUF
        PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVE    1,D6WBUF
        MOVE    2,D6RBUF
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D6CPER
                 JRST   D6PR]
        JRST    D6CONT
D6PR:   PRTBUFER 6,D6WBUF,D6RBUF,D6CNT
D6CONT: PUSHJ   P,INCDA
        JFCL    0
        MOVEI   1,1
        ADDM    1,D6PASS
        MOVE    1,CYL
        MOVEM   1,T6CYL
        MOVE    1,HEAD
        MOVEM   1,T6HED
        MOVE    1,SECTOR
        MOVEM   1,T6SEC
        SKIPE   ZEROFLG
        JRST    T7ENT
        SKIPN   PHASEW
        JRST    TESTD6
        SETZM   PHASEW
        JRST    T6ENT
D6DATA: 252525252525
T6CYL:  0
T6HED:  7
T6SEC:  5
D6RDER: 0
D6PASS: 0
D6WBUF: 212000
D6RBUF: 213000
D6CPER: 0
D6CNT:  1000

TESTD7: ;WRITE THEN READ A PATTERN OF ????????????
        ;USING RANDOM CYL, HEAD AND SECTOR.

        MOVE    P,SAVEIT
        MOVEI   1,7
        MOVEM   1,TESTNUM
        SETZM   ALTER
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SKIPE   DWRTPRO
        JRST    SFTPRO
        PUSHJ   P,TSTPRI
        SKIPE   CEHLD                   ;DONT NEED PASSWORD IF CEHLD
        PUSHJ   P,GTPASS
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        SETOM   PHASEW
T7ENT:  MOVE    P,SAVEIT
        MOVEI   1,7
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        MOVE    1,PHASEW
        CAIN    1,0
        JRST    D7RD
GETAGN: SKIPN   CEHLD
        JRST    [MOVE   1,CALCCY
                 SUBI   1,1     
                 MOVEM  1,T7CYL
                 JRST   XRAN]
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T7CYL
XRAN:   MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN
        MOVE    1,RANDOM
        MOVEM   1,T7HED
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN
        MOVE    1,RANDOM
        MOVEM   1,T7SEC
        MOVE    1,T7CYL
        MOVE    2,T7HED
        MOVE    3,T7SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T7SAV
        MOVE    1,T7CYL
        MOVEM   1,CYL
        MOVE    1,T7HED
        MOVEM   1,HEAD
        MOVE    1,T7SEC
        MOVEM   1,SECTOR
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        SKIPE   INBAT                   ;IF IT WAS IN THE BAT BLOCK DO IT AGAIN
        JRST    GETAGN                  ;MAY BE ONE OF THE OTHER TESTS AREA.
        MOVE    1,[T1SAV,,TMPSAV]
        BLT     1,TMPSAV+7
        MOVEI   2,0
        MOVEI   4,0
TSTDUP: MOVE    1,TMPSAV(4)                     
        MOVE    3,ONES                  ;BLITZ SO IT DON'T COMPARE ITSELF
        MOVEM   3,TMPSAV(4)
DUPMR:  CAMN    1,TMPSAV(2)
        JRST    GETAGN                  ;GET TO HERE ON DUPLICATE VA ADD.
        ADDI    2,1
        CAIE    2,10
        JRST    DUPMR
        MOVEI   2,0
        ADDI    4,1
        CAIE    4,10
        JRST    TSTDUP
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO TEST FOR ANY MEMORY ERRORS
        move    1,d7wbuf
        pushj   p,memlim
        MOVEI   0,1
        MOVE    1,T7DATA
        MOVE    2,D7WBUF
        MOVEI   3,1000
        MOVEI   4,0                     ;NO DELIMITER
        PUSHJ   P,BUFSPR                ;GO SPREAD THE BUFFER
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D7WBUF
        PUSHJ   P,WRSUB                 ;GO WRITE THE STUFF
        HRLZ    1,D7WBUF                ;SAVE THE RANDOM DATA
        IORI    1,T7BUF
        BLT     1,T7BUF+777
        SKIPN   ZEROFLG                 ;SKIP IF ZERO FLAG SET
        JRST    D7RD
        SETZM   PHASEW
        JRST    T1ENT
D7RD:   SETZM   PHASEW
        MOVE    1,T7CYL
        MOVEM   1,CYL
        MOVE    1,T7HED
        MOVEM   1,HEAD
        MOVE    1,T7SEC
        MOVEM   1,SECTOR
        move    1,d7wbuf
        pushj   p,memlim
;       MOVEI   1,0
;       HRLI    1,T7BUF
;       IOR     1,D7WBUF
;       BLT     1,D7WBUF+777
        SKIPE   OVRLAP
        PUSHJ   P,SKDRV
        MOVE    1,D7RBUF
        PUSHJ   P,RDSUB
        MOVEI   0,0
        MOVEi   1,t7buf
        MOVE    2,d7rbuf
        MOVEI   3,1000
        PUSHJ   P,BUFCMP
        CAIE    7,0
        JRST    [MOVEI  1,1
                 ADDM   1,D7CPER
                 JRST   D7PR]
        JRST    D7CONT
D7PR:   PRTBUFER 7,D7WBUF,D7RBUF,D7CNT
D7CONT: MOVEI   1,1
        ADDM    1,D7PASS
        SKIPE   ZEROFLG
        JRST    TESTD1
        JRST    TESTD7
D7DATA: 0
T7CYL:  0
T7HED:  11
T7SEC:  7
T7BUF:  BLOCK   1000
D7RDER: 0
D7PASS: 0
D7WBUF: 214000
D7RBUF: 215000
D7CPER: 0
D7CNT:  1000

TESTD8: MOVE    P,SAVEIT
        MOVEI   1,10
        MOVEM   1,TESTNUM
        SKIPN   ALTER
        PUSHJ   P,[SETZM T8CYL
                   SETZM T8HED
                   SETZM T8SEC
                   POPJ P,]
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        SETZM   ALTER
        SETOM   USEINT
        MOVEI   1,3
        PUSHJ   P,DOYOU
        SKIPE   NO
        SETOM   ALTER
        PUSHJ   P,TSTPRI
        SKIPN   ONCE
        JRST    [T8BEG: SETOM   ONCE
                        MOVE    1,MINCYL
                        MOVEM   1,T8CYL
                        MOVE    1,MINHED
                        MOVEM   1,T8HED
                        MOVE    1,MINSEC
                        MOVEM   1,T8SEC
                        JRST    T8RET]
T8RET:  MOVE    1,T8CYL
        CAMLE   1,MAXCYL                ;THIS IS TO CORRECT PROBLEM OF
        JRST    T8BEG                   ;TEST 8 RUNNING IN RANDOM MODE
        MOVEM   1,CYL                   ;THEN SWITCHING TO SEQ. MODE.
        MOVE    1,T8HED                 ;T8CYL COULD HAVE BEEN > MAXCYL.
        MOVEM   1,HEAD
        MOVE    1,T8SEC
        MOVEM   1,SECTOR
        SETZM   AUTBAT                  ;TURN OFF AUTO BAT **DANGEROUS HERE**
T8ENT:  MOVE    P,SAVEIT
        SKIPE   ALTER
        PUSHJ   P,TTYIN
        SKIPE   ERRDSK                  ;WE RECEIVED A DISK ERROR PRIOR
        PUSHJ   P,[      SKIPN ALTER
                         JRST POPX
                         MOVEI 1,11
                         PUSHJ P,DOYOU
                         SKIPN NO
                         PUSHJ P,INCDA
                         JFCL 0
                   POPX: SETZM ERRDSK
                         POPJ P, ]
        MOVEI   1,10
        MOVEM   1,TESTNUM
        MOVE    1,[JSR DSKINT]
        MOVEM   1,INTLOC
        SKIPE   ALTER
        JRST    RNDPAS
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,CYL
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;GET RANDOM HEAD
        MOVE    1,RANDOM
        MOVEM   1,HEAD
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;GET RANDOM SECTOR
        MOVE    1,RANDOM
        MOVEM   1,SECTOR
RNDPAS: PUSHJ   P,TSTVA                 ;SEE IF IN LIMITS
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        SKIPE   REPORT
        PUSHJ   P,TSTREP                ;GO PRINT ^T INFO
        PUSHJ   P,TSTMEM                ;GO TEST FOR ANY MEMORY ERRORS
        MOVE    1,D8RBUF
        PUSHJ   P,MEMLIM
        PUSHJ   P,[SKDRV:  SKIPE OVRLAP
                           JRST  OK1
                           JRST  NOSK
                   OK1:    SKIPN ALTER
                           JRST  OK2
                           JRST  NOSK
                   OK2:    SKIPN CEHLD
                           JRST  NOSK
                           JRST  OKSK
                   OKSK:   setzm intcnt
                           pushj p,sksub
                   skwait: skipn gotint
                           jrst [aos intcnt
                                 pushj p,ttyin
                                 pushj p,scannr
                                 skipe abo
                                 jrst getout
                                 jrst skwait]
                   NOSK:   POPJ P,]
        MOVE    1,D8RBUF
        PUSHJ   P,RDSUB
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    getout
        MOVEI   1,1
        ADDM    1,D8PASS
        PUSHJ   P,INCDA
        JRST    [MOVE   1,CYL
                 MOVEM  1,T8CYL
                 MOVE   1,HEAD
                 MOVEM  1,T8HED
                 MOVE   1,SECTOR
                 MOVEM  1,T8SEC
                 JRST   T8ENT]
        skipn   alter
        jrst    t8ent
        movei   1,10
        pushj   p,doyou
        skipe   no
        JRST    [move   1,mincyl
                 movem  1,cyl
                 move   1,minhed
                 movem  1,head
                 move   1,minsec
                 movem  1,sector
                 jrst   t8ent]
        movei   2,[asciz /
Scanning aborted by operator /]
prit:   pushj   p,strout
        pushj   p,pritim
        carret
        jrst    dispat
D8RDER: 0
D8PASS: 0
D8WBUF: 216000
D8RBUF: 217000
D8CPER: 0
ALTER:  0
T8CYL:  0
T8HED:  0
T8SEC:  0

GTPASS: ;THIS IS THE GTPASS ROUTINE. IT WILL ASK THE FE FOR A PASSWORD
        ;FOR CERTAIN KINDS OF COMMANDS.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        skipe   passwd          ;if passwd is 0 then we need password
        jrst    gtpex
        MOVEI   2,[ASCIZ /
Because there is certain amount of danger in your
using this exerciser, I must ask you for the /]
        pushj   p,strout
del2:   print /password: /
pasmor: setom   silent
        pushj   p,ttyin
        skipn   bufful
        jrst    [SKIPE  TTYABO
                 JRST   [SETZM  TTYABO
                         MOVEI  2,INBUF
                         SETOM  BUFFUL
                         HRLZI  1,INBUF
                         ADDI   1,INBUF+1
                         SETZM  INBUF
                         BLT    1,INBUF+77
                         MOVE   3,[POINT 7,INBUF]
                         MOVEM  3,SAVEPT
                         carret
                         JRST   DEL2]
                 movei  2,inbuf
                 setom  bufful
                 pushj  p,scanin
                 hrlzi  1,inbuf
                 addi   1,inbuf+1
                 setzm  inbuf
                 blt    1,inbuf+77
                 move   3,[point 7,inbuf]
                 movem  3,savept
                 jrst   pasret]
        jrst    pasmor
pasret: move    1,sel
        caie    1,42            ;this is if password compares
        JRST    [movei  2,[asciz /
You failed the password recognition.

/]
                 pushj  p,strout
                 setzm  passwd
                 jrst   del2]
        movei   2,[asciz /
You have passed the password recognition.
Please be careful, you have wheel status.
/]
        pushj   p,strout
        setom   passwd
gtpex:  setzm   silent
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,

MAKVA:  ;THIS ROUTINE WILL MAKE A VIRTUAL ADDRESS OF THE
        ;CLY,HEAD,SECTOR IN AC 1 2 3 RESPECTIVELY.
        ;IT WILL THEN STORE THE RESULT INTO DSKVA.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        MOVEM   1,PHYCYL
        MOVEM   2,PHYHED
        MOVEM   3,PHYSEC
        MOVE    1,PHYCYL     ;(PHYCYL*(CALCHD*CALCSC))+(PHYHED*CALCSC)+PHYSEC
        MOVE    4,CALCHD
        IMUL    1,4
        MOVEM   1,COMA
        MOVE    1,CALCSC
        MOVE    4,COMA
        IMUL    1,4
        MOVEM   1,COMA
        MOVE    1,PHYHED
        MOVE    4,CALCSC
        IMUL    1,4
        MOVEM   1,COMB
        MOVE    1,PHYSEC
        ADD     1,COMA
        ADD     1,COMB
        MOVEM   1,SAVVA                 ;WE NOW HAVE THE VIRT. ADD OF DSK ADD.
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
SAVVA:  0
PHYCYL: 0
PHYHED: 0
PHYSEC: 0


TSTVA:  ;THIS SUBROUTINE WILL CHECK TO SEE IF VIRTUAL DISK ADDRESS
        ;IS WITHIN LIMITS OF THE SPECIFIED MINCYL, MINHED, MINSEC.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
CMPCUR: MOVE    1,CYL                   ;(CYL*(CALCHD*CALCSC))+(HEAD*CALCSC)
        MOVE    2,HEAD                  ;+SECTOR
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA                 ;WE NOW HAVE VIRTUAL IN VADSK
        MOVE    1,SAVVA
        MOVEM   1,VADSK
CMPMIN: MOVE    1,MINCYL                ;(MINCYL*(CALCHD*CALCSC))
        MOVE    2,MINHED                ;+(MINHED*CALCSC)+MINSEC
        MOVE    3,MINSEC
        PUSHJ   P,MAKVA                 ;WE NOW HAVE VIRTUAL ADD OF LOW LIMIT
        MOVE    1,SAVVA
        MOVEM   1,VAMIN
CMPMAX: MOVE    1,MAXCYL                ;(MAXCYL*(CALCHD*CALCSC))
        MOVE    2,MAXHED                ;+(MAXHED*CALCSC)+MAXSEC
        MOVE    3,MAXSEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,VAMAX                 ;WE NOW HAVE VIRTUAL ADD OF LAST SECTOR
        MOVE    1,VADSK
        CAMLE   1,VAMAX
        JRST    [MOVE   1,MAXCYL
                 MOVEM  1,CYL
                 MOVE   1,MAXHED
                 MOVEM  1,HEAD
                 MOVE   1,MAXSEC
                 MOVEM  1,SECTOR
                 JRST   VAEX]
        CAMGE   1,VAMIN
        JRST    [MOVE   1,MINCYL
                 MOVEM  1,CYL
                 MOVE   1,MINHED
                 MOVEM  1,HEAD
                 MOVE   1,MINSEC
                 MOVEM  1,SECTOR
                 JRST   VAEX]
VAEX:   POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
VAMIN:  0
VAMAX:  0
VADSK:  0

TSTREP: PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        MOVEI   2,[ASCIZ /Executing TEST /]
        PUSHJ   P,STROUT
        MOVE    2,TESTNUM
        CAIN    2,1
        JRST    [MOVEI  2,[ASCIZ /1  /]
                 JRST   TSTCNT]
        CAIN    2,2
        JRST    [MOVEI  2,[ASCIZ /2  /]
                 JRST   TSTCNT]
        CAIN    2,3
        JRST    [MOVEI  2,[ASCIZ /3  /]
                 JRST   TSTCNT]
        CAIN    2,4
        JRST    [MOVEI  2,[ASCIZ /4  /]
                 JRST   TSTCNT]
        CAIN    2,5
        JRST    [MOVEI  2,[ASCIZ /5  /]
                 JRST   TSTCNT]
        CAIN    2,6
        JRST    [MOVEI  2,[ASCIZ /6  /]
                 JRST   TSTCNT]
        CAIN    2,7
        JRST    [MOVEI  2,[ASCIZ /7  /]
                 JRST   TSTCNT]
        CAIN    2,10
        JRST    [MOVEI  2,[ASCIZ /8  /]
                 JRST   TSTCNT]
        MOVEI   2,[ASCIZ /?  /]
TSTCNT: PUSHJ   P,STROUT
        movei   2,[asciz /Unit=/]
        pushj   p,strout
        move    1,unit
        movei   2,0
        movei   3,0
        pushj   p,decout
        MOVEI   2,[ASCIZ /  Cyl=/]
        PUSHJ   P,STROUT
        MOVE    1,CYL
        MOVEI   2,0             ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /  Head=/]
        PUSHJ   P,STROUT
        MOVE    1,HEAD
        MOVEI   2,0             ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /  Sector=/]
        PUSHJ   P,STROUT
        MOVE    1,SECTOR
        MOVEI   2,0             ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /  /]
        pushj   p,strout
        pushj   p,PRITIM
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,

PRITIM: skipn   clkflg
        jrst    timex
        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        move    1,days
        movem   1,tmpdys
        move    1,hour
        movem   1,tmphr
        move    1,minute
        movem   1,tmpmin
        move    1,second
        movem   1,tmpsnd
;       move    1,tmpdys
;       movei   2,1             ;no decimal point
;       movei   3,1             ;only 2 digits
;       pushj   p,decout
;       movei   2,[asciz /:/]
;       pushj   p,strout
        move    1,tmphr
        movei   2,1
        movei   3,1
        pushj   p,decout
        movei   2,[asciz /:/]
        pushj   p,strout
        move    1,tmpmin
        movei   2,1
        movei   3,1
        pushj   p,decout
        MOVEI   2,[ASCIZ /:/]
        PUSHJ   P,STROUT
        move    1,tmpsnd
        movei   2,1
        movei   3,1
        pushj   p,decout
        POP     P,3
        POP     P,2     
        POP     P,1
timex:  POPJ    P,

PAKCPY: ;THIS IS THE PAKCPY ROUTINE.
        ;IT WILL TRY TO COPY DATA FROM DRIVE TO THE OTHER.
        
        MOVE    P,SAVEIT
        movei   1,31
        movem   1,testnum
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    WRGDEV
        carret
        movei   1,6
        pushj   p,doyou
        skipe   no
        jrst    [SETZM  t9CYL
                 SETZM  t9HED
                 SETZM  t9SEC
                 jrst   cpyret]
cpyret: move    1,src
        movem   1,unit
        pushj   p,rcal
        move    1,dst
        movem   1,unit
        pushj   p,rcal
        move    1,retry
        movem   1,retcnt
        setom   copy
        SETZM   AUTBAT                  ;TURN OFF AUTO BAT **DANGEROUS HERE**
        SETzM   USEINT
        movei 2,[asciz /
Copying started /]
        pushj p,strout
        pushj p,pritim
        carret
        setzm   numtry
t9ent:  move    p,saveit        ;setup stack again, could be from error
        skipe   tymout          ;return.
        pushj   p,[setzm tymout
                   movei 1,14
                   pushj p,doyou
                   skipn no
                   pushj p,incda
                   jrst  [move  1,cyl
                          movem 1,t9cyl
                          move 1,head
                          movem 1,t9hed
                          move 1,sector
                          movem 1,t9sec
                          popj   p,]
                   move p,saveit
                   jrst  cpyext]
        skipe   errdsk
        pushj   p,[setzm errdsk
                   move 1,retry
                   movem 1,retcnt
                   movei 1,13
                   pushj p,doyou
                   skipn no
                   pushj p,incda
                   jrst [move   1,cyl
                         movem 1,t9cyl
                         move 1,head
                         movem 1,t9hed
                         move 1,sector
                         movem 1,t9sec
                         popj    p,]
                   move p,saveit
                   jrst cpyext]
        move    1,t9cyl
        movem   1,cyl
        move    1,t9hed
        movem   1,head
        move    1,t9sec
        movem   1,sector
        PUSHJ   P,TSTBAT                ;SEE IF SPOT IN BATBLK
        SKIPE   REPORT
        JRST    REP9
        JRST    NOREP9
REP9:   MOVEI   2,[ASCIZ /Starting to copy Cyl=/]
        PUSHJ   P,STROUT
        MOVE    1,CYL
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /  Head=/]
        PUSHJ   P,STROUT
        MOVE    1,HEAD
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /  Sector=/]
        PUSHJ   P,STROUT
        MOVE    1,SECTOR
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /  /]
        pushj   p,strout
        pushj   p,pritim
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETZM   REPORT
NOREP9: PUSHJ   P,TSTMEM
        move    1,src
        movem   1,unit
        MOVEI   1,RBUF
        PUSHJ   P,RDSUB
        move    1,[rbuf,,wbuf]
        blt     1,wbuf+777
        move    1,dst
        movem   1,unit
        MOVEI   1,WBUF
        pushj   p,wrsub
        MOVE    1,ONES
        CAMN    1,ABO
        JRST    [movei  2,[asciz /
Copying aborted  /]
                 pushj  p,strout
                 pushj  p,pritim
                 carret
                 setzm  abo
                 JRST   DISPAT]
        move    1,retry
        came    1,retcnt
        pushj   p,[move 1,retry
                   sub  1,retcnt
                   movem 1,retcnt
                   movei 2,[asciz /Cyl /]
                   pushj p,strout
                   move 1,cyl
                   movei 2,0
                   movei 3,0
                   pushj p,decout
                   movei 2,[asciz /  Head /]
                   pushj p,strout
                   move 1,head
                   movei 2,0
                   movei 3,0
                   pushj p,decout
                   movei 2,[asciz /  Sector /]
                   pushj p,strout
                   move 1,sector
                   movei 2,0
                   movei 3,0
                   pushj p,decout
                   movei 2,[asciz / recovered after /]
                   pushj p,strout
                   move 1,retcnt
                   movei 2,1
                   movei 3,0
                   pushj p,decout
                   movei 2,[asciz / retries.
/]
                   pushj p,strout
                   move  1,retry
                   movem 1,retcnt
                   popj  p,]
        PUSHJ   P,INCDA
        jrst    [move   1,cyl
                 movem  1,t9cyl
                 move   1,head
                 movem  1,t9hed
                 move   1,sector
                 movem  1,t9sec
                 JRST   T9ENT]
cpyext: movei   2,[asciz /
Copying complete  /]
        pushj   p,strout
        pushj   p,pritim
        carret
        jrst    dispat
t9cyl:  0
t9hed:  0
t9sec:  0

getout: ;JUST A COMMON RETURN

        MOVEI   2,[asciz /
Testing aborted  /]
        pushj   p,strout
        pushj   p,pritim
        carret
        setzm   abo
        jrst    dispat

TSTPRI: ;THIS ROUTINE WILL PRINT OUT AT THE TTY ONCE
        ;AUTO BAT OR NOT AUTO BAT MESSAGE
        
        SKIPE   DPRINT
        POPJ    P,0             ;GET OUT A WASTE OF TIME
        SETOM   DPRINT
        carret
        carret
        skipe clkflg
        pushj   p,teltim
        SKIPN   F3
        JRST    HLTCNT
        skipe   memhlt
        jrst    [movei  2,[asciz /Memory Error Halt is enabled/]
                 pushj  p,strout
                 jrst   hltcnt]
        movei   2,[asciz /Memory Error Halt is disabled/]
        pushj   p,strout
hltcnt: SKIPE   AUTBAT
        JRST    [MOVEI  2,[ASCIZ /
Auto Addbat enabled
/]
                 PUSHJ  P,STROUT
                 pushj  p,seek
                 jrst   comext]
        JRST    [MOVEI  2,[ASCIZ/
Auto Addbat disabled
/]
                 PUSHJ  P,STROUT
                 pushj  p,seek
                 jrst   comext]
comext: SKIPe   SKDIS
        pushj   p,[print /Overlap seek is disabled/
                   carret
                   popj p,]
         popj   p,

RNDGEN:                 ;Quasi-random generator, steps value in RANDOM
        PUSH    P,1             ;Save some ACs on stack
        PUSH    P,2
        MOVE    1,[RHYMEN: BEGPRG,,RNDBUF]
        JUMPE   1,.+2           ;Skip buffer init if not virgin
        BLT     1,RNDBUF+77     ;Init buffer
        SETZM   RHYMEN          ;Clear buffer init flag
        MOVE    1,FIBBA1        ;Step the "address" generator
        EXCH    1,FIBBA0
        ADD     1,FIBBA1
        JUMPN   1,.+3           ;Unhang if in 0,0 loop (once every 2^36 !!)
        SKIPN   FIBBA0
        MOVE    1,[SIXBIT/FOONLY/]
        MOVEM   1,FIBBA1        ;Address generator is stepped, in AC 1 too
                                ;Now fold up AC 1 into six bits by adding bytes
        HLR     2,1             ;Add left and right halves
        ADD     1,2
        MOVE    2,1             ;Add in each sixth
        LSH     2,-6
        ADD     1,2
        MOVE    2,1
        LSH     2,-6
        ADD     1,2
        ANDI    1,77            ;Mask off the resulting mess
        MOVE    2,FIBBS1        ;Step the "source" generator
        EXCH    2,FIBBS0
        ADD     2,FIBBS1
        JUMPN   2,.+3           ;Unhang if in 0,0 loop (once every 2^36 !!)
        SKIPN   FIBBS0
        MOVE    2,[SIXBIT/FOONLY/]
        MOVEM   2,FIBBS1        ;Source generator now stepped, in AC 2 too
        XOR     2,[SIXBIT/FOONLY/]      ;Just for randomness
        ADDM    2,RNDBUF(1)     ;Alter value in table
        HLRZ    2,RNDBUF(1)     ;Add left and right halves
        ADD     2,RNDBUF(1)
        HRRZ    2,2             ;Mask to get low half   
        HRRZ    1,RNDLIM        ;Get (masked) limit
        IMUL    1,2             ;Multiply
        HLRZM   1,RANDOM        ;Save scaled random value
        POP     P,2             ;Restore and exit
        POP     P,1
        POPJ    P,

RANDOM: 0               ;Random output
RNDLIM: 0               ;Upper limit: 0 <= RANDOM < RNDLIM (must fit in RH)
FIBBA0: SIXBIT/YOWIAM/  ;Fibbonacci address generator
FIBBA1: SIXBIT/HAVING/
FIBBS0: SIXBIT/FUN!!!/  ;Fibbonacci source generator
FIBBS1: SIXBIT/-ZIPPY/
RNDBUF: BLOCK 100       ;Buffer for random gubbish

TSTBAT: ;THIS IS THE TSTBAT SUBROUTINE.
        ;IT WILL LOOK TO SEE IF THE CURRENT
        ;CYL HEAD SECTOR IS IN THE BATBLK.
        ;ALSO SEE IF THE BATBLK ITSELF IS TRYING TO
        ;BE ACCESSED. IF SO JUST INCREMENTS IT
        ;USING INCDA.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        PUSH    P,7
        SETZM   INBAT                   ;CLEAR INBAT FLAG
        SETZM   BATWRT
        movei   1,0
        movei   2,1
        movei   3,4                     ;get virtual of primary batblk
        pushj   p,makva
        move    1,savva
        movem   1,hit1
        movei   1,0
        movei   2,0
        movei   3,4                     ;get virtual of secondary batblk
        pushj   p,makva
        move    1,savva
        movem   1,hit2
        movei   4,0                     ;clear index for battab
RTRY:   MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        pushj   p,makva
        move    1,savva
        movem   1,hit3
        CAMN    1,HIT1
        JRST    [WBAT: PUSHJ    P,INCDA
                       SETOM    INBAT
                       SETOM    BATWRT
                       JRST     RTRY]
        CAMN    1,HIT2
        JRST    WBAT
        SKIPN   GOTBAT                  ;NO SENSE IN GOING ON IF NOT BATBLK
        JRST    TSTEXT
tstmor: move    5,battab(4)
        camn    5,batlim
        jrst    tstext
        CAIN    5,0                     ;CAN NOT HAVE ANY BATBLK OF ZERO
        JRST    [MOVEI 2,[ASCIZ /
Can not have any BATBLK of zero, aborting./]
                 pushj  p,strout
                 jrst   dispat]
        camn    5,hit3                  ;make <> to current
        jrst    [pushj  p,incda
                 setom  inbat
                 jrst   RTRY]
        addi    4,1
        jrst    tstmor
TSTEXT: POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
batlim: 707070,,707070
hit1:   0
hit2:   0
hit3:   0

ECCGEN: ;THIS IS A LITTLE ROUTINE I ADDED TO DEBUG
        ;THE ECC OR CRC(SYN) CIRCUIT. WHAT IT DOES IS
        ;GENERATE ECC DATA AND LOGS EACH STEP STARTING
        ;AT LOC 400000. THE DATA IT USES IS RBUF.

        PUSHJ   P,BCNVRT        ;GO CONVERT BUFFER TO 32 BIT BUFFER
        MOVEI   6,0             ;CLEAR INDEX
        MOVEI   5,400000        ;CLEAR THIS INDEX TO
        MOVEI   10,0            ;USED TO SAVE ECC TEMP.
CRC1:   MOVE    4,ECCBUF(6)     ;GET DATA WORD
        MOVEI   1,40            ;GENERATE 32 BITS OF ECC
        MOVEI   3,0
        LSHC    3,4
        OR      3,10            ;PUT IN PREVIOUS ECC
CRC2:   TLNE    3,400000
        XORI    3,10
        LSHC    3,1
        TRNE    3,20
        XOR     3,[1B8!1B10!1B20!1B29]
        MOVE    7,3
        LSH     7,-4                    ;STRIP OFF RIGHT 4 BITS
        LSH     7,4
        MOVEM   7,0(5)                  ;LETS SAVE IT FOR DEBUGGING
        ADDI    5,1
        SOJG    1,CRC2
        MOVE    10,3                    ;SAVE CRC FOR NEXT WORD
        ADDI    6,1
        CAIE    6,1100
        JRST    CRC1
        JRST    DISPAT

BCNVRT: PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,10
        PUSH    P,11
        MOVE    10,[POINT 4,RBUF]
        MOVE    11,[POINT 8,ECCBUF]
        MOVEI   4,0
        MOVEI   5,0
DCNT:   ILDB    2,10
        ILDB    3,10
        LSH     3,40
        LSHC    2,4
        IDPB    2,11
        ADDI    4,1
        CAIG    4,10
        JRST    DCNT
        MOVEI   4,0
        ADDI    5,1
        CAIG    5,400
        JRST    DCNT
DEXT:   POP     P,11
        POP     P,10
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,


RDSUB:  ;Modified read subroutine. It will use variable read and write buffers
        ;AC 1 CONTAINS THE BUFFER ADDRESS TO READ INTO.

        MOVE    2,1
        MOVE    3,1                     ;USED FOR CLEARING THE FIRST WORD
        ADDI    2,1                     ;USED FOR CLEARING THE BUFFER
        HLRZ    1,1                     ;MOVE THE ADDRESS TO THE LEFT
        IOR     1,2                     ;NOW WE HAVE BLT INFO
        ADDI    2,777                   ;THIS IS THE END OF BLT AREA
        SETZM   (3)                     ;CLEARED FIRST AREA
        BLT     1,0(2)                  ;BUFFER SHOULD BE CLEARED
        MOVE    1,3                     ;GET THE ORIGINAL ADDRESS
        MOVEI   4,0
        PUSHJ   P,DOOP
RDXSUB: POPJ    P,
        POPJ    P,                      ;I DON'T KNOW WHY EITHER


select: move p,saveit
        pushj p,selctd
        jrst    goddt

RD:     MOVE    P,SAVEIT
        setom   ddtind
        movei   1,1
        movem   1,ddtknd
        setzm   numtry
rdent:  MOVE    1,[RBUF,,RBUF+1]
        SETZM   RBUF
        BLT     1,RBUF+777
        MOVE    1,[0,,RBUF]
        MOVEI   4,0
        PUSHJ   P,DOOP
RDX:    JFCL    0
        setzm   ddtind
        carret
        print   /Number of retries = /
        outoct  numtry,3
        carret
        carret
        JRST    goddt

RCAL:   LE      RST             ;RESET CONTROLLER
        LC      [1404000]       ;SEND A RECALIBRATE TO THE DRIVE
        PUSHJ   P,GO
        POPJ    P,0

RECAL:  MOVE    P,SAVEIT
        setzm   numtry
        setom   ddtind
        movei   1,3
        movem   1,ddtknd
rclent: PUSHJ   P,RCAL
        carret
        print   /Number of retries = /
        outoct  numtry,3
        carret
        carret
        setzm   ddtind
        JRST    GODDT

WR:     MOVE    P,SAVEIT
        setzm   numtry
        setom   ddtind
        movei   1,2
        movem   1,ddtknd
wrent:  MOVEI   1,WBUF
        PUSHJ   P,WRSUB
wrx:    jfcl    0
        carret
        print   /Number of retries = /
        outoct  numtry,3
        carret
        carret
        setzm   ddtind
        JRST    GODDT

WRSUB:  ;MODIFIED WRSUB ROUTINE. IT WILL LET US WRITE AT
        ;VARIABLE ADDRESS
        MOVEM   1,HLDADD
        SKIPE   CEHLD
        jrst    wrok
        MOVE    1,CALCCY        ;IF CE HOLD THEN THIS WILL BE THE FIRST
        SUBI    1,1             ;PLACE HE CAN WRITE ON, NO OTHERS <.
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,MAKVA
        MOVE    4,SAVVA
        MOVEM   4,SAVCUR
        MOVE    1,CYL           ;the current cyl head sector he is trying
        MOVE    2,HEAD          ;to write on.
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    4,SAVVA
        CAMGE   4,SAVCUR
        JRST    [WRNOK: MOVEI   2,[ASCIZ /
Attempting to write on area protected by program.
Please correct problem before going on.
/]
                        pushj   p,strout
                        jrst   DISPAT]
wrok:   MOVE    1,HLDADD
        HRLI    1,11000
        MOVEI   4,11000
        PUSHJ   P,DOOP
WRXSUB: POPJ    P,

SAVCUR: 0

TSTSK:  PUSH    P,0
        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        SETZM   GOTINT
        PUSHJ   P,SKSUB
        SETZM   GOTINT
;       CONO    PI,10400        ;CLEAR PI SYSTEM AND TURN IT OFF.
;       CONO    PI,42300
;       CONO    0,3001          ;FOR THE CLOCK
;       CONO    PI,2210
;       DCONO   DINTCHN
SK:     ADDM    10,SKCNT
        RC      0               ;GET THE STATUS
        TLNE    S.ONCY
        JRST    .+2
        JRST    [PUSHJ  P,TTYIN
                 PUSHJ P,SCANNR
                 JRST SK]
        skipn   gotint
        jrst    [movei  2,[asciz /
On-Cylinder received, but interrupt not received on seek.
/]
                 pushj  p,strout
                 jrst   goddt]
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POP     P,0
        POPJ    P,

SEEK:   setzm   ovrlap
        skipe   skdis
        popj    p,
        movei   2,[asciz /Performing overlap seek test.
/]
        pushj   p,strout
        SETZM   SPECSK
        SETZM   SKFLG
        SETZM   USEINT
        PUSHJ   P,RCAL
ROVR:   RC      0               ;GET STATUS
        TLNN    S.ONCY          ;DO WE HAVE ON-CYLINDER?
        JRST    ROVR            ;GO BACK NO ON-CYL YET
        MOVE    1,CALCCY
        SUBI    1,1
        MOVEM   1,CYL
        SETZM   GOTINT
        SETOM   USEINT
        PUSHJ   P,SKSUB
FIRSK:  SKIPN   GOTINT
        AOS     INTCNT
        RC      0               ;GET THE STATUS
        TLNE    S.ONCY
        JRST    .+2
        JRST    [AOS SKCNT
                 PUSHJ P,TTYIN
                 SKIPE REPORT
                 PUSHJ P,[MOVEI 2,[ASCIZ /Overlap seek test.
/]
                          PUSHJ P,STROUT
                          SETZM REPORT
                          POPJ P,]
                 SKIPE ABO
                 JRST   [SETZM ABO
                         SETZM  SKFLG
                         SETZM  SPECSK
                         JRST DISPAT]
                 JRST FIRSK]
        skipn   gotint
        jrst    [movei  2,[asciz /On-Cylinder received, but interrupt not received on seek.
/]
                 pushj  p,strout
                 jrst   endsk]
        move    1,intcnt
        caie    1,0
        jrst    [MOVEI  2,[ASCIZ /Operation complete, appears that overlap seek
E.C.O. is installed correctly.
/]
                 pushj  p,strout
                 setom  ovrlap
                 SETZM  SLOW
                 jrst   endsk]
        jrst    [movei  2,[asciz /Operation complete, appears that overlap seek
E.C.O. is not installed correctly. Please notify
Tymshare hardware maintenance personel.
/]
                 pushj  p,strout
                 setzm ovrlap
                 SETOM  SLOW
                 jrst   endsk]
endsk:  movei   2,[asciz /Skcnt = /]
        pushj   p,strout
        outoct  skcnt,6
        movei   2,[asciz /   Intcnt = /]
        pushj   p,strout
        outoct  intcnt,6
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SETOM   USEINT
        MOVE    TESTNUM
        CAIN    10
        PUSHJ   P,[SKIPE ALTER
                   SETZM USEINT
                   POPJ P,]
        CAIG    7
        PUSHJ   P,[SKIPN CEHLD
                   SETZM USEINT
                   POPJ P,]
        popj p,

SKSUB:  MOVE    1,[0,,RBUF]
        MOVEI   4,0
        SETOM   SPECSK
        SETZM   SKCNT
        SETZM   INTCNT
        PUSHJ   P,DOOP
        SETZM   SPECSK          ;JUST TO CLEAN UP ACT
        SETZM   SKFLG           ;SAME HERE
        POPJ    P,

DOOP:   ;THIS IS THE DISK DOOP ROUTINE. IT WILL DO A DISK OPERATION
        ;THAT WAS SPECIFIED. TO BE REWRITTEN.

        MOVEM   1,MA            ;RECORD THE DATA ADDRESS.
        MOVEM   4,CMD           ;ALSO THE COMMAND.
        LE      RST             ;RESET CTRL
        PUSHJ   P,SETDA
        LA      1               ;DESELECT OLD DRIVE AND LOAD NEW DSK ADDR.
        TLO     1,2000          ;OR IN THE SELECT ENABLE BIT.
        LA      1               ;SELECT DRIVE 
        RC      0               ;READ STATUS BITS.
        MOVEM   0,DSKSTA
        TLNE    S.SERR          ;SELECT ERROR ?
B.SEL1: JSP     R,B.ERR
        LC      RCMD            ;FAULT CLEAR (NOTE: USED IN ECO TO FIX CLOCK)
        PUSHJ   P,GO
        SKIPE   SPECSK
        SETOM   SKFLG
        LC      CMD             ;load cmd register
        lm      newma           ;lets jiggle the ma reg
        rm      2               ;before we really load it - conflict you know
        and     2,lstma
        came    2,newma
        pushj   p,[errma: move 1,maerr
                          addi 1,1
                          movem 1,maerr
                          popj p,]
        move    1,newma         ;
        addi    1,1
        camn    1,lstma
        movei   1,0             ;start over again
        movem   1,newma
        LM      MA                      ;LOAD DISK MA REG.
        RC      0
        MOVEM   0,DSKSTA
        TRNE    S.ANY
        JSP     R,B.ERR
        TLNE    S.SERR          ;FOLLOWING CODE IN CASE SUMMARY NOT SET
        JSP     R,B.ERR
        TLNE    S.NRDY
        JSP     R,B.ERR
        TLNE    S.SEEK
        JSP     R,B.ERR
        tlne    s.hdecc
        jsp     r,b.err
        TLNE    S.DFLT
        JSP     R,B.ERR
        TLNE    S.HCER
        JSP     R,B.ERR
        TLNE    S.hecc
        JSP     R,B.ERR
        TLNE    S.secc
        JSP     R,B.ERR
        TLNE    S.rovr
        JSP     R,B.ERR
        TLNE    S.WOVR
        JSP     R,B.ERR
        TLNE    S.SOVR
        JSP     R,B.ERR
        MOVE    1,TESTNUM
        CAIE    1,20
        PUSHJ   P,[TLNE S.SPAR
                   JSP  R,B.ERR
                   POPJ P,]
        PUSHJ   P,GO
DOOPX:  POPJ    P,
CMD:    0
MA:     0
RCMD:   404000
RST:    2
lstma:  3777777

SELCTD: ;THIS ROUTINE WILL JUST SELECT A DRIVE AND SEE IF IT
        ;IS ABLE TO COMM.

        SETOM   DWRTPRO         ;BECAUSE YOU MIGHT SWITCH DRIVES IN MID STREAM
        SETZM   AUTBAT          ;TURN OFF AUTO BAT MODE
        SETZM   CEHLD           ;FORCE DIAG AT CE CYLINDERS
        LE      RST             ;RESET CONTROLLER
        PUSHJ   P,SETDA
        MOVE    1,DA
        LA      1                       ;DESLECT OLD DRIVE & LOAD NEW DSK ADD.
        TLO     1,2000                  ;OR IN SELECT ENABLE BIT
        LA      1                       ;SELECT DRIVE
        RC      0                       ;READ STATUS BITS
        MOVEM   0,DSKSTA                ;PUT THE STATUS THERE
        TLNE    S.SERR                  ;SEE IF SELECT ERROR
        JRST    [movei  2,[asciz /
     *** ERROR on Initail Select ***
/]
                 pushj  p,strout
                 PUSHJ  P,TASTAT
                 JRST   DISPAT]
        movei   2,[asCIz /
Drive responded to the select

/]
        pushj   p,strout
        move    0,dsksta
        tlne    s.wrlk
        jrst    .+2
        pushj   p,[movei        2,[asciz /** Warning - Disk is not write protected **
/]
                   pushj p,strout
                   popj p,]
        POPJ    P,0

SETDA:  ;THIS IS THE SETDA SUBROUTINE. IT WILL BUILD DA
        ;FROM UNIT CYLINDER HEAD AND SECTOR.

        MOVE    1,UNIT
        DPB     1,[POINT 3,DA,6]
        MOVE    1,CYL
        DPB     1,[POINT 12,DA,19]
        MOVE    1,HEAD
        DPB     1,[POINT 8,DA,27]
        MOVE    1,SECTOR
        DPB     1,[POINT 8,DA,35]
        MOVE    1,DA
        POPJ    P,
DA:     0                               ;THIS IS THE HARDWARE DISK ADD.

        ;THIS IS THE ROUTINE TO MAKE THE DISK REALLY GO.

GO:     SETZM   GOTINT
GO1:    LE      [1]             ;STARTS DISK OPERATION.
        SKIPE   USEINT
        PUSHJ   P,[DCONO 4
                   AOS  (P)
                   POPJ P,]
        DCONO   0
        SKIPE   SKFLG           ;OVERLAP SEEK FLAG
        JRST    [       SETZM GOCNT
                 TSAGN: AOS GOCNT
                        RC 0
                        TLNE S.ONCY
                        JRST TSAGN
                        LE [2]  ;KILL THE DISK READ OPERATION
                        SETZM GOTINT
                        SKIPE USEINT
                        PUSHJ P,[DCONO 24
                                 AOS (P)
                                 POPJ P,]
                        DCONO 0
                        JRST GOX]       ;GET OUT OF HERE        
        MOVE    1,DTIMOUT       ;GET TIMOUT COUNTER
GOL:    SKIPN   USEINT
        JRST    [PUSHJ  P,TTYIN
                 JRST   GOM]
        JRST    [SETZM  WTCNT
                 PUSHJ  P,DWAIT
                 JRST   GOM]
GOM:    
GOL1:   RC      0               ;READ COMMAND & STATUS BITS INTO AC 0
        MOVEM   0,DSKSTA
        TLNN    0,S.NBSY        ;CHECK FOR NOT BUSY.
        SOJG    1,GOL
        JUMPG   1,EX            ;CHECK FOR TIMED OUT...
B.TIMO: JSP     R,B.ERR
EX:     SKIPN   USEINT
        JRST    XX
        SKIPE   GOTINT
        JRST    XX
        JRST    GOL
XX:     TRNN    6000            ;SKIP IF NON-MEM OR WHOLE TRACK OPERATION.
        JRST    GO3             ;NOT A READ OR WRITE OPERATION
        RM      1               ;GET ENDING MA
        TLZ     1,777776
        SUB     1,MA
GO3:    TRNE    S.ANY   ;CHECK ERROR SUMMARY BIT
B.GANY: JSP     R,B.ERR
        TLNE    S.SERR          ;FOLLOWING CODE IN CASE SUMMARY NOT SET
        JSP     R,B.ERR
        TLNE    S.NRDY
        JSP     R,B.ERR
        TLNE    S.SEEK
        JSP     R,B.ERR
        TLNE    S.DFLT
        JSP     R,B.ERR
        tlne    s.hdecc
        jsp     r,b.err
        TLNE    S.HCER
        JSP     R,B.ERR
        tlne    s.hecc
        jsp     r,b.err
        tlne    s.secc
        jsp     r,b.err
        TLNE    S.ROVR
        JSP     R,B.ERR
        TLNE    S.WOVR
        JSP     R,B.ERR
        TLNE    S.SOVR
        JSP     R,B.ERR
        MOVE    1,TESTNUM
        CAIE    1,20
        PUSHJ   P,[TLNE S.SPAR
                   JSP  R,B.ERR
                   POPJ P,]
GOX:    POPJ    P,
COROUT: 0
BLTAC:  RBUF+1000,,RBUF+1000
BLTEND: RBUF+2000
USEMEM: 0

B.ERR:  skipe   copy
        jrst    [aos numtry
                 move 1,retry
                 came 1,numtry
                 jrst   t9ent
                 jrst   E0]
        skipn   ddtind          ;Dont't skip if not rd or wr function
        jrst    E0
        SKIPe   RETRY
        jrst    [aos    numtry
                 move   1,retry
                 came   1,numtry        
                 jrst   [move p,saveit ;set stack back up just in case
                         move 1,ddtknd
                         cain 1,1
                         JRST  rdent
                         cain 1,2
                         JRST  wrent
                         cain 1,3
                         JRST  rclent
                         jrst e0]
                 jrst   E0]
E0:
        MOVEI   1,0
        MOVEM   1,TSTSAV
E1:     CAIE    R,B.TIMO+1
        JRST    E2
        movei   2,[asciz /
     *** TIMEOUT ERROR - TEST /]
        pushj   p,strout
        PUSHJ   P,PTEST
        movei   2,[asciz / ***
/]
        pushj   p,strout
        PUSHJ   P,TASTAT
        JRST    DISPAT
E2:     movei   2,[asciz/
     ******* ERROR - TEST /]
        pushj   p,strout
        PUSHJ   P,PTEST
        movei   2,[asciz / *******
/]
        pushj   p,strout
        PUSHJ   P,TASTAT
        SKIPE   AUTBAT
        JRST    ADDBAT
        skipe   copy
        jrst    [setom errdsk
                 jrst t9ent]
        JRST    DISPAT
PTEST:  MOVE    1,TESTNUM
        MOVEM   1,TSTSAV
        CAIN    1,10
        JRST    [movei  2,[asciz /8/]
                 pushj  p,strout
                 JRST SPEC2]
        CAIN    1,20
        JRST    [movei 2,[asciz /FMT/]
                 pushj  p,strout
                 JRST   SPEC2]
        CAIN    1,21
        JRST    [movei 2,[asciz /GETBAT/]
                 pushj p,strout
                 JRST   SPEC2]
        CAIN    1,22
        JRST    [movei 2,[asciz /INSBAT/]
                 pushj  p,strout
                 JRST   SPEC2]
        CAIN    1,23
        JRST    [movei 2,[asciz /ADDBAT/]
                 pushj  p,strout
                 JRST   SPEC2]
        CAIN    1,30
        JRST    [movei 2,[asciz /EDDT/]
                 pushj  p,strout
                 JRST   SPEC2]
        cain    1,31
        jrst    [movei 2,[asciz /COPY/]
                 pushj  p,strout
                 jrst   spec2]
        MOVEI   2,TESTNUM
        MOVEI   3,1
        PUSHJ   P,OCTOUT
SPEC2:  POPJ    P,0
USEINT: 0
DTIMOUT:        60000
TSTSAV: 0

TASTAT: ;THIS IS THE REWRITTEN STATUS ROUTINE FROM DISK TEST (DT.FAI)

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        SETOM   ENTRY1
STATUS: MOVE    2,DEVICE
        CAIE    2,1                     ;IF IT IS A 1 THEN TAPE DRIVE
        JRST    [CAIE   2,2
                 JRST   STPRI
                 JRST   STDSK]
        JRST    STTAP
STPRI:  MOVEI   2,[ASCIZ /
You must select a device first **TRY HELP**
/]
        PUSHJ   P,STROUT
        JRST    DISPAT
STDSK:  MOVE    1,TESTNUM
        CAIN    1,1
        JRST    [MOVEI  1,1
                 ADDM   1,D1RDER
                 JRST   TACONT]
        CAIN    1,2
        JRST    [MOVEI  1,1
                 ADDM   1,D2RDER
                 JRST   TACONT]
        CAIN    1,3
        JRST    [MOVEI  1,1
                 ADDM   1,D3RDER
                 JRST   TACONT]
        CAIN    1,4
        JRST    [MOVEI  1,1
                 ADDM   1,D4RDER
                 JRST   TACONT]
        CAIN    1,5
        JRST    [MOVEI  1,1
                 ADDM   1,D5RDER
                 JRST   TACONT]
        CAIN    1,6
        JRST    [MOVEI  1,1
                 ADDM   1,D6RDER
                 JRST   TACONT]
        CAIN    1,7
        JRST    [MOVEI  1,1
                 ADDM   1,D7RDER
                 JRST   TACONT]
        CAIN    1,10
        JRST    [MOVEI  1,1
                 ADDM   1,D8RDER
                 JRST   TACONT]
TACONT: carret
        skipe clkflg
        pushj   p,teltim
        movei   2,[asciz /Unit = /]
        pushj   p,strout
        MOVE    1,UNIT
        MOVE    2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /  Cylinder = /]
        pushj   p,strout
        MOVE    1,CYL
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /  Head = /]
        pushj   p,strout
        MOVE    1,HEAD
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /  Sector = /]
        pushj   p,strout
        MOVE    1,SECTOR
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        movei   2,[asciz /

/]
        pushj   p,strout
        MOVE    0,DSKSTA                ;GET THE DISK CONTROLLER STATUS
        movei   2,[asciz /Last Disk Controller Status = /]
        pushj   p,strout
        MOVEI   2,0
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
/]
        pushj   p,strout
        SETZM   HIT             ;TO TYPE OUT NO COMMA
        MOVEI   4,0             ;TO BE USED TO ADD WITH
        TLNE    0,S.SERR
        JRST    [movei  2,[asciz /SelectErr/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD2]
TD2:    TLNE    0,S.WRLK
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Writelocked/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD3]
TD3:    TLNE    0,S.NRDY
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /NotReady/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD4]
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Ready/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD4]
TD4:    TLNE    0,S.ONCY
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /OnCyl/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD5]
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /NotOnCyl/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD5]
TD5:    TLNE    0,S.SEEK
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /SeekErr/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD6]
TD6:    TLNE    0,S.DFLT
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /DrvFlt/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD7]
TD7:    TLNE    0,S.HDECC
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Hdecc/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD8]
TD8:    TLNE    0,S.HCER
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /HdCompErr/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD9]
TD9:    TLNE    0,S.NBSY
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /NotBusy/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD10a]
        JRST    [SKIPE HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Busy/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD10a]
TD10a:  TLNE    0,S.hecc
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /HardEcc/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD10b]
TD10b:  TLNE    0,S.secc
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /SoftEcc/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD11]
TD10:   TLNE    0,S.ROVR
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /ReadOverun/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD11]
TD11:   TLNE    0,S.WOVR
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /WritOverun/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD12]
TD12:   TLNE    0,S.SOVR
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /SectOverun/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD13]
TD13:   TLNE    0,S.SPAR
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /IntPar/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD14]
TD14:   TRNE    0,S.ANY
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /AnyErr&ECC/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TD15]
TD15:   TRNE    0,S.OCMP
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Complete/]
                 pushj  p,strout
                 SETOM  HIT
                 JRST   TD16]
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /NotComplete/]
                 pushj  p,strout
                 SETOM  HIT
                 JRST   TD16]
TD16:   movei   2,[asciz/

Last Command Issued     = /]
        pushj   p,strout
        MOVEI   2,CMD
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /    Last Ecc in Ecc reg.    = /]
        pushj   p,strout
        720000,,1
        movem   1,ecctmp
        lsh     1,7
        lsh     1,-31
        movem   1,eccdat
        MOVEI   2,eccdat
        MOVEI   3,4
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
Last Hardware Disk Add. = /]
        pushj   p,strout
        MOVEI   2,DA
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /    Bitcnt in BITCNT Reg.   = /]
        pushj   p,strout
        move    1,ecctmp
        lsh     1,24
        lsh     1,-24
        movem   1,eccdat
        MOVEI   2,eccdat
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
Last Buffer Address     = /]
        pushj   p,strout
        MOVEI   2,MA
        MOVEI   3,14
        PUSHJ   P,OCTOUT                              
        movei   2,[asciz /    Total number of retries = /]
        pushj   p,strout
        movei   2,numtry
        movei   3,3
        pushj   p,octout
        setzm   numtry
        movei   2,[asciz /
Last Disk Add in DA Reg = /]
        pushj   p,strout
        717000,,1
        lsh     1,11
        lsh     1,-11
        movem   1,dareg
        MOVEI   2,dareg
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
Last Mem Add in MA Reg  = /]
        pushj   p,strout
        716000,,1
        movem   1,mareg
        MOVEI   2,mareg
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
/]
        pushj   p,strout
        MOVE    1,TESTNUM
        CAIN    1,10
        SETOM   ERRDSK
        JRST    STEXIT
STTAP:  MOVE    0,COMBINE               ;GET THE TAPE CONTROLLER STATUS
        carret
        skipe clkflg
        pushj   p,teltim
        movei   2,[asciz /Last Tape Controller Status = /]
        pushj   p,strout
        MOVEI   2,0
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        movei   2,[asciz /
/]
        pushj   p,strout
        SETZM   HIT             ;TO TYPE OUT NO COMMA
        MOVEI   4,0             ;TO BE USED TO ADD WITH
        TRNE    0,1B30
        JRST    [movei  2,[asciz /Online/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT2]
TT2:    TRNE    0,1B32
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /WriteProtect/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT3]
TT3:    TRNE    0,1B35
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /EndOfTape/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT4]
TT4:    TRNE    0,1B31
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /Rewinding/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT5]
TT5:    TRNE    0,1B34
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /TapeReady/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT6]
TT6:    TRNE    0,1B33
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /LoadPoint/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT7]
TT7:    TLNE    0,MICTPE
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /MicTpe/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT8]
TT8:    TLNE    0,MICEOF
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /MicEof/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT9]
TT9:    TLNE    0,MICLNE
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /MicLen/]
                 pushj  p,strout
                 SETOM  HIT
                 ADDI   4,1
                 CAIL   4,10
                 PUSHJ  P,RETST
                 JRST   TT10]
TT10:   TLNE    0,MICFLG
        JRST    [SKIPE  HIT
                 PUSHJ  P,COMMA
                 movei  2,[asciz /MicFlg/]
                 pushj  p,strout
                 SETOM  HIT
                 JRST   STEXIT]
        JRST    STEXIT
STEXIT: SKIPE   ENTRY1
        JRST    [SETZM  ENTRY1
                 movei  2,[asciz /
/]
                 pushj  p,strout
                 POP    P,4
                 POP    P,3
                 POP    P,2
                 POP    P,1
                 POPJ   P,0]
        movei   2,[asciz /
/]
        pushj   p,strout
        JRST    DISPAT
HIT:    0
ENTRY1: 0
DSKSTA: 0
COMMA:  MOVEI   2,[COMDAT]
        PUSHJ   P,STROUT
        POPJ    P,0
RETST:  PUSHJ   P,COMMA
        SETZM   HIT
        MOVEI   4,0
        movei   2,[asciz /
/]
        pushj   p,strout
        POPJ    P,0

XRAY:   ;THIS IS THE XRAY ROUTINE. IT WILL TYPE OUT
        ;GOOD INFO TO SEE WHAT IS GOING ON.

        MOVE    1,DEVICE
        CAIE    1,1
        JRST    DXRAY
        JRST    TXRAY
TXRAY:  CARRET
        PRINT   / Test   Write Buffer   Read  Buffer   Word Count   Rd  Errors   Wrt Errors/
        CARRET
        PRINT   / ----   ------------   ------------   ----------   ----------   ----------/
        CARRET
        PRINT   /  /
        MOVEI   2,[1]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T1WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T1RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T1CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T1RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T1WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[2]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T2WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T2RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T2CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T2RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T2WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[3]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T3WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T3RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T1CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T3RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T3WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[4]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T4WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T4RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T4CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T4RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T4WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[5]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T5WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T5RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T5CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T5RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T5WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[6]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T6WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T6RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T6CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T6RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T6WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[7]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T7WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T7RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /        /
        MOVEI   2,T7CNT
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T7RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,T7WRER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        CARRET
        PRINT   / Test   Iterations      Cmp Errors/
        CARRET
        PRINT   / ----   ----------      ----------/
        CARRET
        PRINT   /  /
        MOVEI   2,[1]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T1PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T1CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[2]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T2PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T2CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[3]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T3PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T3CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[4]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T4PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T4CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[5]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T5PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T5CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[6]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T6PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T6CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[7]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,T7PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,T7CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        CARRET
        JRST    XRAYEX
DXRAY:  CARRET
        PRINT   / Test   Write Buffer   Read  Buffer   Dsk Errors   /
        CARRET
        PRINT   / ----   ------------   ------------   ----------/
        CARRET
        PRINT   /  /
        MOVEI   2,[1]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D1WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D1RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D1RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[2]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D2WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D2RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D2RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[3]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D3WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D3RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D3RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[4]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D4WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D4RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D4RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[5]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D5WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D5RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D5RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[6]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D6WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D6RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D6RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[7]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D7WBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D7RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D7RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        PRINT   /08/
        PRINT   /      /
        MOVEI   2,D8WBUF
        MOVEI   2,[ASCIZ /XXXXXX/]
        PUSHJ   P,STROUT
        PRINT   /          /
        MOVEI   2,D8RBUF
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /       /
        MOVEI   2,D8RDER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        CARRET
        PRINT   / Test   Iterations      Cmp Errors/
        CARRET
        PRINT   / ----   ----------      ----------/
        CARRET
        PRINT   /  /
        MOVEI   2,[1]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D1PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D1CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[2]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D2PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D2CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[3]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D3PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D3CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[4]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D4PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D4CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[5]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D5PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D5CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[6]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D6PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D6CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        MOVEI   2,[7]
        MOVEI   3,2
        PUSHJ   P,OCTOUT
        PRINT   /      /
        MOVEI   2,D7PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D7CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        PRINT   /  /
        PRINT   /08/
        PRINT   /      /
        MOVEI   2,D8PASS
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        PRINT   /          /
        MOVEI   2,D8CPER
        MOVEI   3,6
        PUSHJ   P,OCTOUT
        CARRET
        JRST    XRAYEX
XRAYEX: PRINT   /Total number of AR refills /
        MOVEI   2,30
        MOVEI   3,14
        PUSHJ   P,OCTOUT
        JRST    DISPAT

TTYIN:  ;THIS IS THE TTY IN SUBROUTINE. IT WILL
        ;SEE IF THE TTY NEEDS SERVICE.

        PUSH    P,4             ;SAVE REG 4 ON STACK
        CONI    TTY,4           ;GET CONSOLE STATUS
        TRNE    4,40            ;BIT FOR CONSOLE WANTS STATUS
        PUSHJ   P,GETIT         ;GO GET THE INPUT
        POP     P,4
        POPJ    P,

SCANIN: ;THIS IS THE SCANIN ROUTINE. IT WILL USE INBUF
        ;AND GO TEST THE TABLE TO SEE IF YOU HAVE A VALID
        ;COMMAND.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        SETZM   SEL                     ;SET SELECT TO ZERO TO START WITH
        MOVEI   7,0                     ;USED AS INDEX INTO TABLE
SCACNT: MOVE    1,TABENT(7)             ;GET TABLE ENTRY
        CAIN    1,0                     ;SEE IF LAST ENTRY IN TABLE
        JRST    NOCMP                   ;GET OUT LAST OF THE TABLE
        MOVE    2,[POINT 7,INBUF]
        MOVE    3,TABENT+1(7)
        PUSHJ   P,CMPPNT
        SKIPE   CMPED
        JRST    SCANEX
        ADDI    7,1
        JRST    SCACNT
NOCMP:  skipe   silent                  ;this is for special types
        jrst    scanex                  ;of scans that I don't want
        CARRET                          ;this message output.
        CARRET
        MOVEI   2,[ASCIZ /*** Please try again, or type HELP ***/]
        PUSHJ   P,STROUT
        CARRET
SCANEX: POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,0

;A LITTLE EXPLAINATION ON HOW THIS WORKS. THIS IS ALL TABLE DRIVEN,
;AND TO ADD AN ENTRY, YOU FIRST PUT IN A BYTE POINTER POINTING TO
;THE ENTRY HERE.
;
;EX:     POINT  7,TABXXX        THIS POINTS TO THE STRING YOU WANT TO TEST
;        XXX                    THIS VALUE IS WHAT GOES INTO SELECT
;
;TABXXX: ASCIZ  /TESTXXX/
;
;IN THE CASE OF HDA SERIAL NUMBER ENTRIES, YOU MUST DO A LITTLE SOMETHING 
;IN ADDITION TO THE ABOVE.
;
;EX:     
;HDATAB: AXXXX                  YOU MUST ENTER SERIAL NUMBER OF HDA
;                               INTO HDATAB, BUT IN A SEQUENCE THAT IS
;                               = (HDATAB - 100) + SELECT.
;
;IF YOU FOLLOW THE ABOVE RULES, DAN OR ANYBODY ELSE, YOU WON'T HAVE ANY
;TROUBLE.

TABENT: POINT   7,TAB1
        1
        POINT   7,TAB2
        2
        POINT   7,TAB3
        3
        POINT   7,TAB4
        4
        POINT   7,TAB5
        5
        POINT   7,TAB6
        6
        POINT   7,TAB7
        7
        POINT   7,TAB8
        10
        POINT   7,TAB9
        11
        POINT   7,TAB10
        12
        POINT   7,TAB11
        13
        POINT   7,TAB12
        14
        POINT   7,TAB13
        15
        POINT   7,TAB14
        16
        POINT   7,TAB15
        17
        POINT   7,TAB16
        20
        POINT   7,TAB17
        21
        POINT   7,TAB20
        22
        POINT   7,TAB21
        23
        POINT   7,TAB22
        24
        POINT   7,TAB23
        25
        POINT   7,TAB24
        26
        POINT   7,TAB25
        27
        POINT   7,TAB26
        30
        POINT   7,TAB27
        31
        POINT   7,TAB28
        32
        POINT   7,TAB29
        33
        POINT   7,TAB30
        34
        POINT   7,TAB31
        35
        POINT   7,TAB32
        36
        POINT   7,TAB33
        37
        POINT   7,TAB34
        40
        POINT   7,TAB35
        41
        POINT   7,TAB36
        42
        POINT   7,TAB37
        43
        POINT   7,TAB40
        44
        POINT   7,TAB140
        44
        POINT   7,TAB101
        1
        POINT   7,TAB102
        2
        POINT   7,TAB103
        3
        POINT   7,TAB104
        4
        POINT   7,TAB105
        5
        POINT   7,TAB106
        6
        POINT   7,TAB107
        7
        POINT   7,TAB108
        10
        POINT   7,TAB109
        11
        POINT   7,TAB110
        12
        POINT   7,TAB111
        13
        POINT   7,TAB112
        14
        POINT   7,TAB113
        15
        POINT   7,TAB114
        16
        POINT   7,TAB115
        17
        POINT   7,TAB116
        20
        POINT   7,TAB117
        21
        POINT   7,TAB120
        22
        POINT   7,TAB121
        23
        POINT   7,TAB122
        24
        POINT   7,TAB123
        25
        POINT   7,TAB124
        26
        POINT   7,TAB125
        27
        POINT   7,TAB126
        30
        POINT   7,TAB127
        31
        POINT   7,TAB128
        32
        POINT   7,TAB129
        33
        POINT   7,TAB130
        34
        POINT   7,TAB131
        35
        POINT   7,TAB132
        36
        POINT   7,TAB133
        37
        POINT   7,TAB134
        40
        POINT   7,TAB135
        41
        POINT   7,TAB136
        42
        POINT   7,TAB137
        43
        POINT   7,TAB200
        100
        POINT   7,TAB201
        101
        POINT   7,TAB202
        102
        POINT   7,TAB203
        103
        POINT   7,TAB204
        104
        POINT   7,TAB205
        105
        POINT   7,TAB206
        106
        POINT   7,TAB207
        107
        POINT   7,TAB210
        110
        POINT   7,TAB211
        111
        POINT   7,TAB212
        112
        POINT   7,TAB213
        113
        POINT   7,TAB214
        114
        POINT   7,TAB215
        115
        POINT   7,TAB216
        116
        POINT   7,TAB217
        117
        POINT   7,TAB400
        100
        POINT   7,TAB401
        101
        POINT   7,TAB402
        102
        POINT   7,TAB403
        103
        POINT   7,TAB404
        104
        POINT   7,TAB405
        105
        POINT   7,TAB406
        106
        POINT   7,TAB407
        107
        POINT   7,TAB410
        110
        POINT   7,TAB411
        111
        POINT   7,TAB412
        112
        POINT   7,TAB413
        113
        POINT   7,TAB414
        114
        POINT   7,TAB415
        115
        POINT   7,TAB416
        116
        POINT   7,TAB417
        117
        POINT   7,TAB220
        120
        POINT   7,TAB420
        120
        POINT   7,TAB221
        121
        POINT   7,TAB421
        121
        POINT   7,TAB222
        122
        POINT   7,TAB422
        122
        POINT   7,TAB223
        123
        POINT   7,TAB423
        123
        POINT   7,TAB224
        124
        POINT   7,TAB424
        124
        POINT   7,TAB225
        125
        POINT   7,TAB425
        125
        POINT   7,TAB226
        126
        POINT   7,TAB426
        126
        POINT   7,TAB227
        127
        POINT   7,TAB427
        127
        point   7,tab230
        130
        point   7,tab430
        130
        POINT   7,TAB231
        131
        POINT   7,TAB431
        131
        POINT   7,TAB232
        132
        POINT   7,TAB432
        132
        POINT   7,TAB233
        133
        POINT   7,TAB433
        133
        POINT   7,TAB234
        134
        POINT   7,TAB434
        134
        POINT   7,TAB235
        135
        POINT   7,TAB435
        135
        POINT   7,TAB236
        136
        POINT   7,TAB436
        136
        POINT   7,TAB237
        137
        POINT   7,TAB437
        137
        POINT   7,TAB240
        140
        POINT   7,TAB440
        140
        POINT   7,TAB241
        141
        POINT   7,TAB441
        141
        POINT   7,TAB242
        142
        POINT   7,TAB442
        142
        POINT   7,TAB243
        143
        POINT   7,TAB443
        143
        POINT   7,TAB244
        144
        POINT   7,TAB444
        144
        POINT   7,TAB245
        145
        POINT   7,TAB445
        145
        POINT   7,TAB246
        146
        POINT   7,TAB446
        146
        POINT   7,TAB247
        147
        POINT   7,TAB447
        147
        POINT   7,TAB250
        150
        POINT   7,TAB450
        150
        POINT   7,TAB251
        151
        POINT   7,TAB451
        151
        POINT   7,TAB252
        152
        POINT   7,TAB452
        152
        POINT   7,TAB253
        153
        POINT   7,TAB453
        153
        POINT   7,TAB254
        154
        POINT   7,TAB454
        154
        POINT   7,TAB255
        155
        POINT   7,TAB455
        155
        POINT   7,TAB256
        156
        POINT   7,TAB456
        156
        POINT   7,TAB257
        157
        POINT   7,TAB457
        157
        POINT   7,TAB260
        160
        POINT   7,TAB460
        160
        POINT   7,TAB261
        161
        POINT   7,TAB461
        161
        POINT   7,TAB262
        162
        POINT   7,TAB462
        162
        point   7,tab263
        163
        point   7,tab463
        163
        point   7,tab264
        164
        point   7,tab464
        164
        point   7,tab265
        165
        point   7,tab465
        165
        point   7,tab266
        166
        point   7,tab466
        166
        point   7,tab267
        167
        point   7,tab467
        167
        point   7,tab270
        170
        point   7,tab470
        170
        point   7,tab271
        171
        point   7,tab471
        171
        point   7,tab272
        172
        point   7,tab472
        172
        point   7,tab273
        173
        point   7,tab473
        173
        point   7,tab274
        174
        point   7,tab474
        174
        point   7,tab275
        175
        point   7,tab475
        175
        point   7,tab276
        176
        point   7,tab476
        176
        0                                       ;LAST TABLE ENTRY SHOULD BE 0

        ;THE FOLLOWING TABLE IS A TABLE OF STRINGS
        ;THAT I COMPARE FOR TO DO SOMETHING.

TAB1:   ASCIZ   /TEST1/
TAB2:   ASCIZ   /TEST2/
TAB3:   ASCIZ   /TEST3/
TAB4:   ASCIZ   /TEST4/
TAB5:   ASCIZ   /TEST5/
TAB6:   ASCIZ   /TEST6/
TAB7:   ASCIZ   /TEST7/
TAB8:   ASCIZ   /EDDT/
TAB9:   ASCIZ   /XRAY/
TAB10:  ASCIZ   /TEST0/
TAB11:  ASCIZ   /HELP/
TAB12:  ASCIZ   /TAPE/
TAB13:  ASCIZ   /DSK/
TAB14:  ASCIZ   /CLKON/
TAB15:  ASCIZ   /CLKOFF/
TAB16:  ASCIZ   /STAT/
TAB17:  ASCIZ   /TEST8/
TAB20:  ASCIZ   /FMT/
TAB21:  ASCIZ   /GETBAT/
TAB22:  ASCIZ   /PRIBAT/
TAB23:  ASCIZ   /ADDBAT/
TAB24:  ASCIZ   /AUTON/
TAB25:  ASCIZ   /AUTOFF/
TAB26:  ASCIZ   /INSBAT/
TAB27:  ASCIZ   /PGRON/
TAB28:  ASCIZ   /PGROFF/
TAB29:  ASCIZ   /RMVPRO/
TAB30:  ASCIZ   /RMVHLD/
TAB31:  ASCIZ   /MERHLT/
TAB32:  ASCIZ   /MERCNT/
TAB33:  ASCIZ   /PAINT/
TAB34:  ASCIZ   /MERRES/
TAB35:  ASCIZ   /PAKCPY/
TAB36:  ASCIZ   /DANSAN/
TAB37:  ASCIZ   /MEM/
TAB40:  ASCIZ   /TIME/
TAB101: ASCIZ   /test1/
tab102: asciz   /test2/         ;THE FOLLOWING IS IF YOU DO NOT HAVE THE 
tab103: asciz   /test3/         ;TTY IN UPPER CASE.
tab104: asciz   /test4/
tab105: asciz   /test5/
tab106: asciz   /test6/
tab107: asciz   /test7/
tab108: asciz   /eddt/
tab109: asciz   /xray/
tab110: asciz   /test0/
tab111: asciz   /help/
tab112: asciz   /tape/
tab113: asciz   /dsk/
tab114: asciz   /clkon/
tab115: asciz   /clkoff/
tab116: asciz   /stat/
tab117: asciz   /test8/
tab120: asciz   /fmt/
tab121: asciz   /getbat/
tab122: asciz   /pribat/
tab123: asciz   /addbat/
tab124: asciz   /auton/
tab125: asciz   /autoff/
tab126: asciz   /insbat/
tab127: asciz   /pgron/
tab128: asciz   /pgroff/
tab129: asciz   /rmvpro/
tab130: asciz   /rmvhld/
tab131: asciz   /merhlt/
tab132: asciz   /mercnt/
tab133: asciz   /paint/
tab134: asciz   /merres/
tab135: asciz   /pakcpy/
tab136: asciz   /dansan/
tab137: asciz   /mem/
tab140: asciz   /time/
TAB200: ASCIZ   /A2401/
TAB201: ASCIZ   /A1012/
TAB202: ASCIZ   /A2125/
TAB203: ASCIZ   /A1328/
TAB204: ASCIZ   /A2738/
TAB205: ASCIZ   /A2403/
TAB206: ASCIZ   /A1707/
TAB207: ASCIZ   /A502/
TAB210: ASCIZ   /A11703/
TAB211: ASCIZ   /A1211/
TAB212: ASCIZ   /A3017/
TAB213: ASCIZ   /C7490/
TAB214: ASCIZ   /C19556/
TAB215: ASCIZ   /C1889/
TAB216: ASCIZ   /C7507/
TAB217: ASCIZ   /A2608/
tab400: asciz   /a2401/
tab401: asciz   /a1012/
tab402: asciz   /a2125/
tab403: asciz   /a1328/
tab404: asciz   /a2738/
tab405: asciz   /a2403/
tab406: asciz   /a1707/
tab407: asciz   /a502/
tab410: asciz   /a11703/
tab411: asciz   /a1211/
tab412: asciz   /a3017/
tab413: ASCIZ   /c7490/
tab414: ASCIZ   /c19556/
tab415: ASCIZ   /c1889/
tab416: asciz   /c7507/
tab417: asciz   /a2608/
TAB220: ASCIZ   /A2404/
tab420: asciz   /a2404/
TAB221: ASCIZ   /A319/
tab421: asciz   /a319/
TAB222: ASCIZ   /A4110/
tab422: asciz   /a4110/
TAB223: ASCIZ   /C4111/
tab423: asciz   /c4111/
TAB224: ASCIZ   /C17543/
tab424: asciz   /c17543/
TAB225: ASCIZ   /C9403/
tab425: asciz   /c9403/
TAB226: ASCIZ   /C7200/
tab426: asciz   /c7200/
TAB227: ASCIZ   /C20179/
tab427: asciz   /c20179/
TAB230: ASCIZ   /C15323/
tab430: asciz   /c15323/
TAB231: ASCIZ   /C6905/
tab431: asciz   /c6905/
TAB232: ASCIZ   /C24495/
tab432: asciz   /c24495/
TAB233: ASCIZ   /C3620/
tab433: asciz   /c3620/
TAB234: ASCIZ   /C20377/
tab434: asciz   /c20377/
TAB235: ASCIZ   /C15407/
tab435: asciz   /c15407/
TAB236: ASCIZ   /C24336/
tab436: asciz   /c24336/
TAB237: ASCIZ   /C19584/
tab437: asciz   /c19584/
TAB240: ASCIZ   /C19049/
tab440: asciz   /c19049/
TAB241: ASCIZ   /C9658/
tab441: asciz   /c9658/
TAB242: ASCIZ   /C1792/
tab442: asciz   /c1792/
TAB243: ASCIZ   /C20627/
tab443: asciz   /c20627/
TAB244: ASCIZ   /C26447/
tab444: asciz   /c26447/
TAB245: ASCIZ   /B797/
tab445: asciz   /b797/
TAB246: ASCIZ   /C1979/
tab446: asciz   /c1979/
TAB247: ASCIZ   /C1196/
tab447: asciz   /c1196/
TAB250: ASCIZ   /C6612/
tab450: asciz   /c6612/
TAB251: ASCIZ   /A10720/
tab451: asciz   /a10720/
TAB252: ASCIZ   /A21706/
tab452: asciz   /a21706/
TAB253: ASCIZ   /A10621/
tab453: asciz   /a10621/
TAB254: ASCIZ   /A11121/
tab454: asciz   /a11121/
TAB255: ASCIZ   /A23011/
tab455: asciz   /a23011/
TAB256: ASCIZ   /C21708/
tab456: asciz   /c21708/
TAB257: ASCIZ   /C1793/
tab457: asciz   /c1793/
TAB260: ASCIZ   /C13232/
tab460: asciz   /c13232/
TAB261: ASCIZ   /B1204/
tab461: asciz   /b1204/
TAB262: ASCIZ   /REM/
tab462: asciz   /rem/
tab263: asciz   /C22821R/
tab463: asciz   /c22821r/
tab264: asciz   /C31484/
tab464: asciz   /c31484/
tab265: asciz   /C35402/
tab465: asciz   /c35402/
tab266: asciz   /C33950/
tab466: asciz   /c33950/
tab267: asciz   /C3079/
tab467: asciz   /c3079/
tab270: asciz   /C2166/
tab470: asciz   /c2166/
tab271: asciz   /C2226/
tab471: asciz   /c2226/
tab272: asciz   /C6431/
tab472: asciz   /c6431/
tab273: asciz   /C1877/
tab473: asciz   /c1877/
tab274: asciz   /C6881/
tab474: asciz   /c6881/
tab275: asciz   /C31347/
tab475: asciz   /c31347/
tab276: asciz   /C31324/
tab476: asciz   /c31324/
        0                               ;JUST A DELIMITER

        ;THE FOLLOWING TABLE IS FOR THE HDA NUMBER
        ;TO BE LOADED INTO HDANUM.

HDATAB: A2401                   ;100
        A1012                   ;101
        A2125                   ;102
        A1328                   ;103
        A2738                   ;104
        A2403                   ;105
        A1707                   ;106
        A502                    ;107
        A11703                  ;110
        A1211                   ;111
        A3017                   ;112
        C7490                   ;113
        C19556                  ;114
        C1889                   ;115
        C7507                   ;116
        A2608                   ;117
        A2404                   ;120
        A319                    ;121
        A4110                   ;122
        C4111                   ;123
        C17543                  ;124
        C9403                   ;125
        C7200                   ;126
        C20179                  ;127
        C15323                  ;130
        C6905                   ;131
        C24495                  ;132
        C3620                   ;133
        C20377                  ;134
        C15407                  ;135
        C24336                  ;136
        C19584                  ;137
        C19049                  ;140
        C9658                   ;141
        C1792                   ;142
        C20627                  ;143
        C26447                  ;144
        B797                    ;145
        C1979                   ;146
        C1196                   ;147
        C6612                   ;150
        A10720                  ;151
        A21706                  ;152
        A10621                  ;153
        A11121                  ;154
        A23011                  ;155
        C21708                  ;156
        C1793                   ;157
        C13232                  ;160
        B1204                   ;161
        DUMMY                   ;162
        C22821                  ;163
        C31484                  ;164
        C35402                  ;165
        C33950                  ;166
        C3079                   ;167
        C2166                   ;170
        C2226                   ;171
        C6431                   ;172
        C1877                   ;173
        C6881                   ;174
        C31347                  ;175
        C31324                  ;176
        0                       ;THIS MUST REMAIN 0 INSERT BEFORE THIS

CMPPNT: ;THIS IS THE CMPPNT ROUTINE. IT WILL COMPARE
        ;TWO STRINGS OF DATA TO SEE IF THEY ARE EQUAL.
        ;TO CALL:
        ;
        ;       MOVE 1,[POINT 7,XXX]
        ;       MOVE 2,[POINT 7,YYY]
        ;       MOVEI 3,ZZ      NUMBER OF ENTRY
        ;       PUSHJ P,CMPPNT
        ;
        ;IF EQUAL CMPED WILL BE SET TO ALL ONES AND SELECT
        ;WILL HAVE THE ENTRY NUMBER IN THE TABLE.

        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        SETOM   CMPED           ;SET FLAG TO -1 TO START WITH
        MOVEI   4,0
        MOVEI   5,0
CMPMOR: ILDB    4,1             ;GET FIRST BYTE
        ILDB    5,2             ;GET THE BYTE TO COMPARE WITH
        CAME    4,5             ;SEE IF THEY ARE THE SAME
        JRST    [SETOM SEL
                 SETZM CMPED
                 JRST CMPEX]
        CAIE    4,0             ;SEE IF LAST CHAR
        JRST    CMPMOR
        MOVEM   3,SEL
CMPEX:  POP     P,5
        POP     P,4
        POP     P,3
        POPJ    P,0
SEL:    0
CMPED:  0

GETIT:  ;THIS IS THE GETIT SUBROUTINE. ALL IT DOES IS
        ;LOOK FOR INPUT SERVICE FLAG, THEN GET THE
        ;CHARACTER AND LOOK FOR A CONTROL C.

        PUSH    P,1             ;SAVE REG 1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4             ;SAVE REG 4
        SETZM   TTYABO          ;CLEAR DEL FLAG
        MOVE    3,SAVEPT        ;GET THE OLD POINTER
        DATAI   TTY,1           ;GET CHARACTER PENDING FROM CONSOLE
        ANDI    1,177           ;REMOVE PARITY BIT
        CAIN    1,3             ; IF ^C
        JRST    [SETOM  ABO
                 JRST   GETEX]
        CAIN    1,177           ;THE DEL KEY
        JRST    [DELKEY: SKIPE  SILENT
                         JRST   DELPAS
                         MOVE   4,CHRCNT
                 DELBS:  MOVEI  2,[ASCIZ //]
                         PUSHJ  P,STROUT
                         SUBI   4,1
                         CAIE   4,0
                         JRST   DELBS
                         MOVE   4,CHRCNT
                 DELXXX: MOVEI  2,[ASCIZ /X/]
                         PUSHJ  P,STROUT
                         SUBI   4,1
                         CAIE   4,0
                         JRST   DELXXX
                         MOVEI  2,[ASCIZ /
/]
                         PUSHJ  P,STROUT
                 DELPAS: MOVE   2,[POINT 7,INBUF]
                         MOVEM  2,SAVEPT
                         SETOM  TTYABO
                         SETZM  BUFFUL
                         SETZM  CHRCNT
                         JRST   GETEX]
        CAIN    1,24            ; IF ^T
        JRST    [SETOM  REPORT
                 JRST   GETEX]
        CAIN    1,33            ; IF ESC KEY
        JRST    [CARRET
                 CARRET
                 PRINT  /Please do not use escape key at this level - only in EDDT./
                 CARRET
                 JRST   DISPAT]
        SKIPE   INPROG
        JRST    RING
        CAIN    1,15            ; IF CR
        JRST    [SETZM  BUFFUL
                 JRST   GETEX]
        JRST    INDATA
RING:   MOVEI   1,7
        DATAO   TTY,1
GETEX:  POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
INDATA: IDPB    1,3             ;SAVE THE BYTE OF DATA
        CONSZ   TTY,T.OBSY
        JRST    .-1
        MOVE    4,CHRCNT
        ADDI    4,1
        MOVEM   4,CHRCNT
        SKIPN   SILENT
        DATAO   TTY,1           ;ECHO THE CHARACTER
        MOVEM   3,SAVEPT        ;SAVE THE POINTER FOR NEXT TIME
        JRST    GETEX           ;GET OUT WE ARE DONE
TTYABO: 0                       ;USED AS FLAG FOR DEL KEY
SAVEPT: 0                       ;PLACE WHERE OLD POINTER GETS SAVED
BUFFUL: 0
ABO:    0
REPORT: 0
CHRCNT: 0
INBUF:  BLOCK 100               ;SHOULD BE ENOUGH INPUT AREA

MEMRAP: ;THIS IS THE MEMRAP SUBROUTINE. IT WILL
        ;TYPE OUT MEMORY RAP AROUND ON THE TTY.

        CARRET
        PRINT   /TEST /
        OUTOCT  NUMBER,2
        PRINT   / memory rap around./
        CARRET
        POPJ    P,

DELIMER: ;THIS IS THE DELIMER SUBROUTINE. IT WILL
        ;PRINT OUT A DELIMITER ERROR MESSAGE 
        ;COMMON TO ALL TESTS. THEN IT WILL BOUNCE
        ;BACK TO EDDT FOR LOOKING AT IT.

        PUSH    P,1                     ;SAVE REGS.
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        PUSH    P,7
        MOVEM   1,TESTNUM               ;PUT DATA IN PRINTABLE AREA     
        MOVEM   2,TXWBUF
        MOVEM   3,TXRBUF
        MOVEM   6,TXCNT
        MOVEM   7,TXMIS
        MOVE    1,@FAILW                ;GET WRITE DATA
        MOVEM   1,WDATA
        MOVE    1,@FAILR                ;GET READ DATA
        MOVEM   1,RDATA
        CARRET
        PRINT /    BUFFER LIMITS ERROR FOR TEST /
        OUTOCT TESTNUM,2
        CARRET
        PRINT /    ----------------------------/
        CARRET
        CARRET
        skipe clkflg
        pushj   p,teltim
        PRINT /Starting write buffer address = /
        OUTOCT  TXWBUF,6
        CARRET
        PRINT /Starting read buffer address  = /
        OUTOCT  TXRBUF,6
        CARRET
        PRINT /Record word count             = /
        OUTOCT  TXCNT,6
        CARRET
        PRINT /Front limiter located at      = /
        move    7,txrbuf
        subi    7,1
        move    6,0(7)
        movem   6,temp1
        movem   7,temp
        outoct  temp,6
        print   /   /
        outoct  temp1,14
        carret
        PRINT /Back limiter located at       = /
        move    7,txrbuf
        add     7,txcnt
        addi    7,1
        move    6,0(7)
        movem   6,temp1
        movem   7,temp
        outoct  temp,6
        print   /   /
        outoct  temp1,14
        carret
        MOVE    7,ONES
        CAMN    7,ERRHALT
        JRST    HALT3
        POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
HALT3:  POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        JRST    DISPAT

DETERM: ;THIS IS THE DETERM SUBROUTINE. IT WILL
        ;DETERMINE THE ERROR PRIORITY AND PRINT
        ;OUT ANY ERROR THAT I FEEL IS WORTHY.

        PUSH    P,1
        PUSH    P,2
        MOVE    1,ONES                  ;THIS IS WHAT TO COMPARE MEMORY WITH
        MOVEI   2,0                     ;AND THIS TO COMPARE WITH ZERO
        CAME    1,OFFLINE               ;SEE IF OFF-LINE
        JRST    DET2
        CARRET
        PRINT   /Tape unit is off-line./
        CARRET
        JRST    DISPAT
DET2:   CAME    1,WRTPRO                ;SEE IF TAPE IS WRITE PROTECTED
        JRST    DET3
        CARRET
        PRINT   /Tape unit is write-protected./
        CARRET
        JRST    DISPAT
DET3:   CAME    2,TAPRDY                ;SEE IF TAPE READY
        JRST    DET4
        CARRET
        PRINT   /Tape unit is not ready./
        CARRET
        JRST    DISPAT
DET4:   CAME    1,EOT
        JRST    DET5
        SETOM   STREW                   ;SET START REWIND FLAG
DET5:   CAME    1,TPERR                 ;SEE IF TAPE ERROR
        JRST    DET6
        MOVE    1,NUMBER
        CAIE    1,1
        JRST    A1
        CARRET
        PRINT   /Test 1 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A1:     CAIE    1,2
        JRST    A2
        CARRET
        PRINT   /Test 2 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A2:     CAIE    1,3
        JRST    A3
        CARRET
        PRINT   /Test 3 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A3:     CAIE    1,4
        JRST    A4
        CARRET
        PRINT   /Test 4 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A4:     CAIE    1,5
        JRST    A5
        CARRET
        PRINT   /Test 5 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A5:     CAIE    1,6
        JRST    A6
        CARRET
        PRINT   /Test 6 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
A6:     CAIE    1,7
        JRST    A7
        CARRET
        PRINT   /Test 7 aborted./
        PUSHJ   P,TASTAT
        jrst    aaex
a7:     carret
        print   /Test ??? aborted. Logical error - notify Dan Martin./
        pushj   p,tastat
        jrst    aaex
aaex:   MOVE    1,TPCOUNT
        ADDI    1,1                     ;ADD ONE TO TAPE ERROR COUNT
        MOVEM   1,TPCOUNT
DET6:   POP     P,2
        POP     P,1
        POPJ    P,                      ;THIS IS ALL FOR RIGHT NOW

STTEST: ;THIS IS THE STTEST SUBROUTINE. USE IT
        ;TO START A TEST.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        SETZM   ABO                     ;CLEAR THE CONSOLE ABORT
        SETZM   TPERR                   ;CLEAR TAPE ERROR FLAG
        MOVE    1,ONES
        CAME    1,STREW                 ;SEE IF WE SHOULD DO A REWIND
        JRST    NOREW
        CARRET
        PRINT   /**** End of tape ****/
        CARRET
        PRINT   / Starting to rewind /
        pushj   p,pritim
        CARRET
        REW                             ;DO A REWIND
        MOVE    2,BIGCNT                ;THIS IS FOR COUNT
LOOP:   PUSHJ   P,TSTAT                 ;GET TAPE STATUS
        SOJN    2,LOOP1                 ;SUBTRACT 1 FROM AC 2
        JRST    STILL                   ;PRINT STILL REWINDING
LOOP1:  CAMN    1,REWIND                ;SEE IF TAPE IS REWINDING
        JRST    LOOP                    ;DO IT AGAIN
NOREW:  SETZM   REWIND                  ;CLEAR FLAGS
        SETZM   OFFLINE
        SETZM   WRTPRO
        SETZM   LDPT
        SETZM   TAPRDY
        SETZM   STREW
        SETZM   EOT
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
STILL:  PRINT   /Still rewinding/
        CARRET
        MOVE    2,BIGCNT
        JRST    LOOP1
BIGCNT: 40,,0                           ;SOMETHING TO START WITH

TSTAT:  ;THIS IS THE TAPE STATUS SUBROUTINE. IT STES
        ;THE APPROPRIATE FLAGS AS/PER THE RETURNED
        ;STATUS WORD.REWIND FLAG IS ALWAYS CLEARED
        ;UPON ENTRY.

        PUSH    P,1                     ;SAVE REG 1 TO RETURN CLEAN
        PUSH    P,2
        SETZM   REWIND                  ;CLEAR REWIND FLAG
        MTDATI  MORSTAT                 ;GET THE OTHER STATUS
        STAT    1                       ;READ TAPE STATUS
        MOVE    2,1
        HLL     2,MORSTAT
        MOVEM   2,COMBINE
        TRNE    1,1B30                  ;TAPE OFF-LINE BIT
        JRST    .+2
        SETOM   OFFLINE                 ;SET OFF-LINE FLAG
        TRNN    1,1B32                  ;WRITE-PROTECT BIT
        JRST    .+2
        SETOM   WRTPRO                  ;SET WRITE PROTECT FLAG
        TRNN    1,1B35                  ;END OF TAPE FLAG
        JRST    .+2
        SETOM   EOT                     ;SET END OF TAPE FLAG
        TRNN    1,1B31                  ;REWINDING BIT
        JRST    .+2
        SETOM   REWIND                  ;SET REWINDING FLAG
        TRNN    1,1B34                  ;TAPE READY BIT
        JRST    .+2
        SETOM   TAPRDY                  ;SET TAPE READY FLAG
        TRNN    1,1B33                  ;LOAD POINT BIT
        JRST    .+2
        SETOM   LDPT                    ;SET AT LOAD POINT FLAG
        MOVE    1,MORSTAT               ;GET THE OTHER STATUS FROM DATI
        TLNE    1,MICTPE                ;SEE IF TPERR
        SETOM   TPERR                   ;SET TAPE ERROR FLAG
        POP     P,2
        POP     P,1                     ;RESTORE REG 1
        POPJ    P,

ERRBUF: ;THIS IS THE ERRBUF SUBROUTINE.
        ;IT WILL PRINT OUT BUFFER COMPARE ERRORS
        ;THAT WILL BE COMMON TO ALL TEST'S
        ;
        ;TO CALL:
        ;       PRTBUFER TEST#,TXWBUF,TXRBUF,TXCNT
        ;       
        ;NOTE: REG'S 4,5 AND 7 ARE ALREADY SET UP
        ;      FROM CMPBUF

        PUSH    P,1                     ;SAVE REGS.
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        PUSH    P,7
        MOVEM   1,TESTNUM               ;PUT DATA IN PRINTABLE AREA     
        MOVEM   2,TXWBUF
        MOVEM   3,TXRBUF
        MOVEM   4,FAILW
        MOVEM   5,FAILR
        MOVEM   6,TXCNT
        MOVEM   7,TXMIS
        MOVE    1,@FAILW                ;GET WRITE DATA
        MOVEM   1,WDATA
        MOVE    1,@FAILR                ;GET READ DATA
        MOVEM   1,RDATA
        CARRET
        PRINT /    BUFFER COMPARE ERROR FOR TEST /
        OUTOCT TESTNUM,2
        CARRET
        PRINT /    --------------------------------/
        CARRET
        CARRET
        skipe clkflg
        pushj   p,teltim
        PRINT /Starting write buffer address = /
        OUTOCT  TXWBUF,6
        CARRET
        PRINT /Starting read buffer address  = /
        OUTOCT  TXRBUF,6
        CARRET
        PRINT /Failing write buffer address  = /
        OUTOCT  FAILW,6
        PRINT /  **/
        OUTOCT  WDATA,14
        PRINT /**/
        CARRET
        PRINT /Failing read buffer address   = /
        OUTOCT  FAILR,6
        PRINT /  **/
        OUTOCT  RDATA,14
        PRINT /**/
        CARRET
        PRINT /Record word count             = /
        OUTOCT  TXCNT,6
        CARRET
        PRINT /Total miscompares for record  = /
        OUTOCT  TXMIS,6
        CARRET
        MOVE    7,ONES
        CAMN    7,ERRHALT
        JRST    HALT2
        POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
HALT2:  POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        JRST    DISPAT
TESTNUM: 0
TXWBUF: 0
TXRBUF: 0
FAILW:  0
FAILR:  0
TXCNT:  0
TXMIS:  0
WDATA:  0
RDATA:  0

TWAIT:  ;THIS IS THE TWAIT SUBROUTINE.
        ;ALL IT DOES IS WAIT HERE FOR THE
        ;INTERRUPT AND COUNT A MEMORY LOCATION
        ;UNTIL WE GET IT.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        MOVE    4,BIGCNT
ITER1:  MOVE    1,GOTINT
        CAIN    1,1             ;SEE IF FLAG
        JRST    INTX1           ;WE GOT IT, GETOUT
        PUSHJ   P,TTYIN         ;GO TEST FOR TTY INPUT
        SKIPE   ABO
        JRST    getout
        SKIPN   BUFFUL
        JRST    TEST
ITERT1: SOJN    4,.+2           ;SUB 1 FROM TIMEOUT COUNT
        JRST    TIMO1
        PUSHJ   P,SCANNR
        SOJN    2,.+2
        JRST    FIX1
        JRST    ITER1           ;GO DO MORE
INTX1:  POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
TIMO1:  CARRET
        MOVE    7,NUMBER
        CAIN    7,0
        JRST    [PRINT /Device Timeout Running Test 0/
                 CARRET
                 JRST DISPAT]
        CAIN    7,1
        JRST    [PRINT /Device Timeout Running Test 1/
                 CARRET
                 JRST DISPAT]
        CAIN    7,2
        JRST    [PRINT /Device Timeout Running Test 2/
                 CARRET
                 JRST DISPAT]
        CAIN    7,3
        JRST    [PRINT /Device Timeout Running Test 3/
                 CARRET
                 JRST DISPAT]
        CAIN    7,4
        JRST    [PRINT /Device Timeout Running Test 4/
                 CARRET
                 JRST DISPAT]
        CAIN    7,5
        JRST    [PRINT /Device Timeout Running Test 5/
                 CARRET
                 JRST DISPAT]
        CAIN    7,6
        JRST    [PRINT /Device Timeout Running Test 6/
                 CARRET
                 JRST DISPAT]
        CAIN    7,7
        JRST    [PRINT /Device Timeout Running Test 7/
                 CARRET
                 JRST DISPAT]
        CAIN    7,10
        JRST    [PRINT /Device Timeout Running Test 8/
                 CARRET
                 JRST DISPAT]
        PRINT   /Device Timeout Running Unknown Test/
        CARRET
        JRST DISPAT
FIX1:   MOVEI   2,777777
        JRST    ITER1

DWAIT:  ;THIS IS THE DWAIT SUBROUTINE.
        ;ALL IT DOES IS WAIT HERE FOR THE
        ;INTERRUPT AND COUNT A MEMORY LOCATION
        ;UNTIL WE GET IT.

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        MOVE    4,DSKCNT
ITER:   SKIPE   GOTINT
        JRST    INTX
        AOS     WTCNT
        MOVE    1,WTCNT
        CAIN    1,60000
        PUSHJ   P,[setzm wtcnt
                   carret
                   print /Disk has failed to report an interrupt./
                   carret
                   popj p,]
        PUSHJ   P,TTYIN
        PUSHJ   P,SCANNR
        SKIPE   ABO
        JRST    getout
        SKIPN   BUFFUL
        JRST    [TEST: MOVEI    2,INBUF
                       SETOM    BUFFUL
                       PUSHJ    P,SCANIN
                       HRLZI    1,INBUF
                       ADDI     1,INBUF+1
                       SETZM    INBUF
                       BLT      1,INBUF+77
                       MOVE     3,[POINT 7,INBUF]
                       MOVEM    3,SAVEPT
                       JRST     ITERET]
ITERET: SKIPN   USEINT
        JRST    INTX
        SOJN    4,.+2           ;SUB 1 FROM TIMEOUT COUNT
        JRST    TIMOUT
        PUSHJ   P,SCANNR
        SOJN    2,.+2
        JRST    FIX
        JRST    ITER            ;GO DO MORE
INTX:   POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
TIMOUT: CARRET
        MOVE    7,TESTNUM
        CAIN    7,0
        JRST    [PRINT /Device Timeout Running Test 0 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,1
        JRST    [PRINT /Device Timeout Running Test 1 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,2
        JRST    [PRINT /Device Timeout Running Test 2 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,3
        JRST    [PRINT /Device Timeout Running Test 3 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,4
        JRST    [PRINT /Device Timeout Running Test 4 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,5
        JRST    [PRINT /Device Timeout Running Test 5 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,6
        JRST    [PRINT /Device Timeout Running Test 6 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,7
        JRST    [PRINT /Device Timeout Running Test 7 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,10
        JRST    [PRINT /Device Timeout Running Test 8 - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,20
        JRST    [PRINT /Device Timeout Running Format - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,21
        JRST    [PRINT /Device Timeout Running Getbat - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,22
        JRST    [PRINT /Device Timeout Running Insbat - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        CAIN    7,23
        JRST    [PRINT /Device Timeout Running Addbat - /
                 PUSHJ  P,PRTLST
                 CARRET
                 JRST DISPAT]
        cain    7,30
        jrst    [PRINT  /Device Timeout Running Unknown Test - /
                 pushj  p,prtlst
                 carret
                 jrst   dispat]
        cain    7,31
        jrst    [PRINT  /Device Timeout Running Copy - /
                 pushj  p,prtlst
                 carret
                 setom  tymout
                 jrst   t9ent]
        PRINT   /Device Timeout Running Unknown Test - /
        PUSHJ   P,PRTLST
        CARRET
        JRST DISPAT
PRTLST: PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PRINT   / Last Cyl=/
        MOVE    1,CYL
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        PRINT   / Head=/
        MOVE    1,HEAD
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        print   / Sector=/
        MOVE    1,SECTOR
        MOVEI   2,0                     ;DECIMAL POINT
        MOVEI   3,0
        PUSHJ   P,DECOUT
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,

FIX:    MOVEI   2,777777
        JRST    ITER
NUMBER: 0
SCANLOC: 777777
COUNTER: 0                      ;COUNT FOR DIAG. PURPOSE

STROUT: ;THIS IS THE STRING OUT SUBROUTINE
        ;TO CALL:
        ;               MOVEI  2,YOURSTRG
        ;               PUSHJ  P,STROUT
        ;
        ;NOTE: IT WILL NOT TYPE OUT IF THE STCHAR FLAG IS SET
        ;WHICH MEANS THAT YOU STARTED TO TYPE SOMETHING, THIS
        ;WILL ALLOW YOU TO KEEP TYPING WITHOUT INTERRUPTION.
        ;THIS ROUTINE MAYBE USED IF STCHAR IS ON BY
        ;
        ;              MOVEI 2,YOURSTRING
        ;              PUSHJ P,SPEC
        ;

;       SKIPE   STCHAR
;       JRST    [IFST: PUSHJ P,TTYIN
;                      SKIPN STCHAR
;                      JRST STR11 
;                      JRST IFST]
SPEC:   PUSH    P,1
        PUSH    P,3
STR11:  MOVE    3,NEWPT         ;GET NEW BYTE POINTER
STR1:   ILDB    1,3             ;GET THE BYTE OF DATA
        JUMPE   1,STRX          ;ARE WE DONE
        CONSZ   TTY,T.OBSY      ;SEE IF TTY BUSY
        JRST    .-1             ;GO BACK IF BUSY
        DATAO   TTY,1           ;OUTPUT THE CHARACTER
        JRST    STR1            ;GO DO SOME MORE
STRX:   POP     P,3             ;RESTORE REG. 3
        POP     P,1             ;RESTORE REG. 1
        POPJ    P,              ;GET OUT YOUR DONE
NEWPT:  440702000000

OCTSPR: ;THIS IS THE OCTSPR SUBROUTINE. IT WILL
        ;SPREAD A BUFFER FROM ONE LOCATION TO
        ;ANOTHER BY USING THE BYTE POINTER IN-
        ;STRUCTIONS.
        ;
        ;TO CALL:   MOVEI 2,FROM
        ;           MOVEI 4,TO
        ;           MOVEI 6,HOWMANY
        ;           PUSHJ P,OCTSPR
        ;

        PUSH    P,2             ;SAVE REGS.
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        MOVE    3,POINT1
        MOVE    5,POINT2
STR2:   ILDB    1,3
        IDPB    1,5
        SUBI    6,1
        CAIE    6,0
        JRST    STR2            ;GO DO MORE, NOT DONE YET
        POP     P,6             ;RESTORE REGS.
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POPJ    P,
POINT1: 440302000000
POINT2: 440304000000

DECOUT: ;THIS IS THE DECOUT SUBROUTINE
        ;IT WILL OUTPUT TO THE TTY THE
        ;OCTAL INTEGER IN AC 1. IT ALWAYS
        ;OUTPUTS FOUR ASCII CHARACTERS.
        ;LEADING ZEROES WILL BE SUPPRESSED
        ;TO SPACES. NUMBER WILL LOOK LIKE
        ;THIS: 1777 = 1023.
        ;
        ;TO CALL:
        ;          MOVE 1,OCTINTEGER
        ;          MOVEI 2,0=DECIMAL POINT 1=NO DECIMAL POINT
        ;          MOVEI 3,0=FOUR DIGITS 1=TWO DIGITS, NO SUPPRESSION
        ;          PUSHJ P,DECOUT

        PUSH    P,1
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        PUSH    P,7
        PUSH    P,10
        PUSH    P,11
        PUSH    P,12
        PUSH    P,13
        PUSH    P,14
DECSTR: SETOM   DECPNT
        SKIPE   3
        SETOM   SUPRESS
        CAIE    2,0
        SETZM   DECPNT
        MOVEI   2,60                    ;THIS IS AN ASCII ZERO
        MOVEI   3,60                    ;THESE FOUR AC'S WILL BE DEC ACCUM.
        MOVEI   4,60
        MOVEI   5,60
        CAIGE   1,0
        JRST    DECBAD
        CAIN    1,0                     ;SEE IF IT IS ZERO TO START WITH
        JRST    ASCDEC
DECADD: ADDI    2,1                     ;ADD 1 TO LEAST SIG DEC DIGIT
        CAIG    2,71                    ;IF >71 THEN UNIT OVERFLOW
        JRST    DECCNT                  ;GO ADD SOMEMORE UNTIL 1 IS ZERO
        MOVEI   2,60                    ;REINIT 2 TO ASCII 0
        ADDI    3,1                     ;CARRY INTO TENS DIGIT
        CAIG    3,71                    ;IF >71 THEN TENS OVERFLOW
        JRST    DECCNT                  ;GO ADD SOMEMORE NO CARRY
        MOVEI   3,60                    ;REINIT 3 TO ASCII 0
        ADDI    4,1
        CAIG    4,71
        JRST    DECCNT
        MOVEI   4,60
        ADDI    5,1     
        CAIG    5,71
        JRST    DECCNT
        MOVEI   5,60                    ;START OVER
DECCNT: SUBI    1,1                     ;SUBTRACT 1 FROM OCTAL NUMBER
        CAIN    1,0                     ;SEE IF DONE
        JRST    ASCDEC
        JRST    DECADD
DECSFT: MOVE    10,5
        MOVE    11,4
        MOVE    12,3
        MOVE    13,2
        SKIPE   SUPRESS
        JRST    [CAIN 12,40
                 MOVEI 12,60    ;ASCIZ ZERO
                 LSH 12,25
                 LSH 13,16
                 IOR 12,13
                 LSH 12,10
                 MOVEM 12,DECASC
                 JRST DECEX]
        LSH     12,7
        LSH     11,16
        LSH     10,25
        IOR     10,11
        IOR     10,12
        IOR     10,13
        LSH     10,10                   ;THIS SHOULD DO IT
        MOVEM   10,DECASC               ;STORE IT AWAY
DECEX:  MOVEI   2,DECASC
        PUSHJ   P,STROUT
        SKIPN   DECPNT
        JRST    NODPNT
        MOVEI   2,[ASCIZ /./]
        PUSHJ   P,STROUT
NODPNT:
DECBAD: SETZM   SUPRESS
        POP     P,14
        POP     P,13
        POP     P,12
        POP     P,11
        POP     P,10
        POP     P,7
        POP     P,6
        POP     P,5
        POP     P,4
        POP     P,3
        POP     P,2
        POP     P,1
        POPJ    P,
ASCDEC: CAIN 5,60
        JRST [MOVEI 5,40
              CAIN 4,60
              JRST [MOVEI 4,40          ;THIS CODE STRIPS
                    CAIN 3,60           ;LEADING ZEROES
                    JRST [MOVEI 3,40    ;AND INSERTS SPACES
                          JRST DECSFT]
                    JRST DECSFT]
              JRST DECSFT]      
        JRST DECSFT
DECPNT: 0
DECASC: BLOCK   2                       ;THIS IS WHERE THE ASCIZ DATA WILL BE

OCTOUT: ;THIS IS THE OCTOUT SUBROUTINE
        ;IT WILL OUTPUT TO THE TTY THE
        ;WORD IN MEMORY THAT YOU SPECIFY
        ;
        ;TO CALL:
        ;
        ;       MOVE  2,ADDRESS
        ;       MOVEI 3,HOWMANY   HOWMANY OCTAL DIGITS
        ;       PUSHJ P,OCTOUT    MAX. DECIMAL 12
        ;                         MIN. 1
        
        PUSH    P,2             ;SAVE REG. 2
        PUSH    P,3             ;SAVE REG. 3
        PUSH    P,4             ;SAVE REG. 4
        PUSH    P,5             ;SAVE REG. 5
        PUSH    P,6             ;SAVE REG. 6
        MOVE    6,2             ;SAVE ADDRESS TO OUTPUT IN REG. 6
        MOVE    4,OCTPT-1(3)    ;GET NEW BYTE POINTER
OCTCNT: ILDB    5,4             ;GET THE OCTAL DIGIT
        ADDI    5,ASCTAB        ;GET THE ASCII EQIV. 
        MOVE    2,5             ;THIS IS ADDRESS OF STRING
        PUSHJ   P,STROUT        ;GO PRINT THE CHARACTER
        SUBI    3,1             ;SUBTRACT 1 FROM COUNT
        JUMPE   3,OCTDNE        ;IF IT IS ZERO, WE ARE DONE
        JUMPA   OCTCNT          ;GO DO MORE
OCTDNE: POP     P,6             ;RESTORE REG. 6
        POP     P,5             ;RESTORE REG. 5
        POP     P,4             ;RESTORE REG. 4
        POP     P,3             ;RESTORE REG. 3
        POP     P,2             ;RESTORE REG. 2
        POPJ    P,              ;GET OUT WE ARE DONE
ASCTAB: ASCIZ   /0/             ;THIS IS A ASCII ZERO
        ASCIZ   /1/             ;THIS IS A ASCII ONE
        ASCIZ   /2/             ;THIS IS A ASCII TWO
        ASCIZ   /3/             ;THIS IS A ASCII THREE
        ASCIZ   /4/             ;THIS IS A ASCII FOUR
        ASCIZ   /5/             ;THIS IS A ASCII FIVE
        ASCIZ   /6/             ;THIS IS A ASCII SIX
        ASCIZ   /7/             ;THIS IS A ASCII SEVEN
OCTPT:  030306,,0               ;NEW OCTAL POINTER TABLE
        060306,,0
        110306,,0
        140306,,0
        170306,,0
        220306,,0
        250306,,0
        300306,,0
        330306,,0
        360306,,0
        410306,,0
        440306,,0               ;END OF THE POINTER TABLE       

BUFSPR: ;THIS IS THE BUFSPR SUBROUTINE.
        ;IT WILL SPREAD A DATA PATTERN
        ;THROUGH MEMORY.
        ;TO CALL:
        ;
        ;       MOVEI   0,RAN OR NORAN
        ;       MOVE    1,DATA
        ;       MOVEI   2,ADDRESS
        ;       MOVEI   3,AMOUNT
        ;       MOVEI   4,X     X=0 DON'T PUT ANY DELIMITER
        ;                       X=1 PUT FRONT DELIMITER
        ;                       X=2 PUT BACK DELIMITER
        ;       PUSHJ   P,BUFSPR
        ;

        PUSH    P,0             ;SAVE REGS.
        PUSH    P,1             
        PUSH    P,2
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        PUSH    P,6
        CAIN    4,0
        JRST    SPRST
        CAIN    4,1
        JRST    PUTFRONT
        CAIN    4,2
        JRST    PUTBACK
SPRST:  SUBI    2,1             ;START OUT AT RIGHT PLACE
        ADD     2,3             ;SET UP INDEX REG IN ADDRESS
        CAIN    0,RAN           ;SEE IF USING RANDOM PATTERN
        PUSHJ   P,GETRAN        ;GET THE RANDOM PATTERN
        MOVEM   1,@2            ;STORE THE DATA
        SUBI    2,1             ;WORD ADDRESS MINUS 1
        SOJN    3,.-4           ;CONTINUE UNTIL DONE
        POP     P,6             ;RESTORE THE REGS.
        POP     P,5
        POP     P,4
        POP     P,3             
        POP     P,2
        POP     P,1
        POP     P,0
        POPJ    P,              ;GET OUT, YOU ARE DONE
PUTFRONT: MOVE  4,FRONT         ;GET FRONT DELIMITER
        MOVE    5,2
        MOVE    6,3
        ADD     5,6             ;THIS IS WHERE WE PUT IT
        MOVEM   4,@5            ;STORE AT 1 ABOVE WRITE BUFFER
        JRST    SPRST
PUTBACK: MOVE   4,BACK          ;GET BACK DELIMITER
        MOVE    5,2
        MOVE    6,3
        ADD     5,6             ;THIS IS WHERE WE PUT IT
        MOVEM   4,@5            ;STORE AT 1 ABOVE READ BUFFER
        JRST    SPRST

GETRAN: ;THIS IS THE GETRAN SUBROUTINE. IT WILL USE
        ;THE PROGRAM DATA SHIFTED FOR RANDOM GEN.
        ;IT SEEMS SIMPLE, BUT IT WAS CHEAP TO WRITE.

        PUSH    P,2             ;SAVE THE REGS.
        PUSH    P,3
        PUSH    P,4
        PUSH    P,5
        MOVE    2,SHIFTER       ;GET THE CURRENT SHIFT COUNT
        MOVE    3,CURADD        ;GET THE CURRENT ADDRESS
        MOVE    4,0(3)          ;GET THE DATA
        ADDI    3,1             ;GET THE SECOND WORD
        CAMLE   3,BUFST         ;SEE IF END OF PROGRAM AREA
NEWADD: MOVEI   3,140           ;START OVER     
        MOVE    5,0(3)
        ROTC    4,0(2)          ;ROTATE THE DATA
        MOVE    1,4             ;PUT BACK IN REG. 1
        MOVEM   3,CURADD
        ADDI    2,1             ;ADD ONE TO SHIFT COUNT
        CAIN    2,100           ;SEE IF MAX. SHIFT
NEWSH:  MOVEI   2,1             ;NEW SHIFT COUNT
        MOVEM   2,SHIFTER       ;STORE FOR NEXT TIME
        POP     P,5             ;RESTORE THE REGS.
        POP     P,4
        POP     P,3
        POP     P,2
GETRAX: POPJ    P,
SHIFTER: 1                      ;1 TO START WITH
CURADD: 140                     ;START WITH DDT

BUFCMP: ;THIS IS THE BUFCMP SUBROUTINE.
        ;IT WILL COMPARE TWO BUFFERS TOGETHER
        ;TO SEE IF THEY ARE EQUIVALENT.
        ;TO CALL:
        ;
        ;       MOVEI   0,X   X=0 DO NOT CHECK DELIMITERS
        ;                     X=1 CHECK DELIMITERS
        ;       MOVEI   1,FIRST
        ;       MOVEI   2,SECOND
        ;       MOVEI   3,HOWMANY
        ;       PUSHJ   P,BUFCMP
        ;
        ;IF REGISTER 4&5 ARE ZERO UPON RETURN, ALL IS
        ;WELL. IF NON-ZERO, THEN THIS WILL BE THE 
        ;ADDRESS'S OF THE FIRST MISCOMPARE.
        ;AC 7 WILL CONTAIN TOTAL NUMBER OF MISCOMPARES.
        ;IF AC 0 IS:
        ;           0 THEN DELIMITERS OK
        ;           1 FRONT DELIMITER ERROR
        ;           2 BACK DELIMITER ERROR
        ;           3 BOTH IN ERROR
        ;

        PUSH    P,1             ;SAVE REGS.
        PUSH    P,2
        PUSH    P,3
        PUSH    P,6
        MOVEI   4,0             ;CLEAR REG 4 TO START WITH
        MOVEI   5,0             ;CLEAR REG 5 TO START WITH
        SETZM   ALRDY           ;CLEAR 
        MOVEI   7,0             ;CLEAR TOTAL ERROR COUNT
BUFCNT: MOVE    6,@1            ;GET FIRST BUFFER WORD
        CAME    6,@2            ;COMPARE WITH SECOND BUFFER WORD
        JRST    BUFERR          ;TO HERE IF THERE IS A MISCOMPARE
ERRDON: ADDI    1,1             ;ADD ONE TO FIRST BUFFER ADDRESS
        ADDI    2,1             ;SEE IF DONE YET
        SOJN    3,BUFCNT        ;GO DO MORE
TSTDL:  CAIE    0,1             ;SEE IF DELIMITER CHECK
        JRST    BUFEXT
        MOVEI   0,0             ;CLEAR FLAG TO START WITH
        MOVE    6,@1            ;GET FRONT DELIMITER
        CAME    6,FRONT
        JRST    FDERR
TSTM:   MOVE    6,@2            ;GET BACK DELIMITER
        CAME    6,BACK
        JRST    BDERR
        JRST    BUFEXT          ;GET OUT
FDERR:  MOVEI   0,1             ;STORE ERROR FLAG
        JRST    TSTM
BDERR:  CAIE    0,1             ;SEE IF FRONT ERROR
        JRST    .+3
        MOVEI   0,3             ;STORE BOTH FLAGS
        JRST    BUFEXT
        MOVEI   0,2             ;STORE BACK ERROR FLAG
        JRST    BUFEXT
BUFEXT: POP     P,6             ;RESTORE THE REGS.
        POP     P,3     
        POP     P,2
        POP     P,1
        POPJ    P,
BUFERR: MOVE    6,ALRDY         ;SEE IF PREVIOUS ERRORS
        CAME    6,ONES
        JRST    FIRST
        ADDI    7,1
        JRST    ERRDON
FIRST:  MOVE    4,1             ;STORE FIRST FAILING ADDRESSES
        MOVE    5,2
        SETOM   ALRDY           ;NOW WE ALREADY HAVE ERROR
        MOVEI   7,1             ;THIS IS THE FIRST ERROR
        JRST    ERRDON

        ;THIS IS THE INTERRUPT ROUTINE
        ;UPON INTERRUPT RECEIVED, GOTINT WILL
        ;THEN CONTAIN A 1 BIT. YOU MUST TURN IT OFF
        ;OR ELSE YOU WILL THINK YOU RECEIVED AN
        ;INTERRUPT ALL THE TIME.
TAPINT: 0                       ;SAVE RETURN ADDRESS
TINT:   AOS     TNTCNT          ;ADD ONE TO TOTAL INTERRUPTS
        AOS     GOTINT          ;TURN ON INTERRUPT REC. FLAG
        MTCNSO  10              ;SEE IF TAPE IS INTERRUPTING
        JRST    NOTME1          ;INT. NOT BECAUSE OF ME
        MTCONO  20              ;TAKE TAPE OFF INT. CHANNEL
        JRST    12,@TAPINT      ;RETURN AND RENABLE INT.
NOTME1: CARRET
        CARRET
        PRINT   /Interrupt not from selected device./
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        JRST    DISPAT

DSKINT: 0                       ;SAVE RETURN ADDRESS
DINT:   AOS     DNTCNT          ;ADD ONE TO TOTAL INTERRUPTS
        AOS     GOTINT          ;TURN ON INTERRUPT REC. FLAG
        DCONSO  10              ;SEE IF DISK IS INTERRUPTING
        JRST    NOTME2          ;INT. NOT BECAUSE OF ME
        DCONO   20              ;TAKE DISK OFF INT CHANNEL
        JRST    12,@DSKINT      ;RETURN AND RENABLE INT.
NOTME2: CARRET
        CARRET
        PRINT   /Interrupt not from selected device./
        SETZM   GOTINT          ;CLEAR INTERRUPT FLAG
        JRST    DISPAT
GOTINT: 0

        ;THIS IS THE DUMP TO TAPE ROUTINE
        ;

;MAKE IMAGE FOR BOOT TAPE

BOTDUN: BLOCK   1               ;NON-ZERO IN BOOT IMAGE FILE
WRKBUF: BLOCK   50              ;JUST A WORK AREA
DMP:    MOVE    P,SAVEIT        ;SETUP STACK POINTER
        MSG     <[ASCIZ/
Making Tyfoon Exerciser image /]>
        HRROI   2,[ASCIZ/TYFOON.IMG/]
        MOVSI   1,600001
        GTJFN
         JRST   [MSG <[ASCIZ/
FAILED TO GTJFN IMAGE FILE./]>
                 JRST   STOP]
        PUSH    P,1             ;SAVE JFN
        MOVE    2,[440000,,300000]
        OPENF   
         JRST   [POP P,1
                 RLJFN
                  JFCL
                 MSG <[ASCIZ/
FAILED TO OPENF IMAGE FILE./]>
                 JRST STOP]
        MSG     <[ASCIZ/
Writing boot image on /]>
        HRROI   1,WRKBUF
        MOVE    2,0(P)
        MOVE    3,[211110,,1]
        JFNS
        MSG     <WRKBUF>
        MSG     <[ASCIZ/.../]>
        MOVE    1,0(P)          ;JFN
        MOVEI   2,20            ;SKIP AC'S
        SFPTR
         JRST   [POP P,1
                 RLJFN
                  JFCL
                 MSG <[ASCIZ/
FAILED TO SFPTR IMAGE FILE./]>
                 JRST STOP]
        MOVE    2,[444400,,20]
        MOVNI   3,177777-20     ;ALL OF CORE
        SETOM   BOTDUN          ;SAY LEGAL IMG FILE IN FILE
        SOUT
        SETZM   BOTDUN          ;CLEAR FOR THIS FORK NOW
        POP     P,1             ;JFN
        CLOSF
         JFCL
        MSG     <[ASCIZ/Complete.
Use MTLOF3 to transfer this file to tape. Start at 140/]>
STOP:   HALTF
        JRST    .+1
        

TRAP:   0
        SKIPN   EXPTRP  
        JRST    TRAPOK
        PGROFF                          ;TURN OFF THE MAP KID
        MOVEI   2,[ASCIZ /
          ****PAGER TRAP****

/]
        PUSHJ   P,STROUT
        skipe clkflg
        pushj   p,teltim
        MOVEI   2,[ASCIZ /The trap status word equals /]
        pushj   p,strout
        OUTOCT  12571,14
        movei   2,[ASCIZ /
Total number of ar refills  /]
        pushj   p,strout
        OUTOCT  30,14
        movei   2,[asciz /
Instruction that trapped    /]
        pushj   p,strout
        MOVE    1,TRAP
        SUBI    1,1
        MOVE    2,@1
        MOVEM   2,TRAPAD
        OUTOCT  TRAPAD,14
        movei   2,[asciz /

/]
        pushj   p,strout
        JRST    DISPAT
TRAPOK: SETOM   NXM                     ;FUDGE NXM ERROR
        JRST    @TRAP

        ;THIS IS THE DISPAT ROUTINE. IT IS THE MAIN
        ;PART OF THE CE INTERFACE INTO MY EXERCISER.

DD:     SETZM   DIAG
DISPAT: SKIPE   DIAG
        JRST    DDT
        setzm   copy
        MOVE    P,SAVEIT                ;SETUP STACK
        skipe   f3
        PGROFF                          ;TURN THE PAGER OFF
        MOVEI   2,INBUF                 ;LETS CLEAR INPUT BUF FIRST
        HRLZI   1,INBUF
        ADDI    1,INBUF+1
        SETZM   INBUF
        BLT     1,INBUF+77
        MOVE    1,[POINT 7,INBUF]       ;INITIALZE POINTER FOR GETIT
        MOVEM   1,SAVEPT
        SETZM   CHRCNT
        SETZM   DIAG                    ;TURN OFF DIAG FLAG FOR ERRORS
        SETOM   BUFFUL
        SETZM   SILENT                  ;TURN ON THE ECHO FLAG
        SETZM   DPRINT
        SETZM   GOTINT                  ;TURN OFF INT FLAG
        SETZM   USEINT
        SETZM   REPORT
        SETZM   ABO
        SETOM   SINGLET                 ;TURN OFF SINGLET FLAG
        SETZM   ZEROFLG
        SETZM   INPROG
        SKIPE   F3
        PUSHJ   P,[SKIPE SIZED
                   POPJ P,
                   CARRET
                   CARRET
                   PRINT /** WARNING - Memory not sized **/
                   carret
                   POPJ P,]
DEL:    CARRET                  ;COMES BACK TO HERE IF HE HIT DEL KEY
        MOVEI   2,TYF
        PUSHJ   P,STROUT
DISPT1: PUSHJ   P,TTYIN         ;GO TEST FOR TTY INPUT
        SKIPN   BUFFUL
        JRST    [PROMPT: SKIPE  TTYABO
                         JRST   [SETZM  TTYABO
                                 SETOM  BUFFUL
                                 HRLZI  1,INBUF
                                 ADDI   1,INBUF+1
                                 SETZM  INBUF
                                 BLT    1,INBUF+77
                                 MOVE   3,[POINT 7,INBUF]
                                 MOVEM  3,SAVEPT
                                 JRST   DEL]
                         MOVEI  2,INBUF
                         SETOM  BUFFUL
                         PUSHJ  P,SCANIN
                         HRLZI  1,INBUF
                         ADDI   1,INBUF+1
                         SETZM  INBUF
                         BLT    1,INBUF+77
                         MOVE   3,[POINT 7,INBUF]
                         MOVEM  3,SAVEPT
                         JRST   PRORET]
        JRST    DISPT1
PRORET: MOVE    1,SEL
        CAIE    1,1
        JRST    G2
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD1]
                 CARRET
                 JRST   TEST1]
G2:     CAIE    1,2
        JRST    G3
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD2]
                 CARRET
                 JRST   TEST2]
G3:     CAIE    1,3
        JRST    G4
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD3]
                 CARRET
                 JRST   TEST3]
G4:     CAIE    1,4
        JRST    G5
        JRST    [SETOM  INPROG
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 MOVE   1,DEVICE
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD4]
                 CARRET
                 JRST   TEST4]
G5:     CAIE    1,5
        JRST    G6
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD5]
                 CARRET
                 JRST   TEST5]
G6:     CAIE    1,6
        JRST    G7
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD6]
                 CARRET
                 JRST   TEST6]
G7:     CAIE    1,7
        JRST    G8
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD7]
                 CARRET
                 JRST   TEST7]
G8:     CAIE    1,10
        JRST    G9
        JRST    [PUSHJ  P,GTPASS
                 CARRET
                 CARRET
                 skipe clkflg
                 pushj  p,[teltim: movei 2,[asciz /Time /]
                                   pushj p,strout
                                   pushj p,pritim
                                   carret
                                   popj p,]
                 PRINT /You are now in the diagnostic debugger./
                 CARRET
                 PRINT /To return to dispatcher use DD$G ** Note change **/
                 CARRET
                 CARRET
                 SETOM  DIAG
                 SETZM  AUTBAT
                 movei  1,30            ;eddt test number
                 movem  1,testnum
                 JRST DDT]
G9:     CAIE    1,11
        JRST    G10
        JRST    [CARRET
                 JRST   XRAY]
G10:    CAIE    1,12
        JRST    G11
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet./
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         SKIPE  DWRTPRO
                         JRST   [CARRET
                                 CARRET
                                 PRINT  /Disk is software write protected./
                                 CARRET
                                 JRST   DISPAT]
                         JRST   TESTD0]
                 CARRET
                 JRST   TEST0]
G11:    CAIE    1,13
        JRST    G12
        JRST    [CARRET
                 JRST   HELPRT]
G12:    CAIE    1,14
        JRST    G13
        JRST    [CARRET
                 MOVEI  2,1
                 MOVEM  2,DEVICE
                 CARRET
                 PRINT  /Disk part of diagnostic now disabled./
                 CARRET
                 JRST   DISPAT]
G13:    CAIE    1,15
        JRST    G14
        JRST    [CARRET
                 MOVEI  2,2
                 MOVEM  2,DEVICE
                 PUSHJ  P,WHATDR
                 MOVE   1,DRTYPE
                 CAIN   1,1
                 JRST   [PUSHJ  P,CDC160
                         JRST   G13RET]
                 CAIN   1,2
                 JRST   [PUSHJ  P,AMP330
                         JRST   G13RET]
                 cain   1,3
                 JRST   [PUSHJ  P,M2351A
                         JRST   G13RET]
                 cain   1,4
                 jrst   [pushj  p,dm9300
                         jrst   g13ret]
                 CARRET
                 PRINT  /Can not set parameters for this type of drive./
                 JRST   DISPAT
G13RET:          CARRET
                 PRINT  /Tape part of diagnostic now disabled./
                 CARRET
                 PUSHJ  P,SELCTD
                 JRST   DISPAT]
G14:    CAIE    1,16
        JRST    G15
        SKIPE   CLKFLG
        JRST    [CARRET
                 CARRET
                 PRINT /Clock is already enabled./
                 carret
                 jrst dispat]
        setom   clkflg
        carret
        CARRET
        print   /Clock is now enabled./
        CONO    PI,10400        ;CLEAR PI SYSTEM AND TURN IT OFF
        CONO    PI,42377        ;TURN ON PI LEVEL 1 FOR APR
        CONO    0,3001
        carret
        jrst    dispat
g15:    caie    1,17
        jrst    g16
        skipn   clkflg
        jrst    [carret
                 CARRET
                 print /Clock is already disabled./
                 carret
                 jrst dispat]
        setzm   clkflg
        carret
        CARRET
        print /Clock is now disabled./
        CONO    0,5000
        CONO    PI,10400        ;CLEAR PI SYSTEM AND TURN IT OFF
        CONO    PI,42377        ;TURN ON PI LEVEL 1 FOR APR
        carret
        jrst    dispat
G16:    CAIE    1,20
        JRST    G17
        JRST    [CARRET
                 JRST   STATUS]
G17:    CAIE    1,21
        JRST    G18
        JRST    [SETOM  INPROG
                 MOVE   1,DEVICE
                 CAIN   1,0
                 JRST   [CARRET
                         PRINT  /You have not selected a device as of yet/
                         CARRET
                         JRST   DISPAT]
                 CAIE   1,1
                 JRST   [CAIE   1,2
                         JRST   DISPAT
                         JRST   TESTD8]
                 CARRET
                 JRST   TEST8]
G18:    CAIE    1,22
        JRST    G19
        JRST    [CARRET
                 MOVE   1,DEVICE
                 CAIE   1,2
                 JRST   [CARRET
                         PRINT  /You can not do a FMT on anything other than a disk./
                         CARRET
                         JRST   DISPAT]
                 SETOM  INPROG
                 SKIPE  DWRTPRO
                 JRST   [CARRET
                         PRINT  /Disk is software write protected./
                         CARRET
                         JRST   DISPAT]
                 CARRET
                 PRINT  /You do realize that if you proceed from here/
                 CARRET
                 PRINT  /the disk will no longer be available to the/
                 CARRET
                 PRINT  /operating system./
                 CARRET
                 CARRET
                 MOVEI  1,0
                 PUSHJ  P,DOYOU
                 SKIPE  NO
                 JRST   [SETOM  CEHLD
                         JRST   FMT]
                 CARRET
                 PRINT  /I did not think so./
                 CARRET
                 JRST   DISPAT]
G19:    CAIE    1,23
        JRST    G20
        JRST    [CARRET
                 SETZM  TESTNUM
                 MOVE   1,DEVICE
                 CAIE   1,2
                 JRST   [CARRET
                         PRINT  /You can not do a GETBAT on anything other than a disk drive./
                         CARRET
                         JRST   DISPAT]
                 SETOM  PRIMRY
                 MOVEI  1,15
                 PUSHJ  P,DOYOU
                 SKIPE  NO
                 SETZM  PRIMRY
                 JRST   DGTBAT]         ;GO TO ALTERNATE ENTRY FOR GETBAT
G20:    CAIE    1,24
        JRST    G21
        JRST    [CARRET
                 MOVE   1,DEVICE
                 CAIE   1,2
                 JRST   [CARRET
                         PRINT  /You can not do a PRIBAT on anything other than a disk drive./
                         CARRET
                         JRST   DISPAT]
                 JRST   PRIBAT]
G21:    CAIE    1,25
        JRST    G22
        JRST    [CARRET
                 MOVE   1,DEVICE
                 CAIE   1,2
                 JRST   [CARRET
                         PRINT  /You can not do a ADDBAT on anything other than a disk drive./
                         CARRET
                         JRST   DISPAT]
                 SKIPE  CEHLD
                 JRST   ADDB
                 JRST   [CARRET
                         CARRET
                         PRINT  /CE cylinder is locked into place./
                         CARRET
                         JRST   DISPAT]
                 ADDB: SKIPE    DWRTPRO
                 JRST   [CARRET
                         CARRET
                         PRINT  /Disk is software write protected./
                         CARRET
                         JRST   DISPAT]
                 JRST   ADDBAT]
G22:    CAIE    1,26
        JRST    G23
        JRST    [CARRET
                 SKIPE  DWRTPRO
                 JRST   [CARRET
                         CARRET
                         PRINT  /Disk is software write protected/
                         CARRET
                         PRINT  /*** Auto ADDBAT ignored ***/
                         CARRET
                         JRST   DISPAT]
                 JRST   AUTON]
G23:    CAIE    1,27
        JRST    G24
        JRST    [CARRET
                 JRST   AUTOFF]
G24:    CAIE    1,30
        JRST    G25
        JRST    [CARRET
                 MOVE   1,DEVICE
                 CAIE   1,2
                 JRST   [CARRET
                         PRINT  /You can not do a INSBAT on anything but a disk drive./
                         CARRET
                         JRST   DISPAT]
                 SKIPE  CEHLD
                 JRST   INSB
                 JRST   [CARRET
                         CARRET
                         PRINT  /CE cylinder is locked into place./
                         CARRET
                         JRST   DISPAT]
                 INSB: SKIPE    DWRTPRO
                 JRST   [CARRET
                         CARRET
                         PRINT  /Disk is software write protected./
                         CARRET
                         JRST   DISPAT]
                 JRST   INSBAT]
G25:    CAIE    1,31
        JRST    G26
        JRST    [skipe pgflg
                 jrst   [carret
                         carret
                         print /Pager system is already enabled./
                         carret
                         jrst   dispat]
                 CARRET
                 CARRET
                 SETOM  PGFLG
                 PRINT  /Pager system is now enabled./
                 CARRET
                 JRST   DISPAT]
G26:    CAIE    1,32
        JRST    G27
        JRST    [skipn  pgflg
                 jrst   [carret
                         carret
                         print  /Pager system is already disabled./
                         carret
                         jrst   dispat]
                 CARRET
                 CARRET
                 SETZM  PGFLG
                 PRINT  /Pager system is now disabled./
                 CARRET
                 JRST   DISPAT]
G27:    CAIE    1,33
        JRST    G28
        JRST    [skipn dwrtpro
                 jrst   [movei 2,[asciz /

You have already removed the write protect, don't you remember.
/]
                         pushj  p,strout
                         jrst   dispat]
                 CARRET
                 CARRET
                 MOVEI  1,0
                 PUSHJ  P,DOYOU
                 SKIPE  NO
                 JRST   [MOVEI  2,[ASCIZ /
*** WARNING - Disk software protect removed /]
                         pushj  p,strout
                         pushj  p,pritim
                         movei  2,[asciz/ ***
/]
                         PUSHJ  P,STROUT
                         SETZM  DWRTPRO
                         JRST   DISPAT]
                 CARRET
                 PRINT  /I did not think so./
                 CARRET
                 JRST   DISPAT]
G28:    CAIE    1,34
        JRST    G29
        JRST    [skipe  cehld
                 JRST   [MOVEI 2,[ASCIZ /

You have already removed the hold, don't you remember.
/]      
                         PUSHJ  P,strout
                         jrst  dispat]
                 CARRET
                 CARRET
                 MOVEI  1,0
                 PUSHJ  P,DOYOU
                 SKIPE  NO
                 JRST   [PUSHJ  P,GTPASS
                         MOVEI 2,[ASCIZ /
*** WARNING - CE cylinder lock removed /]
                         pushj  p,strout
                         pushj  p,pritim
                         movei  2,[asciz/ ***
/]
                         PUSHJ  P,STROUT
                         SETOM  CEHLD
                         PUSHJ  P,INISET
                         MOVEI  1,0
                         MOVEM  1,MINCYL
                         MOVEM  1,MINHED
                         MOVEM  1,MINSEC
                         JRST   DISPAT]
                 CARRET
                 PRINT  /I did not think so./
                 CARRET
                 JRST   DISPAT]
G29:    CAIE    1,35
        JRST    G30
        JRST    [skipe  memhlt
                 jrst   [carret
                         carret
                         print  /Memory error halt is already enabled./
                         carret
                         jrst   dispat]
                 MOVEI  2,[ASCIZ /

Memory error halt is now enabled.
/]
                 pushj  p,strout
                 setom  memhlt
                 jrst   dispat]
G30:    CAIE    1,36
        JRST    G31
        jrst    [skipn  memhlt
                 jrst   [carret
                         carret
                         print /Memory error halt is already disabled./
                         carret
                         jrst   dispat]
                 movei  2,[asciz /

Memory error halt is now disabled.
/]
                 pushj  p,strout
                 setzm  memhlt
                 jrst   dispat]
G31:    CAIE    1,37
        JRST    G32
        MOVE    1,[BRD26H,,TMP26H]
        BLT     1,TMP10L
PNTRES: SKIPE   TMP26H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B26                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C26                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP17L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C17                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C08                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP25H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B25                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C24                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP16L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C16                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C06                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP24H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B24                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C22                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP15L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C15                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C04                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP23H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B23                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C20                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP14L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C14                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C02                 PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP22H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B22                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP13L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C13                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP21H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B21                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP12L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C12                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP20H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B20                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP11L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C11                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP19H
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION B19                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        SKIPE   TMP10L
        JRST    [MOVEI  2,[ASCIZ /

|-----------------------------------------------------------------------------|
/]
                 PUSHJ  P,STROUT
                 MOVEI  2,[ASCIZ /| BOARD LOCATION C10                 PINS^                     COMPONENT VIEW |/]
                 skipe  chp64k
                 MOVEI  2,[ASCIZ /| BOARD LOCATION impossible          PINS^                     COMPONENT VIEW |/]
                 PUSHJ  P,STROUT
                 JRST   BDHDEX]
        JRST    [MOVEI  2,[ASCIZ /

*** There are no errors to paint ***

/]
                 PUSHJ  P,STROUT
                 JRST   dispat]
BDHDEX: SKIPE   TMP26H
        JRST    [MOVEI  5,CHPTAB
                 SETZM  TMP26H
                 JRST   BDCNT]
        SKIPE   TMP17L
        JRST    [MOVEI  5,CHPTAB+260
                 SETZM  TMP17L
                 JRST   BDCNT]
        SKIPE   TMP25H
        JRST    [MOVEI  5,CHPTAB+260*2
                 SETZM  TMP25H
                 JRST   BDCNT]
        SKIPE   TMP16L
        JRST    [MOVEI  5,CHPTAB+260*3
                 SETZM  TMP16L
                 JRST   BDCNT]
        SKIPE   TMP24H
        JRST    [MOVEI  5,CHPTAB+260*4
                 SETZM  TMP24H
                 JRST   BDCNT]
        SKIPE   TMP15L
        JRST    [MOVEI  5,CHPTAB+260*5
                 SETZM  TMP15L
                 JRST   BDCNT]
        SKIPE   TMP23H
        JRST    [MOVEI  5,CHPTAB+260*6
                 SETZM  TMP23H
                 JRST   BDCNT]
        SKIPE   TMP14L
        JRST    [MOVEI  5,CHPTAB+260*7
                 SETZM  TMP14L
                 JRST   BDCNT]
        SKIPE   TMP22H
        JRST    [MOVEI  5,CHPTAB+260*10
                 SETZM  TMP22H
                 JRST   BDCNT]
        SKIPE   TMP13L
        JRST    [MOVEI  5,CHPTAB+260*11
                 SETZM  TMP13L
                 JRST   BDCNT]
        SKIPE   TMP21H
        JRST    [MOVEI  5,CHPTAB+260*12
                 SETZM  TMP21H
                 JRST   BDCNT]
        SKIPE   TMP12L
        JRST    [MOVEI  5,CHPTAB+260*13
                 SETZM  TMP12L
                 JRST   BDCNT]
        SKIPE   TMP20H
        JRST    [MOVEI  5,CHPTAB+260*14
                 SETZM  TMP20H
                 JRST   BDCNT]
        SKIPE   TMP11L
        JRST    [MOVEI  5,CHPTAB+260*15
                 SETZM  TMP11L
                 JRST   BDCNT]
        SKIPE   TMP19H
        JRST    [MOVEI  5,CHPTAB+260*16
                 SETZM  TMP19H
                 JRST   BDCNT]
        SKIPE   TMP10L
X4:     JRST    [MOVEI  5,CHPTAB+260*17
                 SETZM  TMP10L
                 JRST   BDCNT]
        MOVEI   5,ZROTAB
BDCNT:  MOVEI   4,0                     ;USED AS INDEX FOR CHIP COUNT ON ROW
        MOVEI   6,0
        MOVEI   1,7
        MOVEM   1,RWNUM
MORERW: MOVEI   2,[ASCIZ /
|                                                                             |
/]
        PUSHJ   P,STROUT
ROWCNT: MOVEI   2,[ASCIZ /| /]
        PUSHJ   P,STROUT
ROWRES: SKIPE   0(5)
        JRST    [MOVEI  2,BDCHP
                 PUSHJ  P,STROUT
                 JRST   RWPRT]
        JRST    [MOVEI  2,[ASCIZ / M /]
                 PUSHJ  P,STROUT
                 JRST   RWPRT]
RWNUM:  0
RWPRT:  ADDI    5,1                     ;GET NEXT CHIP
        ADDI    6,1                     ;USED AS A COUNTER
        CAIN    6,260
        JRST    CHPDON
        ADDI    4,1                     ;FINISH THE ROW
        CAIN    4,13
        JRST    [MOVEI  2,[ASCIZ /  ROW /]
                 PUSHJ  P,STROUT
                 OUTOCT RWNUM,1
                 MOVE   1,RWNUM
                 SUBI   1,1
                 MOVEM  1,RWNUM
                 MOVEI  2,[ASCIZ /  /]
                 PUSHJ  P,STROUT
                 JRST   ROWRES]
        CAIN    4,26
        JRST    [MOVEI  2,[ASCIZ / |/]
                 PUSHJ  P,STROUT
                 MOVEI  4,0             ;RESET THE INDEX
                 JRST   MORERW]         ;GO THE THE REST OF THE PAINTING
        JRST    ROWRES                  ;GO DO SOME MORE
CHPDON: MOVEM   5,DEBUG2
        MOVEI   2,[ASCIZ / |/]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
|-----------------------------------------------------------------------------|/]
        PUSHJ   P,STROUT
        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        SKIPE   TMP26H
        JRST    PNTMOR
        SKIPE   TMP17L
        JRST    PNTMOR
        SKIPE   TMP25H
        JRST    PNTMOR
        SKIPE   TMP16L
        JRST    PNTMOR
        SKIPE   TMP24H
        JRST    PNTMOR
        SKIPE   TMP15L
        JRST    PNTMOR
        SKIPE   TMP23H
        JRST    PNTMOR
        SKIPE   TMP14L
        JRST    PNTMOR
        SKIPE   TMP22H
        JRST    PNTMOR
        SKIPE   TMP13L
        JRST    PNTMOR
        SKIPE   TMP21H
        JRST    PNTMOR
        SKIPE   TMP12L
        JRST    PNTMOR
        SKIPE   TMP20H
        JRST    PNTMOR
        SKIPE   TMP11L
        JRST    PNTMOR
        SKIPE   TMP19H
        JRST    PNTMOR
        SKIPE   TMP10L
        JRST    PNTMOR
        JRST    DISPAT
PNTMOR: movei   1,4
        CARRET
        PUSHJ   P,DOYOU
        SKIPE   NO
        JRST    PNTRES
        JRST    DISPAT
G32:    CAIE    1,40
        JRST    G33
        MOVE    1,[BRD26H,,BRD26H+1]    ;LETS CLEAR BOARD INDICATOR
        SETZM   BRD26H
        BLT     1,BRD26H+17
        MOVE    1,[CHPTAB,,CHPTAB+1]    ;LETS CLEAR CHIP INDICATOR
        SETZM   CHPTAB
        BLT     1,CHPTAB+5377           ;MAX NUMBER OF CHIPS ON 1MEG 16K CHIP
        MOVEI   2,[ASCIZ /

*** Memory history buffer is now cleared /]
        pushj   p,strout
        pushj   p,pritim
        movei   2,[asciz/ ***

/]
        pushj   p,strout
        JRST    DISPAT
G33:    CAIE    1,41
        JRST    G34
        move    1,device
        caie    1,2
        jrst    [carret
                 print /You must select the disk drive as a device first./
                 carret
                 jrst dispat]
        carret
        setzm   source
        pushj   p,whatad
        movem   1,src
        setom   source
        pushj   p,whatad
        movem   1,dst
        jrst    pakcpy
G34:    CAIE    1,43
        JRST    G35
        MOVEI   2,[ASCIZ /

Testing started /]
        pushj   p,strout
        pushj   p,pritim
        carret
        setzm   device
        jrst    scnmem
G35:    CAIE    1,44
        JRST    GEX
        JRST    SETIME
GEX:    HRLZI   1,INBUF
        ADDI    1,INBUF+1
        SETZM   INBUF
        BLT     1,INBUF+77
        MOVE    3,[POINT 7,INBUF]
        MOVEM   3,SAVEPT
LUUP:   JRST    DISPAT1
INPROG: 0

SETIME: ;THIS IS THE SETIME ROUTINE. IT WILL ALLOW YOU TO SET THE TIME
        ;TO WHATEVER THE REAL TIME OF DAY IS.

        MOVEI   2,[ASCIZ /
Please enter the time in the following format ( hours:minutes ) ? /]
        pushj   p,strout
        movei   1,0
        movem   1,hour
        movem   1,minute
        movem   1,second
        carret
        jrst    dispat
enttab: asciz   /00/
        asciz   /01/
        asciz   /02/
        asciz   /03/
        asciz   /04/
        asciz   /05/
        asciz   /06/
        asciz   /07/
        asciz   /08/
        asciz   /09/
        asciz   /10/
        asciz   /11/
        asciz   /12/
        asciz   /13/
        asciz   /14/
        asciz   /15/
        asciz   /16/
        asciz   /17/
        asciz   /18/
        asciz   /19/
        asciz   /20/
        asciz   /21/
        asciz   /22/
        asciz   /23/
        asciz   /24/
        asciz   /25/
        asciz   /26/
        asciz   /27/
        asciz   /28/
        asciz   /29/
        asciz   /30/
        asciz   /31/
        asciz   /32/
        asciz   /33/
        asciz   /34/
        asciz   /35/
        asciz   /36/
        asciz   /37/
        asciz   /38/
        asciz   /39/
        asciz   /40/
        asciz   /41/
        asciz   /42/
        asciz   /43/
        asciz   /44/
        asciz   /45/
        asciz   /46/
        asciz   /47/
        asciz   /48/
        asciz   /49/
        asciz   /50/
        asciz   /51/
        asciz   /52/
        asciz   /53/
        asciz   /54/
        asciz   /55/
        asciz   /56/
        asciz   /57/
        asciz   /58/
        asciz   /59/

INISET: SETZM   INIHIT
        SKIPN   CEHLD
        JRST    [MOVE   1,MAXCYL
                 MOVEM  1,T1CYL
                 MOVEM  1,T2CYL
                 MOVEM  1,T3CYL
                 MOVEM  1,T4CYL
                 MOVEM  1,T5CYL
                 MOVEM  1,T6CYL
                 MOVEM  1,T7CYL
                 JRST   CYLPASS]
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T1CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T2CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T3CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T4CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T5CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T6CYL
        MOVE    1,MAXCYL
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random cylinder
        MOVE    1,RANDOM
        MOVEM   1,T7CYL
CYLPASS: MOVE   1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T1HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T2HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T3HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T4HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T5HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T6HED
        MOVE    1,MAXHED
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random HEAD
        MOVE    1,RANDOM
        MOVEM   1,T7HED
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T1SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T2SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T3SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T4SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T5SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T6SEC
        MOVE    1,MAXSEC
        ADDI    1,1
        MOVEM   1,RNDLIM
        PUSHJ   P,RNDGEN                ;Get random SECTOR
        MOVE    1,RANDOM
        MOVEM   1,T7SEC
        MOVE    1,T1CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T1HED
        MOVE    3,T1SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T1SAV
        MOVE    1,T2CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T2HED
        MOVE    3,T2SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T2SAV
        MOVE    1,T3CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T3HED
        MOVE    3,T3SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T3SAV
        MOVE    1,T4CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T4HED
        MOVE    3,T4SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T4SAV
        MOVE    1,T5CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T5HED
        MOVE    3,T5SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T5SAV
        MOVE    1,T6CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T6HED
        MOVE    3,T6SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T6SAV
        MOVE    1,T7CYL         ;COMPUTE SOFTWARE DISK ADD.
        MOVE    2,T7HED
        MOVE    3,T7SEC
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        MOVEM   1,T7SAV
        MOVE    1,[T1SAV,,TMPSAV]
        BLT     1,TMPSAV+7
        MOVEI   2,0
        MOVEI   4,0
INICOM: MOVE    1,TMPSAV(4)
        MOVE    3,ONES
        MOVEM   3,TMPSAV(4)
INIMOR: CAMN    1,TMPSAV(2)
        JRST    [SETOM  INIHIT
                 JRST   INISET]
        ADDI    2,1
        CAIE    2,10
        JRST    INIMOR
        MOVEI   2,0
        ADDI    4,1
        CAIE    4,10
        JRST    INICOM
INIEX:  POPJ    P,0
INIHIT: 0
COMA:   0
COMB:   0
T1SAV:  0
T2SAV:  0
T3SAV:  0
T4SAV:  0
T5SAV:  0
T6SAV:  0
T7SAV:  0

DGTBAT: ;THIS IS AN ALTERNATE ENTRY FOR GETBAT. THIS FIXED AUTO
        ;GETBAT PROBLEM FROM DISPATCH.

        SETOM   DGT     
        JRST    GETBAT
DGT:    0                       ;JUST A FLAG FOR ALTERNATE ENTRY

GETBAT: ;THIS ROUTINE WILL GET THE BAT BLOCK OFF THE CURRENT DRIVE.
        ;ALL TESTS THEN WILL INTEROGATE THE BAT BLOCK TO SEE IF IT
        ;SHOULD BYPASS THIS DISK SECTOR.

        MOVE    P,SAVEIT
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [CARRET
                 PRINT  /You can not do a GETBAT on anything else but a disk drive./
                 CARRET
                 JRST   DISPAT]
        MOVEI   1,21
        MOVEM   1,TESTNUM
        MOVE    1,CYL
        MOVEM   1,GETCYL
        MOVE    1,HEAD
        MOVEM   1,GETHED
        MOVE    1,SECTOR
        MOVEM   1,GETSEC
        MOVE    1,UNIT
        MOVEM   1,UNITSAV
        MOVEI   1,0
        MOVEM   1,CYL
        MOVEI   1,1
        MOVEM   1,HEAD
        SKIPN   PRIMRY
        PUSHJ   P,[MOVEI 1,0            ;FOR SECONDARY BATBLK
                   MOVEM 1,HEAD
                   POPJ  P,]
        MOVEI   1,4
        MOVEM   1,SECTOR
        MOVEI   1,RBUF
        PUSHJ   P,RDSUB
        setzm   badcod
        move    1,rbuf
        came    1,batnam
        jrst    [movei 1,3
                 movem  1,badcod
                 jrst   badbat]
        move    1,rbuf+777
        skipn   primry
        jrst    [came 1,batsf1
                 jrst [movei 1,1
                       movem 1,badcod
                       jrst badbat]
                 jrst secok]
        jrst    [came 1,batsf2
                 jrst [movei 1,1
                       movem 1,badcod
                       jrst badbat]
                 jrst secok]
secok:  MOVE    1,RBUF+7
        HLRZ    2,1
        HRRZS   1,1
        ADD     1,2
        MOVEM   1,BATENT
        ADD     1,RBUF+6
        CAIE    1,764
        JRST    [movei 1,2
                 movem 1,badcod
                 jrst BADBAT]
        MOVE    1,[RBUF+11,,BATBLK]
        BLT     1,BATBLK+762
        move 1,calccy           ;COMPUTE LAST SECTOR ADD. THAT TENEX USES
        subi    1,2
        movei 2,0
        movei 3,0
        pushj p,makva
        move  1,SAVVA
        movem 1,vatlg
        move    6,batent
        movei   7,0     ;clear reg 7 in case there are zero batblk entries
        movei   5,0
        caie    6,0
        pushj   p,[        movei 6,0            ;use as an index
                           movei 7,0            ;init counter
                   maktab: move 1,batblk(6)     ;get entry
                           lshc 1,-10           ;lets get sector
                           lsh 2,-34
                           movem 2,tmpsec
                           caml 2,calcsc
                           pushj p,[movei 10,7
                                    movem 10,badcod
                                    popj p,]
                           lshc 1,-10           ;lets get head
                           lsh 2,-34
                           movem 2,tmphed       
                           caml 2,calchd
                           pushj p,[movei 10,6
                                    movem 10,badcod
                                    popj p,]
                           lshc 1,-15           ;lets get cylinder
                           lsh 2,-27
                           movem 2,tmpcyl
                           caml 2,calccy
                           pushj p,[movei 10,5
                                    movem 10,badcod
                                    popj p,]
                           movem 1,cnt
                           move 2,calcsc
                           addi 2,1
                           caml 1,2
                           pushj p,[movei 10,11
                                    movem 10,badcod
                                    popj p,]
                           cain 1,0
                           pushj p,[movei 10,10
                                    movem 10,badcod
                                    popj p,]
                           skipe badcod
                           jrst mkext
                           move 1,tmpcyl
                           move 2,tmphed
                           move 3,tmpsec
                           pushj p,makva        ;make a virtual add. out of it
                           move 4,cnt
                           move 1,savva         ;get the virtual add.
                   viradd: movem 1,battab(5)    ;put it away
                           addi 7,1
                           addi 5,1             ;add to battab index
                           subi 4,1             ;sub 1 from the count
                           addi 1,1             ;add one to virtual add.
                           caie 4,0             ;0 if last one
                           jrst viradd
                           addi 6,1             ;sub from the index
                           came 6,batent        ;see if end of batblk
                           jrst maktab          ;go do somemore
                           move 1,batlim        ;store away delimiter
                   mkext:  popj p,]             ;we are done
        skipe   badcod
        jrst    badbat
        move    1,batlim
        movem   1,battab(5)             ;store away delimiter so we can stop
        SETZM   DUP
        MOVE    1,[BATTAB,,TMPTAB]
        BLT     1,TMPTAB+777
        MOVEI   4,0
        MOVEI   3,0
NEWENT: MOVE    1,TMPTAB(4)
        CAMN    1,BATLIM
        JRST    DUPEND
CEVA:   caml    1,vatlg         ;SEE IF CE CYL>=VATLG
        jrst    [movei 1,4
                 movem 1,badcod
                 jrst badbat]
        SETOM   TMPTAB(4)
DUPMOR: CAMN    1,TMPTAB(3)
        SETOM   DUP
        ADDI    3,1
        MOVE    5,TMPTAB(3)
        CAMN    5,BATLIM
        JRST    [ADDI   4,1
                 MOVEI  3,0
                 CAIGE  4,1000
                 JRST   NEWENT
                 MOVEI  2,[ASCIZ /
Hung in seemingly endless loop, please contact Dan Martin.
/]
                 pushj  p,strout
                 jrst   dispat]
        JRST    DUPMOR
DUPEND: setom   gdbat
        SKIPE   DUP
        jrst    [MOVEI  2,[ASCIZ /
Duplicate entries found in primary BATBLK.
/]
                 SKIPN  PRIMRY
                 PUSHJ  P,[MOVEI 2,[ASCIZ /
Duplicate entries found in secondary BATBLK.
/]
                           popj p,]
                 pushj  p,strout
                 jrst   dupcnt]
        jrst    [movei  2,[asciz /
No duplicate entries found in primary BATBLK.
/]
                 skipn  primry
                 pushj  p,[movei 2,[asciz /
No duplicate entries found in secondary BATBLK.
/]
                           popj p,]
                 pushj  p,strout
                 jrst   dupcnt]
DUPCNT: SETOM   GOTBAT
        movei   2,[asciz /Total number of entries in primary BATBLK - /]
        skipn   primry
        pushj   p,[movei 2,[asciz /Total number of entries in secondary BATBLK -/]
                   popj p,]
        pushj   p,strout
        move    1,7
        movei   2,1
        MOVEI   3,0
        pushj   p,decout
        carret
        carret
        SKIPE   AUTBAT
        JRST    [SKIPE  DGT             ;FROM ALTERNATE ENTRY
                 JRST   [SETZM  DGT
                         JRST   GETEXT]
                 CARRET
                 PRINT  /Auto ADDBAT enabled ** RETURNING TO TEST **/
                 CARRET
                 SKIPE  ZEROFLG
                 JRST   TESTD1          ;GO BACK AND RESTART TEST0
                 MOVE   1,TSTSAV        ;GO BACK AND START OTHER TESTS
                 CAIN   1,1
                 JRST   TESTD1
                 CAIN   1,2
                 JRST   TESTD2
                 CAIN   1,3
                 JRST   TESTD3
                 CAIN   1,4
                 JRST   TESTD4
                 CAIN   1,5
                 JRST   TESTD5
                 CAIN   1,6
                 JRST   TESTD6
                 CAIN   1,7
                 JRST   TESTD7
                 CAIN   1,0
                 JRST   GETEXT
                 CARRET
                 PRINT  /Testnum does not equal a valid test./
                 CARRET
                 PRINT  /         ***ABORTING***/
                 CARRET
                 JRST   GETEXT]
        SETZM   DGT             ;JUST IN CASE WE TRIED TO LEAVE IT ON
        JRST    GETEXT
BADBAT: MOVEI   2,[ASCIZ /
Appears to be bad primary BATBLK.
/]
        skipn   primry
        pushj   p,[movei 2,[asciz /
Appears to be bad secondary BATBLK.
/]
                   popj p,]
        pushj   p,strout
        move    1,badcod
        cain    1,1
        jrst    [movei 2,[asciz /Sector ID at end of sector is not correct.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,2
        jrst    [movei 2,[asciz /BATBLK entries do not add up to 764.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,3
        jrst    [movei 2,[asciz /First entry in BATBLK is not BATID.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,4
        jrst    [movei 2,[asciz /BATBLK has CE cyl entry in it.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,5
        jrst    [movei 2,[asciz /BATBLK has illegal cylinder address in it.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,6
        jrst    [movei 2,[asciz /BATBLK has illegal head address in it.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,7
        jrst    [movei 2,[asciz /BATBLK has illegal sector address in it.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,10
        jrst    [movei 2,[asciz /BATBLK has count equal to zero in it.
/]
                 pushj p,strout
                 jrst   getext]
        cain    1,11
        jrst    [movei 2,[asciz /BATBLK has count greater than number of max. sectors in it.
/]
                 pushj p,strout
                 jrst   getext]
        JRST    GETEXT
GETEXT: MOVE    1,GETCYL
        MOVEM   1,CYL
        MOVE    1,GETHED
        MOVEM   1,HEAD
        MOVE    1,GETSEC
        MOVEM   1,SECTOR
        JRST    DISPAT
BATENT: 0                       ;THE NUMBER OF ENTRIES IN THE BATBLK
GETCYL: 0
GETHED: 0
GETSEC: 0
UNITSAV: 0                                      ;THIS CELL SHOULD EQUAL UNIT.

PRIBAT: ;THIS ROUTINE WILL TYPE OUT THE BAT BLOCKS FOR THE CURRENT DRIVE.
        ;YOU MUST USE GETBAT FIRST.

        MOVE    P,SAVEIT
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [CARRET
                 PRINT  /You can not do a PRIBAT on anything else but a disk drive./
                 CARRET
                 JRST   DISPAT]
        MOVEI   6,0             ;CLEAR INDEX
        PUSHJ   P,HEADER
        MOVEI   7,1
        MOVEM   7,ENTRY
        MOVEI   7,0
PRIMOR: MOVE    4,BATBLK(6)     ;GET FIRST ENTRY
        CAIN    4,0     
        JRST    [CARRET
                 CARRET
                 PRINT  /*** End of BATBLK file ***/
                 CARRET
                 JRST   DISPAT]
        LSHC    4,-10
        LSH     5,-34
        MOVEM   5,PRISEC
        LSHC    4,-10
        LSH     5,-34
        MOVEM   5,PRIHED
        LSHC    4,-15
        LSH     5,-27
        MOVEM   5,PRICYL
        MOVEM   4,PRICNT
        MOVEI   2,[ASCIZ /   /]
        PUSHJ   P,STROUT
        MOVE    1,ENTRY
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /       /]
        PUSHJ   P,STROUT
        MOVE    1,ENTRY
        ADD     1,PRICNT
        MOVEM   1,ENTRY
        MOVE    1,PRICNT
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /       /]
        PUSHJ   P,STROUT
        MOVE    1,PRICYL
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /       /]
        PUSHJ   P,STROUT
        MOVE    1,PRIHED
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,DECOUT
        MOVEI   2,[ASCIZ /       /]
        PUSHJ   P,STROUT
        MOVE    1,PRISEC
        MOVEI   2,0
        MOVEI   3,0
        PUSHJ   P,DECOUT
        CARRET
        ADDI    6,1
        ADDI    7,1
        CAIE    7,24
        JRST    PRIMOR
        MOVEI   1,1
        PUSHJ   P,DOYOU
        SKIPE   NO
        JRST    [MOVEI  7,0
                 MOVE   4,BATBLK(6)     ;GET FIRST ENTRY
                 CAIN   4,0     
                 JRST   [CARRET
                         CARRET
                         PRINT  /*** End of BATBLK file ***/
                         CARRET
                         JRST   DISPAT]
                 CARRET
                 CARRET
                 PUSHJ  P,HEADER
                 JRST   PRIMOR]
        JRST    DISPAT
ENTRY:  0
PRISEC: 0
PRIHED: 0
PRICYL: 0
PRICNT: 0
HEADER: CARRET
        PRINT   /   Entry       Count     Cylinder       Head       Sector/
        CARRET  
        POPJ    P,0


INCDAX:         ; ALTERNATE ENTRY TO INCDA
                ; INCREMENTS ONLY HEAD & CYL (NOT SECTOR)
        PUSH    P,1
        JRST    INCDA1
INCDA:          ; INCREMENT DISK ADDRESS PARAMETERS
                ; SKIP RETURNS WHEN THEY OVERFLOW
        PUSH    P,1
        SETOM   INBAT                   ;TALK ABOUT STRUCTURED PROGRAMING.
        AOS     1,SECTOR
        CAMG    1,MAXSEC
        JRST    INCX
        MOVE    1,MINSEC
        MOVEM   1,SECTOR
INCDA1: AOS     1,HEAD
        CAMG    1,MAXHED
        JRST    INCX
        MOVE    1,MINHED
        MOVEM   1,HEAD
        AOS     1,CYL
        CAMG    1,MAXCYL
        JRST    INCX
        MOVE    1,MINCYL
        MOVEM   1,CYL
        AOS     -1(P)   ;SKIP RETURN
INCX:   POP     P,1
        POPJ    P,
INBAT:  0

INITDA:
        PUSH    P,1
        MOVE    1,MINSEC
        MOVEM   1,SECTOR
        MOVE    1,MINHED
        MOVEM   1,HEAD
        MOVE    1,MINCYL
        MOVEM   1,CYL
        POP     P,1
        POPJ    P,

ADDBAT: ;THIS ROUTINE WILL ADD A BAD SPOT TO THE BAT BLOCK. IT WILL
        ;USE THE DATA THAT IS IN CYL,HEAD, AND SECTOR.

        CARRET
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [CARRET
                 CARRET
                 PRINT  /You can not do a ADDBAT on anything else but a disk drive./
                 CARRET
                 JRST   DISPAT]
        skipn   gdbat
        JRST    [CARRET
                 CARRET
                 PRINT  /You have not done a GETBAT as of yet./
                 CARRET
                 PRINT  /*** ADDBAT ignored ***/
                 CARRET
                 JRST   DISPAT]
        SKIPE   DWRTPRO
        JRST    [CARRET
                 CARRET
                 PRINT  /Disk is software write protected./
                 CARRET
                 JRST   DISPAT]
        MOVE    P,SAVEIT
        PUSHJ   P,GTPASS
        MOVEI   1,23
        MOVEM   1,TESTNUM
        move 1,calccy           ;COMPUTE LAST SECTOR ADD. THAT TENEX USES
        subi    1,2
        movei 2,0
        movei 3,0
        pushj p,makva
        move  1,SAVVA
        movem 1,vatlg
        MOVE    1,CYL
        MOVE    2,HEAD
        MOVE    3,SECTOR
        PUSHJ   P,MAKVA
        MOVE    1,SAVVA
        CAML    1,VATLG
        JRST    [MOVEI  2,[ASCIZ /
You can not add this disk address to the BATBLK,
it will cause Tenex to compute wrong or impossible
disk addresses.
         !!!!OPERATION ABORTED!!!!

/]
                 pushj p,strout
                 jrst  dispat]
        MOVE    1,CYL
        MOVEM   1,ADDCYL
        MOVE    1,HEAD
        MOVEM   1,ADDHED
        MOVE    1,SECTOR
        MOVEM   1,ADDSEC
        PUSHJ   P,TSTBAT                ;SEE IF ALREADY IN BAT BLOCK
        SKIPE   BATWRT
        JRST    [MOVEI 2,[ASCIZ /
Trying to add the BATBLK to the BATBLK.
      !!!!OPERATION ABORTED!!!!

/]
                 PUSHJ  P,STROUT
                 JRST DISPAT]
        SKIPE   INBAT                   ;SKIP IF NOT IN BAT BLOCK ALREADY
        JRST    [MOVEI  2,[ASCIZ /   
This disk address is already in the BATBLK.
        !!!!OPERATION ABORTED!!!!
   
/]
                 PUSHJ P,STROUT
                 JRST DISPAT]
        SETZM   CYL
        MOVEI   1,1                     ;FOR PRIMARY BAT BLOCK
        MOVEM   1,HEAD
        MOVEI   1,4                     ;FOR SECTOR FOUR
        MOVEM   1,SECTOR
PRBAT:  MOVEI   1,RBUF
        PUSHJ   P,RDSUB                 ;NOW GET THE BAT BLOCK
        MOVE    1,RBUF+7                ;LETS GET BATCNT
        HLRZ    2,1
        HRRZS   1,1
        ADD     1,2
        MOVE    3,1                     ;USE AS INDEX IF OK
        ADD     1,RBUF+6                ;ADD IT TO BATFRE
        CAIE    1,764                   ;SHOULD EQUAL THIS
        JRST    [ MOVEI 2,[ASCIZ /   
Primary BATBLK appears to be bad.
    !!!!OPERATION ABORTED!!!!
   /]
                  PUSHJ P,STROUT
                  JRST DISPAT]
        MOVEI   2,[ASCIZ /   
Primary BATBLK appears to be ok,
adding new bad spot to primary BATBLK./]
        PUSHJ   P,STROUT
        MOVE    1,ADDCYL                ;LETS GET OFFENDING CYLINDER
        MOVE    2,ADDHED                ;GET OFFENDING HEAD
        LSH     2,34                    ;SHIFT 28 BITS LEFT
        LSHC    1,10                    ;SHIFT BOTH REG 8 BITS
        MOVE    2,ADDSEC                ;GET OFFENDING SECTOR
        LSH     2,34                    ;SHIFT 28 BITS LEFT
        LSHC    1,10                    ;SHIFT BOTH REG 8 BITS
        OR      1,[4000,,0]             ;THIS IS THE COUNT FIELD
        MOVEM   1,RBUF+11(3)            ;STORE IT AWAY
        MOVE    1,RBUF+7
        ADDI    1,1                     ;ADD ONE TO THE CNT
        MOVEM   1,RBUF+7
        MOVE    1,RBUF+6
        SUBI    1,1                     ;SUBTRACT ONE FROM BATFRE
        MOVEM   1,RBUF+6
        MOVE    1,[RBUF,,WBUF]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
        PUSHJ   P,WRSUB
        SETZM   HEAD
        MOVEI   1,RBUF
        PUSHJ   P,RDSUB
SECBAT: MOVE    1,RBUF+7                ;LETS GET BATCNT
        HLRZ    2,1
        HRRZS   1,1
        ADD     1,2
        MOVE    3,1                     ;USE AS INDEX IF OK
        ADD     1,RBUF+6                ;ADD IT TO BATFRE
        CAIE    1,764                   ;SHOULD EQUAL THIS
        JRST    [ MOVEI 2,[ASCIZ /   
Secondary BATBLK appears to be bad.
    !!!!OPERATION ABORTED!!!!
/]
                  PUSHJ P,STROUT
                  JRST DISPAT]
        MOVEI   2,[ASCIZ /   
Secondary BATBLK appears to be ok,
adding new bad spot to secondary BATBLK.

/]
        PUSHJ   P,STROUT
        MOVE    1,ADDCYL                ;LETS GET OFFENDING CYLINDER
        MOVE    2,ADDHED                ;GET OFFENDING HEAD
        LSH     2,34                    ;SHIFT 24 BITS LEFT
        LSHC    1,10                    ;SHIFT BOTH REG 8 BITS
        MOVE    2,ADDSEC                ;GET OFFENDING SECTOR
        LSH     2,34                    ;SHIFT 28 BITS LEFT
        LSHC    1,10                    ;SHIFT BOTH REG 8 BITS
        OR      1,[4000,,0]             ;THIS IS THE COUNT FIELD
        MOVEM   1,RBUF+11(3)            ;STORE IT AWAY
        MOVE    1,RBUF+7
        ADDI    1,1                     ;ADD ONE TO THE CNT
        MOVEM   1,RBUF+7
        MOVE    1,RBUF+6
        SUBI    1,1                     ;SUBTRACT ONE FROM BATFRE
        MOVEM   1,RBUF+6
        MOVE    1,[RBUF,,WBUF]
        BLT     1,WBUF+777
        MOVEI   1,WBUF
        PUSHJ   P,WRSUB
        MOVEI   2,[ASCIZ /Starting to execute auto GETBAT
/]
        PUSHJ   P,STROUT
        MOVE    1,ADDCYL
        MOVEM   1,CYL
        MOVE    1,ADDHED
        MOVEM   1,HEAD
        MOVE    1,ADDSEC
        MOVEM   1,SECTOR
        JRST    GETBAT
ADDCYL: 0
ADDHED: 0
ADDSEC: 0

AUTON:  ;THIS IS THE AUTON WHOLE.

        CARRET
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [CARRET
                 CARRET
                 PRINT  /You can not do a AUTON on anything else but a disk drive./
                 CARRET
                 JRST   DISPAT]
        skipn   gdbat
        JRST    [CARRET
                 CARRET
                 PRINT  /You have not done a GETBAT as of yet./
                 CARRET
                 PRINT  /*** Auto ADDBAT ignored ***/
                 CARRET
                 JRST   DISPAT]
        SKIPE   DWRTPRO
        JRST    [CARRET
                 CARRET
                 PRINT  /Disk is software write protected./
                 CARRET
                 PRINT  /*** Auto ADDBAT ignored ***/
                 CARRET
                 JRST   DISPAT]
        SKIPN   CEHLD
        JRST    [CARRET
                 CARRET
                 PRINT  /You must remove hold first./
                 CARRET
                 JRST   DISPAT]
        skipe   autbat
        jrst    [print /Auto ADDBAT is already enabled./
                 carret
                 jrst   dispat]
        PRINT   /Auto ADDBAT is enabled./
        CARRET
        SETOM   AUTBAT
        JRST    DISPAT
AUTBAT: 0

AUTOFF: ;THIS IS THE AUTOFF WHOLE.

        CARRET
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [CARRET
                 PRINT  /You can not do a AUTOFF on anything else but a disk drive./
                 CARRET
                 JRST   DISPAT]
        skipn   autbat
        jrst    [print /Auto ADDBAT is already disabled./
                 carret
                 jrst   dispat]
        PRINT   /Auto ADDBAT is disabled./
        CARRET
        SETZM   AUTBAT
        JRST    DISPAT

litfix: carret
        print /So you want to install the BATBLK. You must first enter the flaw map/
        carret
        print /from the drive HDA flaw chart. Please use the TYFOON write up to enter/
        carret
        print /the flaw map or we can use the flaw maps that are built into the /
        carret
        print /diagnostic./
        carret
        carret
        print /Please enter the HDA serial number ( EX. A1707 or C292 ) - /
        pushj   p,gethda
        move    1,hdanum
        move    2,ones
        came    2,hdanum
        jrst    [carret
                 print /HDA information is in the current library - Moving to BADADR./
                 carret
                 MOVE   1,HDANUM
                 PUSHJ  P,MOVBAT
                 jrst   batins]
         jrst   [carret
                 print /HDA is not in the current library - aborting operation/
                 jrst   dispat]

INSBAT: ;THIS ROUTINE WILL INSTALL A BAT BLOCK ONTO THE DRIVE. THE
        ;REASON THIS SHOULD BE DONE BY THE FE IS THAT BAT BLOCKS FOR
        ;THIS DRIVE SHOULD BE PART OF THE HARDWARE.

        MOVEI   2,[ASCIZ /
/]
        PUSHJ   P,STROUT
        MOVE    1,DEVICE
        CAIE    1,2
        JRST    [movei  2,[asciz /
You can not do a INSBAT on anything but a disk drive
/]
                 pushj  p,strout
                 JRST   DISPAT]
        SKIPE   DWRTPRO
        JRST    [movei  2,[asciz /
Disk is software write protected
/]
                 pushj  p,strout
                 JRST   DISPAT]
        MOVE    P,SAVEIT
        PUSHJ   P,GTPASS
        MOVEI   1,22
        MOVEM   1,TESTNUM
        SETZM   SAVAREA
        MOVE    1,[SAVAREA,,SAVAREA+1]
        BLT     1,SAVAREA+1777
        MOVEI   1,764           ;LETS RESTORE BATFRE AND BATCNT
        MOVEM   1,BATFRE
        SETZM   BATCNT
        MOVE    1,BADADR        ;GET THE NUMBER OF ENTRIES
        CAIN    1,0             ;SEE IF IT IS ZERO
        JRST    litfix
batins: MOVEI   3,0             ;USED AS INDEX
        MOVEI   4,11            ;USED AS SAVE INDEX
        MOVE    1,BADADR        ;GET IT AGIAN
        cain    1,0             ;see if no entries
        jrst    initial         ;just initialize the bat block
ADDMOR: MOVEI   6,0             ;CLEAR AC 6
        SETZM   ALL             ;CLEAR ALL TRACK FLAG
        MOVE    7,BADADR+1(3)   ;GET THE FIRST VALUE
        LSHC    6,22            ;LETS GET CYL
        LSH     6,20            ;LINE IT UP FOR MERGE
        MOVEM   6,CYLSAV        ;SAVE IT FOR LATER
        LSHC    6,22            ;LETS GET HEAD
        LSH     6,10            ;LINE IT UP FOR MERGE
        MOVEM   6,HEDSAV        ;SAVE THIS FOR LATER
        MOVEI   6,0             ;CLEAR AC 6
        ADDI    3,1             ;ADD ONE TO THE INDEX
BLDRET: MOVE    7,BADADR+1(3)   ;GET THE SECOND VALUE
        MOVE    11,ONES         ;THIS IS MY FLAG
        CAMN    11,BADADR+1(3)  ;SEE IF MINUS 1
        setom   all
        CAIN    7,0             ;WE KNOW IT IS SECTOR 0
        JRST    [MOVEI  7,100
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,1
        JRST    [MOVE   7,BYTCNT
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,2
        JRST    [MOVE   6,BYTCNT
                 MULI   6,2
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,3
        JRST    [MOVE   6,BYTCNT
                 MULI   6,3
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,4
        JRST    [MOVE   6,BYTCNT
                 MULI   6,4
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,5
        JRST    [MOVE   6,BYTCNT
                 MULI   6,5
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,6
        JRST    [MOVE   6,BYTCNT
                 MULI   6,6
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,7
        JRST    [MOVE   6,BYTCNT
                 MULI   6,7
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,10
        JRST    [MOVE   6,BYTCNT
                 MULI   6,10
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,11
        JRST    [MOVE   6,BYTCNT
                 MULI   6,11
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        CAIN    7,12
        JRST    [MOVE   6,BYTCNT
                 MULI   6,12
                 HRLZM  7,BADADR+1(3)
                 JRST   BLDRET]
        HLRZ    6,BADADR+1(3)
        CAIN    6,0             ;LETS MAKE SURE NOT DIV BY 0
        MOVEI   6,100           ;WHY NOT
        MOVEI   7,0
        cain    6,-1
        movei   6,100
        IDIV    6,BYTCNT
        OR      6,HEDSAV        ;OR IN THE HEAD
        OR      6,CYLSAV        ;OR IN THE CYLINDER
        SKIPE   ALL             ;SEE IF ALL TRACKS BAD
        JRST    [ OR 6,ALLT     ;GO DO THIS LITTLE BIT
                  setzm all
                  JRST RET1]
        OR      6,IDONTNO       ;count field
RET1:   MOVEM   6,SAVAREA(4)    ;SAVE THE RESULT
        ADDI    4,1             ;ADD ONE TO SAVE INDEX
        ADDI    3,1             ;ADD 1 TO INDEX 3
        MOVE    10,BATFRE
        SUBI    10,1
        MOVEM   10,BATFRE
        MOVE    10,BATCNT
        ADDI    10,1
        MOVEM   10,BATCNT
        SOJG    1,ADDMOR
INITIAL: MOVE   10,BATNAM
        MOVEM   10,SAVAREA
        MOVE    10,BATID1
        MOVEM   10,SAVAREA+1
        MOVE    10,BATVER
        MOVEM   10,SAVAREA+2
        MOVE    10,BATHW0
        MOVEM   10,SAVAREA+3
        MOVE    10,BATHB1
        MOVEM   10,SAVAREA+4
        MOVE    10,BATHB2
        MOVEM   10,SAVAREA+5
        MOVE    10,BATFRE
        MOVEM   10,SAVAREA+6
        MOVE    10,BATCNT
        MOVEM   10,SAVAREA+7
        MOVE    10,BATSPR
        MOVEM   10,SAVAREA+10
        MOVE    10,BATCOD
        MOVEM   10,SAVAREA+776
        MOVE    10,BATSF1
        MOVEM   10,SAVAREA+777
        MOVE    10,[SAVAREA,,WBUF]
        BLT     10,WBUF+777
        movei   2,[asciz /Starting to install secondary BATBLK
/]
        pushj   p,strout
STOPN:  MOVEI   10,0
        MOVEM   10,CYL
        MOVEI   10,0
        MOVEM   10,HEAD
        MOVEI   10,4
        MOVEM   10,SECTOR
        MOVEI   1,WBUF
        PUSHJ   P,WRSUB
        MOVE    10,BATID2
        MOVEM   10,SAVAREA+1
        MOVE    10,BATSF2
        MOVEM   10,SAVAREA+777
        MOVE    10,[SAVAREA,,WBUF]
        BLT     10,WBUF+777
        movei   2,[asciz /Starting to install primary BATBLK
/]
        pushj   p,strout
        MOVEI   10,1
        MOVEM   10,HEAD
        MOVEI   1,WBUF
        PUSHJ   P,WRSUB
        movei   2,[asciz /BATBLKS installed. Do not forget to do a GETBAT now for verification
/]
        pushj   p,strout
        JRST    DISPAT          ;GET OUT YOU ARE DONE
del1:   carret
        print /Please enter the HDA serial number ( EX. A1707 or C292 ) - /
        jrst    hdamor
gethda: PUSH    P,1
        push    p,2
        push    p,3
hdamor: pushj   p,ttyin
        skipn   bufful
        jrst    [SKIPE  TTYABO
                 JRST   [SETZM  TTYABO
                         MOVEI  2,INBUF
                         SETOM  BUFFUL
                         HRLZI  1,INBUF
                         ADDI   1,INBUF+1
                         SETZM  INBUF
                         BLT    1,INBUF+77
                         MOVE   3,[POINT 7,INBUF]
                         MOVEM  3,SAVEPT
                         JRST   DEL1]
                 movei  2,inbuf
                 setom  bufful
                 pushj  p,scanin
                 hrlzi  1,inbuf
                 addi   1,inbuf+1
                 setzm  inbuf
                 blt    1,inbuf+77
                 move   3,[point 7,inbuf]
                 movem  3,savept
                 jrst   hdaret]
        jrst    hdamor
hdaret: MOVEI   1,100
        CAME    1,SEL
        JRST    [ADDI   1,1
                 MOVE   2,HDATAB-100(1) ;BECAUSE OF THE 100 BIAS FROM SELECT
                 CAIN   2,0
                 JRST   HDANOT
                 JRST   HDARET+1]
        JRST    [MOVE   3,HDATAB-100(1) ;BECAUSE OF THE 100 BIAS FROM SELECT
                 MOVEM  3,HDANUM
                 JRST   HDEX]
HDANOT: move    1,ones
        movem   1,hdanum
        JRST    HDEX
hdex:   setzm   silent
        POP     P,3
        pop     p,2
        pop     p,1
        POPJ    P,
HDANUM: 0
ADDDAT: 5000,,0
ALL:    0
BATNAM: 424164,,0
BATID1: 220000,,0
BATID2: 210000,,0
BATVER: 1,,1000
BATHW0: 6015,,10010
BATHB1: 0,,402
BATHB2: 0,,2
BATFRE: 0,,764
BATCNT: 0
BATSPR: 0
BATSF1: 0,,4
BATSF2: 0,,404
BATCOD: 0,,606060
IDONTNO: 4000,,0
ALLT:   40000,,0
CYLSAV: 0
HEDSAV: 0
SECSAV: 0

clrbat: ;this routine will clear the batblks

        push    p,1
        setzm   badadr
        move    1,[badadr,,badadr+1]
        blt     1,badadr+1777
        setzm   batblk
        move    1,[batblk,,batblk+1]
        blt     1,batblk+777
        setzm   battab
        move    1,[battab,,battab+1]
        blt     1,battab+777
        pop     p,1
        popj    p,

CDC160: ;THIS WILL CONFIGURE THE CDC160 MEG BYTE DRIVE.

        SETZM   CEHLD
        setzm   skdis
        SETZM   ONCE
        SETZM   GOTBAT
        setzm   gdbat
        pushj   p,clrbat
        HRLZI   1,40000
        MOVEM   1,ALLT
        MOVEI   1,4730          ;USED IN INSBAT CALCULTATIONS
        MOVEM   1,BYTCNT
        MOVEI   1,1143          ;FOR SKIPPING OVER DATA, ECC, SPLICE AND GAP3
        MOVEM   1,DESGP3        ;STORE IN MEM LOCATION
        MOVEI   1,21
        MOVEM   1,SPLGP2
        MOVE    1,[SEC0ST,,SEC0ST+1]
        SETZM   SEC0ST
        BLT     1,SEC19ST       ;CLEAR SECTOR START INDICATORS
        MOVEI   1,FBUF          ;USED FOR WORD COUNT OF A SECTOR
        MOVEM   1,SEC0ST
        ADDI    1,1166
        MOVEM   1,SEC1ST
        ADDI    1,1166
        MOVEM   1,SEC2ST
        ADDI    1,1166
        MOVEM   1,SEC3ST
        ADDI    1,1166
        MOVEM   1,SEC4ST
        ADDI    1,1166
        MOVEM   1,SEC5ST
        ADDI    1,1166
        MOVEM   1,SEC6ST
        ADDI    1,1166
        MOVEM   1,SEC7ST
        ADDI    1,1166
        MOVEM   1,FBEND
        MOVEI   1,0
        MOVEM   1,MINHED
        MOVEM   1,MINSEC
        MOVEM   1,MINCYL
        MOVEI   1,1466
        MOVEM   1,MAXCYL
        ADDI    1,1
        MOVEM   1,CALCCY        ;USED FOR CALCULATIONS
        MOVEI   1,11
        MOVEM   1,MAXHED
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CalCHD
        MOVEI   1,7
        MOVEM   1,MAXSEC
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCSC
        PUSHJ   P,INISET
        MOVEI   1,1464
        MOVEM   1,MINSAF
        MOVEI   1,1466
        MOVEM   1,MAXSAF
        MOVEI   1,0
        MOVEM   1,BAT1CY
        MOVEM   1,BAT2CY
        MOVEI   1,0
        MOVEM   1,BAT1HD
        MOVEI   1,4
        MOVEM   1,BAT1SC
        MOVEM   1,BAT2SC
        MOVEI   1,1
        MOVEM   1,BAT2HD
        POPJ    P,0


AMP330: ;THIS WILL CONFIGURE THE AMP330 DRIVE.

        SETZM   CEHLD
        setzm   skdis
        SETZM   ONCE
        SETZM   GOTBAT
        setzm   gdbat
        pushj   p,clrbat
        HRLZI   1,40000
        MOVEM   1,ALLT
        MOVEI   1,4730          ;USED IN INSBAT CALCULATIONS
        MOVEM   1,BYTCNT
        MOVEI   1,1143          ;FOR SKIPPING OVER DATA, ECC, SPLICE AND GAP3
        MOVEM   1,DESGP3        ;STORE IN MEM LOCATION
        MOVEI   1,21
        MOVEM   1,SPLGP2
        MOVE    1,[SEC0ST,,SEC0ST+1]
        SETZM   SEC0ST
        BLT     1,SEC19ST       ;CLEAR SECTOR START INDICATORS
        MOVEI   1,FBUF          ;USED FOR WORD COUNT OF A SECTOR
        MOVEM   1,SEC0ST
        ADDI    1,1166
        MOVEM   1,SEC1ST
        ADDI    1,1166
        MOVEM   1,SEC2ST
        ADDI    1,1166
        MOVEM   1,SEC3ST
        ADDI    1,1166
        MOVEM   1,SEC4ST
        ADDI    1,1166
        MOVEM   1,SEC5ST
        ADDI    1,1166
        MOVEM   1,SEC6ST
        ADDI    1,1166
        MOVEM   1,SEC7ST
        ADDI    1,1166
        MOVEM   1,FBEND
        MOVEI   1,0
        MOVEM   1,MINHED
        MOVEM   1,MINSEC
        MOVEM   1,MINCYL
        MOVEI   1,1777
        MOVEM   1,MAXCYL
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCCY
        MOVEI   1,17
        MOVEM   1,MAXHED
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCHD
        MOVEI   1,7
        MOVEM   1,MAXSEC
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCSC
        PUSHJ   P,INISET
        MOVEI   1,1775
        MOVEM   1,MINSAF
        MOVEI   1,1777
        MOVEM   1,MAXSAF
        MOVEI   1,0
        MOVEM   1,BAT1CY
        MOVEM   1,BAT2CY
        MOVEI   1,0
        MOVEM   1,BAT1HD
        MOVEI   1,4
        MOVEM   1,BAT1SC
        MOVEM   1,BAT2SC
        MOVEI   1,1
        MOVEM   1,BAT2HD
        POPJ    P,0

M2351A: ;THIS WILL CONFIGURE THE EAGLE DRIVE.

        SETZM   CEHLD
        setom   skdis
        SETZM   ONCE
        SETZM   GOTBAT
        setzm   gdbat
        pushj   p,clrbat
        HRLZI   1,54000
        MOVEM   1,ALLT
        MOVEI   1,5000          ;USED IN INSBAT CALCULTATIONS
        MOVEM   1,BYTCNT
        MOVEI   1,1143          ;USED FOR SKIPPING OVER DATA, ECC, SPLICE, GP3
        MOVEM   1,DESGP3        ;STORE IN MEM LOCATION
        MOVEI   1,21+50
        MOVEM   1,SPLGP2
        MOVE    1,[SEC0ST,,SEC0ST+1]
        SETZM   SEC0ST
        BLT     1,SEC19ST       ;CLEAR SECTOR START INDICATORS
        MOVEI   1,FBUF          ;USED FOR WORD COUNT OF A SECTOR
        MOVEM   1,SEC0ST
        ADDI    1,1200
        MOVEM   1,SEC1ST
        ADDI    1,1200
        MOVEM   1,SEC2ST
        ADDI    1,1200
        MOVEM   1,SEC3ST
        ADDI    1,1200
        MOVEM   1,SEC4ST
        ADDI    1,1200
        MOVEM   1,SEC5ST
        ADDI    1,1200
        MOVEM   1,SEC6ST
        ADDI    1,1200
        MOVEM   1,SEC7ST
        ADDI    1,1200
        MOVEM   1,SEC8ST
        ADDI    1,1200
        MOVEM   1,SEC9ST
        ADDI    1,1200
        MOVEM   1,SEC10ST
        ADDI    1,1200
        MOVEM   1,FBEND
        MOVEI   1,0
        MOVEM   1,MINHED
        MOVEM   1,MINSEC
        MOVEM   1,MINCYL
        MOVEI   1,1511
        MOVEM   1,MAXCYL
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCCY
        MOVEI   1,23
        MOVEM   1,MAXHED
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCHD
        MOVEI   1,12
        MOVEM   1,MAXSEC
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCSC
        PUSHJ   P,INISET
        MOVEI   1,1507
        MOVEM   1,MINSAF
        MOVEI   1,1511
        MOVEM   1,MAXSAF
        MOVEI   1,0
        MOVEM   1,BAT1CY
        MOVEM   1,BAT2CY
        MOVEI   1,0
        MOVEM   1,BAT1HD
        MOVEI   1,4
        MOVEM   1,BAT1SC
        MOVEM   1,BAT2SC
        MOVEI   1,1
        MOVEM   1,BAT2HD
        POPJ    P,0


dm9300: ;THIS WILL CONFIGURE THE dm9300 removable drive.

        SETZM   CEHLD
        setzm   skdis
        SETZM   ONCE
        SETZM   GOTBAT
        setzm   gdbat
        pushj   p,clrbat
        HRLZI   1,40000
        MOVEM   1,ALLT
        MOVEI   1,4730          ;USED IN INSBAT CALCULATIONS
        MOVEM   1,BYTCNT
        MOVEI   1,1143          ;FOR SKIPPING OVER DATA, ECC, SPLICE AND GAP3
        MOVEM   1,DESGP3        ;STORE IN MEM LOCATION
        MOVEI   1,21
        MOVEM   1,SPLGP2
        MOVE    1,[SEC0ST,,SEC0ST+1]
        SETZM   SEC0ST
        BLT     1,SEC19ST       ;CLEAR SECTOR START INDICATORS
        MOVEI   1,FBUF          ;USED FOR WORD COUNT OF A SECTOR
        MOVEM   1,SEC0ST
        ADDI    1,1166
        MOVEM   1,SEC1ST
        ADDI    1,1166
        MOVEM   1,SEC2ST
        ADDI    1,1166
        MOVEM   1,SEC3ST
        ADDI    1,1166
        MOVEM   1,SEC4ST
        ADDI    1,1166
        MOVEM   1,SEC5ST
        ADDI    1,1166
        MOVEM   1,SEC6ST
        ADDI    1,1166
        MOVEM   1,SEC7ST
        ADDI    1,1166
        MOVEM   1,FBEND
        MOVEI   1,0
        MOVEM   1,MINHED
        MOVEM   1,MINSEC
        MOVEM   1,MINCYL
        MOVEI   1,1466
        MOVEM   1,MAXCYL
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCCY
        MOVEI   1,22
        MOVEM   1,MAXHED
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCHD
        MOVEI   1,7
        MOVEM   1,MAXSEC
        ADDI    1,1             ;USED FOR CALCULATIONS
        MOVEM   1,CALCSC
        PUSHJ   P,INISET
        MOVEI   1,1465
        MOVEM   1,MINSAF
        MOVEI   1,1466
        MOVEM   1,MAXSAF
        MOVEI   1,0
        MOVEM   1,BAT1CY
        MOVEM   1,BAT2CY
        MOVEI   1,0
        MOVEM   1,BAT1HD
        MOVEI   1,4
        MOVEM   1,BAT1SC
        MOVEM   1,BAT2SC
        MOVEI   1,1
        MOVEM   1,BAT2HD
        POPJ    P,0

HELPRT: ;THIS IS THE HELPRT ROUTINE. IT WILL TYPE OUT AT
        ;THE TTY THE CURRENT COMMANDS THAT ARE AVAILABLE.

        CARRET  CARRET
        PRINT   /The available commands are: /
        CARRET
        PRINT   /TEST0  - This test will cause TEST1 to TEST7 to be executed./
        CARRET
        PRINT   /TEST1  - This test will write and read fixed data 000000000000./
        CARRET
        PRINT   /TEST2  - This test will write and read fixed data 777777777777./
        CARRET
        PRINT   /TEST3  - This test will write and read fixed data 070707070707./
        CARRET
        PRINT   /TEST4  - This test will write and read fixed data 707070707070./
        CARRET
        PRINT   /TEST5  - This test will write and read fixed data 525252525252./
        CARRET
        PRINT   /TEST6  - This test will write and read fixed data 252525252525./
        CARRET
        PRINT   /TEST7  - This test will write and read random data./
        CARRET
        PRINT   /TEST8  - Disk * Random read using ran. or seq. cyl head and sector./
        CARRET  
        PRINT   /       - Tape * Use this to set up start stop time./
        CARRET
        PRINT   /EDDT   - This will go to the diagnostic debugger./
        CARRET
        PRINT   /XRAY   - This will print out test information./
        CARRET
        PRINT   /TAPE   - Specifies that you want to test the tape drive./
        CARRET
        PRINT   /DSK    - Specifies that you want to test a disk drive./
        CARRET
        PRINT   /MEM    - Specifies that you want to test memory only./
        CARRET
        PRINT   /FMT    - Formats the specified disk drive./
        CARRET
        PRINT   /STAT   - Breaks down last status word from specified device./
        CARRET
        PRINT   /^C     - To terminate a test after you have started one./
        CARRET
        PRINT   /^T     - To interrogate what is going on during testing./
        CARRET
        CARRET
        MOVEI   1,1
        PUSHJ   P,DOYOU                 ;SEE IF HE WANTS TO PRINT MORE
        SKIPE   NO
        JRST    .+2
        JRST    HELPEX
        CARRET
        CARRET
        PRINT   /GETBAT - This command will get the BATBLK off of the specified/
        CARRET
        PRINT   /         disk drive. It will be used to determined if the sector to/
        CARRET
        PRINT   /         be tested will be bypassed./
        CARRET
        PRINT   /PRIBAT - This command will print out at the terminal the current/
        CARRET
        PRINT   /         BATBLK information. The information is in octal format./
        CARRET
        PRINT   /ADDBAT - This command will add to the specified disk the current/
        CARRET
        PRINT   /         cyl head and sector to the BATBLK file./
        CARRET
        PRINT   /AUTON  - This command will do a ADDBAT automatically after a disk/
        CARRET
        PRINT   /         error has been encountered. It will first see if the BATBLK/
        CARRET
        PRINT   /         is installed or initialized. Then it will try to read the /
        CARRET
        PRINT   /         key that was installed after a fresh FMT was performed./
        CARRET
        PRINT   /AUTOFF - This command will turn off the auto ADDBAT./
        CARRET
        PRINT   /INSBAT - This command should be used to install the BATBLK/
        CARRET
        PRINT   /         information on the specified disk drive. This would be/
        CARRET
        PRINT   /         done after you have installed a new disk or the disk has/
        CARRET
        PRINT   /         just been formatted. Please pay close attention to prompts./
        CARRET
        PRINT   /PGRON  - Allows the program to scan all of memory./
        CARRET  
        PRINT   /PGROFF - Will not allow the program to scan all the memory./
        CARRET
        PRINT   /RMVPRO - This command will remove the software write protect./
        CARRET
        PRINT   /RMVHLD - This command will unfreeze tests that do any writing on disk./
        CARRET
        PRINT   /MERCNT - This command will allow program to continue after memory error./
        CARRET
        print   /MERHLT - Just the inverse of MERCNT./
        carret
        carret
        MOVEI   1,1
        PUSHJ   P,DOYOU                 ;SEE IF HE WANTS TO PRINT MORE
        SKIPE   NO
        JRST    .+2
        JRST    HELPEX
        carret
        carret
        print   /PAINT  - This will paint you a picture of the bad chip on one or all/
        carret
        print   /         of the failing boards. Try it - you'll like it./
        carret
        print   /MERRES - Clears all bad chips from painted picture./
        carret
        print   /CLKON  - Turns on the 60 hz. clock./
        carret
        print   /CLKOFF - Turns off the 60 hz. clock./
        movei   2,[asciz /
PAKCPY - Copies data from source disk to a destination disk.
         You must select the disk as a device first, then it
         is suggested that you do a GETBAT on the source drive.
         The BATBLK will not be copied, so the original BATBLK
         will remain intact. If a file gets written into a known
         bad spot, that file will be damaged./]
        pushj   p,strout
        movei   2,[asciz /
         If a sector reports an error, it will be retried to the 
         value set into RETRY, before typing the error out. You
         will then be asked if you want to try again. If the
         sector times out, no attempt to retry will be made auto-
         matically, but you will be given that choice, just re-
         spond to the message./]
        pushj   p,strout
        carret
HELPEX: JRST    DISPAT

DOYOU:  ;THIS IS THE DOYOU ROUTINE. IT WILL ASK IF YOU WANT TO
        ;PRINT MORE INFORMATION. IT WILL TURN OFF A FLAG IF YES.
        ;AC 1 WILL CONTAIN THE APPROPRIATE MESSAGE TO TYPE

        MOVEM   1,DOSAV
NOGOOD: MOVE    1,DOSAV
        CAIN    1,1
        JRST    [PRINT  /Would you like some more ( Y or N )? /
                 JRST   DORET]
        CAIN    1,0
        JRST    [PRINT  /Are you absolutely sure ( Y or N )? /
                 JRST   DORET]
        CAIN    1,2
        JRST    [PRINT  /Would you like to try and salvage the Bat Blocks ( Y or N )? /
                 JRST   DORET]
        CAIN    1,3
        JRST    [CARRET
                 CARRET
                 PRINT  /Would you like to alter Test 8 to scan drive/
                 CARRET
                 PRINT  /instead of random seek ( Y or N )? /
                 JRST   DORET]
        CAIN    1,4
        JRST    [PRINT  /Would you like to see another failing board ( Y or N )? /
                 jrst   doret]
        CAIN    1,5
        JRST    [PRINT  /Would you like to use the current diagnostic library ( Y or N )? /
                 jrst   doret]
        cain    1,6
        jrst    [print /Would you like to start at the beginning ( Y or N )? /
                 jrst doret]
        CAIN    1,7
        JRST    [CARRET
                 PRINT /Are you running on a Foonly F3 ( Y or N )? /
                 jrst doret]
        cain    1,10
        jrst    [movei  2,[asciz /
Test 8 has reached the end of the its limits.
Would you like to go again ( Y or N )? /]
                 PUSHJ  P,STROUT
                 jrst doret]
        CAIN    1,11
        JRST    [MOVEI  2,[ASCIZ /
The last TEST8 resulted in a disk error,
would you like to try the failing disk
address over again ( Y or N )? /]
                 pushj  p,strout
                 jrst doret]
        cain    1,12
        jrst    [movei  2,[asciz /
Do you wish to verify all data patterns ( Y or N )? /]
                 pushj p,strout
                 jrst doret]
        cain    1,13
        jrst    [movei  2,[asciz /
Can not copy the disk correctly after many retries, do
you wish to retry the failing sector again ( Y or N )? /]
                 pushj  p,strout
                 jrst   doret]
        cain    1,14
        jrst    [movei  2,[asciz /
Do you wish to retry the timed out sector again ( Y or N )? /]
                 pushj  p,strout
                 jrst   doret]
        CAIN    1,15
        JRST    [MOVEI  2,[ASCIZ /
Do you wish to use the secondary BATBLK ( Y or N )? /]
                 pushj  p,strout
                 jrst   doret]
        CAIN    1,16
        JRST    [MOVEI  2,[ASCIZ /
Are your memory boards of the 64K variety ( Y or N )? /]
                 pushj p,strout
                 jrst   doret]
        cain    1,17
        jrst    [movei  2,[asciz /
Are you running on the 26KL flavor CPU ( Y or N )? /]
                 pushj  p,strout
                 jrst   doret]
        PRINT   /Logical error from DOYOU - Please notify Dan Martin./
        CARRET
        JRST    DISPAT
DORET:  CONI    TTY,4           ;GET CONSOLE STATUS
        TRNE    4,40            ;BIT FOR CONSOLE WANTS STATUS
        JRST    .+2             ;PROCESS CHARACTER
        JRST    .-3             ;GET MORE STATUS
        DATAI   TTY,1           ;GET CHARACTER PENDING FROM CONSOLE
        ANDI    1,177           ;REMOVE PARITY BIT
        DATAO   TTY,1           ;ECHO THE CHARACTER
        CAIN    1,131           ; IF Y
        JRST    [SETOM  NO
                 CARRET
                 JRST   YOUEX]
        CAIN    1,171           ; IF y
        JRST    [SETOM  NO
                 CARRET
                 JRST   YOUEX]
        CAIN    1,116           ; IF N
        JRST    [SETZM  NO
                 CARRET
                 JRST   YOUEX]
        CAIN    1,156           ; IF n
        JRST    [SETZM  NO
                 CARRET
                 JRST   YOUEX]
        CARRET
        CARRET
        PRINT   /*** Please enter correct response ***/
        CARRET
        CARRET
        JRST    NOGOOD                  ;TRY AGAIN
YOUEX:  POPJ    P,0
DOSAV:  0       
NO:     0




WHATDR: ;THIS IS THE WHATDR ROUTINE. IT WILL ASK YOU FOR DRIVE TYPE.

NGOOD:  CARRET
        PRINT   /Please enter the drive address ( 0 - 7 ) ? /
        CONI    TTY,4           ;GET CONSOLE STATUS
        TRNE    4,40            ;BIT FOR CONSOLE WANTS STATUS
        JRST    .+2             ;PROCESS CHARACTER
        JRST    .-3             ;GET MORE STATUS
        DATAI   TTY,1           ;GET CHARACTER PENDING FROM CONSOLE
        ANDI    1,177           ;REMOVE PARITY BIT
        DATAO   TTY,1           ;ECHO THE CHARACTER
        MOVEI   2,0             ;CLEAR THE INDEX
MORADD: CAMN    1,CMPTAB(2)     ;SEE IF IN TABLE
        JRST    [MOVE   1,MOVTAB(2)
                 MOVEM  1,unit
                 CARRET
                 JRST   UNIREX]
        ADDI    2,1             ;ADD TO THE INDEX
        CAIE    2,10            ;LAST OF THE TABLES
        JRST    MORADD
        CARRET
        CARRET
        PRINT   /*** Please enter correct response ***/
        CARRET
        CARRET
        JRST    NGOOD
UNIREX: CARRET
        CARRET
        PRINT   /Please enter the drive type (1 - 4 or ?)  /
        CONI    TTY,4           ;GET CONSOLE STATUS
        TRNE    4,40            ;BIT FOR CONSOLE WANTS STATUS
        JRST    .+2             ;PROCESS CHARACTER
        JRST    .-3             ;GET MORE STATUS
        DATAI   TTY,1           ;GET CHARACTER PENDING FROM CONSOLE
        ANDI    1,177           ;REMOVE PARITY BIT
        DATAO   TTY,1           ;ECHO THE CHARACTER
        CAIN    1,61            ; IF 1
        JRST    [MOVEI  1,1
                 MOVEM  1,DRTYPE
                 CARRET
                 JRST   WHDREX]
        CAIN    1,62            ; IF 2
        JRST    [MOVEI  1,2
                 MOVEM  1,DRTYPE
                 CARRET
                 JRST   WHDREX]
        CAIN    1,63            ; IF 3
        JRST    [MOVEI  1,3
                 MOVEM  1,DRTYPE
                 CARRET
                 JRST   WHDREX]
        CAIN    1,64            ; IF 4
        JRST    [MOVEI  1,4
                 MOVEM  1,DRTYPE
                 CARRET
                 JRST   WHDREX]
        CAIN    1,77            ; IF ?
        jrst    [CARRET
                 carret
                 PRINT  /The current drive types are:/
                 CARRET
                 CARRET
                 PRINT  /      1 = CDC160 (BZ9A1A)/
                 CARRET
                 PRINT  /      2 = AMP330 (Capricorn)/
                 carret
                 print  /      3 = M2351A (Fujitsu Eagle)/
                 CARRET
                 print  /      4 = DM9300 (Ampex removable)/
                 carret
                 JRST   UNIREX]
        CARRET
        CARRET
        PRINT   /*** Please enter correct response ***/
        CARRET
        CARRET
        JRST    UNIREX                  ;TRY AGAIN
WHDREX: POPJ    P,0
MOVTAB: 0
        1
        2
        3
        4
        5
        6
        7
CMPTAB: 60
        61
        62
        63
        64
        65
        66
        67

WHATAD: ;THIS IS THE WHATAD ROUTINE. IT WILL ASK YOU FOR DRIVE ADD.
        ;IF SOURCE IS 0 THEN IT IS ASKING YOU FOR THE SOURCE ADD.
        ;IF SOURCE IS -1 THEN IT IS ASKING YOU FOR THE DEST. ADD.

NGOOD1: CARRET
        skipn   source
        jrst    [PRINT  /Please enter the src drive address ( 0 - 7 ) ? /
                 jrst   resp]
        jrst    [PRINT  /Please enter the dst drive address ( 0 - 7 ) ? /
                 jrst   resp]
resp:   CONI    TTY,4           ;GET CONSOLE STATUS
        TRNE    4,40            ;BIT FOR CONSOLE WANTS STATUS
        JRST    .+2             ;PROCESS CHARACTER
        JRST    .-3             ;GET MORE STATUS
        DATAI   TTY,1           ;GET CHARACTER PENDING FROM CONSOLE
        ANDI    1,177           ;REMOVE PARITY BIT
        DATAO   TTY,1           ;ECHO THE CHARACTER
        CAIN    1,60            ; IF 0
        JRST    [MOVEI  1,0
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,61            ; IF 1
        JRST    [MOVEI  1,1
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,62            ; IF 2
        JRST    [MOVEI  1,2
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,63            ; IF 3
        JRST    [MOVEI  1,3
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,64            ; IF 4
        JRST    [MOVEI  1,4
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,65            ; IF 5
        JRST    [MOVEI  1,5
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,66            ; IF 6
        JRST    [MOVEI  1,6
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CAIN    1,67            ; IF 7
        JRST    [MOVEI  1,7
                 skipn  source
                 jrst   [MOVEM  1,src
                         carret
                         jrst   whadex]
                 jrst   [movem  1,dst
                         carret
                         jrst   whadex]]
        CARRET
        CARRET
        PRINT   /*** Please enter correct response ***/
        CARRET
        CARRET
        JRST    NGOOD1                  ;TRY AGAIN
WHADEX: POPJ    P,0
SRC:    0
DST:    0
source: 0

        ;THIS IS UNIVERSAL DATA AREA TO BE
        ;USED BY EVERYBODY.

BATBLK: BLOCK   1000
SAVAREA: BLOCK  2000
UNIT:   0
CYL:    0
HEAD:   0
SECTOR: 0
MINCYL: 0
MINHED: 0
MINSEC: 0
CALCCY: 0                       ;USED FOR GETBAT AND TSTBAT CALCULATION
CALCHD: 0                       ;SAME
CALCSC: 0                       ;SAME
MAXCYL: 1777
MAXHED: 17
MAXSEC: 7
MINSAF: 0
MAXSAF: 0
BAT1CY: 0
BAT1HD: 0
BAT1SC: 0
BAT2CY: 0
BAT2HD: 0
BAT2SC: 0
BADCNT: 0
BADADR: BLOCK   2000
RADIX   ^D10
A2401:  19,,1
        2882,,0
        20,,1
        5150,,0
        29,,1
        13782,,0
        40,,15
        1228,,0
        49,,13
        11480,,0
        51,,13
        14026,,0
        55,,0
        13564,,0
        61,,13
        17894,,0
        87,,2
        10558,,0
        92,,2
        9052,,0
        93,,2
        9052,,0
        112,,2
        5038,,0
        113,,3
        9010,,0
        130,,4
        12944,,0
        136,,13
        1628,,0
        162,,7
        18426,,0
        170,,5
        62,,0
        172,,5
        62,,0
        177,,1
        6622,,0
        178,,1
        -1
        179,,1
        -1
        184,,13
        19774,,0
        197,,2
        18160,,0
        229,,3
        2938,,0
        239,,1
        7612,,0
        256,,6
        3996,,0
        259,,2
        13206,,0
        271,,4
        11274,,0
        305,,5
        1384,,0
        323,,2
        76,,0
        337,,12
        17714,,0
        338,,12
        17714,,0
        339,,12
        17712,,0
        341,,6
        15468,,0
        355,,12
        17582,,0
        356,,4
        1924,,0
        359,,15
        9938,,0
        361,,6
        10496,,0
        362,,4
        6780,,0
        367,,15
        16052,,0
        405,,15
        9808,,0
        423,,10
        12682,,0
        451,,7
        14980,,0
        452,,7
        14978,,0
        455,,0
        7508,,0
        475,,5
        19224,,0
        491,,15
        124,,0
        493,,13
        5022,,0
        496,,14
        4750,,0
        497,,1
        7008,,0
        500,,5
        12700,,0
        524,,15
        12770,,0
        526,,2
        14298,,0
        527,,2
        14296,,0
        529,,9
        11692,,0
        544,,8
        -1
        545,,15
        9346,,0
        552,,11
        14532,,0
        568,,8
        18778,,0
        598,,15
        8094,,0
        614,,14
        10332,,0
        622,,15
        16164,,0
        625,,11
        15966,,0
        637,,1
        8892,,0
        641,,15
        13540,,0
        644,,14
        16462,,0
        645,,11
        13360,,0
        670,,1
        9702,,0
        675,,4
        1440,,0
        679,,5
        7822,,0
        683,,9
        3396,,0
        684,,9
        3396,,0
        687,,0
        17420,,0
        693,,1
        5892,,0
        693,,14
        17308,,0
        701,,5
        13904,,0
        705,,11
        2662,,0
        707,,11
        19762,,0
        708,,11
        18058,,0
        715,,10
        2738,,0
        721,,11
        324,,0
        725,,7
        10152,,0
        727,,11
        14004,,0
        731,,14
        1112,,0
        738,,3
        7116,,0
        744,,11
        12272,,0
        748,,0
        5834,,0
        748,,15
        14824,,0
        755,,11
        956,,0
        773,,11
        6194,,0
        792,,3
        5174,,0
        798,,5
        8504,,0
        806,,11
        13596,,0
        821,,1
        2246,,0
        825,,5
        9634,,0
        826,,15
        5440,,0
        827,,11
        14816,,0
        842,,10
        14134,,0
        854,,11
        2138,,0
        861,,13
        15752,,0
        865,,1
        18572,,0
        866,5
        15000,,0
        869,5
        3954,,0
        877,,10
        19096,,0
        882,,5
        134,,0
        884,,13
        8216,,0
        891,,9
        1530,,0
        921,,11
        17892,,0
        925,,0
        224,,0
        928,,2
        13954,,0
        930,,10
        18248,,0
        931,,7
        4428,,0
        935,,9
        13294,,0
        936,,9
        13292,,0
        955,,5
        12362,,0
        961,,1
        7056,,0
        975,,15
        1966,,0
        986,,11
        15678,,0
        988,,1
        4028,,0
        998,,7
        -1
        998,,12
        2348,,0
        1008,,5
        9552,,0
        1010,,3
        15162,,0
        1010,,9
        13918,,0
        1013,,5
        14250,,0
        1014,,5
        14250,,0
        1015,,5
        -1
        1016,,5
        14250,,0
        1016,,11
        11308,,0
        1019,,11
        14002,,0
        1017,,15        ;THE FOLLOWING ARE ADDITIONS TO BAD SPOTS
        3
        806,,13
        1
RADIX   ^D8     
        707070,,707070  ;USE THIS AS A DELIMITER

RADIX   ^D10
A1012:  20,,10
        7144,,0
        35,,7
        16398,,0
        159,,1
        5020,,0
        218,,10
        9800,,0
        220,,10
        9800,,0
        221,,2
        19640,,0
        221,,10
        9800,,0
        287,,1
        2164,,0
        288,,3
        10022,,0
        289,,3
        -1
        290,,3
        10022,,0
        320,,13
        1958,,0
        408,,2
        15514,,0
        438,,6
        10122,,0
        439,,6
        -1
        440,,6
        -1
        441,,6
        10122,,0
        463,,8
        9582,,0
        485,,5
        18210,,0
        502,,12
        1884,,0
        503,,12
        1884,,0
        553,,13
        19594,,0
        658,,4
        7842,,0
        683,,3
        4284,,0
        734,,5
        4038,,0
        770,,0
        8426,,0
        788,,3
        6224,,0
        789,,3
        6224,,0
        811,,4
        9218,,0
        810,,15
        14044,,0
        829,,8
        5522,,0
        1000,,13
        18826,,0
        1008,,1
        8132,,0
        1011,,1
        15990,,0
RADIX   ^D8
        707070,,707070          ;USE THIS AS A DELIMITER

RADIX   ^D10
A2125:  46,,1
        -1
        47,,1
        -1
        48,,1
        -1
        48,,12
        20110,,0
        49,,1
        -1
        50,,1
        10206,,0
        68,,9
        1940,,0
        102,,4
        7390,,0
        122,,14
        7104,,0
        136,,8
        17946,,0
        160,,0
        17414,,0
        178,,14
        7110,,0
        189,,4
        8236,,0
        199,,14
        7220,,0
        214,,13
        11896,,0
        223,,4
        180,,0
        231,,15
        6832,,0
        258,,5
        13276,,0
        263,,10
        7560,,0
        283,,3
        4004,,0
        284,,3
        -1
        285,,3
        -1
        286,,3
        4002,,0
        287,,3
        4002,,0
        288,,3
        4002,,0
        290,,3
        4002,,0
        292,,3
        4004,,0
        293,,3
        -1
        295,,0
        11894,,0
        368,,1
        3940,,0
        378,,0
        7794,,0
        381,,0
        7620,,0
        423,,12
        8924,,0
        442,,6
        9282,,0
        449,,1
        2586,,0
        477,,5
        -1
        483,,12
        1896,,0
        528,,14
        6870,,0
        545,,14
        6930,,0
        546,,14
        13946,,0
        575,,14
        6868,,0
        609,,14
        6906,,0
        626,,14
        6934,,0
        668,,1
        -1
        669,,1
        11530,,0
        677,,12
        2644,,0
        689,,14
        6836,,0
        698,,14
        6984,,0
        711,,14
        7004,,0
        722,,14
        6836,,0
        723,,14
        7030,,0
        756,,14
        6908,,0
        829,,14
        6930,,0
        831,,9
        2126,,0
        856,,11
        16598,,0
        857,,14
        6926,,0
        860,,14
        6898,,0
        867,,7
        8328,,0
        868,,7
        8328,,0
        911,,14
        6968,,0
        974,,15
        6812,,0
        993,,13
        2352,,0
        994,,13
        -1
        995,,13
        -1
        996,,13
        -1
        997,,13
        -1
        1012,,12
        17916,,0
RADIX   ^D8                     ;PUT ADDITIONS HERE
        707070,,707070          ;USE THIS AS A DELIMITER

RADIX   ^D10
A1328:  56,,15
        9394
        85,,15
        8504
        126,,10
        16154,,0
        211,,13
        8292
        211,,15
        784,,0
        212,,13
        8292,,0
        235,,1
        12176,,0
        282,,4
        6484,,0
        313,,4
        11026,,0
        372,,10
        16492,,0
        375,,1
        2966,,0
        484,,10
        16472,,0
        525,,5
        5306,,0
        526,,5
        5300,,0
        540,,15
        12106,,0
        587,,13
        18760,,0
        588,,13
        18760,,0
        609,,11
        10990,,0
        610,,11
        10990,,0
        629,,4
        15982,,0
        630,,4
        15982,,0
        736,,15
        2278,,0
        757,,15
        11936,,0
        764,,12
        4666,,0
        771,,7
        11538,,0
        792,,9
        10416,,0
        811,,15
        17898,,0
        833,,0
        13540,,0
        836,,8
        8506,,0
        843,,14
        9766,,0
        844,,14
        9766,,0
        871,,5
        15530,,0
        904,,13
        10384,,0
        905,,13
        10384,,0
        907,,13
        10384,,0
        900,,13
        10384,,0
        909,,13
        10384,,0
        911,,13
        10382,,0
        912,,13
        10382,,0
        914,,12
        10822,,0
        928,,13
        10380,,0
        946,,15
        9408,,0
        952,,13
        10378,,0
        959,,13
        10378,,0
        960,,12
        9768,,0
        963,,9
        9018,,0
        966,,13
        10378,,0
        987,,9
        10230,,0
        995,,13
        10382,,0
        1015,,9
        11930,,0
;       1023,,15
;       13216,,0
        429,,5                  ;THESE ARE ADDITIONS
        0
        901,,9
        3
        908,,13
        4
        210,,15
        0
        211,,13
        3
        350,,15
        6
RADIX   ^D8
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A2738:  0,,15
        2790,,0
        62,,1
        528,,0
        120,,13
        19748,,0
        123,,7
        4588,,0
        169,,4
        18362,,0
        177,,13
        5790,,0
        191,,14
        13086,,0
        215,,13
        -1
        225,,13
        18892,,0
        226,,13
        18892,,0
        227,,13
        18892,,0
        229,,13
        18894,,0
        246,,15
        16394,,0
        254,,8
        7240,,0
        277,,5
        10800,,0
        362,,0
        9442,,0
        372,,0
        7050,,0
        301,,5
        19408,,0
        407,,13
        -1
        408,,13
        -1
        414,,3
        17800,,0
        443,,15
        9370,,0
        471,,13
        8822,,0
        473,,12
        19324,,0
        533,,6
        9944,,0
        561,,4
        4546,,0
        562,,4
        4544,,0
        569,,9
        15814,,0
        571,,5
        17486,,0
        572,,5
        17484,,0
        610,,12
        5994,,0
        633,,9
        15194,,0
        648,,11
        1368,,0
        649,,11
        -1
        680,,10
        3176,,0
        703,,3
        8640,,0
        724,,2
        11454,,0
        726,,7
        17374,,0
        751,,2
        11422,,0
        845,,1
        16774,,0
        854,,13
        3048,,0
        877,,4
        -1
        889,,13
        16220,,0
        894,,1
        140,,0
        895,,1
        140,,0
        916,,0
        1526,,0
        918,,5
        -1
        919,,5
        1550,,0
        952,,15
        1720,,0
        953,,15
        1720,,0
        958,,13
        12450,,0
        994,,4
        14902,,0
RADIX   ^D8             ;THE FOLLOWING ARE ADDITIONS TO BAD SPOTS
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A2403:  49,,8
        13496,,0
        50,,8
        -1
        51,,8
        13496,,0
        96,,2
        16952,,0
        101,,1
        7232,,0
        134,,4
        14294,,0
        135,,4
        -1
        136,,12
        3484,,0
        137,,12
        -1
        138,,12
        -1
        139,,12
        -1
        140,,12
        3484,,0
        153,,1
        14672,,0
        156,,13
        6762,,0
        165,,11
        4306,,0
        220,,13
        6682,,0
        284,,12
        10246,,0
        353,,13
        20074,,0
        359,,4
        19030,,0
        386,,3
        17084,,0
        424,,1
        4008,,0
        578,,7
        7856,,0
        604,,13
        9284,,0
        703,,5
        14584,,0
        704,,5
        14584,,0
        726,,1
        -1
        727,,1
        -1
        728,,1
        -1
        758,,1
        6836,,0
        812,,9
        -1
        923,,2
        -1
        924,,2
        -1
        925,,2
        -1
        926,,2
        -1
        950,,8
        18620,,0
        959,,13
        14766,,0
        951,,8                  ;THE FOLLOWING ARE FOR ADDITIONS
        7
        489,,5
        1
        574,,9
        0                       
RADIX   ^D8                     
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A1707:  54,,8
        14540,,0
        56,,8
        1060,,0
        90,,1
        14296,,0
        129,,2
        9784,,0
        155,,10
        4924,,0
        156,,10
        4924,,0
        157,,10
        4924,,0
        197,,10
        -1
        198,,10
        18180,,0
        199,,10
        -1
        200,,10
        -1
        201,,10
        18182,,0
        207,,1
        14304,,0
        224,,6
        19338,,0
        288,,0
        8496,,0
        343,,8
        19048,,0
        349,,4
        -1
        350,,4
        -1
        351,,0
        13312,,0
        351,,4
        -1
        352,,4
        -1
        363,,12
        6480,,0
        455,,13
        10090,,0
        474,,0
        14158,,0
        482,,11
        14710,,0
        536,,1
        14310,,0
        564,,12
        746,,0
        584,,10
        7380,,0
        587,,3
        5868,,0
        696,,13
        13722,,0
        712,,13
        19288,,0
        813,,8
        7528,,0
        814,,9
        7138,,0
        818,,1
        9704,,0
        835,,1
        12032,,0
        844,,13
        19924,,0
        968,,8
        9384,,0
        1004,,11
        8320,,0                 ;the following are for additions
        822,,4
        3
        799,,14
        3
        602,,13
        0
        794,,10
        3
        802,,4
        3
        983,,13
        6
        245,,13
        0
RADIX   ^D8                     ;THE FOLLOWING ARE FOR ADDITIONS
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A502:   6,,6
        14080,,0
        17,,12
        8200,,0
        20,,5
        11044,,0
        23,,4
        3820,,0
        24,,5
        15516,,0
        28,,11
        18718,,0
        33,,13
        12002,,0
        40,,11
        18718,,0
        48,,1
        14518,,0
        51,,1
        13556,,0
        64,,8
        14304,,0
        73,,13
        62,,0
        76,,11
        62,,0
        83,,9
        5256,,0
        95,,0
        10190,,0
        102,,10
        8488,,0
        105,,10
        8478,,0
        113,,7
        5056,,0
        116,,1
        4250,,0
        124,,2
        10292,,0
        130,,13
        6864,,0
        133,,8
        7976,,0
        134,,14
        7940,,0
        146,,4
        2270,,0
        147,,3
        10318,,0
        148,,0
        62,,0
        148,,13
        17212,,0
        149,,6
        16884,,0
        192,,2
        6346,,0
        195,,9
        13906,,0
        197,,9
        1638,,0
        211,,4
        3746,,0
        212,,4
        6448,,0
        226,,14
        17360,,0
        230,,0
        13582,,0
        261,,7
        450,,0
        262,,2
        7784,,0
        262,,9
        -1
        265,,7
        13968,,0
        271,,12
        19836,,0
        273,,1
        16938,,0
        282,,6
        3606,,0
        294,,11
        882,,0
        313,,12
        10546,,0
        317,,11
        18876,,0
        322,,6
        7902,,0
        326,,11
        18864,,0
        332,,0
        5232,,0
        332,,1
        -1
        338,,2
        13580,,0
        338,,7
        4390,,0
        341,,11
        18886,,0
        346,,2
        14506,,0
        348,,10
        18608,,0
        358,,12
        20088,,0
        366,,3
        4238,,0
        370,,0
        17526,,0
        370,,4
        8264,,0
        370,,13
        5554,,0
        371,,4
        8264,,0
        372,,4
        8266,,0
        376,,11
        9818,,0
        377,,1
        17684,,0
        382,,12
        19816,,0
        383,,9
        190,,0
        387,,5
        14690,,0
        387,,10
        10622,,0
        392,,7
        4262,,0
        396,,1
        3856,,0
        401,,12
        11314,,0
        407,,11
        18930,,0
        422,,4
        9276,,0
        433,,8
        5944,,0
        445,,7
        14650,,0
        450,,12
        10144,,0
        451,,12
        10144,,0
        458,,13
        2886,,0
        462,,11
        18956,,0
        470,,12
        10240,,0
        472,,7
        16646,,0
        474,,14
        10890,,0
        477,,1
        10938,,0
        489,,3
        4584,,0
        491,,14
        11786,,0
        496,,2
        62,,0
        514,,13
        3036,,0
        515,,11
        18980,,0
        515,,13
        -1
        516,,13
        -1
        527,,6
        4288,,0
        549,,11
        19012,,0
        552,,7
        11894,,0
        559,,8
        13948,,0
        561,,15
        5298,,0
        582,,0
        1724,,0
        587,,11
        524,,0
        592,,7
        4758,,0
        606,,11
        3324,,0
        615,,11
        19056,,0
        629,,6
        6488,,0
        631,,13
        2876,,0
        635,,11
        8806,,0
        649,,7
        10840,,0
        651,,9
        -1
        655,,9
        17888,,0
        671,,11
        19092,,0
        678,,6
        16160,,0
        693,,11
        19124,,0
        695,,9
        2216,,0
        696,,9
        2216,,0
        697,,12
        14746,,0
        701,,15
        5396,,0
        702,,7
        1014,,0
        714,,11
        19124,,0
        717,,1
        13232,,0
        724,,5
        -1
        750,,14
        19584,,0
        755,,11
        19166,,0
        756,,1
        4598,,0
        757,,0
        19734,,0
        773,,9
        13438,,0
        791,,0
        17032,,0
        808,,5
        1410,,0
        809,,5
        11174,,0
        819,,13
        9542,,0
        833,,5
        16096,,0
        845,,3
        4986,,0
        851,,7
        19946,,0
        854,,10
        2558,,0
        855,,6
        17288,,0
        855,,10
        18488,,0
        896,,7
        2986,,0
        901,,11
        13852,,0
        908,,8
        10476,,0
        914,,2
        12546,,0
        916,,6
        2264,,0
        922,,3
        18622,,0
        930,,3
        9548,,0
        933,,1
        14360,,0
        954,,9
        5710,,0
        955,,9
        5708,,0
        956,,9
        5710,,0
        967,,13
        17522,,0
        970,,1
        5284,,0
        975,,15
        12840,,0
        980,,9
        8116,,0
        985,,1
        4876,,0
        985,,13
        7506,,0
        987,,13
        13576,,0
        989,,1
        20078,,0
        997,,14
        6152,,0
        999,,5
        3530,,0
        1003,,0
        16752,,0
        1006,,9
        6918,,0
        1009,,5
        8424,,0
        1020,,1
        10666,,0                ;THE FOLLOWING ARE FOR ADDTIONS
        102,,0
        6
        102,,0
        6
        103,,0
        6
RADIX   ^D8
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A11703: 91,,9
        1528,,0
        92,,9
        1528,,0
        135,,5
        19214,,0
        153,,13
        6356,,0
        186,,13
        12118,,0
        201,,13
        16578,,0
        222,,2
        4364,,0
        236,,14
        7268,,0
        303,,13
        10748,,0
        316,,4
        10772,,0
        446,,15
        4492,,0
        493,,5
        538,,0
        493,,15
        19436,,0
        494,,5
        538,,0
        495,,7
        6484,,0
        567,,12
        12428,,0
        568,,12
        12428,,0
        582,,9
        16192,,0
        695,,7
        9670,,0
        696,,13
        14758,,0
        762,,11
        11762,,0
        773,,1
        14404,,0
        822,,12
        15882,,0
        834,,11
        12148,,0
        870,,0
        12174,,0
        873,,9
        3410,,0
        959,,5
        -1
        960,,5
        -1
        984,,9
        -1
        986,,9
        -1
        1010,,15
        8248,,0
        985,,9
        -1
        462,,6                  ;THESE ARE THE ADDITIONS
        7               
        471,,13
        4
        208,,10
        6
        509,,4
        3
RADIX   ^D8             
        707070,,707070          ;USED AS A DELIMITER

RADIX   ^D10
A1211:  24,,3
        15600,,0
        26,,6
        11716,,0
        48,,9
        4544,,0
        66,,9
        6442,,0
        94,,9
        11792,,0
        98,,9
        11792,,0
        99,,9
        11792,,0
        100,,9
        11792,,0
        101,,9
        11792,,0
        102,,9
        -1
        103,,9
        -1
        104,,9
        11790,,0
        105,,9
        11794,,0
        106,,9
        -1
        129,,7
        1050,,0
        131,,0
        15852,,0
        131,,6
        8134,,0
        153,,14
        9622,,0
        188,,8
        5764,,0
        223,,3
        15800,,0
        256,,0
        1198,,0
        258,,7
        -1
        259,,7
        -1
        260,,7
        -1
        265,,11
        12246,,0
        279,,4
        4624,,0
        301,,10
        7980,,0
        309,,7
        1926,,0
        329,,5
        10182,,0
        330,,5
        1966,,0
        349,,6
        11184,,0
        374,,6
        15952,,0
        376,,4
        19006,,0
        401,,5
        6192,,0
        441,,4
        3110,,0
        462,,5
        3952,,0
        489,,7
        6664,,0
        546,,10
        7734,,0
        553,,1
        16994,,0
        562,,3
        10988,,0
        571,,8
        904,,0
        608,,5
        13092,,0
        609,,5
        13092,,0
        642,,2
        18678,,0
        646,,8
        19380,,0
        671,,5
        3952,,0
        675,,8
        6502,,0
        726,,4
        4664,,0
        765,,3
        18470,,0
        773,,7
        11870,,0
        782,,5
        4236,,0
        808,,9
        10328,,0
        826,,11
        19220
        857,,1
        16338,,0
        877,,1
        16324,,0
        885,,5
        13704,,0
        890,,15
        780,,0
        893,,8
        15514,,0
        896,,15
        780,,0
        907,,11
        7560,,0
        933,,1
        18200,,0
        945,,13
        15666,,0
        954,,5
        12072,,0
        971,,4
        17670,,0
        1020,,2
        17014,,0
        1020,,6
        1406,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
A3017:  0,,2
        8878,,0
        9,2
        784,,0
        40,,1
        13648,,0
        40,,5
        1410,,0
        43,,12
        -1
        44,,12
        2956,,0
        46,,3
        9768,,0
        55,,0
        19456,,0
        56,,8
        2148,,0
        60,,1
        11580,,0
        70,,14
        14,,0
        84,,9
        11256,,0
        88,,14
        14,,0
        103,,1
        -1
        161,,1
        2778,,0
        184,,3
        -1
        185,,3
        -1
        186,,3
        -1
        196,,3
        19866,,0
        198,,2
        16972,,0
        202,,11
        2894,,0
        204,,11
        2894,,0
        220,,10
        5472,,0
        221,,10
        5472,,0
        240,,3
        10846,,0
        241,,3
        -1
        246,,3
        15634,,0
        253,,1
        9470,,0
        274,,3
        16870,,0
        297,,10
        15740,,0
        300,,3
        -1
        301,,3
        -1
        307,,9
        476,,0
        379,,4
        8890,,0
        386,,8
        19004,,0
        390,,10
        3638,,0
        391,,10
        3638,,0
        413,,3
        10294,,0
        414,,3
        -1
        415,,3
        -1
        427,,4
        9098,,0
        436,,12
        60,,0
        491,,4
        11946,,0
        505,,7
        1166,,0
        509,,10
        1888,,0
        510,,10
        1888,,0
        527,,11
        7358,,0
        550,,4
        508,,0
        563,,10
        8358,,0
        564,,3
        17706,,0
        586,,10
        744,,0
        604,,11
        15694,,0
        612,,11
        10490,,0
        619,,9
        11586,,0
        636,,6
        1010,,0
        639,,7
        19578,,0
        640,,7
        19578,,0
        641,,7
        19578,,0
        675,,5
        3128,,0
        714,,4
        5498,,0
        821,,2
        8278,,0
        822,,0
        14046,,0
        823,,1
        15760,,0
        827,,10
        5676,,0
        828,,9
        14480,,0
        915,,12
        13936,,0
        916,,12
        13936,,0
        940,,4
        13464,,0
        941,,4
        13464,,0
        974,,13
        17264,,0
        1006,,9
        12382,,0
        802,,9                          ;THESE ARE ADDITIONS
        5
        803,,14
        6
RADIX   ^D8                             
        707070,,707070                  ;USED AS DELIMITER

radix   ^D10
C7490:  47,,1
        10306,,0
        53,,8
        3862,,0
        64,,1
        8938,,0
        84,,1
        11324,,0
        93,,9
        7762,,0
        102,,1
        12056,,0
        115,,0
        10602,,0
        199,,7
        1488,,0
        209,,6
        11675,,0
        213,,8
        14950,,0
        251,,1
        11940,,0
        283,,6
        9468,,0
        290,,7
        -1
        376,,2
        11330,,0
        447,,2
        94,,0
        531,,0
        6178,,0
        531,,4
        7501,,0
        600,,9
        4519,,0
        603,,4
        11207,,0
        614,,9
        2649,,0
        631,,9
        5298,,0
        635,,9
        12480,,0
        641,,9
        18407,,0
        645,,0
        9935,,0
        646,,9
        163,,0
        665,,9
        4699,,0
        665,,9
        -1
        672,,0
        -1
        673,,0
        -1
        674,,0
        -1
        675,,0
        -1
        676,,0
        -1
        681,,9
        19798,,0
        682,,6
        2479,,0
        720,,9
        15448,,0
        729,,9
        16562,,0
        740,,6
        3601,,0
        741,,6
        3602,,0
        742,,6
        -1
        743,,6
        3603,,0
        747,,9
        763,,0
        763,,3
        6903,,0
        764,,9
        87,,0
        768,,2
        48,,0
        771,,9
        2114,,0
        815,,0
        -1
        815,,2
        4411,,0
        816,,0
        -1
        816,,2
        4411,,0
        817,,0
        -1
        817,,2
        4412,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED FOR DELIMITER

RADIX   ^D10
C19556: 4,,5
        17,,0
        12,,9
        6606,,0
        18,,7
        4826,,0
        19,,7
        4826,,0
        20,,7
        4828,,0
        22,,7
        4825,,0
        23,,7
        4828,,0
        31,,7
        4871,,0
        32,,7
        4872,,0
        33,,7
        4906,,0
        36,,1
        2231,,0
        216,,8
        4704,,0
        332,,7
        1341,,0
        544,,7
        19263,,0
        559,,4
        13364,,0
        650,,0
        15919,,0
        659,,0
        1916,,0
        737,,0
        13969,,0
        747,,8
        12257,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED FOR DELIMITER

RADIX   ^D10
C1889:  25,,3
        13369,,0
        44,,5
        13321,,0
        223,,2
        19578,,0
        238,,9
        6660,,0
        239,,9
        6660,,0
        273,,2
        19445,,0
        280,,0
        13552,,0
        335,,4
        4434,,0
        340,,3
        -1
        413,,0
        14061,,0
        442,,1
        4068,,0
        519,,2
        17297,,0
        532,,0
        13637,,0
        533,,0
        13391,,0
        543,,0
        10643,,0
        596,,2
        16363,,0
        632,,2
        18058,,0
        688,,5
        15755,,0
        720,,0
        18192,,0
        757,,4
        710,,0
        758,,4
        711,,0
        788,,0
        8308,,0
        810,,6
        3533,,0
        811,,4
        18329,,0
        816,,1
        11773,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED FOR DELIMITER

RADIX   ^D10
C7507:  1,,0
        15733,,0
        2,,1
        5884,,0
        3,,1
        5885,,0
        4,,1
        -1
        5,,1
        5886,,0
        6,,1
        5886,,0
        119,,9
        9731,,0
        235,,2
        14433,,0
        238,,2
        14291,,0
        247,,9
        4053,,0
        283,,4
        3687,,0
        391,,9
        9370,,0
        449,,0
        7967,,0
        453,,1
        -1
        550,,1
        12217,,0
        555,,1
        12218,,0
        605,,7
        16640,,0
        665,,0
        19664,,0
        681,,0
        5811,,0
        741,,0
        4066,,0
        752,,0
        10481,,0
        752,,8
        -1
        758,,8
        11977,,0
        795,,6
        8799,,0
        796,,6
        8800,,0
        804,,8
        11940,,0
        805,,8  
        11940,,0
        818,,0
        -1
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED FOR DELIMITER

RADIX   ^D10
A2608:  0,,7
        15262,,0
        3,,1
        5188,,0
        3,,6
        17064,,0
        4,,1
        5188,,0
        22,,10
        9242,,0
        31,,13
        13644,,0
        35,,13
        13246,,0
        65,,5
        18138,,0
        87,,3
        12630,,0
        90,,9
        12412,,0
        97,,8
        864,,0
        100,,5
        18160,,0
        115,,10
        8826,,0
        116,,4
        8838,,0
        131,,14
        14560,,0
        142,,14
        12500,,0
        145,,13
        2578,,0
        184,,13
        12752,,0
        199,,4
        344,,0
        221,,3
        3776,,0
        237,,15
        19496,,0
        261,,11
        16292,,0
        263,,13
        16308,,0
        264,,13
        16308,,0
        265,,13
        16308,,0
        268,,13
        16308,,0
        269,,13
        16308,,0
        270,,13
        16308,,0
        271,,13
        16308,,0
        272,,13
        16308,,0
        273,,13
        16308,,0
        275,,13
        8492,,0
        279,,14
        16662,,0
        280,,14
        16662,,0
        287,,12
        15058,,0
        294,,15
        1820,,0
        304,,12
        1326,,0
        315,,6
        12806,,0
        318,,13
        16772,,0
        331,,3
        18402,,0
        334,,8
        5034,,0
        335,,8
        5034,,0
        336,,8
        5034,,0
        365,,5
        16902,,0
        379,,7
        14692,,0
        385,,4
        12680,,0
        404,,11
        13404,,0
        418,,1
        11766,,0
        447,,3
        1098,,0
        451,,14
        12592,,0
        460,,11
        18288,,0
        464,,6
        14062,,0
        473,,12
        3668,,0
        474,,12
        3668,,0
        475,,5
        2696,,0
        508,,5
        -1
        509,,5
        -1
        510,,5
        11952,,0
        550,,14
        288,,0
        564,,9
        11950,,0
        567,,15
        15872,,0
        568,,15
        15850,,0
        569,,15
        15872,,0
        582,,9
        10642,,0
        587,,3
        12648,,0
        621,,13
        19304,,0
        631,,3
        1978,,0
        633,,4
        2100,,0
        643,,9
        2800,,0
        644,,9
        2800,,0
        645,,12
        14848,,0
        694,,14
        6104,,0
        709,,7
        10646,,0
        713,,10
        830,,0
        714,,3
        15788,,0
        728,,4
        18526,,0
        729,,12
        2030,,0
        743,,7
        15818,,0
        749,,7
        -1
        754,,9
        10954,,0
        755,,9
        10954,,0
        758,,7
        17726,,0
        767,,7
        14712,,0
        768,,7
        14790,,0
        769,,7
        -1
        798,,7
        17916,,0
        799,,3
        1708,,0
        811,,13
        11330,,0
        844,,7
        5802,,0
        852,,14
        16164,,0
        865,,7
        4636,,0
        866,,7
        17100,,0
        878,,1
        18034,,0
        885,,1
        5430,,0
        886,,1
        5430,,0
        886,,4
        18906,,0
        886,,7
        19574,,0
        887,,1
        5430,,0
        896,,1
        6320,,0
        901,,7
        3360,,0
        915,,13
        7606,,0
        926,,7
        13116,,0
        940,,15
        8656,,0
        946,,13
        2930,,0
        965,,7
        2190,,0
        978,,12
        6156,,0
        988,,7
        2454,,0
        1004,,3
        2116,,0
        1004,,13
        12728,,0
        1020,,4
        16084,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        1712,,11
        0
        1720,,7
        1
        1730,,7
        1
        1121,,17
        1
        733,,5
        5
        1017,,1
        5
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
A2404:  2,,2
        16852,,0
        29,,6
        19496,,0
        32,,1
        19496,,0
        33,,1
        9756,,0
        45,,13
        11622,,0
        46,,13
        12676,,0
        54,,2
        19496,,0
        57,,5
        4574,,0
        69,,7
        17704,,0
        77,,1
        18948,,0
        77,,3
        9622,,0
        80,,15
        19496,,0
        81,,1
        19496,,0
        90,,1
        14402,,0
        94,,4
        12276,,0
        95,,4
        12276,,0
        96,,1
        10382,,0
        103,,5
        6606,,0
        110,,2
        19496,,0
        114,,5
        1906,,0
        117,,8
        11630,,0
        118,,8
        -1
        119,,8
        -1
        120,,8
        11628,,0
        124,,12
        8340,,0
        133,,15
        19496,,0
        149,,1
        5048,,0
        157,,13
        13736,,0
        166,,3
        468,,0
        168,,1
        5192,,0
        169,,1
        -1
        170,,1
        -1
        171,,1
        5194,,0
        183,,6
        5538,,0
        187,,3
        13078,,0
        189,,0
        19496,,0
        200,,1
        19496,,0
        201,,3
        4808,,0
        204,,5
        19496,,0
        213,,14
        19496,,0
        225,,1
        19496,,0
        231,,12
        7312,,0
        241,,2
        18448,,0
        246,,13
        5094,,0
        269,,4
        19496,,0
        276,,12
        19496,,0
        284,,0
        11714,,0
        288,,15
        20040,,0
        292,,14
        19496,,0
        297,,1
        3352,,0
        307,,2
        19496,,0
        307,,9
        15694,,0
        308,,8
        19496,,0
        308,,9
        15694,,0
        310,,12
        19496,,0
        316,,14
        2608,,0
        319,,4
        12922,,0
        325,,2
        19496,,0
        327,,2
        19496,,0
        330,,13
        1948,,0
        332,,8
        19496,,0
        334,,8
        8250,,0
        336,,12
        19496,,0
        342,,4
        13704,,0
        347,,1
        9154,,0
        348,,2
        19496,,0
        364,,4
        18046,,0
        368,,3
        19496,,0
        371,,5
        6824,,0
        373,,1
        6700,,0
        373,,8
        19496,,0
        389,,5
        18304,,0
        406,,8
        5158,,0
        415,,0
        6162,,0
        426,,11
        3416,,0
        431,,1
        1708,,0
        435,,3
        19496,,0
        448,,1
        10756,,0
        449,,1
        10756,,0
        450,,2
        19496,,0
        450,,8
        19496,,0
        452,,13
        13528,,0
        460,,13
        18496,,0
        463,,12
        19496,,0
        466,,5
        7510,,0
        469,,12
        15016,,0
        499,,5
        7286,,0
        499,,11
        15670,,0
        504,,1
        10156,,0
        506,,2
        19496,,0
        512,,3
        8616,,0
        534,,1
        19496,,0
        541,,1
        -1
        542,,2
        19496,,0
        550,,14
        5612,,0
        566,,11
        10500,,0
        569,,4
        14674,,0
        573,,7
        3298,,0
        576,,1
        9376,,0
        581,,1
        1900,,0
        591,,9
        12668,,0
        596,,3
        20048,,0
        604,,1
        11250,,0
        604,,4
        19496,,0
        610,,9
        2784,,0
        615,,1
        16916,,0
        622,,2
        9570,,0
        622,,4
        19496,,0
        638,,8
        14988,,0
        657,,5
        1922,,0
        662,,15
        11932,,0
        668,,3
        11742,,0
        676,,14
        19060,,0
        690,,13
        19018,,0
        691,,13
        19018,,0
        695,,3
        230,,0
        698,,3
        7302,,0
        699,,3
        7302,,0
        708,,5
        2070,,0
        721,,1
        18822,,0
        722,,8
        13712,,0
        723,,11
        5056,,0
        724,,11
        5056,,0
        725,,3
        19496,,0
        731,,8
        19496,,0
        739,,14
        17672,,0
        740,,15
        5330,,0
        741,,13
        6546,,0
        742,,12
        19376,,0
        743,,15
        15520,,0
        746,,5
        598,,0
        759,,13
        94,,0
        762,,0
        1718,,0
        766,,9
        12814,,0
        775,,0
        8234,,0
        781,,13
        19452,,0
        785,,9
        1794,,0
        790,,2
        19496,,0
        794,,8
        14784,,0
        795,,15
        18522,,0
        800,,9
        1594,,0
        801,,15
        10598,,0
        803,,3
        17306,,0
        808,,5
        15508,,0
        809,,6
        4028,,0
        812,,8
        12262,,0
        816,,8
        12520,,0
        817,,2
        19496,,0
        818,,9
        18238,,0
        818,,11
        14548,,0
        833,,1
        13848,,0
        842,,6
        14848,,0
        843,,5
        2338,,0
        844,,9
        5296,,0
        844,,13
        2766,,0
        846,,15
        9896,,0
        851,,12
        11730,,0
        852,,11
        182,,0
        856,,7
        11678,,0
        856,,15
        2596,,0
        860,,1
        6674,,0
        867,,6
        9344,,0
        892,,3
        19496,,0
        894,,1
        15388,,0
        897,,4
        19704,,0
        901,,7
        760,,0
        902,,15
        5860,,0
        904,,1
        15570,,0
        907,,10
        4604,,0
        909,,1
        348,,0
        912,,12
        18592,,0
        915,,6
        11008,,0
        919,,4
        1456,,0
        933,,12
        15626,,0
        934,,11
        15260,,0
        941,,8
        14726,,0
        943,,1
        17634,,0
        948,,12
        17846,,0
        952,,10
        19360,,0
        960,,9
        18062,,0
        961,,2
        9038,,0
        964,,12
        18748,,0
        970,,4
        12832,,0
        973,,2
        12250,,0
        974,,5
        16468,,0
        976,,5
        18358,,0
        985,,9
        16858,,0
        994,,3
        7546,,0
        999,,13
        7592,,0
        1014,,9
        3446,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
A319:   1,,8
        18384,,0
        3,,0
        -1
        3,,12
        16870,,0
        4,,12
        16870,,0
        5,,12
        2304,,0
        8,,14
        10124,,0
        17,,2
        2714,,0
        51,,12
        5624,,0
        60,,3
        1140,,0
        69,,12
        19496,,0
        114,,6
        15306,,0
        127,,3
        19496,,0
        133,,0
        17066,,0
        135,,8
        18456,,0
        153,,6
        5696,,0
        159,,5
        4794,,0
        171,,7
        15084,,0
        172,,7
        -1
        173,,7
        15086,,0
        188,,12
        17704,,0
        204,,2
        17638,,0
        216,,14
        19496,,0
        218,,1
        1320,,0
        228,,6
        14050,,0
        280,,8
        13918,,0
        298,,12
        19496,,0
        303,,2
        19496,,0
        308,,4
        750,,0
        309,,4
        750,,0
        334,,7
        19496,,0
        382,,14
        19496,,0
        392,,11
        19496,,0
        418,,1
        19496,,0
        419,,13
        1892,,0
        423,,13
        14346,,0
        424,,13
        14346,,0
        466,,9
        448,,0
        476,,14
        19496,,0
        499,,5
        3250,,0
        518,,1
        16384,,0
        576,,6
        15636,,0
        584,,3
        6570,,0
        588,,12
        19496,,0
        607,,2
        2570,,0
        607,,11
        14474,,0
        610,,5
        19500,,0
        653,,8
        10508,,0
        692,,2
        19496,,0
        698,,5
        484,,0
        698,,9
        8940,,0
        718,,3
        -1
        719,,3
        -1
        720,,3
        -1
        721,,3
        -1
        749,,1
        -1
        768,,14
        19496,,0
        802,,13
        12698,,0
        813,,1
        3934,,0
        841,,1
        3304,,0
        842,,1
        3304,,0
        843,,1
        3304,,0
        844,,1
        3302,,0
        845,,1
        -1
        846,,1
        3302,,0
        847,,1
        3302,,0
        849,,1
        3300,,0
        850,,1
        3300,,0
        850,,5
        7508,,0
        907,,1
        2450,,0
        908,,1
        2450,,0
        931,,8
        652,,0
        932,,9
        3174,,0
        949,,7
        2952,,0
        951,,7
        2334,,0
        952,,7
        -1
        953,,7
        -1
        954,,7
        -1
        956,,2
        2940,,0
        963,,1
        9854,,0
        964,,15
        9398,,0
        965,,15
        15542,,0
        967,,4
        2704,,0
        968,,7
        8194,,0
        968,,13
        16138,,0
        976,,1
        3316,,0
        977,,15
        1494,,0
        982,,13
        1740,,0
        1012,,1
        5406,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
A4110:  7,,8
        10966,,0
        8,,8
        10966,,0
        9,,8
        10966,,0
        12,,8
        8130,,0
        55,,10
        16160,,0
        65,,4
        9328,,0
        71,,4
        4708,,0
        72,,4
        4708,,0
        79,,10
        17372,,0
        109,,14
        13210,,0
        130,,2
        12050,,0
        138,,2
        14380,,0
        143,,12
        18290,,0
        155,,4
        3374,,0
        169,,0
        19088,,0
        204,,10
        12740,,0
        237,,2
        6850,,0
        239,,6
        5538,,0
        241,,12
        5366,,0
        246,,6
        13966,,0
        278,,2
        2148,,0
        297,,9
        15592,,0
        311,,13
        12192,,0
        314,,14
        11710,,0
        360,,2
        2314,,0
        372,,11
        14346,,0
        383,,5
        14886,,0
        384,,5
        14886,,0
        385,,5
        14886,,0
        404,,0
        9040,,0
        420,,11
        16756,,0
        470,,4
        8300,,0
        497,,10
        3550,,0
        498,,10
        3550,,0
        502,,11
        17276,,0
        524,,3
        9246,,0
        536,,4
        178,,0
        551,,6
        8832,,0
        558,,1
        7744,,0
        651,,2
        6802,,0
        703,,10
        10262,,0
        704,,7
        14774,,0
        727,,11
        1494,,0
        732,,1
        6758,,0
        737,,10
        11954,,0
        781,,9
        4060,,0
        814,,10
        14992,,0
        819,,6
        10304,,0
        833,,5
        9544,,0
        887,,14
        9976,,0
        918,,13
        1160,,0
        921,,13
        1160,,0
        944,,1
        16684,,0
        950,,14
        2936,,0
        1019,,14
        6046,,0
        1020,,2
        13458,,0
        494,,13                         ;used for additions
        2
RADIX   ^D8                             
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
C4111:  102,,5
        3696,,0
        120,,4
        15181,,0
        146,,3
        5605,,0
        241,,9
        636,,0
        360,,4
        -1
        361,,4
        15195,,0
        363,,4
        15199,,0
        412,,4
        19789,,0
        416,,5
        19401,,0
        474,,4
        3552,,0
        497,,5
        18402,,0
        507,,3
        16944,,0
        511,,3
        12995,,0
        511,,4
        3565,,0
        512,,4
        3566,,0
        517,,4
        3567,,0
        520,,4
        3568,,0
        523,,4
        3569,,0
        534,,4
        3573,,0
        543,,4
        3576,,0
        545,,4
        3577,,0
        554,,4
        15071,,0
        555,,4
        -1
        555,,6
        16471,,0
        556,,4
        -1
        557,,4
        -1
        558,,4
        15073,,0
        584,,3
        15843,,0
        596,,9
        8176,,0
        608,,4
        3595,,0
        609,,4
        3594,,0
        615,,4
        3596,,0
        616,,4
        3596,,0
        617,,4
        3597,,0
        618,,4
        3597,,0
        624,,4
        3598,,0
        626,,4
        3599,,0
        628,,4
        3599,,0
        629,,4
        3598,,0
        630,,7
        16563,,0
        631,,4
        3598,,0
        632,,4
        3598,,0
        632,,9
        18360,,0
        635,,4
        3599,,0
        636,,4
        3599,,0
        637,,4
        3599,,0
        638,,4
        3600,,0
        639,,4
        3599,,0
        641,,4
        3600,,0
        644,,4
        3600,,0
        648,,4
        3600,,0
        649,,4
        3600,,0
        650,,4
        3600,,0
        651,,4
        3600,,0
        652,,4
        3599,,0
        652,,6
        11784,,0
        653,,4
        3599,,0
        654,,4
        3599,,0
        656,,4
        3599,,0
        657,,4
        3599,,0
        658,,4
        3599,,0
        659,,4
        3599,,0
        663,,4
        3598,,0
        664,,4
        3598,,0
        665,,4
        3597,,0
        666,,4
        3597,,0
        667,,4
        3597,,0
        669,,4
        3596,,0
        670,,4
        3596,,0
        671,,4
        3595,,0
        672,,4
        3595,,0
        673,,4
        3595,,0
        673,,5
        12515,,0
        674,,4
        3594,,0
        675,,4
        3594,,0
        676,,1
        5513,,0
        676,,4
        3593,,0
        677,,4
        3593,,0
        678,,4
        3593,,0
        679,,4
        3592,,0
        680,,4
        3592,,0
        681,,4
        3591,,0
        682,,4
        3590,,0
        683,,4
        3590,,0
        684,,4
        3590,,0
        685,,4
        3589,,0
        686,,4
        3588,,0
        687,,4
        3588,,0
        688,,4
        3588,,0
        689,,4
        3587,,0
        690,,4
        3586,,0
        691,,4
        3586,,0
        692,,4
        3585,,0
        693,,4
        3584,,0
        694,,4
        3583,,0
        695,,4
        3583,,0
        696,,4
        3582,,0
        697,,4
        3581,,0
        698,,4
        3581,,0
        699,,4
        3580,,0
        700,,4
        3579,,0
        701,,4
        3578,,0
        702,,4
        3577,,0
        703,,4
        3576,,0
        704,,4
        -1
        705,,4
        3574,,0
        706,,4
        3573,,0
        707,,4
        -1
        708,,4
        -1
        709,,4
        3569,,0
        713,,4
        3566,,0
        715,,4
        3564,,0
        716,,4
        3563,,0
        717,,4
        3563,,0
        718,,4
        3562,,0
        719,,4
        3561,,0
        720,,4
        3560,,0
        721,,4
        3560,,0
        722,,4
        3559,,0
        723,,4
        3558,,0
        724,,4
        3558,,0
        725,,4
        3557,,0
        726,,4
        3556,,0
        727,,4
        3556,,0
        728,,4
        3555,,0
        729,,4
        3554,,0
        730,,4
        3554,,0
        731,,4
        3554,,0
        731,,9
        13529,,0
        732,,4
        3553,,0
        739,,4
        3549,,0
        750,,4
        3549,,0
        759,,2
        799,,0
        784,,3
        765,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS A DELIMITER

RADIX   ^D10
C17543: 24,,8
        8174,,0
        122,,7
        17143,,0
        354,,0
        8170,,0
        388,,9
        7916,,0
        398,,7
        10117,,0
        420,,9
        3743,,0
        447,,7
        9466,,0
        448,,7
        9468,,0
        449,,7
        9468,,0
        455,,7
        17366,,0
        456,,2
        9694,,0
        542,,3
        18780,,0
        553,,2
        7591,,0
        573,,7
        9229,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS A DELIMITER

RADIX   ^D10
C9403:  145,,9
        19240,,0
        148,,9
        19237,,0
        159,,7
        15561,,0
        162,,7
        15557,,0
        292,,7
        8060,,0
        311,,9
        11816,,0
        425,,9
        833,,0
        460,,9
        17190,,0
        618,,7
        -1
        619,,7
        -1
        738,,7
        14636,,0
RADIX   ^D8                             ;USED FOR ADDITIONS
        707070,,707070                  ;USED AS A DELIMITER

RADIX   ^D10
C7200:  8,,5
        1241,,0
        9,,5
        -1
        10,,5
        -1
        11,,3
        596,,0
        13,,3
        19940,,0
        16,,3
        446,,0
        28,,5
        1888,,0
        47,,5
        364,,0
        73,,1
        19198,,0
        79,,5
        532,,0
        93,,0
        15267,,0
        172,,3
        -1
        220,,5
        1469,,0
        232,,1
        11551,,0
        237,,1
        11552,,0
        243,,1
        11552,,0
        247,,3
        1783,,0
        251,,2
        18540,,0
        268,,5
        1535,,0
        432,,1
        14344,,0
        534,,1
        13761,,0
        561,,0
        483,,0
        574,,6
        9970,,0
        591,,4
        12995,,0
        593,,7
        5513,,0
        612,,4
        9905,,0
        668,,2
        10694,,0
        672,,1
        2015,,0
        698,,1
        19738,,0
        708,,9
        14730,,0
        722,,1
        13845,,0
        733,,5
        10989,,0
        741,,6
        6551,,2
        742,,6
        -1
        743,,6
        6568,,0
        744,,6
        6570,,0
        762,,1
        17241,,0
        805,,8
        10830,,0
        808,,8
        10831,,0
        814,,4
        16320,,0
        818,,3
        11454,,0
        818,,8
        10837,,0
        819,,8
        10837,,0
RADIX   ^D8
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
C15323: 6,,8
        18143,,0
        14,,8
        10768,,0
        19,,2
        7533,,0
        34,,8
        8865,,0
        48,,8
        11661,,0
        126,,5
        18175,,0
        127,,5
        18175,,0
        151,,2
        10833,,0
        213,,8
        2392,,0
        237,,9
        11970,,0
        250,,0
        18033,,0
        300,,4
        12172,,0
        314,,8
        2419,,0
        325,,7
        3329,,0
        335,,8
        2180,,0
        356,,0
        12086,,0
        383,,9
        4060,,0
        390,,8
        2629,,0
        394,,5
        9533,,0
        394,,7
        3321,,0
        397,,7
        3318,,0
        427,,7
        3290,,0
        437,,4
        12934,,0
        456,,8
        2507,,0
        456,,9
        6305,,0
        484,,1
        3213,,0
        499,,9
        15487,,0
        501,,8
        7125,,0
        508,,4
        15812,,0
        511,,4
        15813,,0
        515,,4
        18097,,0
        555,,8
        13947,,0
        562,,6
        12149,,0
        563,,4
        -1
        593,,4
        18220,,0
        639,,9
        12424,,0
        717,,8
        3414,,0
        763,,4
        18898,,0
        766,,4
        18902,,0
        767,,4
        18903,,0
RADIX   ^D8
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
C20179: 96,,3
        10150,,0
        177,,2
        10560,,0
        465,,6
        18484,,0
        506,,6
        4051,,0
        620,,8
        11761,,0
        622,,9
        12004,,0
        655,,9
        13934,,0
        779,,1
        40,,0
RADIX   ^D8
        707070,,707070                  ;USED AS DELIMITER

RADIX   ^D10
C6905:  1,,3
        10508,,0
        5,,3
        10983,,0
        10,,9
        4707,,0
        20,,3
        -1
        25,,3
        11670,,0
        30,,4
        12110,,0
        34,,3
        11455,,0
        41,,3
        10569,,0
        63,,5
        10868,,0
        212,,5
        1178,,0
        236,,5
        14812,,0
        247,,5
        679,,0
        259,,5
        462,,0
        263,,5
        396,,0
        267,,9
        4841,,0
        291,,9
        4816,,0
        292,,9
        4779,,0
        302,,9
        4668,,0
        348,,2
        8738,,0
        408,,3
        10299,,0
        533,,5
        15139,,0
        571,,2
        390,,0
        636,,7
        16933,,0
        647,,8
        8736,,0
        651,,2
        12824,,0
        792,,4
        16563,,0
        792,,6
        6265,,0
        797,,8
        12094,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C24495: 439,,9
        3221,,0
        449,,0
        9990,,0
        816,,3
        13917,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C3620:  7,,7
        7568,,0
        10,,7
        7569,,0
        11,,7
        7569,,0
        77,,2
        17873,,0
        147,,3
        17974,,0
        162,,4
        19738,,0
        204,,9
        11501,,0
        247,,8
        291,,0
        316,,9
        14511,,0
        319,,4
        11514,,0
        323,,4
        11501,,0
        361,,6
        14452,,0
        380,,8
        9978,,0
        401,,6
        4859,,0
        436,,0
        9869,,0
        480,,3
        1068,,0
        524,,8
        13264,,0
        532,,9
        3313,,0
        599,,7
        7432,,0
        634,,8
        1040,,0
        638,,7
        18782,,0
        684,,5
        18528,,0
        698,,9
        14656,,0
        721,,7
        19263,,0
        740,,5
        5772,,0
        777,,6
        1205,,0
        779,,4
        19251,,0
        781,,9
        12874,,0
        789,,8
        16413,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C20377: 62,,3
        6443,,0
        107,,3
        8904,,0
        135,,3
        16931,,0
        136,,3
        16931,,0
        151,,9
        11008,,0
        152,,4
        9230,,0
        254,,1
        10211,,0
        266,,8
        8243,,0
        317,,0
        19452,,0
        410,,3
        3973,,0
        446,,3
        8834,,0
        469,,3
        5536,,0
        485,,3
        15249,,0
        511,,2
        16873,,0
        536,,8
        19394,,0
        602,,2
        12733,,0
        643,,2
        2126,,0
        741,,0
        13209,,0
        816,,2
        16340,,0
        817,,2
        16340,,0
        818,,2
        16343,,0
        819,,2
        16341,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C15407: 84,,5
        13435,,0
        85,,5
        13435,,0
        250,,0
        306,,0
        274,,3
        11579,,0
        275,,3
        11576,,0
        348,,1
        14577,,0
        362,,0
        7137,,0
        363,,0
        7133,,0
        364,,0
        -1
        365,,0
        7139,,0
        366,,0
        7144,,0
        413,,0
        8257,,0
        414,,1
        9326,,0
        499,,8
        9275,,0
        507,,1
        7886,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C24336: 78,,6
        12433,,0
        92,,6
        11684,,0
        93,,8
        1935,,0
        94,,8
        -1
        136,,0
        11685,,0
        202,,1
        1458,,0
        210,,8
        12113,,0
        240,,6
        14339,,0
        276,,6
        946,,0
        394,,2
        425,,0
        395,,3
        15912,,0
        401,,6
        12020,,0
        436,,3
        11468,,0
        503,,8
        1025,,0
        505,,8
        1025,,0
        525,,8
        6745,,0
        527,,8
        6747,,0
        528,,8
        6749,,0
        547,,8
        977,,0
        548,,8
        977,,0
        549,,8
        977,,0
        550,,8
        977,,0
        551,,8
        977,,0
        571,,8
        979,,0
        572,,8
        979,,0
        573,,8
        979,,0
        574,,8
        979,,0
        575,,8
        979,,0
        576,,8
        979,,0
        578,,8
        979,,0
        591,,8
        980,,0
        592,,8
        980,,0
        593,,8
        980,,0
        594,,8
        980,,0
        595,,8
        980,,0
        596,,8
        980,,0
        597,,8
        980,,0
        598,,8
        980,,0
        608,,8
        981,,0
        609,,8
        981,,0
        610,,8
        981,,0
        612,,8
        981,,0
        613,,1
        13564,,0
        613,,8
        981,,0
        620,,8
        982,,0
        630,,6
        8666,,0
        630,,8
        982,,0
        631,,8
        982,,0
        634,,6
        8668,,0
        655,,7
        977,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C19584: 49,,3
        6942,,0
        110,,3
        6555,,0
        127,,1
        8023,,0
        142,,1
        8035,,0
        149,,5
        12581,,0
        182,,0
        8676,,0
        187,,3
        11749,,0
        232,,3
        11403,,0
        249,,3
        11901,,0
        250,,3
        11901,,0
        251,,3
        11901,,0
        286,,3
        11823,,0
        320,,1
        8714,,0
        322,,1
        8713,,0
        325,,1
        8713,,0
        387,,1
        8055,,0
        390,,1
        8055,,0
        447,,4
        -1
        448,,3
        8826,,0
        527,,1
        8085,,0
        550,,1
        8084,,0
        554,,9
        18834,,0
        569,,4
        16350,,0
        571,,7
        1195,,0
        679,,2
        18676,,0
        682,,6
        4276,,0
        696,,1
        579,,0
        705,,0
        16,,0
        710,,3
        13716,,0
        717,,0
        16,,0
        747,,0
        536,,0
        759,,8
        11599,,0
        792,,6
        13590,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C19049: 0,,5
        10468,,0
        6,,1
        -1
        9,,5
        19434,,0
        10,,5
        19437,,0
        11,,5
        19436,,0
        15,,8
        8397,,0
        17,,8
        8398,,0
        18,,8
        8398,,0
        22,,9
        1359,,0
        23,,5
        19559,,0
        23,,9
        1359,,0
        24,,5
        19560,,0
        24,,9
        1359,,0
        25,,9
        1359,,0
        26,,9
        1359,,0
        27,,9
        1359,,0
        28,,9
        1359,,0
        29,,9
        1359,,0
        39,,9
        2564,,0
        44,,9
        1359,,0
        45,,9
        1359,,0
        48,,7
        363,,0
        139,,2
        396,,0
        166,,5
        19025,,0
        170,,0
        13000,,0
        182,,9
        16985,,0
        241,,5
        14908,,0
        246,,3
        9457,,0
        268,,6
        12436,,0
        275,,8
        16480,,0
        288,,8
        15531,,0
        305,,0
        16630,,0
        494,,7
        5253,,0
        520,,7
        3500,,0
        588,,4
        13745,,0
        604,,6
        13808,,0
        607,,6
        16118,,0
        631,,6
        3410,,0
        647,,6
        4562,,0
        665,,1
        15143,,0
        667,,0
        3133,,0
        668,,0
        3134,,0
        669,,0
        3134,,0
        672,,5
        -1
        694,,6
        10860,,0
        747,,8
        18349,,0
        770,,2
        16987,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C9658:  26,,1
        14300,,0
        32,,1
        12344,,0
        261,,6
        8752,,0
        280,,6
        7778,,0
        506,,6
        16137,,0
        579,,8
        4684,,0
        613,,2
        3515,,0
        780,,7
        17421,,0
        793,,6
        5265,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C1792:  12,,1
        1094,,0
        46,,2
        19855,,0
        88,,2
        5678,,0
        92,,5
        6068,,0
        93,,5
        6068,,0
        96,,5
        6071,,0
        105,,5
        6288,,0
        132,,9
        9271,,0
        135,,9
        9271,,0
        168,,0
        18995,,0
        169,,0
        18994,,0
        170,,0
        18994,,0
        171,,0
        18995,,0
        213,,0
        5161,,0
        215,,0
        5162,,0
        216,,0
        5162,,0
        219,,0
        5162,,0
        351,,3
        16869,,0
        359,,2
        5482,,0
        372,,3
        10304,,0
        404,,5
        14739,,0
        413,,3
        6932,,0
        436,,4
        17258,,0
        482,,3
        11568,,0
        493,,5
        17215,,0
        497,,3
        4275,,0
        514,,9
        4044,,0
        539,,3
        11666,,0
        587,,8
        6166,,0
        597,,3
        7182,,0
        606,,6
        558,,0
        638,,0
        2728,,0
        652,,9
        7168,,0
        672,,8
        2217,,0
        693,,7
        17256,,0
        714,,3
        19525,,0
        718,,1
        7372,,0
        730,,3
        2282,,0
        750,,2
        17418,,0
        790,,1
        10263,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C20627: 0,,5
        11898,,0
        1,,5
        11897,,0
        19,,9
        1800,,0
        21,,9
        1788,,0
        32,,1
        9956,,0
        72,,2
        9512,,0
        96,,2
        2137,,0
        103,,9
        1745,,0
        112,,3
        17173,,0
        157,,2
        19274,,0
        174,,9
        1630,,0
        202,,9
        17742,,0
        206,,7
        2636,,0
        215,,7
        2633,,0
        216,,7
        2633,,0
        295,,2
        12514,,0
        325,,9
        1865,,0
        334,,1
        10456,,0
        335,,1
        10455,,0
        336,,1
        10455,,0
        341,,1
        10453,,0
        343,,1
        10453,,0
        345,,1
        10452,,0
        346,,1
        10452,,0
        347,,1
        10451,,0
        349,,1
        10451,,0
        350,,1
        10451,,0
        351,,1
        10451,,0
        352,,1
        10451,,0
        353,,1
        10451,,0
        354,,1
        10451,,0
        355,,1
        10450,,0
        356,,1
        10450,,0
        357,,1
        10450,,0
        358,,1
        10450,,0
        359,,1
        10450,,0
        360,,1
        10450,,0
        361,,1
        10450,,0
        362,,1
        10449,,0
        363,,1
        10449,,0
        364,,1
        10449,,0
        366,,1
        10449,,0
        370,,9
        1898,,0
        419,,3
        6718,,0
        511,,8
        14697,,0
        550,,9
        13210,,0
        551,,8
        14860,,0
        555,,2
        9851,,0
        645,,3
        6849,,0
        650,,0
        10986,,0
        651,,0
        10985,,0
        652,,0
        10986,,0
        653,,0
        10987,,0
        654,,0
        10987,,0
        669,,2
        15411,,0
        670,,2
        15411,,0
        671,,2
        15412,,0
        672,,2
        15413,,0
        673,,2
        15413,,0
        674,,2
        15414,,0
        675,,2
        -1
        676,,2
        6720,,0
        814,,4
        17720,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C26447: 1,,1
        12231,,0
        15,,2
        16511,,0
        58,,0
        5790,,0
        103,,1
        19886,,0
        222,,6
        6455,,0
        258,,1
        9959,,0
        259,,1
        9959,,0
        260,,1
        9959,,0
        261,,1
        9958,,0
        262,,1
        9959,,0
        263,,1
        9959,,0
        264,,1
        9959,,0
        357,,8
        19539,,0
        387,,0
        16145,,0
        446,,2
        10442,,0
        465,,2
        13010,,0
        466,,0
        3078,,0
        467,,8
        10597,,0
        494,,8
        836,,0
        498,,6
        11854,,0
        513,,1
        4611,,0
        561,,2
        9783,,0
        562,,2
        9783,,0
        563,,2
        9783,,0
        604,,2
        -1
        605,,2
        -1
        606,,2
        -1
        607,,2
        -1
        608,,2
        -1
        609,,0
        2327,,0
        609,,2
        -1
        610,,2
        -1
        611,,2
        -1
        611,,8
        12574,,0
        612,,2
        -1
        632,,2
        7849,,0
        653,,2
        -1
        654,,2
        -1
        655,,2
        -1
        659,,8
        14657,,0
        673,,1
        7479,,0
        673,,2
        -1
        674,,2
        -1
        675,,2
        -1
        681,,0
        12465,,0
        686,,0
        16216,,0
        709,,1
        -1
        724,,0
        19617,,0
        727,,0
        12886,,0
        728,,0
        9526,,0
        736,,1
        11085,,0
        753,,1
        15213,,0
        787,,0
        2266,,0
        791,,0
        6077,,0
        799,,1
        937,,0
RADIX   ^D8
        707070,,707070

DUMMY:  707070,,707070          ;THIS IS A DUMMY FILE USED FOR REM DRIVES

RADIX   ^D10
B1204:  118,,18
        19144,,0
        212,,11
        26952,,0
        213,,11
        26950,,0
        214,,11
        26950,,0
        272,,16
        18386,,0
        338,,4
        22604,,0
        384,,3
        17868,,0
        385,,3
        17868,,0
        386,,3
        17870,,0
        572,,6
        9792,,0
        692,,4
        27506,,0
        744,,6
        24916,,0
        756,,2
        15736,,0
        110,,18         ;additions
        4
        530,,0
        0
        702,,10
        5
        710,,14
        0
        736,,10
        4
RADIX   ^D8
        707070707070

RADIX   ^D10
B797:   5,,16
        930,,0
        10,,14
        20450,,0
        14,,4
        11901,,0
        25,,15
        16374,,0
        30,,15
        26742,,0
        36,,4
        7122,,0
        38,,6
        18124,,0
        39,,7
        16349,,0
        48,,4
        790,,0
        50,,16
        16983,,0
        51,,18
        1731,,0
        61,,17
        25739,,0
        62,,5
        2663,,0
        66,,9
        3792,,0
        72,,8
        4103,,0
        73,,16
        27037,,0
        80,,2
        2358,,0
        81,,16
        6933,,0
        88,,1
        6514,,0
        91,,16
        75,,0
        104,,12
        9284,,0
        107,,16
        22634,,0
        114,,16
        25890,,0
        117,,7
        11906,,0
        129,,4
        1218,,0
        138,,10
        2643,,0
        158,,17
        10769,,0
        159,,17
        10771,,0
        160,,14
        5241,,0
        161,,4
        11080,,0
        167,,16
        654,,0
        169,,3
        15242,,0
        169,,4
        19866,,0
        170,,3
        15239,,0
        176,,4
        1430,,0
        176,,18
        6346,,0
        178,,15
        21925,,0
        187,,13
        19865,,0
        191,,2
        8880,,0
        198,,4
        21712,,0
        199,,14
        16786,,0
        203,,2
        3215,,0
        211,,0
        17457,,0
        212,,16
        5777,,0
        213,,1
        25642,,0
        215,,16
        26731,,0
        218,,5
        8394,,0
        218,,6
        11998,,0
        219,,15
        16411,,0
        223,,3
        18590,,0
        224,,3
        27403,,0
        234,,3
        27020,,0
        235,,3
        27018,,0
        241,,10
        15909,,0
        242,,8
        26665,,0
        250,,6
        7567,,0
        252,,17
        12372,,0
        254,,11
        12374,,0
        256,,8
        7103,,0
        258,,15
        2490,,0
        267,,16
        2073,,0
        272,,15
        5344,,0
        273,,2
        27056,,0
        277,,16
        19179,,0
        278,,19
        18640,,0
        289,,6
        6064,,0
        293,,19
        27383,,0
        315,,15
        5393,,0
        317,,1
        10522,,0
        319,,11
        16898,,0
        320,,11
        16897,,0
        322,,4
        19481,,0
        324,,1
        19373,,0
        326,,4
        13265,,0
        330,,18
        1478,,0
        339,,17
        23788,,0
        340,,12
        18747,,0
        344,,4
        27160,,0
        344,,8
        22268,,0
        349,,12
        -1
        350,,2
        6014,,0
        357,,4
        28034,,0
        376,,2
        18450,,0
        377,,16
        28131,,0
        378,,3
        14558,,0
        383,,4
        151,,0
        385,,17
        22764,,0
        385,,13
        2241,,0
        386,,16
        28068,,0
        386,,17
        22762,,0
        387,,6
        6505,,0
        388,,3
        15318,,0
        390,,3
        15318,,0
        391,,15
        6871,,0
        399,,9
        5755,,0
        403,,16
        18711,,0
        406,,5
        14082,,0
        406,,16
        18711,,0
        408,,2
        4908,,0
        409,,17
        9836,,0
        418,,16
        28079,,0
        419,,6
        15978,,0
        419,,16
        28093,,0
        422,,15
        22712,,0
        437,,4
        21936,,0
        440,,2
        19394,,0
        443,,16
        28121,,0
        449,,19
        27408,,0
        458,,16
        14827,,0
        460,,10
        10210,,0
        466,,2
        26554,,0
        474,,5
        7119,,0
        477,,2
        6482,,0
        479,,11
        751,,0
        481,,5
        501,,0
        481,,11
        24337,,0
        482,,5
        501,,0
        483,,11
        24337,,0
        484,,11
        24337,,0
        485,,11
        24337,,0
        486,,11
        24337,,0
        487,,8
        4015,,0
        487,,11
        24337,,0
        498,,16
        27965,,0
        500,,17
        12220,,0
        501,,6
        5209,,0
        522,,10
        8994,,0
        528,,18
        14670,,0
        530,,17
        8508,,0
        537,,5
        26222,,0
        540,,4
        19181,,0
        550,,1
        17958,,0
        551,,0
        25903,,0
        551,,15
        1574,,0
        566,,10
        20422,,0
        567,,0
        5133,,0
        590,,17
        8190,,0
        628,,17
        23990,,0
        640,,16
        12879,,0
        650,,16
        11670,,0
        656,,17
        28135,,0
        666,,10
        20878,,0
        666,,13
        5012,,0
        670,,16
        72,,0
        671,,2
        26943,,0
        673,,6
        5814,,0
        675,,16
        22138,,0
        676,,6
        19527,,0
        676,,19
        27031,,0
        679,,5
        22563,,0
        680,,8
        23649,,0
        685,,12
        18387,,0
        688,,6
        11880,,0
        689,,10
        25401,,0
        693,,9
        22308,,0
        701,,17
        44,,0
        702,,4
        6683,,0
        711,,6
        26477,,0
        717,,16
        119,,0
        726,,2
        23181,,0
        728,,6
        12434,,0
        741,,7
        15765,,0
        742,,3
        21060,,0
        742,,16
        235,,0
        746,,8
        19824,,0
        749,,8
        19772,,0
        749,,10
        8099,,0
        749,,17
        15855,,0
        766,,0
        5011,,0
        768,,15
        15173,,0
        768,,17
        5787,,0
        769,,7
        6306,,0
        771,,16
        28159,,0
        783,,12
        20903,,0
        786,,2
        25227,,0
        788,,12
        27713,,0
        792,,16
        20,,0
        798,,2
        16222,,0
        802,,12
        18903,,0
        807,,12
        7953,,0
        808,,11
        20272,,0
        819,,4
        7866,,0
        830,,7
        26436,,0
        831,,11
        2281,,0
        833,,4
        -1
        835,,6
        14903,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C1979:  31,,5
        7478,,0
        81,,2
        17688,,0
        82,,2
        17688,,0
        82,,3
        17686,,0
        87,,9
        2013,,0
        113,,3
        12268,,0
        126,,5
        13890,,0
        127,,5
        13890,,0
        128,,5
        13998,,0
        132,,5
        -1
        133,,5
        -1
        135,,5
        15707,,0
        144,,5
        14221,,0
        207,,8
        8673,,0
        254,,6
        15114,,0
        338,,0
        10973,,0
        396,,2
        12284,,0
        409,,6
        19574,,0
        429,,6
        16045,,0
        453,,7
        11894,,0
        458,,7
        9771,,0
        509,,1
        19851,,0
        523,,4
        17699,,0
        551,,4
        14260,,0
        558,,2
        14511,,0
        560,,2
        14006,,0
        580,,4
        14280,,0
        589,,6
        17659,,0
        597,,7
        11215,,0
        602,,7
        12958,,0
        655,,9
        4591,,0
        688,,2
        12754,,0
        693,,8
        16195,,0
        714,,2
        16518,,0
        731,,6
        10201,,0
        743,,0
        9123,,0
        745,,0
        9127,,0
        90,,5                           ;ADDITIONS TO ORIGINAL INFO
        -1
        0,,9
        1
        1,,9
        1
        10,,9
        1
        11,,9
        1
        334,,9
        5
        682,,9
        7
        763,,9
        7
        818,,9
        7
        131,,5
        6
        819,,9
        7
        129,,5
        -1
        150,,5
        6
        152,,9
        6
        100,,5
        2
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C1196:  9,,1
        16254,,0
        20,,5
        19869,,0
        23,,1
        4387,,0
        30,,5
        18028,,0
        33,,5
        18028,,0
        36,,5
        17899,,0
        41,,5
        10019,,0
        42,,1
        1508,,0
        43,,5
        15792,,0
        52,,3
        19303,,0
        57,,5
        14118,,0
        79,,5
        5290,,0
        92,,4
        3163,,0
        98,,2
        5729,,0
        98,,5
        -1
        103,,7
        13594,,0
        105,,7
        13594,,0
        106,,7
        13596,,0
        107,,7
        13595,,0
        109,,7
        13595,,0
        129,,3
        14104,,0
        132,,5
        408,,0
        144,,5
        15668,,0
        169,,3
        15826,,0
        170,,3
        15825,,0
        184,,8
        10061,,0
        190,,7
        13617,,0
        191,,7
        13616,,0
        199,,5
        21,,0
        214,,4
        5395,,0
        253,,9
        15278,,0
        254,,5
        1859,,0
        263,,9
        21,,0
        277,,9
        11127,,0
        337,,6
        3976,,0
        385,,6
        9873,,0
        387,,2
        12479,,0
        392,,6
        13652,,0
        408,,9
        10334,,0
        452,,8
        4799,,0
        477,,8
        2831,,0
        481,,7
        2299,,0
        481,,9
        9658,,0
        483,,8
        1526,,0
        485,,9
        15064,,0
        489,,9
        13174,,0
        507,,9
        7802,,0
        539,,9
        17574,,0
        567,,3
        19262,,0
        575,,5
        8822,,0
        621,,9
        16787,,0
        622,,9
        16786,,0
        683,,3
        15724,,0
        733,,2
        5409,,0
        777,,1
        4031,,0
        811,,9
        9870,,0
        817,,8
        19241,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C6612:  0,,5
        210,,0
        2,,3
        9654,,0
        11,,5
        209,,0
        14,,5
        212,,0
        24,,4
        1308,,0
        25,,9
        2867,,0
        45,,3
        14342,,0
        51,,7
        10205,,0
        52,,7
        10206,,0
        53,,7
        10205,,0
        54,,7
        10205,,0
        55,,7
        10205,,0
        56,,7
        10205,,0
        57,,7
        10205,,0
        58,,7
        10205,,0
        59,,7
        10205,,0
        60,,7
        10205,,0
        61,,7
        10205,,0
        62,,5
        787,,0
        62,,7
        10204,,0
        86,,3
        8245,,0
        99,,3
        15191,,0
        100,,3
        15191,,0
        101,,3
        15190,,0
        102,,3
        15190,,0
        142,,3
        15521,,0
        160,,2
        12069,,0
        513,,3
        6868,,0
        539,,2
        8670,,0
        539,,3
        17038,,0
        542,,2
        8673,,0
        548,,2
        3107,,0
        552,,2
        726,,0
        554,,2
        5045,,0
        567,,9
        16421,,0
        582,,3
        7398,,0
        589,,2
        16890,,0
        594,,3
        11525,,0
        640,,3
        11069,,0
        645,,3
        15873,,0
        687,,3
        8703,,0
        703,,4
        -1
        704,,4
        -1
        705,,4
        -1
        706,,4
        -1
        707,,4
        -1
        708,,4
        -1
        709,,4
        -1
        710,,4
        -1
        711,,4
        -1
        712,,4
        -1
        713,,4
        -1
        714,,4
        -1
        715,,4
        -1
        716,,2
        8272,,0
        716,,4
        -1
        717,,4
        -1
        718,,4
        13023,,0
        719,,1
        12566,,0
        719,,4
        16927,,0
        739,,3
        2468,,0
        739,,5
        7656,,0
        746,,8
        10785,,0
        747,,8
        10786,,0
        748,,8
        10786,,0
        756,,3
        9199,,0
        770,,8
        10831,,0
        771,,8
        10832,,0
        772,,8
        10833,,0
        773,,8
        10834,,0
        774,,8
        10835,,0
        804,,8
        10648,,0
        805,,8
        10649,,0
        806,,8
        10650,,0
        14,,3                           ;THESE ARE ADDITIONS TO ORIGINAL INFO.
        4
RADIX   ^D8
        707070,,707070

RADIX   ^D10
A10720: 0,,10
        17482,,0
        2,,10
        852,,0
        15,,10
        8282,,0
        16,,10
        8282,,0
        18,,10
        -1
        19,,10
        8266,,0
        21,,10
        8262,,0
        22,,10
        8262,,0
        23,,10
        8262,,0
        25,,5
        14326,,0
        32,,2
        17690,,0
        33,,15
        -1
        35,,6
        2908,,0
        44,,9
        13450,,0
        46,,2
        10096,,0
        47,,2
        10130,,0
        49,,9
        66,,0
        49,,10
        12880,,0
        75,,8
        2160,,0
        80,,11
        13680,,0
        82,,9
        1652,,0
        83,,0
        13308,,0
        104,,9
        4988,,0
        119,,12
        3792,,0
        120,,12
        -1
        144,,9
        284,,0
        147,,11
        15294,,0
        157,,8
        -1
        157,,9
        19744,,0
        158,,8
        1990,,0
        169,,12
        234,,0
        170,,12
        234,,0
        171,,12
        -1
        176,,8
        4888,,0
        177,,8
        4888,,0
        180,,8
        -1
        191,,8
        6410,,0
        192,,8
        6410,,0
        193,,8
        -1
        194,,8
        -1
        194,,9
        19654,,0
        195,,9
        19654,,0
        196,,15
        226,,0
        197,,8
        6408,,0
        201,,6
        4312,,0
        203,,6
        4304,,0
        204,,6
        -1
        206,,0
        7980,,0
        209,,10
        4914,,0
        209,,13
        220,,0
        212,,6
        4314,,0
        216,,9
        5732,,0
        220,,6
        4302,,0
        221,,6
        4302,,0
        264,,15
        2770,,0
        270,,12
        13428,,0
        272,,12
        13430,,0
        293,,5
        7028,,0
        296,,3
        12260,,0
        299,,10
        4322,,0
        299,,12
        10720,,0
        311,,10
        7030,,0
        319,,8
        19618,,0
        329,,8
        16382,,0
        346,,2
        18840,,0
        349,,8
        15212,,0
        350,,8
        15212,,0
        359,,10
        544,,0
        373,,5
        9774,,0
        381,,10
        566,,0
        386,,3
        12056,,0
        386,,7
        17818,,0
        400,,13
        3602,,0
        406,,11
        2482,,0
        411,,9
        6172,,0
        444,,6
        6022,,0
        450,,9
        -1
        451,,9
        13706,,0
        453,,6
        6044,,0
        457,,9
        14086,,0
        465,,5
        6012,,0
        466,,13
        -1
        467,,6
        6046,,0
        467,,13
        -1
        468,,13
        -1
        469,,13
        128,,0
        475,,6
        -1
        476,,6
        -1
        478,,6
        -1
        479,,6
        -1
        480,,6
        12634,,0
        481,,4
        13072,,0
        483,,6
        -1
        484,,6
        12634,,0
        509,,8
        12094,,0
        512,,4
        600,,0
        522,,8
        2276,,0
        523,,8
        -1
        536,,8
        -1
        546,,6
        13300,,0
        546,,15
        -1
        566,,9
        18924,,0
        573,,9
        2818,,0
        581,,10
        18798,,0
        582,,13
        11588,,0
        626,,11
        7786,,0
        644,,9
        6446,,0
        647,,8
        13438,,0
        652,,10
        12682,,0
        653,,9
        8168,,0
        670,,13
        19020,,0
        678,,9
        7698,,0
        680,,9
        -1
        690,,15
        19642,,0
        695,,8
        -1
        696,,8
        -1
        697,,8
        -1
        698,,8
        -1
        719,,6
        1106,,0
        730,,8
        -1
        731,,8
        16906,,0
        739,,9
        2624,,0
        760,,9
        15410,,0
        769,,9
        15154,,0
        773,,15
        17654,,0
        792,,8
        18254,,0
        801,,8
        18222,,0
        802,,8
        18224,,0
        803,,8
        18226,,0
        811,,13
        19764,,0
        842,,3
        15092,,0
        845,,11
        3130,,0
        858,,9
        462,,0
        862,,2
        14528,,0
        864,,9
        18486,,0
        891,,3
        -1
        891,,9
        14732,,0
        892,,9
        14732,,0
        899,,9
        1778,,0
        900,,1
        7678,,0
        901,,1
        7678,,0
        902,,5
        1770,,0
        904,,9
        410,,0
        910,,9
        10,,0
        910,,14
        916,,0
        924,,9
        3802,,0
        925,,9
        3802,,0
        926,,9
        3802,,0
        927,,9
        3804,,0
        937,,4
        4234,,0
        938,,4
        4234,,0
        964,,11
        12804,,0
        969,,1
        3160,,0
        971,,1
        -1
        972,,1
        -1
        973,,1
        -1
        974,,1
        -1
        975,,1
        -1
        980,,8
        18604,,0
        982,,8
        18608,,0
        984,,9
        -1
        986,,9
        10248,,0
        991,,8
        18614,,0
        992,,8
        -1
        1010,,4
        3812,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
A21706: 30,,0
        19024,,0
        36,,5
        11990,,0
        42,,12
        8504,,0
        50,,2
        14886,,0
        53,,5
        8854,,0
        54,,1
        20062,,0
        57,,4
        7498,,0
        80,,2
        15244,,0
        89,,8
        7252,,0
        92,,5
        12608,,0
        95,,2
        14446,,0
        97,,10
        7438,,0
        107,,0
        15050,,0
        117,,2
        5140,,0
        152,,14
        19834,,0
        181,,7
        -1
        182,,7
        -1
        183,,7
        -1
        188,,5
        5922,,0
        217,,14
        2822,,0
        222,,3
        19362,,0
        233,,12
        15774,,0
        274,,3
        10116,,0
        275,,3
        10116,,0
        306,,7
        18730,,0
        307,,7
        18730,,0
        313,,4
        2014,,0
        327,,0
        12180,,0
        330,,14
        1820,,0
        345,,12
        10104,,0
        346,,12
        10104,,0
        387,,9
        7476,,0
        409,,0
        3988,,0
        409,,5
        3976,,0
        418,,4
        11924,,0
        425,,9
        13040,,0
        448,,10
        3028,,0
        486,,2
        672,,0
        499,,13
        14968,,0
        500,,13
        14968,,0
        516,,8
        4996,,0
        523,,13
        5092,,0
        528,,13
        15180,,0
        531,,7
        18342,,0
        550,,15
        13632,,0
        551,,15
        13632,,0
        561,,6
        2356,,0
        572,,10
        1080,,0
        573,,10
        1080,,0
        609,,10
        1072,,0
        611,,10
        1072,,0
        616,,7
        2350,,0
        622,,9
        2002,,0
        667,,12
        14810,,0
        669,,7
        8508,,0
        709,,12
        12300,,0
        710,,12
        12298,,0
        717,,8
        15406,,0
        718,,8
        15406,,0
        719,,8
        15406,,0
        725,,3
        11982,,0
        730,,12
        18702,,0
        731,,6
        1910,,0
        747,,13
        9434,,0
        749,,2
        19214,,0
        749,,8
        16986,,0
        751,,6
        1792,,0
        751,,12
        9718,,0
        753,,3
        3160,,0
        761,,6
        1714,,0
        764,,6
        8056,,0
        769,,10
        8930,,0
        773,,9
        14750,,0
        775,,13
        -1
        803,,13
        9454,,0
        807,,12
        1360,,0
        808,,2
        7706,,0
        808,,12
        -1
        809,,2
        7706,,0
        809,,9
        8102,,0
        811,,4
        6318,,0
        818,,3
        11846,,0
        822,,12
        1358,,0
        825,,4
        11126,,0
        835,,3
        476,,0
        856,,9
        546,,0
        865,,13
        17148,,0
        875,,3
        12020,,0
        881,,2
        12568,,0
        902,,5
        13662,,0
        904,,5
        13660,,0
        905,,5
        13660,,0
        906,,5
        13660,,0
        907,,5
        13660,,0
        908,,5
        13660,,0
        909,,5
        13660,,0
        910,,5
        13660,,0
        911,,5
        13660,,0
        912,,5
        13660,,0
        914,,5
        13660,,0
        915,,5
        13660,,0
        916,,5
        13660,,0
        919,,5
        13660,,0
        935,,0
        2546,,0
        937,,4
        7172,,0
        938,,8
        16064,,0
        938,,11
        14588,,0
        948,,7
        7260,,0
        960,,11
        19032,,0
        964,,5
        17466,,0
        974,,7
        16886,,0
        974,,13
        7664,,0
        980,,6
        18118,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
A10621: 10,,13
        1820,,0
        45,,1
        11358,,0
        68,,4
        11584,,0
        109,,9
        10444,,0
        131,,1
        5786,,0
        143,,15
        1298,,0
        170,,7
        10834,,0
        171,,7
        10834,,0
        177,,0
        14416,,0
        178,,0
        19208,,0
        194,,1
        16308,,0
        206,,12
        17752,,0
        221,,9
        4896,,0
        238,,13
        10992,,0
        283,,0
        14506,,0
        300,,5
        4798,,0
        333,,8
        6098,,0
        352,,0
        4844,,0
        362,,12
        2386,,0
        374,,13
        10492,,0
        441,,9
        8292,,0
        449,,9
        16056,,0
        519,,0
        11190,,0
        520,,7
        11612,,0
        523,,7
        -1
        524,,7
        -1
        525,,7
        -1
        526,,7
        -1
        527,,7
        -1
        540,,8
        17058,,0
        552,,10
        12268,,0
        558,,8
        9686,,0
        569,,0
        11176,,0
        575,,0
        14636,,0
        580,,13
        -1
        584,,8
        7574,,0
        589,,13
        4266,,0
        631,,1
        11436,,0
        638,,8
        11094,,0
        665,,6
        17228,,0
        671,,4
        12448,,0
        690,,12
        15648,,0
        691,,8
        3506,,0
        692,,8
        3506,,0
        701,,4
        12142,,0
        706,,7
        1316,,0
        714,,0
        11086,,0
        794,,0
        11430,,0
        807,,5
        19724,,0
        812,,5
        7164,,0
        829,,12
        8980,,0
        836,,7
        6286,,0
        856,,1
        18340,,0
        864,,5
        5738,,0
        868,,12
        15344,,0
        872,,2
        13198,,0
        881,,1
        11248,,0
        899,,1
        -1
        900,,1
        9096,,0
        901,,1
        -1
        902,,1
        -1
        902,,9
        -1
        903,,4
        6472,,0
        903,,9
        11240,,0
        904,,1
        -1
        905,,1
        9098,,0
        936,,0
        12310,,0
        976,,5
        -1
        977,,5
        -1
        978,,5
        -1
        979,,5
        -1
        979,,8
        1784,,0
        994,,10
        12470,,0
        1010,,11
        11006,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
A11121: 4,,6
        2164,,0
        14,,4
        2464,,0
        15,,2
        16542,,0
        24,,14
        18496,,0
        49,,0
        10940,,0
        51,,13
        3966,,0
        52,,0
        11348,,0
        52,,12
        4402,,0
        57,,2
        7232,,0
        59,,13
        -1
        63,,14
        -1
        65,,1
        6826,,0
        81,,2
        11180,,0
        87,,2
        11180,,0
        109,,4
        2446,,0
        145,,0
        2072,,0
        153,,7
        16180,,0
        161,,14
        6246,,0
        162,,14
        6246,,0
        175,,0
        11906,,0
        225,,15
        2548,,0
        235,,10
        14344,,0
        240,,15
        -1
        251,,1
        12068,,0
        273,,2
        11300,,0
        275,,12
        12078,,0
        319,,0
        17286,,0
        323,,0
        17288,,0
        324,,0
        17288,,0
        325,,0
        17288,,0
        367,,15
        -1
        368,,15
        -1
        371,,15
        12676,,0
        372,,15
        12676,,0
        395,,4
        17632,,0
        398,,12
        10012,,0
        403,,1
        17592,,0
        403,,12
        6630,,0
        405,,1
        -1
        406,,1
        -1
        419,,1
        6966,,0
        423,,8
        11250,,0
        505,,12
        10096,,0
        667,,12
        7404,,0
        682,,0
        19948,,0
        758,,6
        15390,,0
        759,,6
        15388,,0
        788,,14
        7384,,0
        789,,14
        7384,,0
        803,,0
        13676,,0
        825,,7
        7852,,0
        877,,1
        14126,,0
        887,,7
        11624,,0
        891,,1
        -1
        910,,10
        -1
        945,,5
        3368,,0
        948,,13
        11322,,0
        949,,13
        11320,,0
        951,,0
        4884,,0
        973,,1
        7070,,0
        985,,0
        7092,,0
        994,,5
        10070,,0
        1019,,4
        10422,,0
        1020,,4
        10420,,0
        1020,,13
        4456,,0
        1021,,4
        10422,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
A23011: 48,,10
        4844,,0
        93,,8
        1264,,0
        112,,7
        2770,,0
        123,,5
        -1
        124,,5
        -1
        132,,4
        5550,,0
        149,,10
        7228,,0
        156,,14
        19138,,0
        166,,6
        4044,,0
        188,,6
        5754,,0
        188,,9
        17622,,0
        234,,9
        17730,,0
        280,,9
        3246,,0
        281,,7
        1148,,0
        282,,7
        1148,,0
        303,,7
        19642,,0
        307,,8
        17002,,0
        308,,14
        9438,,0
        312,,9
        394,,0
        363,,9
        8842,,0
        369,,9
        5312,,0
        403,,8
        2848,,0
        411,,0
        13362,,0
        430,,9
        9724,,0
        455,,13
        1010,,0
        478,,11
        15162,,0
        509,,8
        15628,,0
        545,,0
        11614,,0
        545,,7
        586,,0
        558,,9
        17590,,0
        583,,5
        7970,,0
        618,,10
        7134,,0
        636,,0
        19994,,0
        649,,13
        5224,,0
        650,,14
        15102,,0
        658,,12
        6194,,0
        687,,14
        12556,,0
        700,,1
        10960,,0
        735,,13
        8062,,0
        745,,13
        19724,,0
        746,,13
        19724,,0
        747,,14
        14514,,0
        757,,5
        1268,,0
        801,,6
        18008,,0
        804,,8
        4634,,0
        868,,2
        -1
        871,,5
        5954,,0
        877,,1
        -1
        878,,1
        -1
        921,,13
        4494,,0
        957,,4
        9374,,0
        962,,8
        290,,0
        967,,13
        5546,,0
        979,,9
        19340,,0
        1016,,8
        128,,0
        1017,,8
        128,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C21708: 0,,5
        18921,,0
        1,,5
        18922,,0
        2,,5
        18921,,0
        3,,5
        18921,,0
        4,,5
        18921,,0
        5,,5
        18921,,0
        6,,5
        18921,,0
        7,,5
        18921,,0
        8,,5
        18921,,0
        9,,5
        18921,,0
        10,,5
        18921,,0
        11,,5
        18922,,0
        12,,5
        18922,,0
        13,,5
        18921,,0
        14,,5
        18922,,0
        15,,5
        18921,,0
        16,,5
        18922,,0
        17,,5
        18922,,0
        18,,5
        18922,,0
        19,,5
        18922,,0
        20,,5
        18922,,0
        21,,5
        18922,,0
        22,,5
        18922,,0
        23,,5
        18922,,0
        25,,5
        18922,,0
        26,,5
        18923,,0
        29,,1
        415,,0
        30,,5
        18923,,0
        66,,9
        16653,,0
        67,,9
        16652,,0
        183,,1
        6867,,0
        208,,5
        15192,,0
        341,,7
        951,,0
        374,,3
        12468,,0
        536,,9
        17172,,0
        548,,8
        2304,,0
        622,,5
        7766,,0
        623,,5
        7767,,0
        710,,4
        5700,,0
        716,,4
        8623,,0
        729,,5
        17942,,0
        768,,5
        6484,,0
        793,,2
        11853,,0
        815,,2
        16553,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C1793:  16,,0
        7914,,0
        17,,0
        7914,,0
        25,,9
        17042,,0
        57,,1
        11136,,0
        150,,1
        16152,,0
        152,,1
        16113,,0
        167,,1
        16849,,0
        180,,4
        4402,,0
        183,,4
        9974,,0
        238,,0
        -1
        254,,0
        839,,0
        290,,3
        17417,,0
        342,,0
        9674,,0
        362,,3
        8750,,0
        426,,1
        3114,,0
        428,,2
        4771,,0
        464,,9
        8032,,0
        515,,7
        17655,,0
        527,,8
        13714,,0
        538,,2
        12168,,0
        566,,5
        18833,,0
        571,,5
        9276,,0
        610,,6
        13376,,0
        621,,5
        12050,,0
        671,,4
        7768,,0
        729,,4
        8342,,0
        756,,0
        7786,,0
        757,,0
        7787,,0
        759,,0
        7789,,0
        760,,0
        7790,,0
        775,,4
        2507,,0
        776,,4
        2509,,0
        777,,4
        2511,,0
        778,,4
        2512,,0
        790,,4
        2530,,0
        794,,4
        2536,,0
        799,,4
        2543,,0
        805,,4
        2552,,0
        806,,4
        2553,,0
        807,,4
        2555,,0
        808,,4
        2556,,0
        808,,9
        19678,,0
RADIX   ^D8
        707070,,707070

RADIX   ^D10
C13232: 13,,9
        9896,,0
        27,,9
        1649,,0
        175,,6
        2489,,0
        188,,6
        2507,,0
        212,,1
        11108,,0
        215,,1
        11109,,0
        219,,1
        11109,,0
        225,,2
        8181,,0
        240,,1
        11113,,0
        241,,1
        11113,,0
        242,,1
        11113,,0
        279,,1
        7204,,0
        362,,1
        7193,,0
        364,,1
        7246,,0
        365,,1
        7246,,0
        366,,1
        7246,,0
        421,,1
        14011,,0
        430,,0
        14962,,0
        490,,1
        14392,,0
        523,,6
        11964,,0
        523,,7
        11928,,0
        524,,6
        11964,,0
        525,,6
        11964,,0
        526,,6
        11964,,0
        626,,8
        5469,,0
        629,,8
        5470,,0
        636,,8
        4942,,0
RADIX   ^D8
        707070,,707070

radix   ^d10
C22821: 72,,7
        6648,,0
        184,,6
        17932,,0
        341,,9
        12143,,0
        379,,0
        9579,,0
        386,,7
        2493,,0
        458,,7
        8118,,0
        489,,3
        19001,,0
radix   ^d8
        707070707070

radix   ^d10
C31484: 39,,8
        8984,,0
        114,,9
        14258,,0
        241,,9
        8361,,0
        245,,7
        12800,,0
        273,,8
        15239,,0
        308,,3
        11277,,0
        339,,6
        11992,,0
        371,,0
        14714,,0
        377,,7
        12699,,0
        410,,0
        14543,,0
        416,,6
        10869,,0
        419,,6
        5063,,0
        420,,6
        5063,,0
        421,,6
        5064,,0
        422,,6
        5065,,0
        423,,6
        5066,,0
        424,,6
        5067,,0
        425,,6
        5068,,0
        426,,6
        5068,,0
        427,,6
        5069,,0
        428,,6
        5070,,0
        429,,0
        7245,,0
        429,,6
        5070,,0
        430,,6
        5071,,0
        432,,6
        5073,,0
        436,,6
        5075,,0
        437,,6
        5076,,0
        438,,3
        16798,,0
        438,,6
        5077,,0
        439,,6
        5078,,0
        454,,6
        5089,,0
        456,,6
        5090,,0
        473,,8
        16928,,0
        474,,8
        16929,,0
        528,,6
        2829,,0
        555,,8
        9093,,0
        587,,6
        2626,,0
        590,,7
        17461,,0
        602,,6
        13933,,0
        631,,0
        970,,0
        632,,0
        971,,0
        633,,0
        971,,0
        634,,0
        971,,0
        637,,0
        972,,0
        638,,0
        972,,0
        640,,0
        973,,0
        666,,8
        2876,,0
        684,,7
        1450,,0
        686,,2
        2119,,0
        695,,2
        5597,,0
        696,,1
        19667,,0
        720,,0
        9489,,0
        731,,6
        11215,,0
        735,,2
        118,,0
        737,,0
        11844,,0
        766,,8
        13359,,0
        774,,7
        1443,,0
        782,,9
        3040,,0
        788,,6
        16152,,0
        813,,6
        15378,,0
        819,,6
        15378,,0
radix   ^d8
        707070707070

radix   ^d10
C35402: 8,,8
        12804,,0
        48,,0
        17664,,0
        60,,6
        14398,,0
        208,,7
        6381,,0
        229,,1
        9402,,0
        266,,1
        19759,,0
        423,,0
        18089,,0
        470,,0
        5145,,0
        521,,1
        4582,,0
        528,,1
        4048,,0
        542,,3
        12809,,0
        634,,8
        3361,,0
        642,,0
        13251,,0
        687,,8
        5669,,0
radix   ^d8
        707070707070

radix   ^d10
C33950: 21,,1
        19385,,0
        72,,2
        16541,,0
        166,,6
        10113,,0
        186,,1
        17952,,0
        206,,3
        18685,,0
        265,,2
        13895,,0
        303,,8
        6753,,0
        312,,5
        5054,,0
        313,,9
        12248,,0
        323,,8
        6303,,0
        324,,2
        14426,,0
        330,,6
        5522,,0
        333,,1
        19446,,0
        334,,1
        19446,,0
        371,,0
        19339,,0
        396,,9
        12485,,0
        409,,8
        18089,,0
        410,,8
        18089,,0
        472,,9
        11031,,0
        498,,2
        16084,,0
        498,,9
        3515,,0
        503,,0
        17527,,0
        526,,2
        3940,,0
        541,,0
        14826,,0
        569,,8
        13035,,0
        573,,2
        17789,,0
        575,,6
        14320,,0
        580,,1
        8317,,0
        587,,0
        14490,,0
        589,,6
        2293,,0
        615,,2
        18086,,0
        654,,9
        19207,,0
        656,,2
        15338,,0
        657,,2
        18575,,0
        657,,6
        13403,,0
        667,,9
        8324,,0
        700,,5
        7753,,0
        703,,9
        18451,,0
        717,,2
        5283,,0
        725,,9
        16190,,0
        727,,8
        11796,,0
        733,,3
        3188,,0
        806,,6
        4977,,0
radix   ^d8
        707070707070

radix   ^d10
C3079:  3,,3
        19340,,0
        7,,3
        3936,,0
        8,,3
        3936,,0
        10,,3
        3936,,0
        11,,3
        3936,,0
        12,,3
        3936,,0
        13,,3
        3936,,0
        14,,3
        3936,,0
        15,,3
        3936,,0
        16,,3
        3936,,0
        17,,3
        -1
        18,,3
        3935,,0
        19,,3
        3935,,0
        62,,7
        3831,,0
        120,,7
        8340,,0
        219,,6
        11824,,0
        220,,7
        14330,,0
        285,,2
        1513,,0
        399,,9
        13995,,0
        418,,1
        10373,,0
        455,,7
        1270,,0
        496,,7
        9788,,0
        582,,7
        13176,,0
        618,,9
        17909,,0
        630,,6
        3300,,0
        683,,9
        14331,,0
        768,,3
        4245,,0
radix   ^d8
        707070707070

radix   ^d10
C2166:  18,,9
        14218,,0
        20,,4
        10347,,0
        69,,1
        10027,,0
        99,,1
        8140,,0
        302,,0
        10261,,0
        333,,2
        3544,,0
        392,,0
        5014,,0
        525,,3
        14963,,0
        525,,6
        14963,,0
        530,,2
        10891,,0
        565,,4
        19679,,0
        597,,8
        6957,,0
        655,,1
        2657,,0
        684,,4
        4913,,0
        734,,2
        6668,,0
        764,,2
        3093,,0
        765,,4
        4747,,0
        784,,2
        5343,,0
        788,,2
        9009,,0
        807,,2
        6372,,0
radix   ^d8
        707070707070

radix   ^d10
C2226:  8,,7
        2455,,0
        15,,7
        3342,,0
        26,,1
        18223,,0
        28,,1
        18204,,0
        44,,3
        4657,,0
        45,,1
        516,,0
        45,,3
        4657,,0
        58,,7
        4163,,0
        61,,1
        2596,,0
        63,,1
        15731,,0
        92,,7
        10384,,0
        118,,2
        9550,,0
        198,,2
        17853,,0
        199,,6
        14001,,0
        200,,6
        14000,,0
        201,,6
        14000,,0
        223,,2
        19602,,0
        243,,2
        17943,,0
        243,,8
        313,,0
        276,,2
        14556,,0
        284,,2
        16027,,0
        287,,2
        19855,,0
        321,,2
        13795,,0
        324,,2
        14949,,0
        327,,2
        487,,0
        327,,3
        20,,0
        328,,2
        487,,0
        344,,2
        17247,,0
        350,,6
        771,,0
        376,,2
        19204,,0
        396,,2
        19380,,0
        424,,2
        4253,,0
        432,,1
        2229,,0
        434,,8
        16442,,0
        450,,6
        565,,0
        460,,0
        7251,,0
        461,,2
        12821,,0
        462,,2
        19930,,0
        465,,1
        17187,,0
        468,,3
        13099,,0
        472,,0
        15491,,0
        488,,4
        18762,,0
        489,,2
        19474,,0
        490,,6
        1746,,0
        495,,3
        18422,,0
        503,,3
        14404,,0
        505,,6
        18796,,0
        510,,7
        12191,,0
        519,,6
        18885,,0
        540,,2
        17123,,0
        541,,2
        17123,,0
        559,,2
        14804,,0
        561,,3
        1377,,0
        563,,8
        17227,,0
        565,,2
        16793,,0
        569,,2
        294,,0
        570,,2
        17502,,0
        573,,6
        19911,,0
        591,,6
        15652,,0
        592,,2
        16357,,0
        593,,2
        -1
        602,,2
        14915,,0
        613,,2
        16839,,0
        622,,7
        14542,,0
        628,,6
        18470,,0
        640,,6
        979,,0
        654,,6
        19263,,0
        654,,7
        4878,,0
        655,,5
        486,,0
        674,,2
        14268,,0
        677,,8
        18194,,0
        681,,2
        17757,,0
        684,,2
        305,,0
        691,,6
        10933,,0
        697,,2
        9717,,0
        699,,2
        15319,,0
        700,,6
        16274,,0
        701,,3
        4400,,0
        702,,0
        6463,,0
        742,,2
        19155,,0
        754,,5
        17987,,0
        767,,2
        268,,0
        771,,8
        1442,,0
        772,,2
        19814,,0
        784,,2
        98,,0
        785,,6
        13042,,0
        792,,6
        19474,,0
radix   ^d8
        707070707070

radix   ^d10
C6431:  21,,1
        17441,,0
        57,,3
        11066,,0
        89,,9
        5921,,0
        140,,5
        8146,,0
        165,,6
        5412,,0
        167,,5
        12224,,0
        189,,1
        18675,,0
        225,,9
        1467,,0
        250,,1
        5515,,0
        299,,3
        243,,0
        301,,1
        -1
        302,,1
        -1
        376,,5
        11163,,0
        378,,9
        1184,,0
        441,,5
        11898,,0
        442,,9
        1194,,0
        516,,2
        18125,,0
        543,,3
        17801,,0
        593,,2
        -1
        617,,3
        8108,,0
        688,,6
        11875,,0
        747,,0
        4055,,0
        765,,6
        18467,,0
        766,,6
        18467,,0
        767,,6
        18468,,0
        768,,6
        18468,,0
        770,,6
        18468,,0
        771,,6
        18469,,0
        773,,6
        18468,,0
        785,,6
        11239,,0
        820,,4
        4181,,0
        179,,1  ;additions to file that system found
        3
        583,,0
        1
        106,,8
        4
        690,,0
        2
radix   ^d8
        707070707070

radix   ^d10
C1877:  0,,1
        17771,,0
        2,,1
        17770,,0
        3,,1
        17766,,0
        4,,1
        17766,,0
        17,,1
        6602,,0
        44,,9
        14640,,0
        67,,7
        13223,,0
        91,,7
        3535,,0
        92,,7
        3534,,0
        151,,1
        12220,,0
        166,,3
        3029,,0
        183,,9
        18593,,0
        324,,3
        9896,,0
        327,,6
        272,,0
        365,,2
        3396,,0
        368,,2
        3406,,0
        369,,2
        3406,,0
        370,,2
        3406,,0
        371,,2
        3405,,0
        450,,2
        3535,,0
        482,,1
        9775,,0
        504,,3
        13164,,0
        523,,4
        1260,,0
        584,,1
        7486,,0
        647,,3
        17483,,0
        654,,1
        8703,,0
        665,,2
        4943,,0
        705,,6
        8863,,0
        773,,2
        19274,,0
        809,,1
        11820,,0
radix   ^d8
        707070707070

radix   ^d10
C6881:  12,,1
        4986,,0
        13,,1
        5010,,0
        17,,7
        1817,,0
        19,,8
        18529,,0
        22,,8
        18567,,0
        32,,8
        16330,,0
        34,,8
        6933,,0
        47,,8
        13643,,0
        49,,9
        12901,,0
        58,,9
        8685,,0
        61,,1
        5267,,0
        66,,8
        6655,,0
        68,,8
        13732,,0
        71,,5
        16555,,0
        79,,9
        2334,,0
        115,,8
        12976,,0
        120,,8
        17470,,0
        129,,5
        11937,,0
        139,,8
        13264,,0
        142,,8
        12041,,0
        143,,8
        13361,,0
        156,,9
        8488,,0
        167,,9
        7683,,0
        183,,8
        11522,,0
        183,,9
        11815,,0
        190,,9
        5880,,0
        193,,8
        18864,,0
        200,,8
        8125,,0
        205,,9
        9998,,0
        221,,9
        7305,,0
        236,,9
        13838,,0
        258,,9
        15152,,0
        267,,9
        8832,,0
        271,,9
        11655,,0
        291,,8
        13021,,0
        328,,3
        5943,,0
        329,,9
        7617,,0
        332,,7
        14719,,0
        333,,7
        14719,,0
        334,,7
        14719,,0
        335,,7
        14719,,0
        336,,7
        14719,,0
        337,,7
        14719,,0
        338,,7
        14719,,0
        338,,9
        12644,,0
        339,,9
        -1
        349,,9
        19147,,0
        354,,9
        9710,,0
        369,,9
        19545,,0
        374,,9
        7579,,0
        382,,9
        7114,,0
        383,,9
        8403,,0
        391,,1
        10695,,0
        391,,9
        12862,,0
        394,,3
        17046,,0
        395,,3
        17023,,0
        396,,9
        12546,,0
        403,,9
        11235,,0
        427,,9
        826,,0
        438,,9
        8187,,0
        440,,9
        5631,,0
        443,,9
        6957,,0
        450,,9
        19498,,0
        473,,9
        17171,,0
        479,,9
        11226,,0
        498,,9
        9981,,0
        506,,9
        17469,,0
        508,,9
        10929,,0
        509,,9
        19336,,0
        512,,8
        10125,,0
        512,,9
        19598,,0
        530,,9
        -1      
        537,,9
        -1
        548,,9
        6825,,0
        550,,9
        18543,,0
        552,,9
        10504,,0
        556,,9
        9048,,0
        563,,0
        -1
        569,,9
        10607,,0
        572,,9
        8291,,0
        578,,9
        11187,,0
        579,,9
        10580,,0
        584,,9
        7502,,0
        587,,9
        18784,,0
        589,,9
        10486,,0
        614,,9
        8117,,0
        616,,9
        8349,,0
        627,,9
        7559,,0
        641,,9
        8237,,0
        656,,9
        17251,,0
        658,,9
        11070,,0
        660,,3
        127,,0
        660,,9
        7218,,0
        661,,9
        9225,,0
        672,,9
        6447,,0
        677,,9
        6868,,0
        700,,1
        5418,,0
        706,,4
        1836,,0
        717,,9
        -1
        724,,9
        5382,,0
        734,,0
        12832,,0
        735,,0
        12831,,0
        757,,0
        2496,,0
        763,,9
        18808,,0
        767,,9
        6179,,0
        768,,9
        6847,,0
        773,,9
        -1
        784,,9
        9025,,0
        787,,9
        9415,,0
        796,,9
        9853,,0
        797,,9
        11102,,0
        809,,9
        15958,,0
        818,,9
        14218,,0
        819,,9
        17561,,0
radix   ^d8
        707070707070

radix   ^d10
C31347: 148,,9
        4979,,0
        154,,2
        6854,,0
        184,,6
        6795,,0
        184,,7
        7986,,0
        308,,3
        17348,,0
        321,,6
        1400,,0
        347,,3
        13932,,0
        368,,8
        13901,,0
        374,,7
        15475,,0
        378,,3
        3316,,0
        419,,8
        15681,,0
        443,,7
        3001,,0
        468,,7
        18347,,0
        482,,7
        7919,,0
        505,,5
        12134,,0
        513,,2
        10145,,0
        549,,2
        12842,,0
        550,,2
        12843,,0
        551,,8
        17971,,0
        554,,7
        14961,,0
        571,,2
        6712,,0
        584,,9
        18423,,0
        645,,7
        5839,,0
        656,,8
        19339,,0
        664,,5
        18396,,0
        737,,3
        4776,,0
        789,,7
        10491,,0
        790,,7
        10490,,0
radix   ^d8
        707070707070

radix   ^d10
C31324: 1,,1
        8356,,0
        67,,8
        17096,,0
        120,,0
        7181,,0
        150,,6
        18311,,0
        163,,7
        9133,,0
        302,,0
        14804,,0
        331,,0
        13599,,0
        368,,0
        10654,,0
        378,,4
        1420,,0
        478,,6
        11678,,0
        498,,7
        4867,,0
        544,,5
        5479,,0
        555,,3
        13008,,0
        673,,8
        -1
        674,,8
        -1
        694,,1
        17036,,0
        708,,0
        11372,,0
        774,,6
        16612,,0
        776,,1
        18831,,0
        787,,1
        19095,,0
        795,,0
        13071,,0
        804,,0
        1431,,0
radix   ^d8
        707070707070

;This is the end of the BATBLK data area.

        ;TO USE THIS ROUTINE, PUT INTO AC1 THE STARTING ADDRESS OF
        ;THE BAT BLOCK INFO. IT WILL PUT INTO BADADR UNTIL THE DELIMITER
        ;IS REACHED.

MOVBAT: PUSH    P,4
        PUSH    P,3
        PUSH    P,2
        PUSH    P,1
        MOVE    4,[BADADR,,BADADR+1]    ;LETS CLEAR BADADR TABLE
        SETZM   BADADR
        BLT     4,BADADR+1777           ;IT IS CLEARED
        MOVEI   3,0                     ;USED AS INDEX INTO BADADR
MOVCNT: MOVE    2,0(1)                  ;GET BAT BLOCK INFO
        CAMN    2,ENDBAT                ;IS THAT ALL
        JRST    [LSH    3,-1            ;A CHEAP DIVIDE
                 MOVEM  3,BADADR        ;SAVE THE COUNT
                 JRST   MOVEX]          ;GET OUT OF HERE
        MOVEM   2,BADADR+1(3)           ;NO STORE IT AWAY
        ADDI    3,1                     ;ADD 1 TO THE INDEX
        ADDI    1,1                     ;ADD 1 TO THE OTHER INDEX ALSO
        JRST    MOVCNT
MOVEX:  POP     P,1
        POP     P,2
        POP     P,3
        POP     P,4
        POPJ    P,
ENDBAT: 707070,,707070

SAVPRI: BLOCK   1000
SAVSEC: BLOCK   1000
SING:   0
DWRTPRO: -1
EXPTRP: 0
LSTPG:  0
RESEND: 200000
TRAPAD: 0
ALRDY:  0
ZEROES: 0
PHASEW: 0
ONES:   -1
WBUFERR: 0
RBUFERR: 0
FRONT:  707000007070
BACK:   070700000707
TOTCMP: 0
BUFST:  0                       ;ADDRESS OF BUFFER START
COUNT:  0
TPERR:  0
MORSTAT: 0
COMBINE: 0
MAXMEM: 777777
SUB:    777777
DSKCNT: 20000
MEMHLT: 0                       ;MEM ERR HLT FLAG
CEHLD:  0
ERRHALT: 0                      ;ERROR HALT FLAG
ZEROFLG: 0
DEBUG1: 0
DEBUG2: 0
clkflg: 0
retry:  20
BDCHP:  ASCIZ /<X>/
TYF:    ASCIZ /TYF> /
PRIMRY: -1
CLKBIT: 0
CLKGO:  0
PGFLG:  -1

;THIS IS THE START OF MASS CLEAR
BLKSTR:
skdis:  0
chp64k: 0
chp16k: 0
gdbat:  0
BYTCNT: 0
FBEND:  0
SPLGP2: 0
ddtknd: 0
ddtind: 0
numtry: 0
SEC0ST: 0
SEC1ST: 0
SEC2ST: 0
SEC3ST: 0
SEC4ST: 0
SEC5ST: 0
SEC6ST: 0
SEC7ST: 0
SEC8ST: 0
SEC9ST: 0
SEC10ST: 0
SEC11ST: 0
SEC12ST: 0
SEC13ST: 0
SEC14ST: 0
SEC15ST: 0
SEC16ST: 0
SEC17ST: 0
SEC18ST: 0
SEC19ST: 0
DESGP3: 0
kltype: 0
tenex:  0
ecctmp: 0
dareg:  0
mareg:  0
eccdat: 0
vatlg:  0
badcod: 0
tymout: 0
copy:   0
retcnt: 0
wtcnt:  0
verify: 0
slow:   0
scnadd: 0
addclr: 0
datclr: 0
ovrlap: 0
GOCNT:  0
INTCNT: 0
SKCNT:  0
SKFLG:  0
SPECSK: 0
temp1:  0
temp:   0
BUFHIT: 0               ;USED TO COUNT HOWMANY SCANNR HITS ON CUR. BUF.
SKIP:   0
SKIP1:  0               ;USED TO TELL SCANNR THAT THIS IS ACTIVE PAGE.
SKIP2:  0               ;SAME
SKIP3:  0               ;SAME
SKIP4:  0               ;SAME
SIZED:  0               ;USED AS A FLAG TO TELL EXER THAT MEMORY IS SIZED.
GOTBAT: 0
HLDADD: 0
PGDONE: 0
DRTYPE: 0
MRAP:   0
hrdent: 0
mer1:   0
mer2:   0
mer3:   0
patwrd: 0
RDWRD:  0
HRDINT: 0
SUPRESS: 0
tmpmin: 0
tmphr:  0
tmpsnd: 0
tmpdys: 0
DUP:    0
TMPTAB: BLOCK   1000
BATWRT: 0
newma:  0
maerr:  0
TMPSAV: BLOCK   10
battab: block   1000
tmpcyl: 0
tmphed: 0
tmpsec: 0
cnt:    0
DIAG:   0
silent: 0
PASSWD: 0
ERRDSK: 0
ONCE:   0
OPER:   0
TPCOUNT: 0
REWIND: 0
OFFLINE: 0
WRTPRO: 0
LDPT:   0
TAPRDY: 0
STREW:  0
EOT:    0
TNTCNT: 0
DNTCNT: 0
SINGLET: 0
T1RDER: 0
T1WRER: 0
T1PASS: 0
T1CPER: 0
T2RDER: 0
T2WRER: 0
T2PASS: 0
T2CPER: 0
T3RDER: 0
T3WRER: 0
T3PASS: 0
T3CPER: 0
T4RDER: 0
T4WRER: 0
T4PASS: 0
T4CPER: 0
T5RDER: 0
T5WRER: 0
T5PASS: 0
T5CPER: 0
T6RDER: 0
T6WRER: 0
T6PASS: 0
T6CPER: 0
T7RDER: 0
T7WRER: 0
T7PASS: 0
T7CPER: 0
RAPS:   0
DEVICE: 0
BLKEND: 0
;THIS IS THE END OF MASS CLEAR

T8DAT1: 776003,,770017
T8DAT2: 740077,,600377
T8WBUF: BLOCK   50
T8CNT:  50

SAVEIT: -100,,SAVEIT+1          ;REMEMBER NOT TO PUT ANYTHING
        BLOCK   77              ;I HOPE THIS IS ENOUGH
        END     INIT


   #+M