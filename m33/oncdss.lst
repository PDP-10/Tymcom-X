ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 1
S.MAC	 6-JUL-89 16:37		S.MAC - with system parameter file for P035/E, March 1989

     1				SUBTTL	S.MAC - with system parameter file for P035/E, March 1989
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KS-10 PARAMETER FILE - KSSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KSSYM.MAC IN COMMON ONLY
     7					.CREF
     8									TAPE>>
     9				; This file is PRINTF.MAC
    10				DEFINE PRINTF(A,B,C,D),<IF2,<;;Output message on MONKS build only
    11				PRINTX A B C D>>
    12
    13				TITLE	ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE
    14
    15				;*;	STOPCD(,ENTRY,ONCDSK)	;Macro is expanded after the PHASE statement
    16
    17				INTERN FILOPT,FILMAN,TYPONL,ONDSTT,ONDLNP,ONDLNR
    18				INTERN MIN,MAX,LNGMES,DECLOP,CMDSCN,CMDSCF,ASKQMM,OPAGIN,OPAGOT
    19				INTERN GETHOM,WTBOTH,GETBAT
    20
    21				;CONMES = output ASCIZ string, addr in T1
    22				;TYPDEC = output P1 as decimal
    23				;CRLF   = output CRLF
    24				;DECLOP = save ACs, message in T1, TYPDEC, CRFLOP
    25				;ASKQUE = save ACs, then YESNO
    26				;YESNO  = output string, get response, skip if "Y"
    27				;CONOUT = CONMES + CRLFOP
    28				;CRLFOP = CRLF + OPOUT
    29				;OPOUT  = output buffer, can be suppressed by ^O or ^C
    30				;OCONM  = cancel ^O suppression, then CONMES
    31
    32				EXTERN BATCNT,BATPAT,HOMSUF,PRT22A,UNICHR,UNYBPR,UNYBPT,UNYBPY
    33				EXTERN CONMES,CRLF,CTEXT,DECIN,GETLIN,OCONM,OCTIN,OPOUT,DSKDDB
    34				EXTERN CORZER,SCNBAT,STTPTR,UNTTBL,STTFPC,UNTLEN
    35				EXTERN STTLEN,SATCNT,UFDHSI
    36				EXTERN NMRBPC,CPOPJ,CPOPJ1,MFDRIB
    37				EXTERN %HOM.P,%BAT.P,%STR.P,%STA.P
    38				EXTERN COMTYO,BRMAX,INLMES,NMSTPC
    39				EXTERN CLRSND,PRNAME,RADX10,TPOPJ,CMPLOG
    40				EXTERN PAGIN,PAGOUT,PCISTS,PGYUNI,PGYPNO,STDREA,PGYERR,OHTNUM,OHTINI
    41				EXTERN PCBPAG,PAKREF,STDWRT,GETPEV
    42				EXTERN BATFIR,BATREG,BAYNBB,BATNBB,BATELB,PAGCOD,PAGNAM,PAGSLF
    43				EXTERN CODBAT,CODHOM,CODRIB,DDBLEN,DDSTAR,ONCDDB
    44				EXTERN ICPFAC,JFYSEC,KONDWN,KONUPA,KOPDWN,KONLTM,KONCPY
    45				EXTERN LPNHOM,LP2HOM,LPNBAT,LP2BAT,SYSUNI,SYSSIZ,EVASIZ
    46				EXTERN REFRSH,SAVE4,SETDDO,IOSEL,CCOD,CWCOD,CLRDDB,YESNO
    47
    48				EXTERN HOMEND,HOMDAT,HOMMFD,HOMHSH,HOMRAN
    49				EXTERN HOMHID,HOMP4C,HOMLOG,HOMLUN,HOMNXT,HOMOVR
    50				EXTERN HOMPRV,HOMREF,HOMSNM,HOMSPU,HOMSAT,HOMFEP
    51
    52				EXTERN RIBLST,RIBPFS,RIBNAM,RIBEXT,RBSPAR,RBREAL,RBINDX,RBMASK
    53				EXTERN RBYUNI,RBYPNO,RBYUN4,RBYUN1,RBLVPR,RBLVSP
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 1
ONCDSK.MAC	14-APR-88 23:38		S.MAC - with system parameter file for P035/E, March 1989

    54
    55				EXTERN STRDDB,STRLEN,SRPNDS
    56				EXTERN STRNAM,STRHSH,STRUNI,STRP4C,STRNXT,STRUNM,STRREF
    57				EXTERN STROVR,STRTAL,STRPPU,STRPID,STRBTS,STRSID
    58
    59				EXTERN UNIPPU,UNIDES,UNIERR,UNIHID,UNISYS,UNIFEP
    60				EXTERN UNINAM,UNISTT,UNISTR
    61				EXTERN UNITAL,UNPCHG,UNPHWP,UNPMSB,UNPOFL,UNVRSF
    62				EXTERN UNYLN1,UNYLUN,UNYSPU,UNIONC
    63				EXTERN UNIKON,UNILOG,UNICHN,UNPPRV,UNISTS
    64
    65				EXTERN DCN,STRPID,REPSID,RE.DCD,HOMDCT,HOMDCV
    66
    67				EXTERN CH7
    68				ENTRY ONCMOD
    69
    70	000000'			ONCMOD:
    71
    72	757000			ONDSTT:	PHASE %OND
    73					STOPCD(,ENTRY,ONCDSK)^
    74					ENTRY	ONCDSK		;For library searches
    75	000000'	260040	000000*	ONCDSK::PUSHJ	P,DIE		;**** Default stopcode for "ONCDSK" ****
    76	000001'	575643	446353		SIXBIT	/ONCDSK/  	;Title of module
    77	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "ONCDSK+nnn(nnnnnn)"
    78			757000	S$NAME==ONCDSK			;For STOPCDs with no arguments
    79					SALL>
    80				^	;Default for NONAME stopcodes
    81		777777	021000'		%D==ONDSTT-ONCDSK	;To look at LABEL, use LABEL+%D
    82
    83				;MACRO TO DEFINE ONCE RESTART SYMBOLS AND BYTE POINTERS
    84				;
    85				DEFINE DCNDEF (DCD)<
    86				  INTERN  REONCE
    87					REONCE:	0
    88					DCNUM==0
    89					IRP DCD, <DCNUM==DCNUM+1>
    90					DCNTAB:
    91					DCXX==0
    92					IRP DCD, <DCN.'DCD==(1B<DCXX>)
    93						  DCNY'DCD: POINT DCSIZ,DCN,35-DCSIZ*<DCNUM-1-DCXX>
    94						  Intern DCN.'DCD,DCNY'DCD
    95						  DCXX==DCXX+1>
    96				>
    97			000003	DCSIZ==DC.SIZ			;(FROM S).
    98	000003'	000000	000000	DCNDEF (<OP,ON,UR,MN,HM,DF>)
    99	000004'	170300	000000*
   100	000005'	140300	000004*
   101	000006'	110300	000005*
   102	000007'	060300	000006*
   103	000010'	030300	000007*
   104	000011'	000300	000010*
   105					;DSKCLN TYPE CAN BE SPECIFIED BY:
   106								; 'OP' - OPER in ONCE (FULL COMMAND)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 1-2
ONCDSK.MAC	14-APR-88 23:38		S.MAC - with system parameter file for P035/E, March 1989

   107								; 'ON' - OPER IN ONCDSK
   108								; 'UR' - USER PROG VIA .REST SETUUO
   109								; 'MN' - MONITOR IN CRASH CODE
   110								; 'HM' - HOME BLOCKS
   111								; 'DF' - DEFAULT
   112				INTERN DCNDFT			;IN THAT ORDER OF PRIORITY
   113			030000	DCNDFT==DCN.HM!DCN.DF		; SETUP DEFAULT TO HOME-BLOCKS ! DEFAULT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   114				SUBTTL	FILMAN
   115
   116	000012'	476000	761743	FILMAN:	SETOM	BATMAN		;MANDATORY CODE.
   117	000013'	260040	760556		PUSHJ	P,RDHOME	;READ HOME PAGES OF ALL UNITS.
   118	000014'	254000	757027		  JRST	MANOK		;ALL OK.
   119	000015'	254000	757024		  JRST	MANQST		;MINOR ERRORS.
   120					MOVEI	T1,[ASCIZ /
   121	000016'	201300	763275	ERRORS which prevent bringing the system UP/]
   122	000017'	260040	000000*	MANCM1:	PUSHJ	P,CONMES
   123	000020'	260040	757312	MANCOM:	PUSHJ	P,FILOPT
   124	000021'	254000	757012		JRST	FILMAN
   125
   126				MANREF:	MOVEI	T1,[ASCIZ /
   127	000022'	201300	763307	File structure NEEDS refreshing/]
   128	000023'	254000	757017		JRST	MANCM1
   129
   130				MANQST:	MOVEI	T1,[ASCIZ /
   131	000024'	201300	763316	MINOR ERRORS - Bring system UP anyway? /]
   132	000025'	260040	761622		PUSHJ	P,ASKQUE
   133	000026'	254000	757020		  JRST	MANCOM		;NO.
   134	000027'	260040	761676	MANOK:	PUSHJ	P,REDBAT	;READ THE BAT PAGES OF ALL UNITS.
   135	000030'	510300	000000*		HLLZ	T1,STRREF+STRDDB
   136	000031'	326300	757022		JUMPN	T1,MANREF	;NEEDS REFRESH.
   137	000032'	201300	000000*		MOVEI	T1,SRPREF##
   138	000033'	616300	000000*		TDNN	T1,STRBTS+STRDDB;Was REFSTR called on this STR?
   139	000034'	402000	000000*		 SETZM	REFLAG##	;No, ignore setting REFLAG from DDT
   140
   141				;HERE TO REWRITE HOME PAGES, WITH INCREMENTED PACK SET ID.
   142
   143	000035'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   144	000036'	350300	761230		AOS	T1,RANHOM	; Increment save'd copy of HOMRAN
   145	000037'	607300	777777		TLNN	T1,-1
   146	000040'	254000	757043		 JRST	MANOK1
   147	000041'	201300	434164		MOVEI	T1,(SIXBIT/CAT/)	;
   148	000042'	552300	761230		HRRZM	T1,RANHOM	; If zero - save sixbit CAT
   149	000043'	506300	000000*	MANOK1:	HRLM	T1,STRDDB+STRPID
   150	000044'	260040	762707		PUSHJ	P,UPDHOM	;
   151	000045'	554245	000000*		HLRZ	U,UNISTR(U)	;Update HOM pages on all units in STR
   152	000046'	326240	757044		JUMPN	U,.-2		;
   153	000047'	260040	762670		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
   154	000050'	302400	000005		CAIE	T3,^L<(DCN.DF)>	;IS MODE DEFAULT
   155	000051'	254000	757056		 JRST	MANOK2		;NO, DON'T QUERY OPER FOR MODE
   156	000052'	201700	000000*		MOVEI	P3,DCFAST##	;Default to FAST instead of asking OPR
   157	000053'	200300	000000*		MOVE	T1,STRDDB+STRBTS;DOES STR REQUIRE
   158	000054'	602300	000000*		TRNE	T1,SRPNDS	; DSKCLN TO BE RUN
   159				;*;	 PUSHJ	P,SPCDKN	;YES, ASK OPER TO SELECT MODE
   160	000055'	137700	757005		 DPB	P3,DCNYON	;Yes, do fast DSKCLN (trust HOM page for FULL)
   161	000056'	135300	757005	MANOK2:	LDB	T1,DCNYON	;GET MODE
   162	000057'	202300	000011*		MOVEM	T1,DCN		; AND SAVE IT FOR DSKCLN TO GETTAB
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 3
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   163				;HERE TO READ THE RIB FOR SAT.SYS AND SET UP THE STTPTR
   164				;ENTRIES IN STT.
   165
   166	000060'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;GET THE PRIME (AND ONLY)
   167	000061'	260040	757177		PUSHJ	P,GETSRB	;RIB INTO %STR.
   168	000062'	256000	757000		 STOPCD
   169	000063'	135300	763327		LDB	T1,[POINT 14,%STR+RIBEXT,35] ;Access date of SAT.SYS
   170	000064'	550340	000000*		HRRZ	T2,THSDAT##	;Current date (if any)
   171	000065'	317300	000007		CAMG	T1,T2		;Get larger into T1
   172	000066'	200300	000007		 MOVE	T1,T2
   173	000067'	542300	000064*		HRRM	T1,THSDAT##	;Store so COPYCRASH had a reasonable date
   174	000070'	201740	000000*		MOVEI	P4,RIBPFS	;P4/ REL ADDR OF RETRIEVAL POINTERS.
   175	000071'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   176
   177				      ;HERE FOR EACH UNIT.
   178	000072'	135440	000000*	RDRBS2:	LDB	T4,UNYLUN	;
   179	000073'	550645	000000*		HRRZ	P2,UNISTT(U)	;P2/ STT ENTRY ADDRESS.
   180	000074'	135700	000000*		LDB	P3,UNYSPU	;P3/ # SATS ON THE UNIT.
   181
   182				      ;HERE FOR EACH SAT.
   183	000075'	307740	000000*	RDRBS3:	CAIG	P4,RIBLST	;MUSTN'T RUN OUT OF RIB ROOM.
   184	000076'	336317	746000		SKIPN	T1,%STR(P4)	;NOT EXPECTING EOF HERE.
   185	000077'	256000	757000		 STOPCD
   186	000100'	607300	000000*		TLNN	T1,RBSPAR!RBINDX ;CHECK THAT THE POINTER IN T1
   187	000101'	607300	000000*		TLNN	T1,RBREAL	;IS A CORRECT POINTER.
   188	000102'	256000	757000		 STOPCD
   189	000103'	135400	000000*		LDB	T3,RBYUN1	;IS THIS THE UNIT
   190	000104'	312400	000011		CAME	T3,T4		;THAT WE EXPECT TO SEE?
   191	000105'	256000	757000		 STOPCD
   192	000106'	621300	000000*		TLZ	T1,RBMASK-RBREAL ;
   193	000107'	202315	000000*		MOVEM	T1,STTPTR(P2)	;YES.  SET STTPTR.
   194	000110'	271740	000001		ADDI	P4,1		;INC PNTR TO PNTRS.
   195	000111'	271640	000000*		ADDI	P2,STTLEN	;ADJUST P2 TO NEXT STT ENTRY.
   196	000112'	367700	757075		SOJG	P3,RDRBS3	;LOOP AGAIN IF MORE SATS ON THIS UNIT.
   197	000113'	402015	000107*		SETZM	STTPTR(P2)	;
   198
   199	000114'	554245	000045*		HLRZ	U,UNISTR(U)	;IS THERE ANOTHER
   200	000115'	326240	757072		JUMPN	U,RDRBS2	;UNIT?
   201	000116'	332017	746000		SKIPE	%STR(P4)	;NO.  CHECK THAT EOF IS PRESENT.
   202	000117'	256000	757000		 STOPCD
   203					PFALL	RDSATS
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 4
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   204				;NOW READ ALL THE SATS ON EACH UNIT IN THE STR, AND SET STTFPC
   205				;IN THE SATS.
   206
   207	000120'	402000	000000*	RDSATS:	SETZM	STRDDB+STRTAL	;CLEAR THE TOTAL COUNT FOR THE STR.
   208	000121'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;
   209	000122'	550705	000073*	RDSTS1:	HRRZ	P3,UNISTT(U)	;P3/PNTR INTO STT FOR THIS UNIT.
   210	000123'	336356	000113*	RDSTS4:	SKIPN	T2,STTPTR(P3)	;OUT OF SATS ON THIS UNIT?
   211	000124'	254000	757153		 JRST	RDSTS5		;YES, GO TO NEXT UNIT.
   212	000125'	135440	000000*		LDB	T4,RBYPNO	;SAT
   213	000126'	201140	000000*		MOVEI	PG,%STA.P	;INTO
   214	000127'	260040	761520		PUSHJ	P,OPAGIN	;%STA.
   215	000130'	254000	757132		  JRST	.+2		;ERROR ON READ.
   216	000131'	254000	757135		 JRST	RDST45		;READ OKAY.
   217	000132'	402000	747000		SETZM	%STA		;PRETEND ALL F BITS IN USE,
   218	000133'	200300	763330		MOVE	T1,[XWD %STA,%STA+1] ;AND LET
   219	000134'	251300	747377		BLT	T1,%STA+377	;DSKCLN WORRY.
   220	000135'	476000	747400	RDST45:	SETOM	%STA+400	;SET ALL THE
   221	000136'	200300	763331		MOVE	T1,[XWD %STA+400,%STA+401] ;M BITS
   222	000137'	251300	747777		BLT	T1,%STA+777	;FREE.
   223	000140'	200300	763332		MOVE	T1,[XWD -400,%STA] ;AOBJN PNTR FOR SATCNT.
   224	000141'	260040	000000*		PUSHJ	P,SATCNT	;T4/ NO. FREE PAGES IN THIS SAT.
   225	000142'	202456	000000*		MOVEM	T4,STTFPC(P3)	;
   226	000143'	272445	000000*		ADDM	T4,UNITAL(U)	;
   227	000144'	200356	000123*		MOVE	T2,STTPTR(P3)	;WRITE  OUT THE SAT
   228	000145'	135440	000125*		LDB	T4,RBYPNO	;SO THE CLEARED M BITS
   229	000146'	201140	000126*		MOVEI	PG,%STA.P	;GET
   230	000147'	260040	761523		PUSHJ	P,OPAGOT	;OUT THERE.
   231	000150'	256000	757000		 STOPCD
   232	000151'	271700	000111*		ADDI	P3,STTLEN	;ADJUST PNTR TO STT.
   233	000152'	254000	757123		JRST	RDSTS4
   234
   235				    ;COMPUTE SAFETY FACTOR FOR UNIT AND ADJUST STRTAL.
   236	000153'	200305	000000*	RDSTS5:	MOVE	T1,UNIPPU(U)	;COMPUTE THE SAFETY FACTOR FOR
   237	000154'	231300	000000*		IDIVI	T1,UNVRSF	;THE UNIT.
   238	000155'	135340	000074*		LDB	T2,UNYSPU	;
   239	000156'	221307	000000		IMULI	T1,(T2)		;
   240	000157'	213000	000006		MOVNS	T1		;
   241	000160'	273305	000143*		ADDB	T1,UNITAL(U)	;ADD TO UNIT'S COUNT.
   242	000161'	325300	757164		JUMPGE	T1,.+3		;DO NOT ALLOW
   243	000162'	402005	000160*		SETZM	UNITAL(U)	;UNITAL TO GO
   244	000163'	254000	757165		JRST	RDSTS6		;NEGATIVE.
   245	000164'	272300	000000*		ADDM	T1,STRDDB+STRTAL ;ADJUST STRTAL.
   246
   247	000165'	554245	000114*	RDSTS6:	HLRZ	U,UNISTR(U)	;
   248	000166'	326240	757122		JUMPN	U,RDSTS1	;
   249
   250				;The calculation of PROT and PROT0 based on disk type is not valid in the                      
   251				                i
   252				;paging monitor.  The code that was deleted here produced garbage for PROT0
   253				;on the F3 as a result of dividing by zero.  The values are now set in COMMON
   254				;based on IFCPU(<KI,KL>),<PROT0:2> and IFNCPU(<KI,KL>),<PROT0:4>.
   255
   256	000167'	205300	000000*		MOVSI	T1,UNPCHG
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 4-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   257	000170'	554240	000000*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
   258	000171'	412305	000000*		ANDCAM	T1,UNIDES(U)	;CLEAR CHANGE BIT
   259	000172'	554245	000000*		HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
   260	000173'	326240	757171		JUMPN	U,.-2		;REPEAT IF ANY LEFT
   261	000174'	332200	000000*		SKIPE	F,DDSTAR	;IF A DDB SETUP
   262	000175'	260040	000000*		PUSHJ	P,CLRDDB	;THEN CLEAR IT.
   263	000176'	263040	000000		POPJ	P,		;NO - RETURN
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 5
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   264				COMMENT #
   265				@@SUBROUTINE GETSRB
   266				@@PURPOSE
   267				SUBR TO READ THE RIB BLOCK FOR SAT.SYS INTO %STR.
   268				@@ENTRY
   269				EXPECTS U/ UNIT DB AND F/ DDB.
   270				@@ACCUM
   271				DESTROYS
   272				@@CALLS
   273				RDCHEK.
   274				@@EXIT
   275				SKIP RETURNS IF THE PAGE READ SUCCESSFULLY.
   276				@@ #
   277
   278
   279	000177'	260040	761354	GETSRB:	PUSHJ	P,GETHOM	;Read in HOM page for DSKB0
   280	000200'	263040	000000		  POPJ	P,		;Can't read it
   281	000201'	337440	751000*		SKIPG	T4,%HOM+HOMSAT	;Get logical page number for RIB for SAT.SYS
   282	000202'	263040	000000		 POPJ	P,		;Should be LPNSAT, not zero!
   283	000203'	201700	000000*		MOVEI	P3,CODRIB	;GET CODE WORD FOR RIB PAGES.
   284	000204'	205640	634164		MOVSI	P2,(SIXBIT .SAT.)
   285	000205'	201140	000000*		MOVEI	PG,%STR.P	;
   286	000206'	476000	761516		SETOM	WHICH		;INDICATE READING FIRST (AND
   287	000207'	402000	761517		SETZM	NOERH		;ONLY) PAGE.
   288	000210'	324740	761407		PJRST	RDCHEK		;READ & VERIFY RIB PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 6
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   289				;SOME MACROS FOR COMMAND WORK
   290
   291					DEFINE SCAN (A,B) <
   292				IFB <B>,<
   293				PRINTX	SCANNER TABLE 'A' Has an undefined SETxM statement
   294				>
   295					MOVEI	P1,SCN'A		; Get address of Scan Table
   296					SET'B'M	CMDSCF			; Specify NO STR/UNIT stuff
   297					PUSHJ	P,CMDSCN		; Call Scanning routine
   298					  JRST	HLP'A			; No good!
   299					XCT DSP'A'(P3)			; Yes?
   300					JRST	A'CMD			; Return as if cr typed.
   301				
   302				A'HLP:	Move	P3,-2(P1)		; Setup AOBJN pointer for messages
   303				A'HL1:	Hrrz	T1,(P3)			; Get address of message
   304					Pushj	P,LNGMES		; Print a long message
   305					Aobjn	P3,A'HL1		; Next?
   306					Jrst	A'CMD			; Return.
   307				>
   308
   309				;MACRO TO MAKE SCAN TABLE
   310				;UNI IS PLACE TO JRST TO IF UNIT
   311				;STR IS PLACE TO JRST TO IF STR
   312				;NAM IS TABLE NAME  Generates SCN'NAM, DSP'NAM, TXT'NAM, SIZ'NAM
   313				; Assumes MK'NAM as the macro defining the X arguments
   314				; JRST to NUL'NAM on <CR> and HLP'NAM on error
   315				; Defines NAM'HLP for a standard typeout of help texts
   316
   317					Extern Ab.Ack,Ab.Nak,Ab.Ver,Ab.Tcv,Ab.Cvr ; Bits - See ONCE.MAC
   318					DEFINE SCNTB (UNI,STR,NAM) <
   319				
   320					DEFINE X(SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   321					INS>	;INSTRUCTION TO EXECUTE
   322				
   323					JRST UNI		;FOR -3 RETURN
   324					JRST STR		;FOR -2 RETURN
   325					JRST NUL'NAM		;FOR -1 RETURN
   326				DSP'NAM: MK'NAM			;GENERATE DISPATCH TABLE
   327					SIZ'NAM==.-DSP'NAM
   328					-SIZ'NAM,,TXT'NAM	;AOBJN POINTER TO HELP
   329					-SIZ'NAM,,SCN'NAM	;AOBJN POINTER TO NAMES
   330					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   331				<	<SIXBIT /SYM/>>
   332				SCN'NAM: MK'NAM			; Define Table to read
   333				
   334					$XZ==0			; Need a counter
   335					define xz$(argh)<lit$'argh==.>
   336					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   337				<	xz$(\$XZ)
   338				Ifnb <TEXT>,<ASCIZ \TEXT'TEXT1'TEXT2'TEXT3\>
   339					$XZ==$XZ+1>
   340					MK'NAM
   341				
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 6-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   342					$XZ==0
   343					define xz$(argh)<lit$'argh>
   344					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   345					<Xwd	Bit,xz$(\$XZ)>
   346					$XZ==$XZ+1>
   347				TXT'NAM: MK'NAM
   348				
   349				 350
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 7
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   351				;P1 IS A POINTER TO THE NAMES TABLE
   352				;The command scanning routine - Copied and munged from ONCDSK
   353
   354	000211'	260040	762571	CMDSCN:	PUSHJ	P,SETRAN	; Start number generator on any question.
   355	000212'	260040	000000*		PUSHJ	P,CTEXT		; Get text (up to 6 chars) in T2
   356	000213'	260040	762574		PUSHJ	P,GETRAN	; Stop generator (KI,F3) and get number
   357					 JUMPE	T2,[CAIL T3,40	;  EOL?
   358						    POPJ P,	;NOT NULL LINE, SPC CHR
   359						    MOVNI P3,1	;RETURN P3=-1 FOR NULL STRING
   360	000214'	322340	763333			    JRST CPOPJ1]
   361	000215'	200300	000007		MOVE	T1,T2		;GET TEXT IN T1
   362	000216'	336000	757307		SKIPN	CMDSCF		; Skip IF we want to do UNI/STR stuff
   363	000217'	254000	757227		  Jrst	CMDSC1		; NO!  Don't Bother.
   364	000220'	202240	757311		MOVEM	U,SVU
   365	000221'	260040	761260		PUSHJ	P,FNDSTR	;IS IT A STR?
   366					JRST	[MOVNI P3,2	;-2 FOR STR WITH P2 TO STR BLOCK
   367	000222'	254000	763337			 JRST CPOPJ1]
   368	000223'	260040	761651		PUSHJ	P,FNDUNI	;CHECK ON UNIT
   369	000224'	334000	000000		  SKIPA			;NO
   370					JRST	[MOVNI P3,3	;-3 WITH U POINTING TO UNIT BLOCK
   371	000225'	254000	763341			 JRST CPOPJ1]
   372	000226'	200240	757311		MOVE	U,SVU
   373	000227'	200654	777776	CMDSC1:	MOVE	P2,-2(P1)	;GET AOBJN POINTER TO HELP TABLE
   374	000230'	200714	777777		MOVE	P3,-1(P1)	;GET AOBJN POINTER TO NAME TABLE
   375	000231'	201740	000000		MOVEI	P4,0		;NOTHING SEEN SO FAR
   376	000232'	205400	770000		MOVSI	T3,770000	;MAKE A MASK
   377	000233'	612300	000010	CMDSC2:	TDNE	T1,T3		; Did we type something?
   378	000234'	670300	000010		TDO	T1,T3		; If something there, set mask bits
   379	000235'	242400	777772		LSH	T3,-6		; Shift
   380	000236'	326400	757233		  JUMPN	T3,CMDSC2	; While we have more to check...
   381	000237'	316356	000000	CMDSC3:	CAMN	T2,(P3)		; Compare !
   382	000240'	254000	757256		  JRST	CMDSC5		; Exact match
   383	000241'	200415	000000		Move	T3,(P2)		; Get Bits,,Text-Adr
   384	000242'	603400	000000*		TLNE	T3,AB.NAK	; See if we can abbreviate it
   385	000243'	254000	757252		  JRST	CMDSC4		; No! -- Don't bother
   386	000244'	200416	000000		MOVE	T3,(P3)		;NO - CHECK MORE
   387	000245'	404400	000006		AND	T3,T1		;MASK OUT UN-TYPED STUFF
   388	000246'	312400	000007		CAME	T3,T2		;CHECK AFTER MASK
   389	000247'	254000	757252		  JRST	CMDSC4		;NO
   390					JUMPN	P4,[MOVEI P4,1	;SET POSITIVE FOR MULTI MATCH
   391	000250'	326740	763343			    JRST   CMDSC4]
   392	000251'	200740	000016		MOVE	P4,P3		;SAVE MATCH
   393	000252'	340640	000000	CMDSC4:	AOJ	P2,		; Increment text pointer
   394	000253'	253700	757237		AOBJN	P3,CMDSC3	; Loop through the table
   395	000254'	331700	000017		SKIPL	P3,P4		;ANY MASKED MATCHES
   396	000255'	263040	000000		  POPJ	P,		;NONE OR MORE THAN 1
   397	000256'	274700	000014	CMDSC5:	SUB	P3,P1		;CONVERT TO RELATIVE INDEX
   398	000257'	550654	777776		HRRZ	P2,-2(P1)	; Get AOBJN Pointer for
   399	000260'	270640	000016		ADD	P2,P3		; Add offset
   400	000261'	200655	000000		MOVE	P2,(P2)		; Get Bits,,Text-Addr
   401	000262'	332000	757306		SKIPE	CMDMSG		; See if debugging?
   402	000263'	254000	000000*		 JRST	CPOPJ1		;  Yes!  Don't bother to verify!
   403	000264'	607640	000000*		TLNN	P2,AB.VER	; Should we Verify?
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 7-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   404	000265'	254000	000263*		 JRST	CPOPJ1		; No! Just Return "SAFE"
   405	000266'	607640	000000*		TLNN	P2,AB.CVR	; Ignore verify for CONSOLE?
   406	000267'	304000	000000		 CAIA			; No.. Don't bother to check!
   407	000270'	336000	000000*		SKIPN	CTYDO##		;  Setup for CTY?
   408	000271'	304000	000000		 CAIA			; No.. Keep going!
   409	000272'	254000	000265*		  JRST	CPOPJ1		; YES! Don't verify.
   410	000273'	607640	000000*		TLNN	P2,AB.TCV	; Is it a TYPE/CHANGE item?
   411	000274'	304000	000000		 CAIA			; No.. Don't worry!
   412	000275'	331000	762112		SKIPL	TYPONL		;  Type ONLY?
   413	000276'	304000	000000		 CAIA			; No.. Keep going!
   414	000277'	254000	000272*		  JRST	CPOPJ1		; YES! Don't verify.
   415	000300'	550300	000015		HRRZ	T1,P2		; Get Text Address
   416	000301'	260040	760544		PUSHJ	P,LNGMES	; No -- Type it out.
   417					MOVEI	T1,[ASCIZ\
   418				
   419	000302'	201300	763345	Are you SURE you want to do this? \]
   420	000303'	260040	000000*		PUSHJ	P,YESNO		; A "Y" will skip, else assume NO.
   421	000304'	211700	000001		  MOVNI P3,1		; Set for null-command return
   422	000305'	254000	000277*		JRST	CPOPJ1		; Always skip return.
   423
   424
   425	000306'	000000	000000	CMDMSG:	0			; Debugging flag. 0=Type long messages.
   426	000307'	000000	000000	CMDSCF:	0			; Flag for checking UNI/STR Stuff
   427								; 0==No checking, -1==Check!
   428	000310'	000000	000000	SVP2:	0
   429	000311'	000000	000000	SVU:	0
   430
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   431				;Here from the FILES command in ONCE
   432				FILOPT:	MOVEI	T1,[ASCIZ /
   433				Entering the FILES dialogue...
   434	000312'	201300	763355	  Type "GO" to return to ONCE./]
   435	000313'	260040	761617		PUSHJ	P,CONOUT
   436	000314'	402000	761743		SETZM	BATMAN
   437	000315'	402000	000000*	        SETZM	EVASIZ		;ENSURE EVMINI GETS CALLED IN EVMALC
   438	000316'	260040	760556		PUSHJ	P,RDHOME
   439	000317'	255000	000000		 JFCL
   440	000320'	255000	000000		 JFCL
   441	000321'	260040	761676		PUSHJ	P,REDBAT	;READ BAT PAGES.
   442
   443				HLPFIL:	MOVEI T1,[ASCIZ /
   444				  Type "HELP" for a list of options.
   445	000322'	201300	763372	/]
   446	000323'	260040	000000*	HLPTY1:	PUSHJ P,OCONM
   447	000324'	260040	000000*		PUSHJ P,OPOUT
   448
   449	757325			TYPCMD:
   450	757325			CHGCMD:
   451	757325			SRPCMD:
   452	757325			NULFIL:
   453				FILCMD:	MOVEI T1,[ASCIZ /
   454	000325'	201300	763403	FILES* /]
   455	000326'	260040	000323*		PUSHJ P,OCONM
   456	000327'	260040	000324*		PUSHJ P,OPOUT
   457	000330'	476000	762115		SETOM KNOUNI
   458	000331'	476000	762110		SETOM DBLSTD
   459	000332'	260040	000000*		PUSHJ P,GETLIN
   460	000333'	254000	757325		 JRST FILCMD	;NOTHING THERE
   461	000334'	201600	757371		SCAN (FIL,Z)
   462	000335'	402000	757307
   463	000336'	260040	757211
   464	000337'	254000	757322
   465	000340'	256016	757352
   466	000341'	254000	757325
   467	000342'	200714	777776
   468	000343'	550316	000000
   469	000344'	260040	760544
   470	000345'	253700	757343
   471	000346'	254000	757325
   472
   473					DEFINE MKFIL <
   474					X DSKCLN,<PUSHJ P,SPCDKN>,Ab.Nak!Ab.Ver,<
   475				DSKCLN  Query or Select DSKCLN mode.
   476				        List the current mode and allow the operator to change it.>
   477					X TYPE,<JRST TYPIT>,Ab.Ack,<
   478				TYPE    List information about the structure.
   479				        Type "TYPE HELP" for a list of options.>
   480					X CHANGE,<JRST CHGIT>,Ab.Ack,<
   481				CHANGE  Change information about the structure.
   482				        Type "CHANGE HELP" for a list of options.>
   483					X ADD,<PUSHJ P,ADDUNI>,Ab.Nak!Ab.Ver,<
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   484				ADD     Add a unit to the structure.
   485				        Reconfigure the disk structure and add another pack.>
   486					X DISOLVE,<JRST BADDIS>,Ab.Nak,<.>
   487					X DISSOLVE,<PUSHJ P,STSDSL>,Ab.Nak!Ab.Ver,<
   488				DISSOLVE Dissolve the disk structure for DSKB.
   489				        Remove all units from the system structure.>
   490					X DEFINE,<PUSHJ P,STSDEF>,Ab.Nak!Ab.Ver,<
   491				DEFINE  Define a NEW structure for DSKB.
   492				        Create a completely new system structure.>
   493					X REFRESH,<PUSHJ P,STSREF>,Ab.Nak!Ab.Ver,<
   494				REFRESH Refresh the structure.
   495				        Delete all files on the system and start over
   496				        with a "FRESH" disk.>
   497					X DDT,<PUSHJ P,DDTX##>,AB.ACK!AB.VER,<
   498				DDT     Enter executive DDT.  To be used ONLY by software wizards
   499				        for emergency patching and examination of the monitor.>,<
   500				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   501					X TSTSUP,<PUSHJ P,TSTSUP##>,AB.ACK!AB.VER,<
   502				TSTSUP  Disk patching routine.  To be used ONLY by software wizards
   503				        for emergency patching of the disk structure.>,<
   504				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   505					X BOOTS,<JRST SYSBTS##>,AB.NAK!AB.VER,<
   506				BOOTS   Crash the system with "BOOTS LOADED" immediately.>
   507					X GO,<JRST FILGO>,Ab.Ack,<
   508				GO      Leave the FILES dialogue and return to the ONCE
   509				        dialogue.>
   510					X HELP,<JRST FILHLP>,Ab.Ack,<
   511				HELP    Type this message.
   512				>
   513				>
   514	000347'	254000	757322		SCNTB (HLPFIL,HLPFIL,FIL)
   515	000350'	254000	757322
   516	000351'	254000	757325
   517	000352'	260040	762603
   518	000353'	254000	760035
   519	000354'	254000	760220
   520	000355'	260040	762374
   521	000356'	254000	760033
   522	000357'	260040	762342
   523	000360'	260040	762221
   524	000361'	260040	762472
   525	000362'	260040	000000*
   526	000363'	260040	000000*
   527	000364'	254000	000000*
   528	000365'	254000	762675
   529	000366'	254000	757342
   530	000367'	777763	760016
   531	000370'	777763	757371
   532	000371'	446353	435456
   533	000372'	647160	450000
   534	000373'	435041	564745
   535	000374'	414444	000000
   536	000375'	445163	575466
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-3
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   537	000376'	445163	635754
   538	000377'	444546	515645
   539	000400'	624546	624563
   540	000401'	444464	000000
   541	000402'	646364	636560
   542	000403'	425757	646300
   543	000404'	475700	000000
   544	000405'	504554	600000
   545	000406'	064250	451626
	000407'	416311	620100
	000410'	507534	571362
	000411'	203376	220246
	000412'	627314	561750
	000413'	202112	345606
	000414'	462344	066736
   546	000415'	623125	606424
	000416'	201004	020100
	000417'	201004	046322
	000420'	717504	072320
	000421'	625014	372744
	000422'	713135	672100
	000423'	667374	462500
	000424'	607354	420302
	000425'	663315	773500
	000426'	723214	520336
	000427'	703136	260750
	000430'	677444	072336
	000431'	203075	060734
	000432'	637124	064750
	000433'	270000	000000
   547	000434'	064252	454640
	000435'	425004	020100
	000436'	463236	372100
	000437'	647354	667744
	000440'	667036	464736
	000441'	671014	161336
	000442'	727504	072320
	000443'	625016	372344
	000444'	727076	472744
   548	000445'	625341	505100
	000446'	201004	020100
	000447'	201012	474740
	000450'	625004	252262
	000451'	502124	044212
	000452'	462404	220314
	000453'	677444	060500
	000454'	663236	372100
	000455'	677144	067740
	000456'	723235	767346
	000457'	270000	000000
   549	000460'	064250	344202
	000461'	472170	520100
	000462'	417214	167316
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-4
ONCDSK.MAC	14-APR-88 23:38		FILMAN

	000463'	625015	167314
	000464'	677455	560750
	000465'	647375	620302
	000466'	613376	572100
	000467'	723214	520346
	000470'	723456	561750
	000471'	727454	527032
   550	000472'	051004	020100
	000473'	201004	020250
	000474'	747414	520104
	000475'	416210	147216
	000476'	425011	042630
	000477'	501044	063336
	000500'	711014	120330
	000501'	647476	420336
	000502'	631015	770350
	000503'	647375	671534
	000504'	000000	000000
   551	000505'	064250	142210
	000506'	201004	020100
	000507'	407114	420302
	000510'	203535	664750
	000511'	203515	720350
	000512'	643124	071750
	000513'	713534	372352
   552	000514'	713125	606424
	000515'	201004	020100
	000516'	201004	051312
	000517'	617375	663322
	000520'	637536	262500
	000521'	723214	520310
	000522'	647475	320346
	000523'	723456	561750
	000524'	727454	520302
	000525'	673104	060710
	000526'	621014	167336
	000527'	723214	571100
	000530'	703034	365534
	000531'	000000	000000
   553	000532'	270000	000000
   554	000533'	064250	444646
	000534'	516371	453212
	000535'	202115	171746
	000536'	677316	662500
	000537'	723214	520310
	000540'	647475	320346
	000541'	723456	561750
	000542'	727454	520314
	000543'	677444	042246
   555	000544'	456045	606424
	000545'	201004	020100
	000546'	201004	051312
	000547'	667376	662500
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-5
ONCDSK.MAC	14-APR-88 23:38		FILMAN

	000550'	607315	420352
	000551'	673236	471500
	000552'	633455	766500
	000553'	723214	520346
	000554'	747476	462732
	000555'	203476	471352
	000556'	617516	571312
	000557'	270000	000000
   556	000560'	064250	442614
	000561'	446350	520100
	000562'	423134	664734
	000563'	625014	120234
	000564'	426564	071750
	000565'	713534	372352
	000566'	713124	063336
	000567'	711010	451626
   557	000570'	411341	505100
	000571'	201004	020100
	000572'	201010	371312
	000573'	607514	520302
	000574'	203075	766740
	000575'	663136	462730
	000576'	745015	662756
	000577'	203477	171750
	000600'	627324	071750
	000601'	713534	372352
	000602'	713125	600000
   558	000603'	064252	242614
	000604'	512132	344100
	000605'	513134	671312
	000606'	717204	072320
	000607'	625016	372344
	000610'	727076	472744
   559	000611'	625341	505100
	000612'	201004	020100
	000613'	201010	462730
	000614'	627514	520302
	000615'	663304	063322
	000616'	663136	320336
	000617'	671016	464312
	000620'	203477	171750
	000621'	627324	060734
	000622'	621016	372302
	000623'	713504	067754
   560	000624'	627441	505100
	000625'	201004	020100
	000626'	201016	764750
	000627'	641014	120104
	000630'	432450	551620
	000631'	211014	464746
	000632'	655340	000000
   561	000633'	064250	442250
	000634'	201004	020100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-6
ONCDSK.MAC	14-APR-88 23:38		FILMAN

	000635'	427356	462744
	000636'	203137	062706
	000637'	727515	173312
	000640'	202110	452134
	000641'	201012	467500
	000642'	613124	072746
	000643'	627104	047634
	000644'	462624	061362
	000645'	203475	763350
	000646'	737036	262500
	000647'	737237	260744
   562	000650'	623461	505100
	000651'	201004	020100
	000652'	201014	667744
	000653'	203135	562744
	000654'	637135	661762
	000655'	203414	172306
	000656'	643235	663500
	000657'	607354	420312
	000660'	743035	564734
	000661'	607515	167734
	000662'	203374	620350
	000663'	643124	066736
	000664'	673236	467744
   563	000665'	270321	220100
	000666'	201004	020100
	000667'	202531	642212
	000670'	511011	647500
	000671'	416232	241652
	000672'	466472	440634
	000673'	416132	320246
	000674'	442372	546210
	000675'	202631	752500
	000676'	472372	246602
	000677'	462313	120252
	000700'	516124	052220
	000701'	446464	041636
	000702'	466330	147210
	000703'	204000	000000
   564	000704'	064252	451650
	000705'	516532	020100
	000706'	423236	365500
	000707'	703036	461720
	000710'	647354	720344
	000711'	677536	464734
	000712'	625344	020250
	000713'	675014	262500
	000714'	727474	562100
	000715'	476351	454500
	000716'	613624	071736
	000717'	633516	760744
	000720'	625016	764764
	000721'	607454	471432
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-7
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   565	000722'	051004	020100
	000723'	201004	020314
	000724'	677444	062732
	000725'	627454	762734
	000726'	617624	070302
	000727'	723075	064734
	000730'	635015	763100
	000731'	723214	520310
	000732'	647475	320346
	000733'	723456	561750
	000734'	727454	527032
   566	000735'	051004	020100
	000736'	201004	020252
	000737'	472110	551100
	000740'	472364	041622
	000741'	512072	546646
	000742'	522031	641612
	000743'	515012	344236
	000744'	526310	420262
	000745'	476524	047236
	000746'	512330	146230
	000747'	545012	551612
	000750'	202511	044646
	000751'	202071	746632
	000752'	406350	420400
   567	000753'	064250	247636
	000754'	522464	020100
	000755'	417454	171720
	000756'	203515	062500
	000757'	717636	372312
	000760'	665016	764750
	000761'	641004	241236
	000762'	476512	320230
	000763'	476030	442610
	000764'	211015	166732
	000765'	627115	160750
	000766'	627317	127000
   568	000767'	064250	747500
	000770'	201004	020100
	000771'	463134	173312
	000772'	203515	062500
	000773'	432231	442646
	000774'	203115	160730
	000775'	677176	562500
	000776'	607354	420344
	000777'	627516	571334
	001000'	203515	720350
	001001'	643124	047634
   569	001002'	416121	505100
	001003'	201004	020100
	001004'	201014	464702
	001005'	663374	772712
	001006'	270000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 8-8
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   570	001007'	064251	042630
	001010'	501004	020100
	001011'	523636	062500
	001012'	723215	171500
	001013'	667136	371702
   571	001014'	637125	606424
	001015'	000000	000000
   572	001016'	000000*	757406
   573	001017'	000000*	757434
   574	001020'	000000*	757460
   575	001021'	000000*	757505
   576	001022'	000000*	757532
   577	001023'	000000*	757533
   578	001024'	000000*	757560
   579	001025'	000000*	757603
   580	001026'	000000*	757633
   581	001027'	000000*	757704
   582	001030'	000000*	757753
   583	001031'	000000*	757767
   584	001032'	000000*	760007
   585
   586				BADDIS:	MOVEI	T1,[ASCIZ /  DISSOLVE is spelled with two "S"es.
   587	001033'	201300	763405	/]			;Here if typed "DISOLVE"
   588	001034'	254000	757323		JRST	HLPTY1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 9
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   589	001035'	476000	762112	TYPIT:	SETOM TYPONL	;ONLY TYPEOUT
   590	001036'	201600	760067		SCAN (TYP,O)
   591	001037'	476000	757307
   592	001040'	260040	757211
   593	001041'	254000	760051
   594	001042'	256016	760056
   595	001043'	254000	757325
   596	001044'	200714	777776
   597	001045'	550316	000000
   598	001046'	260040	760544
   599	001047'	253700	760045
   600	001050'	254000	757325
   601
   602	760051			NULTYP:
   603				HLPTYP:	MOVEI T1,[ASCIZ /
   604				Type "TYPE HELP" for a list of options.
   605	001051'	201300	763415	/]
   606	001052'	254000	757323		JRST HLPTY1
   607
   608					DEFINE MKTYP <
   609					X STR,<PUSHJ P,TYPSTR>,Ab.Nak,<
   610				STR     Name of the STRUCTURE and UNITS on it.>
   611					X UNITS,<PUSHJ P,TYPUNS>,Ab.Nak,<
   612				UNITS   Names of all units NOT in a file structure.>
   613					X BAT,<PUSHJ P,TYPBAT>,Ab.Nak,<
   614				BAT     Number of BAD pages and regions for a unit.>
   615					X SATPCBS,<PUSHJ P,TYPSPC>,Ab.Nak,<
   616				SATPCBS Number of SAT PCBs.>
   617					X RIBPCBS,<PUSHJ P,TYPRPC>,Ab.Nak,<
   618				RIBPCBS Number of RIB PCBs.>
   619					X ALL,<JRST TYPALL>,Ab.Nak,<
   620				ALL     All of the above.>
   621					X HELP,<JRST TYPHLP>,Ab.Ack,<
   622				str-name  Type information about the structure.
   623				unit-name Type information about the unit.
   624				HELP    Type this message.
   625				>
   626				>
   627	001053'	254000	760343		SCNTB (TYPUIP,TYPSRP,TYP)
   628	001054'	254000	760420
   629	001055'	254000	760051
   630	001056'	260040	762002
   631	001057'	260040	761765
   632	001060'	260040	763037
   633	001061'	260040	762775
   634	001062'	260040	763012
   635	001063'	254000	762024
   636	001064'	254000	760044
   637	001065'	777771	760211
   638	001066'	777771	760067
   639	001067'	636462	000000
   640	001070'	655651	646300
   641	001071'	424164	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 9-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   642	001072'	634164	604342
   643	001073'	625142	604342
   644	001074'	415454	000000
   645	001075'	504554	600000
   646	001076'	064252	352244
	001077'	201004	020100
	001100'	473035	562500
	001101'	677144	072320
	001102'	625012	352244
	001103'	526072	452644
	001104'	425014	167310
	001105'	202531	644650
	001106'	515015	767100
	001107'	647505	600000
   647	001110'	064252	547222
	001111'	522464	020100
	001112'	473035	562746
	001113'	203374	620302
	001114'	663304	072734
	001115'	647516	320234
	001116'	476504	064734
	001117'	203024	063322
	001120'	663124	071750
	001121'	713534	372352
	001122'	713125	600000
   648	001123'	064250	240650
	001124'	201004	020100
	001125'	473535	561312
	001126'	711015	763100
	001127'	412030	420340
	001130'	607174	571500
	001131'	607354	420344
	001132'	627175	167734
	001133'	715014	667744
	001134'	203024	072734
	001135'	647505	600000
   649	001136'	064252	340650
	001137'	502070	251500
	001140'	473535	561312
	001141'	711015	763100
	001142'	516032	420240
	001143'	416056	327000
   650	001144'	064252	244604
	001145'	502070	251500
	001146'	473535	561312
	001147'	711015	763100
	001150'	512230	220240
	001151'	416056	327000
   651	001152'	064250	146230
	001153'	201004	020100
	001154'	407315	420336
	001155'	631016	464312
	001156'	203034	267754
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 9-3
ONCDSK.MAC	14-APR-88 23:38		FILMAN

	001157'	625340	000000
   652	001160'	064256	372344
	001161'	267354	166712
	001162'	201012	474740
	001163'	625015	167314
	001164'	677455	560750
	001165'	647375	620302
	001166'	613376	572100
	001167'	723214	520346
	001170'	723456	561750
	001171'	727454	527032
   653	001172'	053535	664750
	001173'	267354	166712
	001174'	202517	170312
	001175'	203235	663336
	001176'	713334	172322
	001177'	677344	060704
	001200'	677536	420350
	001201'	643124	072734
   654	001202'	647505	606424
	001203'	442131	450100
	001204'	201004	052362
	001205'	703124	072320
	001206'	647464	066712
	001207'	717474	163712
   655	001210'	270321	200000
   656	001211'	000000*	760076
   657	001212'	000000*	760110
   658	001213'	000000*	760123
   659	001214'	000000*	760136
   660	001215'	000000*	760144
   661	001216'	000000*	760152
   662	001217'	000000*	760160
   663
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 10
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   664	001220'	402000	762112	CHGIT:	SETZM TYPONL
   665	001221'	201600	760247		SCAN (CHG,O)
   666	001222'	476000	757307
   667	001223'	260040	757211
   668	001224'	254000	760234
   669	001225'	256016	760241
   670	001226'	254000	757325
   671	001227'	200714	777776
   672	001230'	550316	000000
   673	001231'	260040	760544
   674	001232'	253700	760230
   675	001233'	254000	757325
   676	760234			NULCHG:
   677				HLPCHG:	MOVEI T1,[ASCIZ /
   678				Type "CHANGE HELP" for a list of options.
   679	001234'	201300	763426	/]
   680	001235'	254000	757323		JRST HLPTY1
   681
   682					DEFINE MKCHG <
   683					X SATPCBS,<PUSHJ P,CHGSPC>,Ab.Nak!Ab.Ver,<
   684				SATPCBS   Change the number of SAT PCBs.>
   685					X RIBPCBS,<PUSHJ P,CHGRPC>,Ab.Nak!Ab.Ver,<
   686				RIBPCBS   Change the number of RIB PCBs.>
   687					X BAT,<PUSHJ P,CHGBAT>,Ab.Nak!Ab.Ver,<
   688				BAT       Refresh the BAT pages for a UNIT.>
   689					X HELP,<JRST CHGHLP>,Ab.Ack,<
   690				str-name  Change parameters for the structure
   691				unit-name Change parameters for a unit.
   692				HELP    Type this message.
   693				>
   694				>
   695	001236'	254000	760343		SCNTB (TYPUIP,TYPSRP,CHG)
   696	001237'	254000	760420
   697	001240'	254000	760234
   698	001241'	260040	763000
   699	001242'	260040	763015
   700	001243'	260040	763027
   701	001244'	254000	760227
   702	001245'	777774	760337
   703	001246'	777774	760247
   704	001247'	634164	604342
   705	001250'	625142	604342
   706	001251'	424164	000000
   707	001252'	504554	600000
   708	001253'	064252	340650
	001254'	502070	251500
	001255'	201010	364302
	001256'	673174	520350
	001257'	643124	067352
	001260'	667054	571100
	001261'	677144	051602
	001262'	521012	041604
	001263'	715340	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 10-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   709	001264'	064252	244604
	001265'	502070	251500
	001266'	201010	364302
	001267'	673174	520350
	001270'	643124	067352
	001271'	667054	571100
	001272'	677144	051222
	001273'	411012	041604
	001274'	715340	000000
   710	001275'	064250	240650
	001276'	201004	020100
	001277'	201012	262714
	001300'	713136	364100
	001301'	723214	520204
	001302'	406504	070302
	001303'	637136	320314
	001304'	677444	060500
	001305'	526351	152134
	001306'	000000	000000
   711	001307'	064256	372344
	001310'	267354	166712
	001311'	201010	364302
	001312'	673174	520340
	001313'	607454	166712
	001314'	723136	271500
	001315'	633376	220350
	001316'	643124	071750
	001317'	713534	372352
   712	001320'	713121	505352
	001321'	673236	426734
	001322'	607334	520206
	001323'	643035	663712
	001324'	203414	171302
	001325'	667136	462744
	001326'	715014	667744
	001327'	203024	072734
   713	001330'	647505	606424
	001331'	442131	450100
	001332'	201004	052362
	001333'	703124	072320
	001334'	647464	066712
	001335'	717474	163712
   714	001336'	270321	200000
   715	001337'	000000*	760253
   716	001340'	000000*	760264
   717	001341'	000000*	760275
   718	001342'	000000*	760307
   719
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 11
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   720	001343'	550645	000165*	TYPUIP:	HRRZ	P2,UNISTR(U)	;IN CASE IN FS
   721	001344'	202640	760354		MOVEM	P2,UIPSVU	;SAVE IT!
   722	001345'	201600	760375		MOVEI	P1,SCNUIP	; Get address of Scan Table
   723	001346'	476000	757307		SETOM	CMDSCF		; Specify STR/UNIT stuff
   724	001347'	260040	757211		PUSHJ	P,CMDSCN	; Call Scanning routine
   725	001350'	254000	760362		  JRST	HLPUIP		; No good!
   726	001351'	200640	760354		MOVE	P2,UIPSVU	;RESTORE in case needed.
   727	001352'	256016	760371		XCT	DSPUIP(P3)	; Yes?
   728	001353'	254000	757325		JRST	FILCMD		; Return as if cr typed.
   729	001354'	000000	000000	UIPSVU:	0
   730
   731	001355'	200714	777776	UIPHLP:	Move	P3,-2(P1)	; Setup AOBJN pointer for messages
   732	001356'	550316	000000	UIPHL1:	Hrrz	T1,(P3)		; Get address of message
   733	001357'	260040	760544		Pushj	P,LNGMES	; Print a long message
   734	001360'	253700	760356		Aobjn	P3,UIPHL1	; Next?
   735	001361'	254000	757325		Jrst	FILCMD		; Return.
   736	760362			NULUIP:
   737				HLPUIP:	MOVEI T1,[ASCIZ /
   738	001362'	201300	763440	Type "TYPE unit-name HELP" for a list of options./]
   739	001363'	331000	762112		SKIPL TYPONL
   740					MOVEI T1,[ASCIZ /
   741	001364'	201300	763453	Type "CHANGE unit-name HELP" for a list of options./]	;WAS A CHANGE
   742	001365'	254000	757323		JRST HLPTY1
   743
   744					DEFINE MKUIP <
   745					X ID,<PUSHJ P,UNITID>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   746				... ID    Unit ID.>
   747					X HELP,<JRST UIPHLP>,Ab.Ack,<
   748				... HELP  Type this message.
   749				>
   750				>
   751	001366'	254000	760362		SCNTB (HLPUIP,HLPUIP,UIP)
   752	001367'	254000	760362
   753	001370'	254000	760362
   754	001371'	260040	762151
   755	001372'	254000	760355
   756	001373'	777776	760413
   757	001374'	777776	760375
   758	001375'	514400	000000
   759	001376'	504554	600000
   760	001377'	064245	627134
	001400'	202230	420100
	001401'	201012	567322
	001402'	721011	142134
	001403'	000000	000000
   761	001404'	064245	627134
	001405'	202210	546240
	001406'	201012	474740
	001407'	625016	464322
	001410'	715015	562746
	001411'	717034	762534
   762	001412'	064240	000000
   763	001413'	000000*	760377
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 11-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   764	001414'	000000*	760404
   765
   766	001415'	336005	000000*	UNCHKA:	SKIPN UNIHID(U)
   767	001416'	260040	762151		PUSHJ P,UNITID
   768	001417'	324740	762142		PJRST	UNITST
   769
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 12
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   770
   771	001420'	201600	760450	TYPSRP:	SCAN (SRP,O)
   772	001421'	476000	757307
   773	001422'	260040	757211
   774	001423'	254000	760433
   775	001424'	256016	760442
   776	001425'	254000	757325
   777	001426'	200714	777776
   778	001427'	550316	000000
   779	001430'	260040	760544
   780	001431'	253700	760427
   781	001432'	254000	757325
   782	760433			NULSRP:
   783				HLPSRP:	MOVEI T1,[ASCIZ /
   784	001433'	201300	763466	Type "TYPE str-name HELP" for a list of options./]
   785	001434'	331000	762112		SKIPL TYPONL
   786					MOVEI T1,[ASCIZ /
   787	001435'	201300	763501	Type "CHANGE str-name HELP" for a list of options./]
   788	001436'	254000	757323		JRST HLPTY1
   789
   790					DEFINE MKSRP <
   791					X OVERDRAW,<PUSHJ P,STRTOV>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   792				... OVERDRAW  The number of pages for overdraw.>
   793					X CRASH,<PUSHJ P,STRTCH>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   794				... CRASH     The number of pages for CRASH.SAV.>
   795					X ALL,<JRST STRTPA>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   796				... ALL       All of the ABOVE.
   797				              The number of pages for Overdraw, for CRASH.SAV.>
   798					X HELP,<JRST SRPHLP>,Ab.Ack,<
   799				... HELP      Type this message.
   800				>
   801				>
   802	001437'	254000	760433		SCNTB (HLPSRP,HLPSRP,SRP)
   803	001440'	254000	760433
   804	001441'	254000	760433
   805	001442'	260040	762210
   806	001443'	260040	762174
   807	001444'	254000	760541
   808	001445'	254000	760426
   809	001446'	777774	760535
   810	001447'	777774	760450
   811	001450'	576645	624462
   812	001451'	436241	635000
   813	001452'	415454	000000
   814	001453'	504554	600000
   815	001454'	064245	627134
	001455'	202372	642644
	001456'	422450	153500
	001457'	202515	062500
	001460'	673535	561312
	001461'	711015	763100
	001462'	703034	762746
	001463'	203155	771100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 12-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

	001464'	677554	571310
	001465'	713036	727000
   816	001466'	064245	627134
	001467'	202072	240646
	001470'	441004	020100
	001471'	202515	062500
	001472'	673535	561312
	001473'	711015	763100
	001474'	703034	762746
	001475'	203155	771100
	001476'	416450	151620
	001477'	272470	153134
	001500'	000000	000000
   817	001501'	064245	627134
	001502'	202031	446100
	001503'	201004	020100
	001504'	202035	466100
	001505'	677144	072320
	001506'	625010	141236
   818	001507'	532125	606424
	001510'	201004	020100
	001511'	201004	020100
	001512'	201004	020250
	001513'	643124	067352
	001514'	667054	571100
	001515'	677144	070302
	001516'	637136	320314
	001517'	677444	047754
	001520'	627454	471302
	001521'	735304	063336
	001522'	711010	351202
	001523'	516205	651602
	001524'	531340	000000
   819	001525'	064245	627134
	001526'	202210	546240
	001527'	201004	020100
	001530'	202517	170312
	001531'	203515	064746
	001532'	203334	571746
	001533'	607174	527032
   820	001534'	050000	000000
   821	001535'	000000*	760454
   822	001536'	000000*	760466
   823	001537'	000000*	760501
   824	001540'	000000*	760525
   825
   826	001541'	260040	762210	STRTPA:	PUSHJ P,STRTOV
   827	001542'	260040	762174		PUSHJ P,STRTCH
   828	001543'	254000	757325		JRST SRPCMD
   829
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 13
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   830				;HELP INFORMATION
   831
   832	001544'	505300	440700	LNGMES:	HRLI T1,(POINT 7,0)
   833	001545'	134400	000006	LNGMS1:	ILDB T3,T1
   834	001546'	322400	000000*		JUMPE T3,CPOPJ
   835	001547'	260040	000000*		PUSHJ P,COMTYO
   836	001550'	302400	000012		CAIE T3,12
   837	001551'	254000	760545		JRST LNGMS1
   838	001552'	261040	000006		PUSH P,T1
   839	001553'	260040	000327*		PUSHJ P,OPOUT
   840	001554'	262040	000006		POP P,T1
   841	001555'	254000	760545		JRST LNGMS1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 14
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   842				COMMENT #
   843				@@SUBROUTINE RDHOME
   844				@@PURPOSE
   845				SUBR TO READ & VERIFY HOME PAGES FOR ALL UNITS AT SYSTEM
   846				INITIALIZATION.  BUILDS THE SYSTEM STR.
   847				SETS INFO IN THE STR DB AND IN THE UNIT DBS.
   848				@@CALLS
   849
   850				@@EXIT
   851				NON-SKIP RETURNS IF AN ERROR WAS DETECTED WHILE READING THE
   852				HOME PAGES OF 1 OR MORE UNITS AND/OR NO STR WAS CREATED
   853				AND/OR MORE THAN ONE STR WAS CREATED.
   854				SKIP RETURNS IF ALL HOME PAGES THAT WERE NOT DOWN READ OK.
   855				@@ #
   856
   857	001556'	260040	000000*	RDHOME:	PUSHJ	P,INLMES##
   858					 ASCIZ /
   859	001557'	064250	364312	Checking all units on disk controller - reading UNIT ID from HOME pages./
	001560'	617275	167316
	001561'	203035	466100
	001562'	727355	172346
	001563'	203375	620310
	001564'	647475	320306
	001565'	677356	471336
	001566'	663314	571100
	001567'	265016	262702
	001570'	623235	663500
	001571'	526351	152100
	001572'	446104	063344
	001573'	677324	044236
	001574'	466124	070302
	001575'	637136	327000
   860	001576'	476000	761117		SETOM	TYPUI0		;Force CRLF next output from TYPUID
   861	001577'	402000	000002*		SETZM	DSKDDB+DEVIOS	;
   862	001600'	700600	000200		WRPI	LI.PIN		;TURN PI SYSTEM ON FOR WAITS
   863	001601'	332200	000174*		SKIPE	F,DDSTAR	;IS THERE A DDB SETUP?
   864	001602'	260040	000175*		PUSHJ	P,CLRDDB	;YES, CLEAR IT
   865	001603'	200300	000000*		MOVE	T1,ONCDDB	;GET LOCATION OF ONCE ONLY DDB
   866	001604'	202300	001601*		MOVEM	T1,DDSTAR
   867	001605'	260040	000000*		PUSHJ	P,SETDDO	;CREATE A DDB FOR ONCE ONLY I/O
   868	001606'	256000	757000		 STOPCD .
   869	001607'	260040	762362		PUSHJ	P,CLRSTR	;INITIALLY THERE IS NO STR.
   870	001610'	402000	761230		SETZM	RANHOM		; Clear so pack-set id check works
   871	001611'	554240	000170*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DATA BLOCK IN SYSTEM.
   872	001612'	322240	760617		JUMPE	U,RDHOM2	;
   873	001613'	205400	000000*		MOVSI	T3,UNPPRV	;
   874	001614'	436405	000171*	RDHOM1:	IORM	T3,UNIDES(U)	;SET UNIT TO BE A PRIVATE PACK.
   875	001615'	554245	000172*		HLRZ	U,UNISYS(U)	;
   876	001616'	326240	760614		JUMPN	U,RDHOM1	;
   877	001617'	554240	001611*	RDHOM2:	HLRZ	U,SYSUNI	;
   878	001620'	402000	761226		SETZM	ERRHOM		;CLEAR ERROR(S) WHILE READING HOME PAGES FLAG
   879	001621'	402000	761227		SETZM	ERRHM2
   880	001622'	634300	000006		TDZA	T1,T1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 14-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   881	001623'	200300	000002	SCNUNI:	 MOVE	T1,J		;SAVE OLD KON
   882	001624'	550105	000000*		HRRZ	J,UNIKON(U)	;GET ADR. OF KONTROLLER DATA PAGE FOR THIS UNIT
   883	001625'	335002	000000*		SKIPGE	KONUPA(J)	;HAS KONTROLLER BEEN FLAGGED AS DOWN?
   884	001626'	254000	760650		 JRST	FLGDWN		;YES - FLAG UNIT AS DOWN ALSO
   885	001627'	316300	000002		CAMN	T1,J		;IS IT THE SAME
   886	001630'	254000	760645		 JRST	KONTOK		;YES, DO NOT NEED TO TRY AGAIN
   887	001631'	260062	001625*	TRYKON:	PUSHJ	P,@KONUPA(J)	;SEE IF KONTROLLER IS UP
   888	001632'	334605	000000*		  SKIPA	P1,UNINAM(U)	;IT'S DOWN
   889	001633'	254000	760645		JRST	KONTOK		;NOW SEE IF UNIT IS OK
   890
   891				;HERE IF KONTROLLER IS DOWN.    (P035/D01 - Don't ask if BPC or BPD are down)
   892				;*;	HLLZS	P1		;GET SIXBIT KONTROLLER NAME
   893				;*;	MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)ON-LINE, OR 2)DOWN? (TYPE #)
   894				;*;.]
   895				;*;	PUSHJ	P,MCKKON	;PRINT MSG & GET ANSWER
   896				;*;	  JRST	TRYKON		;ILLEGAL RESPONSE
   897				;*;	CAIE	T2,2		;WAS "2" TYPED?
   898				;*;	JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   899	001634'	260040	761620		PUSHJ	P,CRLFOP	;Start a new line
   900	001635'	510340	000014		HLLZ	T2,P1		;Get Kontroller name ("BPA", "BPB", etc)
   901	001636'	260040	000000*		PUSHJ	P,PRNAME	;Put it in buffer
   902	001637'	201300	763514		MOVEI	T1,[ASCIZ / is off-line/]
   903	001640'	260040	000017*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
   904	001641'	260040	761620		PUSHJ	P,CRLFOP	;ADD CRLF & OUTPUT MSG.
   905	001642'	205300	000000*		MOVSI	T1,KOPDWN	;KONTROLLER DOWN BIT(SIGN BIT)
   906	001643'	436302	000000*		IORM	T1,KONDWN(J)	;FLAG KONTROLLER AS DOWN
   907	001644'	254000	760650		JRST	FLGDWN		;FLAG UNIT DOWN AS WELL
   908
   909				;HERE IF KONTROLLER ON-LINE - TO CHECK IF UNIT OK
   910	760645			KONTOK:
   911				IFCPU (F3),<
   912					MOVSI	T1,UNPOFL
   913					TDNE	T1,UNIDES(U)	;IS UNIT OFF-LINE OR DOWN?
   914					 JRST	SCNUN1		;YES - CONTINUE SCAN ON NEXT UNIT
   915				>;END IFCPU (F3)
   916	001645'	260040	761554		PUSHJ	P,DSKCPY	;GET CAPACITY AND SEE IF UP
   917	001646'	331445	000000*		SKIPL	T4,UNIONC(U)	;1B0 set if off-line, 1B1 if write-protect
   918	001647'	254000	760702		 JRST	WCKUNI		;IF POSITIVE, UNIT IS UP
   919				;Use routine TYPUID instead of UNTDWN to report off-line units
   920
   921				;HERE TO FLAG UNIT AS DOWN & OFF-LINE.
   922	001650'	201340	000000*	FLGDWN:	MOVEI	T2,SYSUNI-UNISYS ;SYSUNI - UNISYS
   923	001651'	554307	001615*	FLGDN1:	HLRZ	T1,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   924	001652'	316300	000005		CAMN	T1,U		;SKIP IF NOT FOUND DOWN UNIT
   925	001653'	254000	760657		 JRST	FLGDN2
   926	001654'	554347	001651*		HLRZ	T2,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   927	001655'	326340	760651		JUMPN	T2,FLGDN1
   928	001656'	254000	760661		JRST	FLGDN3		;NOT THERE?
   929
   930	001657'	554306	001654*	FLGDN2:	HLRZ	T1,UNISYS(T1)	;LINK TO NEXT UNIT
   931	001660'	506307	001657*		HRLM	T1,UNISYS(T2)	;STORE IN PREVIOUS
   932	001661'	334340	000005	FLGDN3:	SKIPA	T2,U		;T2 = THIS UNIT
   933	001662'	554347	001624*	FLGDN4:	 HLRZ	T2,UNIKON(T2)	;NEXT UNIT IN KONTROLLER RING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 14-3
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   934	001663'	554307	001662*		HLRZ	T1,UNIKON(T2)	;NEXT BACK TO US?
   935	001664'	312300	000005		CAME	T1,U
   936	001665'	254000	760662		 JRST	FLGDN4		;NO
   937	001666'	554306	001663*		HLRZ	T1,UNIKON(T1)	;YES, LINK TO NEXT
   938	001667'	506307	001666*		HRLM	T1,UNIKON(T2)	;STORE IN PREVIOUS
   939	001670'	334340	000005		SKIPA	T2,U		;T2 = THIS
   940	001671'	554347	000000*	FLGDN5:	 HLRZ	T2,UNICHN(T2)	;T2 = NEXT UNIT IN CHANNEL RING
   941	001672'	554307	001671*		HLRZ	T1,UNICHN(T2)
   942	001673'	312300	000005		CAME	T1,U		;BACK TO US?
   943	001674'	254000	760671		 JRST	FLGDN5		;NO
   944	001675'	554306	001672*		HLRZ	T1,UNICHN(T1)	;LINK TO NEXT
   945	001676'	506307	001675*		HRLM	T1,UNICHN(T2)	;STORE IN PREVIOUS
   946	001677'	205300	000000*		MOVSI	T1,UNPOFL	;OFF-LINE BIT
   947	001700'	436305	001614*		IORM	T1,UNIDES(U)	;SET BIT IN LH. OF UNIDES WORD
   948	001701'	254000	761071		JRST	SCNUN1		;CONTINUE SCAN ON NEXT UNIT
   949
   950				;HERE IF UNIT ON-LINE - TO CHECK IF UNIT WRITE ENABLED
   951	001702'	205300	000000*	WCKUNI:	MOVSI T1,UNPHWP
   952	001703'	616305	001700*		TDNN T1,UNIDES(U)
   953	001704'	607440	200000		TLNN T4,(1B1)		;IS IT WRITE PROTECTED?
   954	001705'	254000	760715		 JRST CHKHOM		;UNIT IS OK OR HAVE BEEN HERE BEFORE
   955					MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)WRITE-ENABLED, OR 2)WRITE-PROTECTED? (TYPE #)
   956				
   957	001706'	201400	763517	.]
   958	001707'	260040	761231		PUSHJ	P,WRPUNM	;PRINT MSG & GET ANSWER
   959	001710'	254000	760631		  JRST	TRYKON		;ILLEGAL RESPONSE
   960	001711'	302340	000002		CAIE	T2,2		;WAS "2" TYPED?
   961	001712'	254000	760631		JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   962	001713'	205300	001702*		MOVSI	T1,UNPHWP	;HARDWARE WRITE-PROTECT BIT
   963	001714'	436305	001703*		IORM	T1,UNIDES(U)	;FLAG UNIT AS WRITE PROTECTED
   964					PFALL	CHKHOM
   965
   966				;HERE IF UNIT ON-LINE & LEGALLY WRITE PROTECTED OR ENABLED - CHECK ITS HOME PAGES
   967
   968	001715'	260040	761354	CHKHOM:	PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
   969	001716'	304000	000000		  CAIA			;ERROR(S) ON BOTH HOME PAGES - T3 RETURNED NON 0.
   970	001717'	254000	760727		JRST	HMBOK		;AT LEAST ONE HOME PAGE OK
   971								;FORCE TO BE A NULL PAGE, NO OPTIONS
   972	001720'	201300	751000		MOVEI	T1,%HOM		;
   973	001721'	260040	000000*		PUSHJ	P,CORZER	;
   974	001722'	202640	751000*		MOVEM	P2,%HOM+PAGNAM	;STORE SIXBIT "HOM"
   975	001723'	202700	751000*		MOVEM	P3,%HOM+PAGCOD	;STORE HOME PAGE CODE
   976	001724'	260040	761624		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN
   977	001725'	260040	761265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DATA BLOCK.
   978	001726'	254000	761054		JRST	NTISTR		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 15
ONCDSK.MAC	14-APR-88 23:38		FILMAN

   979				;HERE IF HOME PAGE(S) READ INTO CORE OK
   980				; GENERATE STR DB & LINK UNIT DBS CORRECTLY.
   981
   982	001727'	322400	760731	HMBOK:	JUMPE	T3,.+2		;ERR WHILE READING HOME PAGES?
   983	001730'	260040	761624		PUSHJ	P,SETCHG	;YES. FLAG THEY NEED REWRITING.
   984	001731'	260040	761265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DB
   985	001732'	201640	000000		MOVEI	P2,0		;SET STR DB ADR. = 0 IN CASE NO STR FOUND
   986	001733'	200300	751000*		MOVE	T1,%HOM+HOMSNM	;GET STR NAME FROM HOME PAGE.
   987	001734'	322300	761054		JUMPE	T1,NTISTR	;DON'T LOOK FOR OR CREATE A ZERO STR NAME.
   988	001735'	260040	761260	HMBOK2:	PUSHJ	P,FNDSTR	;DOES THIS STR EXIST?
   989	001736'	254000	760756		  JRST	NOTPRV		;YES. UNIT IS NOT A PRIVATE PACK.
   990	001737'	332015	000000*		SKIPE	STRNAM(P2)	;NO, DOES ANY STR EXIST?
   991	001740'	254000	761047		 JRST	NOSTR		;YES, ONLY ONE STR IS LEGAL. DIE.
   992								;NO, THIS IS THE SYSTEM STR.
   993	001741'	260040	761304		PUSHJ	P,MOVSTR	;MOVE PARAMS FROM HOME PAGE TO STR DB.
   994	001742'	200340	757003		MOVE	T2,REONCE	;GET ONCE COPY OF RESTRT WORD
   995	001743'	621340	140000		TLZ	T2,DCN.UR!DCN.MN	;IN CASE STR IS MODIFIED
   996	001744'	550300	751000*		HRRZ	T1,%HOM+HOMRAN	;GET PACK SET ID
   997	001745'	312300	000000*		CAME	T1,REPSID	;HAS NEW PACK SET BEEN MOUNTED?
   998	001746'	254000	760754		 JRST	HMBOK3		;YES: IGNORE RESTRT
   999	001747'	400300	000000		SETZ	T1,		;ZERO DSKCLN TYPE SPEC FLAG WORD
  1000	001750'	602340	000000*		TRNE	T2,RE.DCD	;DID USER SELECT A DSKCLN TYPE?
  1001	001751'	661300	100000		 TLO	T1,DCN.UR	;YES: SO INDICATE
  1002	001752'	661300	040000		TLO	T1,DCN.MN	;IND MON SELECTED A DSKCLN TYPE
  1003	001753'	436300	000057*		IORM	T1,DCN
  1004	001754'	200300	751000*	HMBOK3:	MOVE	T1,%HOM+HOMDCT	;INITIALIZE FOR VERIFICATION OF
  1005	001755'	137300	757010		DPB	T1,DCNYHM	; HOME BLOCK DSKCLN TYPE VALIDITY
  1006	001756'	260040	761631	NOTPRV:	PUSHJ	P,SETPUB	;SET THE UNIT PUBLIC.
  1007
  1008				    ;HERE WHEN STR UNIT BELONGS IN EXISTS
  1009	001757'	322640	761011	OLDSTR:	JUMPE	P2,OLDST8	;SKIP OVER RAN & HSH CHK IF NO STR.
  1010	001760'	135300	757010		LDB	T1,DCNYHM	;SET UP TO VERIFY THAT HOME
  1011	001761'	505300	000000*		HRLI	T1,HOMDCV	; DSKCLN TYPE IS VALID/CONSISTENT
  1012	001762'	515340	020000		HRLZI	T2,DCN.HM
  1013	001763'	312300	751000*		CAME	T1,%HOM+HOMDCT	;IS TYPE GOOD?
  1014	001764'	412340	001753*		 ANDCAM	T2,DCN		;NO: SO INDICATE
  1015	001765'	554300	751000*		HLRZ	T1,%HOM+HOMHSH	;T1/ UNIT'S HASH CONSTANT.
  1016	001766'	322300	760775		JUMPE	T1,OLDST1	;MUST BE NON-ZERO.
  1017	001767'	550355	000000*	OLDST2:	HRRZ	T2,STRHSH(P2)	;T2/ STR'S HASH CONSTANT SET
  1018	001770'	326340	760773		JUMPN	T2,OLDST0	;YET?
  1019	001771'	542315	001767*		HRRM	T1,STRHSH(P2)	;NO, JUST STORE FIRST FOUND.
  1020	001772'	254000	760777		JRST	OLDST4		;GO TO RAN LOOK.
  1021	001773'	306307	000000	OLDST0:	CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
  1022	001774'	254000	760777		 JRST	OLDST4		;OKAY.
  1023	001775'	201300	763536	OLDST1:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT HASH CONSTANT FOR UNIT /]
  1024	001776'	260040	761345		PUSHJ	P,MSGUNI	;
  1025	001777'	550300	751000*	OLDST4:	HRRZ	T1,%HOM+HOMRAN	;T1/ UNIT'S PACK SET ID.
  1026	002000'	322300	761007		JUMPE	T1,OLDST5	;CAN'T BE ZERO.
  1027	002001'	332340	761230	OLDST6:	SKIPE	T2,RANHOM	;ALREADY SEEN ID?
  1028	002002'	254000	761005		 JRST	STRFIX		;YES.
  1029	002003'	552300	761230		HRRZM	T1,RANHOM	;NO, JUST STORE FIRST FOUND.
  1030	002004'	254000	761011		 JRST	OLDST8		;
  1031	002005'	306307	000000	STRFIX::CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 15-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1032	002006'	254000	761011		 JRST	OLDST8		;OKAY.
  1033				 ;Label STRFIX to JFCL missing or inconsistant pack set it
  1034	002007'	201300	763550	OLDST5:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT PACK SET ID FOR UNIT /]
  1035	002010'	260040	761345		PUSHJ	P,MSGUNI	;
  1036	761011			OLDST8:	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 16
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1037	002011'	322640	761054		JUMPE	P2,NTISTR	;IF UNIT NOT IN STR, JUMP OVER THIS.
  1038					MOVEI	T1,[ASCIZ .
  1039	002012'	201300	763562	DISK FORMAT DOES NOT MATCH EXPECTED FORMAT ON UNIT .]
  1040	002013'	336340	000000*		SKIPN	T2,DSKPPU##	;# of disk pages per unit we expect
  1041	002014'	200345	000153*		 MOVE	T2,UNIPPU(U)	;If zero, we can accept anything
  1042	002015'	312345	002014*		CAME	T2,UNIPPU(U)	;Match?
  1043	002016'	260040	761345		 PUSHJ	P,MSGUNI	;Error, don't let BPXKON destroy 3650 disk
  1044	002017'	135340	000072*		LDB	T2,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  1045	002020'	332000	751000*		SKIPE	%HOM+HOMNXT	;IS THIS LAST UNIT IN STR?
  1046	002021'	254000	761033		 JRST	NLSUNI		;NO - GO LINK UNIT DATA BLOCK INTO STR
  1047	002022'	550315	000000*		HRRZ	T1,STRUNM(P2)	;HAVE WE ALREADY SEEN A LAST UNIT FOR THIS STR?
  1048	002023'	322300	761030		JUMPE	T1,LSTUNI	;NO - NOW WE HAVE
  1049	002024'	261040	000007		PUSH	P,T2		;SAVE LOG. UNIT #
  1050					MOVEI	T1,[ASCIZ .
  1051	002025'	201300	763575	MORE THAN ONE LAST UNIT IN STR .]
  1052	002026'	260040	761336		PUSHJ	P,MSGSTR	;PRINT MSG FOLLOWED BY SIXBIT STR NAME
  1053	002027'	262040	000007		POP	P,T2		;RESTORE LOG. UNIT #
  1054
  1055				;HERE WHEN UNIT READ IS THE LAST IN A STR.
  1056
  1057	002030'	405340	000077	LSTUNI:	ANDI	T2,77		;MAX. OF 64 UNITS IN STR!!!!!!!
  1058	002031'	542355	002022*		HRRM	T2,STRUNM(P2)	;STORE LOG. # OF LAST UNIT IN STR
  1059	002032'	350015	002031*		AOS	STRUNM(P2)	;LEAVE T2 ALONE BUT MAKE MEMORY OK
  1060
  1061				;HERE WHEN UNIT READ ISN'T LAST IN THE STR
  1062				; LINK UNIT TO STR & OTHER UNITS IN STR
  1063
  1064	002033'	201455	000000*	NLSUNI:	MOVEI	T4,STRUNI(P2)	;GET ADR. OF LINK TO 1ST. UNIT DATA BLOCK IN STR
  1065	002034'	254000	761041		JRST	LINKT1
  1066
  1067	002035'	135400	000000*	LINKIT:	LDB	T3,UNYLN1	;YES - GET LOG. UNIT # OF NEXT UNIT
  1068	002036'	313400	000007		CAMLE	T3,T2		;IS IT GREATER THAN UNIT JUST READ?
  1069	002037'	254000	761043		 JRST	INSERT		;YES - INSERT UNIT DATA BLOCK HERE
  1070	002040'	201446	001343*		MOVEI	T4,UNISTR(T1)	;GET ADR. OF LINK TO NEXT UNIT
  1071	002041'	554311	000000	LINKT1:	HLRZ	T1,(T4)		;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1072	002042'	326300	761035		JUMPN	T1,LINKIT	;MORE DATA BLOCKS?
  1073	002043'	506305	002040*	INSERT:	HRLM	T1,UNISTR(U)	;SAVE LINKS TO STR & NEXT UNIT DATA BLOCK
  1074	002044'	542645	002043*		HRRM	P2,UNISTR(U)	; IN THIS UNIT DATA BLOCK
  1075	002045'	506251	000000		HRLM	U,(T4)		;SAVE THIS UNIT ADR. IN PREVIOUS UNIT DATA BLOCK
  1076								; (OR STR DATA BLOCK)
  1077	002046'	254000	761055		JRST	CRESTT		;TRY & SETUP SAB RING & SPT TABLE FOR THIS UNIT
  1078
  1079				NOSTR:	MOVEI T1,[ASCIZ /
  1080	002047'	201300	763604	TOO MANY STR'S /]
  1081	002050'	260040	000326*		PUSHJ P,OCONM
  1082	002051'	200340	751000*		MOVE	T2,%HOM+HOMSNM
  1083	002052'	260040	761343		PUSHJ P,NAMFLO
  1084	002053'	256000	757000		STOPCD
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 17
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1085				;HERE TO CREATE STT TABLE FOR THIS UNIT.
  1086				;(EVEN IF NOT IN STR, MAY ADD TO STR LATER.).
  1087
  1088	002054'	402005	000000*	NTISTR:	SETZM	UNILOG(U)	;INDICATE UNIT NOT IN A STR.
  1089	002055'	260040	762134	CRESTT:	PUSHJ	P,SPUCLC	;CALC NO. SATS ON UNIT.
  1090	002056'	135700	000155*		LDB	P3,UNYSPU	;
  1091	002057'	221700	000151*		IMULI	P3,STTLEN	;COMPUTE LENGTH OF
  1092	002060'	271700	000001		ADDI	P3,1		;STT TABLE.
  1093	002061'	200340	000016		MOVE	T2,P3		;GET TOTAL NO. OF WORDS NEEDED
  1094	002062'	260040	000000*		PUSHJ	P,EVMALC##	;FOR STT
  1095	002063'	542305	000122*		HRRM	T1,UNISTT(U)	;STORE ADR OF STT IN UNIT DB.
  1096	002064'	402006	000000		SETZM	(T1)		;
  1097	002065'	515346	000000		HRLZI	T2,(T1)		;BUILD A
  1098	002066'	541346	000001		HRRI	T2,1(T1)	;BLT AC.
  1099	002067'	271316	777777		ADDI	T1,-1(P3)	;ADR OF LAST WORD IN STT TABLE.
  1100	002070'	251346	000000		BLT	T2,(T1)		;CLEAR THE STT.
  1101
  1102	002071'	260040	761120	SCNUN1:	PUSHJ	P,TYPUID	;Output physical name and HOM id
  1103	002072'	554245	001660*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DB ADR IN SYSTEM.
  1104	002073'	326240	760623		JUMPN	U,SCNUNI	;AROUND AGAIN IF ANY LEFT
  1105	002074'	260040	761620		PUSHJ	P,CRLFOP	;Finish off last disk report line
  1106	002075'	260040	761620		PUSHJ	P,CRLFOP	;Add a blank line
  1107
  1108					PRINTF(<[Need to define seperate UNTTBL for each STR]>)
  1109				    ;HERE TO CREATE UNTTBL.
  1110	002076'	402000	000000*		SETZM	UNTTBL		;CLEAR OUT
  1111	002077'	505300	002076*		HRLI	T1,UNTTBL	;ALL
  1112	002100'	541300	000001*		HRRI	T1,UNTTBL+1	;OF
  1113	002101'	251300	000000*		BLT	T1,UNTTBL+UNTLEN-1 ;UNTTBL.
  1114
  1115	002102'	554240	001617*		HLRZ U,SYSUNI		;GET SET TO GENERATE UNTTBL
  1116	002103'	201300	777777*		MOVEI T1,UNTLEN-1
  1117	002104'	322240	761154	SETUNT:	JUMPE U,SCNSTR	;DONE
  1118	002105'	332005	002054*		SKIPE UNILOG(U)		;IS IT IN A STR?
  1119	002106'	254000	761113		JRST SETUTS		;YES
  1120	002107'	202246	002077*		MOVEM U,UNTTBL(T1)
  1121	002110'	137300	002017*		DPB T1,UNYLUN
  1122	002111'	554245	002072*		HLRZ U,UNISYS(U)
  1123	002112'	364300	761104		SOJA T1,SETUNT		;AND GO
  1124
  1125	002113'	135340	002110*	SETUTS:	LDB T2,UNYLUN
  1126	002114'	202247	002107*		MOVEM U,UNTTBL(T2)
  1127	002115'	554245	002111*		HLRZ U,UNISYS(U)
  1128	002116'	254000	761104		JRST SETUNT
  1129
  1130	002117'	777777	777777	TYPUI0:	-1
  1131	002120'	265340	761660	TYPUID:	JSP	T2,SVOTAC	;Save ACs
  1132	002121'	350340	761117		AOS	T2,TYPUI0	;Formatting
  1133	002122'	606340	000003		TRNN	T2,3		;If multiple of 4,
  1134	002123'	260040	761620		 PUSHJ	P,CRLFOP	; start a new line
  1135	002124'	135340	000000*		LDB	T2,UNYPUN##	;Get physical unit number
  1136	002125'	307340	000007		CAIG	T2,7		;If single digit number
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 17-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1137	002126'	260040	000000*		 PUSHJ	P,PRSPC##	; output leading blank
  1138	002127'	200345	001632*		MOVE	T2,UNINAM(U)
  1139	002130'	260040	001636*		PUSHJ	P,PRNAME##	;Physical unit name
  1140	002131'	260040	000000*		PUSHJ	P,PRCOL##	;Colon
  1141	002132'	335305	001646*		SKIPGE	T1,UNIONC(U)	;Off line?
  1142	002133'	254000	761143		 JRST	TYPUI1		;Yes
  1143	002134'	200345	001415*		MOVE	T2,UNIHID(U)	;No, get UNIT-ID from HOM block
  1144	002135'	260040	000000*		PUSHJ	P,PRNAMF##	;Output 6 digits
  1145	002136'	332345	002105*		SKIPE	T2,UNILOG(U)	;Get name (such as 'DSKB17')
  1146	002137'	505340	000035		 HRLI	T2,'  ='	;If blank leave it blank, else
  1147	002140'	241340	000014		ROT	T2,^D12		; make it '=B17  '
  1148	002141'	260040	002135*		PUSHJ	P,PRNAMF##	;Output 6 characters (even if all blanks)
  1149	002142'	324740	001553*		PJRST	OPOUT		;Force out message now
  1150	002143'	200306	761146	TYPUI1:	MOVE	T1,OFLTAB(T1)	;Get addr of off-line message
  1151	002144'	260040	001640*		PUSHJ	P,CONMES##	;Output 12 ASCII characters
  1152	002145'	324740	002142*		PJRST	OPOUT
  1153
  1154			761146		%%ZZQ==.
  1155	000000			OFLTAB:	PHASE 0 ;123456789012;	;4 drive reports per line = 72 columns
  1156	002146'	000000	763610		 [ASCIZ /-offline-   /]	;Pack not spinning or no ID plug
  1157	002147'	000000	763613	%OFLER::![ASCIZ /unit error  /]	;Hardware indications on drive
  1158	002150'	000000	763616	%OFLFM::![ASCIZ /bad format  /]	;Incorrectly formatted pack on drive
  1159	002151'	000000	763621	%OFLMT::![ASCIZ /maintenance /]	;Drive is in MAINT. mode
  1160	002152'	000000	763624	%OFLRS::![ASCIZ /(no disk)   /]	;No response from drive (RM03 not plugged in)
  1161	002153'	000000	763627	%OFLIG::![ASCIZ /(ignored)   /]	;Wrong vol-set-ID (belongs to another system)
  1162	761154				PHASE .+%%ZZQ
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 18
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1163				;HERE WHEN ALL UNITS IN SYSTEM HAVE TRIED TO BE READ &
  1164				; THE STR DATA BLOCK HAS BEEN CREATED IF IT CAN BE.  NOW
  1165				; CHECK THAT ALL UNITS THAT SHOULD BE ARE PRESENT IN THE STR.
  1166
  1167	002154'	201640	000000*	SCNSTR:	MOVEI	P2,STRDDB	;GET ADR. OF STR DATA BLOCK.
  1168	002155'	336015	001737*		SKIPN	STRNAM(P2)	;IS THERE A STR?
  1169	002156'	254000	761217		 JRST	SCNSTD		;NO, NON-SKIP RETURN
  1170	002157'	550315	002032*		HRRZ	T1,STRUNM(P2)
  1171	002160'	326300	761173		JUMPN	T1,LSTRED	;WAS THE LAST UNIT IN THIS STR FOUND?
  1172					MOVEI	T1,[ASCIZ .
  1173	002161'	201300	763632	LAST UNIT WASN'T FOUND IN STR .]
  1174	002162'	260040	761336		PUSHJ	P,MSGSTR	;NO - PRINT MSG. FOLLOWED BY SIXBIT STR NAME
  1175	002163'	554255	002033*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR
  1176	002164'	334000	000000		SKIPA			;
  1177	002165'	200240	000006	SCNST2:	MOVE	U,T1
  1178	002166'	554305	002044*		HLRZ	T1,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1179	002167'	326300	761165		JUMPN	T1,SCNST2	;REPEAT UNTIL LAST ONE FOUND
  1180	002170'	135300	002113*		LDB	T1,UNYLUN	;GET ITS LOG. UNIT # IN STR
  1181	002171'	271300	000001		ADDI	T1,1		;MAKE INTO # UNITS IN STR
  1182	002172'	542315	002157*		HRRM	T1,STRUNM(P2)	; & STORE IT
  1183
  1184				;HERE TO CHECK FOR THE PRESENCE OF ALL UNITS BUT THE LAST IN A STR.
  1185
  1186	002173'	554255	002163*	LSTRED:	HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN THIS STR
  1187	002174'	476000	000017		SETOM	P4		;SETUP FAKE PREVIOUS LOG. UNIT #
  1188	002175'	135600	002170*	CHKUNI:	LDB	P1,UNYLUN	;GET LOG. UNIT # OF THIS UNIT WITHIN STR
  1189	002176'	250600	000017		EXCH	P1,P4		;PUT THIS & PREVIOUS LOG. UNIT #'S IN PROPER ACS
  1190	002177'	312740	000014		CAME	P4,P1		;ARE LOG. UNIT #'S THE SAME?
  1191	002200'	254000	761205		 JRST	MISUNI		;NO - CHECK FOR MISSING UNITS
  1192					MOVEI	T3,[ASCIZ .
  1193	002201'	201400	763641	TWO LOGICAL UNIT .]
  1194	002202'	201300	763645		MOVEI	T1,[ASCIZ .'S FOUND IN STR .]
  1195	002203'	260040	761326		PUSHJ	P,MSGLNG	;PRINT MSGS FOLLOWED BY SIXBIT STR NAME
  1196	002204'	254000	761214		JRST	CHKUN1		;CHECK NEXT PAIR OF UNITS
  1197
  1198	002205'	306754	000001	MISUNI:	CAIN	P4,1(P1)	;IS THIS UNIT 1 GREATER THAN LAST ONE?
  1199	002206'	254000	761214		 JRST	CHKUN1		;YES - CHECK NEXT PAIR OF UNITS
  1200	002207'	271600	000001		ADDI	P1,1		;INCREMENT TO GET CORRECT MISSING LOG. UNIT #
  1201					MOVEI	T3,[ASCIZ .
  1202	002210'	201400	763651	LOGICAL UNIT .]
  1203	002211'	201300	763655		MOVEI	T1,[ASCIZ . MISSING FROM STR .]
  1204	002212'	260040	761326		PUSHJ	P,MSGLNG
  1205	002213'	254000	761205		JRST	MISUNI		;REPEAT UNTIL ALL MISSING ARE TYPED OUT
  1206
  1207	002214'	554245	002166*	CHKUN1:	HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1208	002215'	326240	761175		JUMPN	U,CHKUNI
  1209	002216'	254000	761221		JRST	SCNSD2
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 19
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1210				;HERE WHEN THROUGH CHECKING ALL UNITS WITHIN A STR.
  1211
  1212				SCNSTD:	MOVEI	T1,[ASCIZ .
  1213	002217'	201300	763661	?NO SYSTEM STRUCTURE.]
  1214	002220'	260040	761613		PUSHJ	P,SVMOT2	;NO, TYPE MESSAGE
  1215	002221'	332000	761226	SCNSD2:	SKIPE	ERRHOM		;ANY ERRORS?
  1216	002222'	350001	000000		AOS	(P)		;NO - SKIP RETURN
  1217	002223'	332000	761227		SKIPE ERRHM2
  1218	002224'	350001	000000		AOS (P)
  1219	002225'	263040	000000		POPJ	P,
  1220
  1221	002226'	000000	000000	ERRHOM:	0			;FLAG FOR ERRORS WHILE READING A HOME PAGE.
  1222	002227'	000000	000000	ERRHM2:	0			;"BAD" ERROR DETECTED.
  1223
  1224	002230'	000000	000000	RANHOM:	Z			; Holds PACK-SET ID info (random #)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 20
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1225	002231'	201440	763666	WRPUNM:	MOVEI	T4,[ASCIZ . IS WRITE PROTECTED.]
  1226
  1227	002232'	200605	002127*		MOVE	P1,UNINAM(U)	;GET SIXBIT UNIT NAME
  1228					MOVEI	T1,[ASCIZ .
  1229	002233'	201300	763672	.]
  1230	002234'	324740	761237		PJRST	NASTYP		;TYPE MSGS. & GET USER'S RESPONSE
  1231
  1232				;SUBROUTINE TO PRINT "CONTROLLER" FOLLOWED BY A "NAME" FOLLOWED BY "IS OFF-LINE"
  1233				; FOLLOWED BY A MESSAGE ASKING WHAT STATE OF THE KONTROLLER IS DESIRED
  1234				; THEN IT WAITS FOR OPERATOR TO TYPE AN OCTAL NUMBER TERMINATED BY CRLF
  1235				;CALL	MOVE	P1,SIXBIT KONTROLLER NAME
  1236				;	MOVEI	T3,MSG. ADR.
  1237				;	PUSHJ	P,MCKKON
  1238				;	  ERROR RETURN	MSG. PRINTED BUT RESPONSE WASN'T AN OCTAL #
  1239				;	OK RETURN	 "      "    T2 CONTAINS OCTAL # TYPED
  1240
  1241				MCKKON:	MOVEI	T1,[ASCIZ .
  1242	002235'	201300	763672	.]
  1243	002236'	201440	763673		MOVEI	T4,[ASCIZ . IS OFF-LINE.]
  1244	002237'	265340	761660	NASTYP:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1245	002240'	261040	000010		PUSH	P,T3		;SAVE 2ND. MSG ADR.
  1246	002241'	261040	000011		PUSH	P,T4		;SAVE 1ST. MSG. ADR.
  1247	002242'	260040	002050*		PUSHJ	P,OCONM		;PUT MSG IN BUFFER
  1248	002243'	200340	000014		MOVE	T2,P1		;GET UNIT/KONTROLLER SIXBIT NAME
  1249	002244'	260040	002130*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1250	002245'	262040	000006		POP	P,T1		;RESTORE 1ST. MSG. ADR.
  1251	002246'	260040	002144*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1252	002247'	260040	761620		PUSHJ	P,CRLFOP	;ADD CRLF & O/P MSG.
  1253	002250'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1254	002251'	260040	761617		PUSHJ	P,CONOUT	;O/P MSG. & ADD CRLF
  1255	002252'	260040	000332*		PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1256	002253'	263040	000000		  POPJ	P,		;CR TYPED
  1257	002254'	260040	000000*		PUSHJ	P,OCTIN		;READ IT AS AN OCTAL NO.
  1258	002255'	263040	000000		  POPJ	P,		;NOTHING BUT A BREAK CH.
  1259	002256'	263040	000000		  POPJ	P,		;ILLEGAL CH.
  1260	002257'	254000	000305*		JRST	CPOPJ1		;OK RETURN WITH NO. IN T2
  1261
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 21
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1262				COMMENT #
  1263				@@SUBROUTINE FNDSTR
  1264				@@PURPOSE
  1265				SUBR TO SET UP THE STR DB ADDRESS IN P2 IF THE STR HAS THE
  1266				SIXBIT NAME IN T1.
  1267				@@ENTRY
  1268				EXPECTS SIXBIT STR NAME IN T1.
  1269				@@ACCUM
  1270				DESTROYS T1 AND P2.
  1271				@@EXIT
  1272				NON-SKIP RETURNS ONLY IF THE SYSTEM STR HAS BEEN SET UP AND IT
  1273				HAS THE NAME IN T1.  ELSE SKIP RETURNS.
  1274				@@ #
  1275
  1276	002260'	201640	002154*	FNDSTR:	MOVEI	P2,STRDDB	;GET ADDR OF STR DB TO P2.
  1277	002261'	620300	007777		TRZ	T1,7777		;STR NAMES ARE A MAX OF 4 CHARS.
  1278	002262'	312315	002155*		CAME	T1,STRNAM(P2)	;
  1279	002263'	350001	000000		AOS	(P)		;
  1280	002264'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 22
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1281				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO UNIT DATA BLOCK
  1282
  1283	002265'	200300	751000*	MOVUNI:	MOVE	T1,%HOM+HOMLOG	;05 Logical unit name (DSKB0-DSKB37)
  1284	002266'	202305	002136*		MOVEM	T1,UNILOG(U)	;01
  1285	002267'	200300	751000*		MOVE	T1,%HOM+HOMHID	;01 Unit ID (330000-330037)
  1286	002270'	202305	002134*		MOVEM	T1,UNIHID(U)	;02
  1287	002271'	200300	751000*		MOVE	T1,%HOM+HOMLUN	;06 Logical unit number (00-37)
  1288	002272'	137300	002175*		DPB	T1,UNYLUN	;03
  1289	002273'	200300	751000*		MOVE	T1,%HOM+HOMSPU	;15 Sats per unit (4 or 8)
  1290	002274'	137300	002056*		DPB	T1,UNYSPU	;43
  1291	002275'	205340	000000*		MOVSI	T2,UNPMSB	;400
  1292	002276'	412345	001714*		ANDCAM	T2,UNIDES(U)	;53
  1293	002277'	302300	000001		CAIE	T1,1		;If more than one SAT page
  1294	002300'	436345	002276*		 IORM	T2,UNIDES(U)	; then set Multiple Sat Blocks bit
  1295	002301'	200300	751000*		MOVE	T1,%HOM+HOMFEP	;14 Front-End Pointer (set on 2020 disks)
  1296	002302'	202305	000000*		MOVEM	T1,UNIFEP(U)	;07 (nonzero when BOOTS in pages 3-5 on KS)
  1297	002303'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 23
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1298				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO STR DB.
  1299
  1300	002304'	200300	751000*	MOVSTR:	MOVE	T1,%HOM+HOMSNM	;02 Structure name
  1301	002305'	202315	002262*		MOVEM	T1,STRNAM(P2)	;00
  1302	002306'	550300	751000*		HRRZ	T1,%HOM+HOMP4C	;26 Pages for CRASH.SAV
  1303	002307'	542315	000000*		HRRM	T1,STRP4C(P2)	;02
  1304	002310'	200300	751000*		MOVE	T1,%HOM+HOMSUF	;23 Page # of RIB to SYS on unit 0
  1305	002311'	661300	000101*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1306	002312'	202300	000000*		MOVEM	T1,SYSRIB##
  1307	002313'	200300	751000*		MOVE	T1,%HOM+HOMMFD	;25 Page # of RIB to MFD on unit 0
  1308	002314'	661300	002311*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1309	002315'	202300	000000*		MOVEM	T1,MFDRIB
  1310	002316'	200305	002015*		MOVE	T1,UNIPPU(U)	;41 Pages per unit
  1311	002317'	313315	000000*		CAMLE	T1,STRPPU(P2)	;06 If this one has more than any other in STR
  1312	002320'	202315	002317*		 MOVEM	T1,STRPPU(P2)	;06  then set this bogus value
  1313	002321'	200300	751000*		MOVE	T1,%HOM+HOMOVR
  1314	002322'	202315	000000*		MOVEM	T1,STROVR(P2)
  1315	002323'	200300	751000*		MOVE	T1,%HOM+HOMREF
  1316	002324'	502315	000000*		HLLM	T1,STRREF(P2)
  1317	002325'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 24
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1318				;Error messages
  1319	002326'	265340	761657	MSGLNG:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1320	002327'	261040	000006		PUSH	P,T1		;SAVE 2ND. MSG ADR. IN T1
  1321	002330'	200300	000010		MOVE	T1,T3		;GET ADR OF 1ST. MSG
  1322	002331'	260040	000000*		PUSHJ P,CLRSND
  1323	002332'	260040	761605		PUSHJ	P,TYPDEC	;PUT MSG. & UNIT # IN BUFFER
  1324	002333'	260040	002145*		PUSHJ	P,OPOUT		;O/P BUFFER
  1325	002334'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1326	002335'	304000	000000		CAIA
  1327
  1328	002336'	265340	761657	MSGSTR:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1329	002337'	260040	002242*		PUSHJ	P,OCONM		;PUT MSG. IN BUFFER
  1330	002340'	476000	761226		SETOM	ERRHOM		;INDICATE ERROR IN "RDHOME"
  1331	002341'	476000	761227		SETOM ERRHM2		;"BAD" ERROR
  1332	002342'	200355	002305*		MOVE	T2,STRNAM(P2)	;GET SIXBIT STR NAME
  1333	002343'	260040	002244*	NAMFLO:	PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER FOLLOWED BY CRLF & START O/P
  1334	002344'	324740	761620		PJRST	CRLFOP
  1335
  1336
  1337	002345'	265340	761657	MSGUNI:	JSP	T2,REFSAV
  1338	002346'	261045	002232*		PUSH	P,UNINAM(U)
  1339	002347'	260040	002337*		PUSHJ	P,OCONM
  1340	002350'	476000	761226		SETOM	ERRHOM
  1341	002351'	476000	761227		SETOM	ERRHM2
  1342	002352'	262040	000007		POP	P,T2
  1343	002353'	324740	761343		PJRST	NAMFLO
  1344
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 25
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1345				COMMENT #
  1346				@@SUBROUTINE GETHOM
  1347				@@PURPOSE
  1348				SUBR TO TRY TO READ BOTH OF A UNIT'S HOME PAGES SUCCESSFULLY
  1349				INTO %HOM.
  1350				@@ENTRY
  1351				EXPECTS U/ UNIT DB AND F/ DDB.
  1352				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1353				@@ACCUM
  1354				DESTROYS
  1355				@@EXIT
  1356				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1357				@@ #
  1358
  1359	002354'	205640	505755	GETHOM:	MOVSI	P2,(SIXBIT .HOM.)
  1360	002355'	201700	000000*		MOVEI	P3,CODHOM	;CODE WORD FOR HOME PAGES.
  1361	002356'	200740	763676		MOVE	P4,[XWD LPNHOM,LP2HOM]	;P4/ NO. 1ST PAGE,,2ND PAGE.
  1362	002357'	201140	000000*		MOVEI	PG,%HOM.P
  1363	002360'	324740	761370		PJRST	RDBOTH		;READ & VERIFY HOME PAGES.
  1364
  1365
  1366
  1367
  1368				COMMENT #
  1369				@@SUBROUTINE GETBAT
  1370				@@PURPOSE
  1371				SUBR TO TRY TO READ BOTH OF A UNIT'S BAT PAGES SUCCESSFULLY
  1372				INTO %BAT.
  1373				@@ENTRY
  1374				EXPECTS U/ UNIT DB AND F/ DDB.
  1375				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1376				@@ACCUM
  1377				DESTROYS
  1378				@@EXIT
  1379				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1380				@@ #
  1381
  1382	002361'	260040	761363	GETBAT:	PUSHJ	P,SETBAT	;
  1383	002362'	324740	761370		PJRST	RDBOTH		;
  1384
  1385
  1386
  1387
  1388				COMMENT #
  1389				@@SUBROUTINE SETBAT
  1390				@@PURPOSE
  1391				LITTLE SUBR TO SET UP SOME PARAMETERS FOR HANDLING BAT PAGES.
  1392				@@ #
  1393
  1394	002363'	205640	424164	SETBAT:	MOVSI	P2,(SIXBIT .BAT.)
  1395	002364'	201700	000000*		MOVEI	P3,CODBAT
  1396	002365'	200740	763677		MOVE	P4,[XWD LPNBAT,LP2BAT]
  1397	002366'	201140	000000*		MOVEI	PG,%BAT.P	;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 25-2
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1398	002367'	263040	000000		POPJ	P,
  1399
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 26
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1400				COMMENT #
  1401				@@SUBROUTINE RDBOTH
  1402				@@PURPOSE
  1403				SUBROUTINE TO READ SPECIAL REDUNDANT PAGES ON THE DISK (HOME
  1404				AND BAT) INTO CORE.
  1405				@@ENTRY
  1406				EXPECTS U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR SAT, P3/ AP-
  1407				PROPRIATE CODE WORD FOR PAGES, P4/ PAGE NO. ON THE
  1408				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1409				PRINTS NO ERROR MESSAGES IF NOERH <>0.
  1410				@@ACCUM
  1411				DESTROYS
  1412				@@CALLS
  1413				RDCHEK.
  1414				@@EXIT
  1415				NON-SKIP RETURNS ONLY IF BOTH PAGES ARE BAD.
  1416				T3/ 0 IF NO ERRORS, O'E LH(T3)<>0 IF ERROR ON 1ST PAGE AND
  1417				RH(T3)<>0 IF ERROR ON 2ND PAGE.
  1418				S=0 IF NO ERRORS, ELSE S HAS THE STANDARD RH ERROR BITS SET.
  1419				NOERH = 0 ON EXIT.
  1420				@@ #
  1421
  1422	002370'	200200	001604*	RDBOTH:	MOVE	F,DDSTAR	;F/ DDB.
  1423	002371'	402000	761515		SETZM	REDERR		;CLEAR ERR FLAG FOR BOTH PAGES.
  1424	002372'	476000	761516	FIROK:	SETOM	WHICH		;INDICATE READING 1ST PAGE.
  1425	002373'	554440	000017		HLRZ	T4,P4		;T4/ DISK PAGE NO.
  1426	002374'	260040	761407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1427	002375'	254000	761377		  JRST	REDSEC		;ERR DETECTED - GO TRY 2ND PAGE.
  1428	002376'	327400	761404		JUMPG	T3,RDBSKP	;NO ERR. JUMP TO SUCCESS IF WE
  1429								;ARE HERE FROM A BAD 2ND PAGE.
  1430
  1431	002377'	402000	761516	REDSEC:	SETZM	WHICH		;INDICATE READING 2ND PAGE.
  1432	002400'	550440	000017		HRRZ	T4,P4		;T4/ DISK PAGE NUMBER.
  1433	002401'	260040	761407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1434	002402'	321400	761405		  JUMPL	T3,RDBNON	;ERROR(S) DETECTED.  IF ON 1ST
  1435								;PAGE AS WELL, GIVES ERR RETURN.
  1436	002403'	327400	761372		JUMPG	T3,FIROK	;IF 2ND BAD 1ST OK GO RETRY 1ST.
  1437	002404'	350001	000000	RDBSKP:	AOS (P)			;SET FOR SKIP RETURN.
  1438	002405'	402000	761517	RDBNON:	SETZM NOERH		;CLR NO ERR MSG FLAG.
  1439	002406'	263040	000000		POPJ P,
  1440
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 27
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1441				COMMENT #
  1442				@@SUBROUTINE RDCHEK
  1443				@@PURPOSE
  1444				SUBR CALLED BY RDBOTH AND OTHERS TO READ A SPECIAL PAGE
  1445				INTO CORE AND CHECK FOR ERRORS.
  1446				@@ENTRY
  1447				EXPECTS  T4/ PAGE NO. ON UNIT, F/ FILE DB, PG/ PCB ADDRESS,
  1448				U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR
  1449				SAT, AND P3/ CODE WORD FOR PAGES.
  1450				WHICH <>0 FOR FIRST PAGE, =0 FOR 2ND.
  1451				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1452				@@CALLS
  1453				OPAGIN AND RDWMSG.
  1454				@@ACCUM
  1455				DESTROYS
  1456				@@EXIT
  1457				FOR 1ST PAGE, LH(T3)=0 UNLESS ERROR, IN WHICH CASE LH(T3)<>0.
  1458				FOR 2ND PAGE, RH(T3)=0 UNLESS ERROR, IN WHICH CASE RH(T3)<>0.
  1459				NON-SKIP RETURN IF ERROR, ELSE SKIP-RETURN.
  1460				IF NO ERROR, S=0 ELSE S HAS RH ERROR BITS SET.
  1461				@@ #
  1462
  1463	002407'	402000	761434	RDCHEK:	SETZM	CHKFLG		;CLR FLG FOR USE OF RDCHEK ONLY
  1464								;(NEEDED SINCE S ACCUMULATES.).
  1465	002410'	260040	761520		PUSHJ	P,OPAGIN	;READ THE PAGE.
  1466	002411'	334405	002346*		  SKIPA	T3,UNINAM(U)	;ERROR	- GET SIXBIT UNIT NAME.
  1467	002412'	254000	761416		JRST	CONCHK		;GO MAKE CONSISTANCY CHECKS.
  1468	002413'	201300	763700		MOVEI	T1,[ASCIZ . PAGE HARDWARE READ ERROR.]
  1469	002414'	260040	761465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE.
  1470	002415'	476000	761434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1471	002416'	260040	000000*	CONCHK:	PUSHJ	P,GETPEV	;GET VIRTUAL ADDR FOR PCB IN PG IN T2
  1472	002417'	316640	763706		CAMN	P2,[SIXBIT /SAT/] ;READING SAT.SYS RIB PAGE?
  1473	002420'	312647	000000*		CAME	P2,RIBNAM(T2)	;YES. NAME IN RIB = 'SAT'?
  1474	002421'	316647	000000*		 CAMN	P2,PAGNAM(T2)	;NO - CHECK BLOCK NAME(THIS ALWAYS FAILS WITH RIB)
  1475	002422'	312707	000000*		CAME	P3,PAGCOD(T2)	;OK - CHECK CODE WORD
  1476	002423'	334405	002411*		 SKIPA	T3,UNINAM(U)	;NO CHECK - GET SIXBIT UNIT NAME
  1477	002424'	254000	761430		  JRST	TSTCHK		;EXIT CHECKING ERRORS ON THE WAY
  1478	002425'	201300	763707		MOVEI	T1,[ASCIZ . PAGE CONSISTENCY ERROR.]
  1479	002426'	260040	761465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE
  1480	002427'	476000	761434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1481	002430'	200400	761515	TSTCHK:	MOVE	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1482	002431'	336000	761434		SKIPN	CHKFLG		;SKIP RETURN IF
  1483	002432'	350001	000000		 AOS	(P)		;NO ERRORS.
  1484	002433'	263040	000000		POPJ	P,
  1485
  1486	002434'	000000	000000	CHKFLG: Z	;FLAG FOR USE BY RDCHEK ONLY.
  1487
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 28
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1488				COMMENT #
  1489				@@SUBROUTINE WTBOTH
  1490				@@PURPOSE
  1491				SUBR TO WRITE SPECIAL REDUNDANT PAGES TO THE DISK (HOM
  1492				AND BAT) FROM CORE.
  1493				@@ENTRY
  1494				EXPECTS F/ FILE DB, U/ UNIT DB, P4/ PAGE NO. ON
  1495				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1496				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1497				@@ACCUM
  1498				DESTROYS
  1499				@@CALLS
  1500				OPAGOT AND RDWMSG.
  1501				@@EXIT
  1502				RETURNS WITH S = 0 IF NO ERRORS. OTHERWISE S HAS STANDARD
  1503				RH ERROR BITS SET.
  1504				T3/ 0 IF NO ERRORS, OTHERWISE RH(T3)<>0 IF ERROR ON 2ND PAGE
  1505				AND LH(T3)<>0 IF ON 1ST PAGE.
  1506				@@ #
  1507
  1508	002435'	402000	761515	WTBOTH:	SETZM	REDERR		;CLR ERR SWITCH FOR BOTH PAGES.
  1509	002436'	476000	761516		SETOM	WHICH		;INDICATE WRITING 1ST PAGE.
  1510	002437'	260040	002416*		PUSHJ	P,GETPEV	;GET VIRTUAL ADDRESS OF DATA FROM C(PG)
  1511	002440'	200600	000007		MOVE	P1,T2		;GET IN MORE PERMANENT PLACE THAN T2
  1512
  1513	002441'	135300	002272*	WRTRN1:	LDB	T1,UNYLUN	;ALSO WORKS FOR ONES NOT IN STR
  1514	002442'	205340	002314*		MOVSI	T2,RBREAL	;
  1515	002443'	137300	000000*		DPB	T1,RBYUNI	;
  1516	002444'	554440	000017		HLRZ	T4,P4		;
  1517	002445'	137440	000145*		DPB	T4,RBYPNO	;
  1518	002446'	202354	000000*		MOVEM	T2,PAGSLF(P1)	;
  1519	002447'	517000	000017		HRLZS	P4		;SETUP P4 FOR PAGE #2.
  1520	002450'	260040	761456		PUSHJ	P,WTCHEK	;GO WRITE OUT PAGE.
  1521	002451'	402000	761516		SETZM	WHICH		;INDICATE WRITING 2ND PAGE.
  1522	002452'	326740	761441		JUMPN	P4,WRTRN1	;HAVE WE WRITTEN BOTH PAGES?
  1523	002453'	336400	761515		SKIPN	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1524	002454'	350001	000000		 AOS	(P)		;SKIP RETURN IF NO ERRORS.
  1525	002455'	263040	000000		POPJ	P,		;
  1526
  1527	002456'	260040	761523	WTCHEK:	PUSHJ	P,OPAGOT	;TRY TO WRITE THE PAGE.
  1528	002457'	254000	761461		  JRST	.+2		;ERRORS.
  1529	002460'	263040	000000		POPJ	P,		;WON.
  1530	002461'	201300	763714		MOVEI	T1,[ASCIZ .HARDWARE WRITE ERROR.]
  1531	002462'	200405	002423*		MOVE	T3,UNINAM(U)	;PICK UP UNIT NAME AND PRINT
  1532	002463'	260040	761465		PUSHJ	P,RDWMSG	;ERROR MSG. FOR PAGE TYPE.
  1533	002464'	263040	000000		POPJ	P,
  1534
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 29
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1535				COMMENT #
  1536				@@SUBROUTINE RDWMSG
  1537				@@PURPOSE
  1538				SUBR TO PRINT ERROR MSG. FOR RDCHEK AND WTCHEK, AND TO SET
  1539				REDERR APPROPRIATELY.
  1540				(REDERR IS AN INTERNAL FLAG FOR RDBOTH AND WTBOTH.).
  1541				@@ENTRY
  1542				EXPECTS T1/ MSG. ADR. AND T3/ SIXBIT UNIT NAME.
  1543				IF NOERH <>0, DOES NOTHING AND RETURNS IMMEDIATELY.
  1544				@@ACCUM
  1545				DESTROYS
  1546				@@CALLS
  1547				SVOTAC, CLRSND, PRNAME, CONMES, AND CRLFOP.
  1548				@@EXIT
  1549				RETURNS LH. OR RH. OF REDERR = -1, DEPENDING ON WHETHER 1ST
  1550				OR 2ND PAGE, RESPECTIVELY, HAS ERROR.
  1551				@@ #
  1552
  1553	002465'	332000	761517	RDWMSG:	SKIPE	NOERH
  1554	002466'	263040	000000		 POPJ	P,		;DO NOT PRINT ERR MSG.
  1555	002467'	265340	761660		JSP	T2,SVOTAC	;SAVE T3,F,U & J
  1556	002470'	261040	000003		PUSH	P,PG		;SAVE PG.
  1557	002471'	261040	000006		PUSH	P,T1		;SAVE ADDR OF MESSAGE
  1558	002472'	260040	002331*		PUSHJ	P,CLRSND
  1559	002473'	200340	000010		MOVE	T2,T3		;SIXBIT UNIT NAME
  1560	002474'	260040	002343*		PUSHJ	P,PRNAME	;PUT NAME IN BUFFER
  1561	002475'	201300	763721		MOVEI	T1,[ASCIZ . FIRST .] ;PRESUME ERROR ON 1ST PAGE.
  1562	002476'	332000	761516		SKIPE	WHICH		;2ND. PAGE WAS READ?
  1563	002477'	254000	761502		 JRST	FSTERR		;NO - 1ST. PAGE.
  1564	002500'	523000	761515		HLLOS	REDERR		;INDICATE ERROR ON 2ND. PAGE.
  1565	002501'	334300	763725		SKIPA	T1,[[ASCIZ . SECOND .]]
  1566	002502'	563000	761515	FSTERR:	 HRROS	REDERR		;INDICATE ERROR ON 1ST. PAGE.
  1567	002503'	260040	002246*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1568	002504'	200340	000015		MOVE	T2,P2		;GET SIXBIT PAGE TYPE(HOME OR "BAT")
  1569	002505'	316640	763706		CAMN	P2,[SIXBIT .SAT.] ;IF THIS WAS A RIB PAGE
  1570	002506'	541340	625142		 HRRI	T2,(SIXBIT .RIB.) ; TYPE "SATRIB"
  1571	002507'	260040	002474*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1572	002510'	262040	000006		POP	P,T1		;ADDR OF MESSAGE
  1573	002511'	260040	002503*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1574	002512'	260040	761620		PUSHJ	P,CRLFOP	;CRLF AND TYPE MESSAGE
  1575	002513'	262040	000003		POP	P,PG		;RESTORE PG.
  1576	002514'	263040	000000		POPJ	P,
  1577
  1578	002515'	000000	000000	REDERR:	0			;ERR WORD FOR RDBOTH AND WTBOTH.
  1579								; RH=-1 IF ERROR ON 2ND. PAGE,
  1580								; LH "  "    "   "  1ST.   "
  1581	002516'	000000	000000	WHICH:	0			;FLAG TO INDICATE WHETHER 2ND
  1582								;OR 1ST PAGE BEING READ.
  1583
  1584	002517'	000000	000000	NOERH:	0			;FLAG TO NOT PRINT ERROR FROM UPDHOM.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 30
ONCDSK.MAC	14-APR-88 23:38		FILMAN

  1585				COMMENT #
  1586				@@SUBROUTINE OPAGIN/OPAGOT
  1587				@@PURPOSE
  1588				ONCE-TIME SUBR TO READ OR WRITE A PAGE.
  1589				@@ENTRY
  1590				ENTRY POINT OPAGOT IS TO WRITE A PAGE, ENTRY POINT OPAGIN IS TO
  1591				READ A PAGE.
  1592				EXPECTS U/ UNIT DB, T4/ PAGE NUMBER ON THE UNIT,
  1593				PG/ ONCE-TIME PCB ADDRESS, AND F/ DDB.
  1594				@@ACCUM
  1595				DESTROYS T1-T4 AND S.
  1596				@@EXIT
  1597				SKIP RETURNS IF NO ERRORS, ELSE NON-SKIP RETURNS AND T3 HAS
  1598				THE PGYERR BITS.
  1599				@@ #
  1600
  1601				    ;HERE TO READ A PAGE.
  1602	002520'	201400	000000*	OPAGIN:	MOVEI	T3,PAGIN	;FILIO SUBR TO CALL.
  1603	002521'	201300	000000*		MOVEI	T1,STDREA
  1604	002522'	254000	761525		JRST	OPAGIO
  1605
  1606				    ;HERE TO WRITE A PAGE.
  1607	002523'	201400	000000*	OPAGOT:	MOVEI	T3,PAGOUT	;FILIO SUBR TO CALL.
  1608	002524'	201300	000000*		MOVEI	T1,STDWRT
  1609
  1610	002525'	261040	000003	OPAGIO:	PUSH	P,PG		;SAVE PG.
  1611	002526'	200340	000003		MOVE	T2,PG		;SET UP T2/ PCB ADDR AND
  1612	002527'	137300	000000*		DPB	T1,PCISTS	;SET FLAG FOR INTRPT LEVEL.
  1613	002530'	554147	000000*		HLRZ	PG,PCBPAG(T2)	;PG/ IN-CORE PAGE NUMBER.
  1614	002531'	400300	000000		SETZ	T1,		;CLEAR ANY
  1615	002532'	137300	000000*		DPB	T1,PGYERR	;ERROR BITS.
  1616	002533'	260040	000000*		PUSHJ	P,OHTINI	;CLEAR OUT ALL OUTPUT ERRORS (SHOULD BE 1 AT THE MOST.)
  1617	002534'	137440	000000*		DPB	T4,PGYPNO	;SET THE "UNIT NUMBER" AND
  1618	002535'	135300	002441*		LDB	T1,UNYLUN	;PAGE NUMBER IN PGYADR.
  1619	002536'	312246	002114*		CAME	U,UNTTBL(T1)	;STRANGE CROCK TO
  1620	002537'	202246	002536*		MOVEM	U,UNTTBL(T1)	;HELP SWPENQ AND FINPCB, WHICH
  1621	002540'	137300	000000*		DPB	T1,PGYUNI	;EXPECT UNTTBL TO BE SET UP.
  1622	002541'	261040	000007		PUSH	P,T2		;SAVE PCB ADDR.
  1623	002542'	260050	000000		PUSHJ	P,(T3)		;CALL PAGIN OR PAGOUT.
  1624	002543'	262040	000007		POP	P,T2		;RESTORE PCB ADDRESS.
  1625	002544'	135400	002527*		LDB	T3,PCISTS	;WAIT FOR
  1626	002545'	602400	000000*		TRNE	T3,STDWRT!STDREA ;THE INTRPT ON COMPLETION TO
  1627	002546'	254000	761544		 JRST	.-2		;HAPPEN.
  1628	002547'	135400	002532*		LDB	T3,PGYERR	;GET ERRORS.
  1629	002550'	262040	000003		POP	P,PG		;RESTORE PG/ PCB ADDR.
  1630	002551'	336000	000000*		SKIPN	OHTNUM		;SKIP IF GOT AN OUTPUT ERROR.
  1631	002552'	322400	002257*		 JUMPE	T3,CPOPJ1	;SKIP RETURN IF NO ERRORS
  1632	002553'	263040	000000		POPJ	P,		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 31
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1633				SUBTTL	CHECK ON DISK CAPACITY
  1634
  1635				DEFINE DSKOFF <WRPI DSKPIF##>
  1636				DEFINE DSKON  <WRPI DSKPIN##>
  1637
  1638				IFCPU(<KI,KL>),<
  1639				CPYMSG:	[ASCIZ	/IBM 3330-1/]	  ;0 3330-1  (100 MEGABYTE) IBM DISK ON SA10
  1640					[ASCIZ	/3330-II or 3675/];1 3330-11 (200 MEGABYTE) IBM DISK ON SA10
  1641					[ASCIZ	/3650 or 3652/]	  ;2 3650/52 (300 MEGABYTE) Memorex disk on SA10
  1642					[ASCIZ	/IBM compatible/] ;3 reserved for other IBM disk on SA10
  1643				CPYFLG:	-1			;Output geometry message first time thru
  1644				>  ;End IFCPU(<KI,KL>)
  1645
  1646	002554'	550105	001667*	DSKCPY:	HRRZ	J,UNIKON(U)	;Point to kontroller for this unit
  1647	002555'	700600	000000*		DSKOFF
  1648	002556'	332005	000000*		SKIPE	UNISTS(U)	;Unit must be idle before setting CWCOD
  1649					 JRST	[DSKON
  1650	002557'	254000	763726			 POPJ	P,]	;Should never get here
  1651	002560'	201300	000000*		MOVEI	T1,CWCOD	;Set unit to capacity-test wait
  1652	002561'	202305	002556*		MOVEM	T1,UNISTS(U)
  1653	002562'	700600	000000*		DSKON			;Turn on disk interrupts
  1654	002563'	260040	000000*		PUSHJ	P,IOSEL		;Start it going
  1655	002564'	205300	000100		MOVSI	T1,100		;Approx 16 seconds
  1656	002565'	332005	002561*	CPYWAT:	SKIPE	UNISTS(U)	;Done yet?
  1657	002566'	367300	761565		 SOJG	T1,CPYWAT	;Wait for unit to be idle
  1658
  1659				IFCPU(<KI,KL>),<;Output what type of disk was found
  1660					SKIPG	UNIONC(U)	;Is it on-line?
  1661					 POPJ	P,		;No
  1662					LDB	T2,UNYKTP##	;Get type of kontroller
  1663					CAIN	T2,4		;Is it "BP"?
  1664					AOSE	CPYFLG		;Yes, has message been output yet?
  1665					 POPJ	P,		;Don't mention it
  1666					LDB	T1,UNYUTP##	;Get unit type
  1667					MOVE	T1,CPYMSG(T1)	;Description
  1668					PUSHJ	P,CONMES
  1669					MOVEI	T1,[ASCIZ / unknown format/]
  1670					LDB	T2,UNYBPR##	;Get blocks per record
  1671					CAIN	T2,1		;Does each record = 1 block?
  1672					 MOVEI	T1,[ASCIZ / formatted in blocks/]
  1673					CAIN	T2,4		;Does each record = 4 blocks?
  1674					 MOVEI	T1,[ASCIZ / formatted in pages/]
  1675					JUMPE	T1,CPOPJ	;No message if unit is off-line
  1676					PUSHJ	P,CONOUT	;How formatted
  1677				>  ;End IFCPU(KI,KL)
  1678	002567'	263040	000000		POPJ	P,		;End of DSKCPY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 32
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1679				;SUBROUTINE TO EXECUTE AN INSTRUCTION FOR ALL UNITS WITHIN A STR.
  1680				; USUALLY STORES A BYTE
  1681				;T1=INSTRUCTION TO BE EXECUTED, P1=ARG., P2=STR DATA BLOCK ADR.
  1682
  1683	002570'	554255	002173*	STOUNI:	HLRZ	U,STRUNI(P2)
  1684	002571'	261040	000006		PUSH	P,T1
  1685	002572'	256001	000000	STOUN1:	XCT	(P)		;EXECUTE INSTRUCTION SUPPLIED IN AC T1
  1686	002573'	554245	002214*		HLRZ	U,UNISTR(U)
  1687	002574'	326240	761572		JUMPN	U,STOUN1
  1688	002575'	254000	000000*		JRST	TPOPJ
  1689
  1690
  1691
  1692
  1693	002576'	265340	761660	DECLOP:	JSP	T2,SVOTAC	;Output string in T1 then number in P1
  1694	002577'	260040	761605		PUSHJ	P,TYPDEC
  1695	002600'	324740	761620		PJRST	CRLFOP
  1696
  1697	002601'	265340	761660	TYPMSN:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1698	002602'	260040	002472*		PUSHJ P,CLRSND
  1699	002603'	260040	761605		PUSHJ	P,TYPDEC	;PUT MSG. IN THE BUFFER FOLLOWED BY DECIMAL #
  1700	002604'	324740	002333*		PJRST	OPOUT		;O/P THE BUFFER
  1701
  1702	002605'	260040	002511*	TYPDEC:	PUSHJ	P,CONMES	;Output message in T1
  1703	002606'	200300	000014		MOVE	T1,P1		;Then number in P1
  1704	002607'	324740	000000*		PJRST	RADX10
  1705
  1706
  1707
  1708
  1709	002610'	334355	002342*	SPSNAM:	SKIPA	T2,STRNAM(P2)
  1710	002611'	200345	002462*	SPUNAM:	MOVE	T2,UNINAM(U)
  1711	002612'	324740	002507*		PJRST PRNAME
  1712
  1713	002613'	476000	761227	SVMOT2:	SETOM ERRHM2
  1714	002614'	476000	761226	SVMOTE:	SETOM	ERRHOM
  1715	002615'	260040	002602*		PUSHJ P,CLRSND
  1716	002616'	265340	761660	SVMOUT:	JSP	T2,SVOTAC
  1717	002617'	260040	002605*	CONOUT:	PUSHJ	P,CONMES
  1718	002620'	260040	000000*	CRLFOP:	PUSHJ	P,CRLF
  1719	002621'	324740	002604*		PJRST	OPOUT
  1720
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 33
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1721	002622'	265340	761660	ASKQUE:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1722	002623'	324740	000303*		PJRST	YESNO		;GET USER'S RESPONSE - SKIP RETURN IF 1ST.
  1723								;T3="Y" NON SKIP RETURN IF ANYTHING ELSE TYPED
  1724
  1725
  1726
  1727				;T2 & T3 ARE RESPECTED
  1728
  1729	002624'	205300	000167*	SETCHG:	MOVSI	T1,UNPCHG	;PREPARE TO FLAG HOME PAGES NEED REWRITING
  1730	002625'	205440	000000*		MOVSI	T4,UNPOFL!UNPHWP
  1731	002626'	616445	002300*		TDNN	T4,UNIDES(U)	;IS UNIT WRITE PROTECTED OR OFF-LINE?
  1732	002627'	436305	002626*		IORM	T1,UNIDES(U)	;SET UNPCHG FLAG
  1733	002630'	263040	000000		POPJ	P,		;RETURN
  1734
  1735
  1736
  1737				;SUBR TO MARK A UNIT AS A PRIVATE/PUBLIC PACK.
  1738	002631'	205400	001613*	SETPUB:	MOVSI	T3,UNPPRV	;
  1739	002632'	412405	002627*		ANDCAM	T3,UNIDES(U)	;
  1740	002633'	263040	000000		POPJ	P,		;
  1741
  1742	002634'	205400	002631*	SETPRV:	MOVSI	T3,UNPPRV	;
  1743	002635'	436405	002632*		IORM	T3,UNIDES(U)	;
  1744	002636'	263040	000000		POPJ	P,		;
  1745	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 34
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1746				;Get name of physical unit
  1747	002637'	260040	002252*	GETUNI:	PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1748	002640'	263040	000000		  POPJ	P,		;JUST CR TYPED - NON SKIP RETURN
  1749	002641'	260040	000212*		PUSHJ	P,CTEXT		;GET SIXBIT UNIT NAME
  1750	002642'	402000	000005		SETZM	U		;ASSUME "ALL" WAS TYPED
  1751	002643'	554300	000007		HLRZ	T1,T2		;MAKE AC LOOK GOOD FOR COMPARE
  1752	002644'	260040	761651		PUSHJ	P,FNDUNI	;SEE IF UNIT EXISTS & RETURN WITH UNIT DATA BLOCK
  1753	002645'	334300	763736		  SKIPA	T1,[[ASCIZ .NOT A PHYSICAL UNIT-TRY AGAIN.]]
  1754	002646'	254000	002552*		 JRST	CPOPJ1		;UNIT EXISTS - SKIP RETURN
  1755	002647'	260040	761616		PUSHJ	P,SVMOUT	;ADD CRLF & O/P MSG.
  1756	002650'	254000	761637		JRST	GETUNI		;TRY AGAIN
  1757
  1758	002651'	554240	002102*	FNDUNI:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1759	002652'	316345	002611*	FNDUN1:	CAMN	T2,UNINAM(U)	;MATCH?
  1760	002653'	254000	002646*		 JRST	CPOPJ1		;YES - SKIP RETURN
  1761	002654'	554245	002115*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DATA BLOCK ADR. IN SYSTEM
  1762	002655'	326240	761652		JUMPN	U,FNDUN1	;REPEAT IF THERE IS ONE
  1763	002656'	263040	000000		POPJ	P,		;NONE FOUND - NON SKIP RETURN
  1764
  1765				;SUBROUTINE TO PRESERVE AC'S P4,F,U & J
  1766
  1767	002657'	563015	002324*	REFSAV:	HRROS	STRREF(P2)	;INDICATE STR NEEDS REFRESHING
  1768	002660'	261040	000017	SVOTAC:	PUSH	P,P4
  1769	002661'	261040	000010		PUSH	P,T3
  1770	002662'	261040	000004		PUSH	P,F
  1771	002663'	261040	000005		PUSH	P,U
  1772	002664'	261040	000002		PUSH	P,J
  1773	002665'	260047	000000		PUSHJ	P,(T2)
  1774	002666'	304000	000000		  CAIA
  1775	002667'	350001	777773		AOS	-5(P)
  1776	002670'	262040	000002		POP	P,J
  1777	002671'	262040	000005		POP	P,U
  1778	002672'	262040	000004		POP	P,F
  1779	002673'	262040	000010		POP	P,T3
  1780	002674'	262040	000017		POP	P,P4
  1781	002675'	263040	000000		POPJ	P,
  1782
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 35
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1783				COMMENT #
  1784				@@SUBROUTINE REDBAT
  1785				@@PURPOSE
  1786				SUBR TO READ AND VERIFY THE BAT PAGES ON ALL UNITS IN THE SYSTEM.
  1787				@@ENTRY
  1788				EXPECTS
  1789				@@CALLS
  1790				CHKBAT AND SCNBAT.
  1791				@@ACCUM
  1792				DESTROYS
  1793				@@ #
  1794
  1795	002676'	554240	002651*	REDBAT:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DB IN THE SYSTEM.
  1796	002677'	205740	001677*		MOVSI	P4,UNPOFL
  1797	002700'	612745	002635*	RDBAT1:	TDNE	P4,UNIDES(U)	;UNIT OFF-LINE?
  1798	002701'	254000	761704		JRST	RDBAT6		;YES, GO READ NEXT BAT PAGE
  1799	002702'	260040	761707		PUSHJ	P,CHKBAT	;NO - GO CHECK "BAT" PAGES FOR THIS UNIT
  1800	002703'	255000	000000		  JFCL			;IGNORE ERRORS
  1801	002704'	554245	002654*	RDBAT6:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA PAGE IN SYSTEM
  1802	002705'	326240	761700		JUMPN	U,RDBAT1	;REPEAT IF THERE IS ONE
  1803	002706'	263040	000000		POPJ	P,		;NONE LEFT - EXIT
  1804
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 36
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1805				COMMENT #
  1806				@@SUBROUTINE CHKBAT/BATREF
  1807				@@PURPOSE
  1808				SUBR TO READ THE BAT PAGES AND ALLOW THE USER TO REINITIALIZE
  1809				THEM IF THEY ARE BAD.
  1810				@@ENTRY
  1811				THE ENTRY POINT CHKBAT READS THE BAT PAGES AND IF ERRORS ARE
  1812				FOUND, ASKS THE USER IF HE/SHE WISHES TO REINITIALIZE THE BAT
  1813				PAGES.  IF YES, IT FALLS INTO BATREF, WHICH DOES.
  1814				EXPECTS U/ UNIT DB AND F/ DDB.
  1815				@@ACCUM
  1816				DESTROYS
  1817				@@CALLS
  1818				SVOTAC, GETBAT, ASKQUE, CORZER, SETBAT, AND WTBOTH.
  1819				@@EXIT
  1820
  1821				@@ #
  1822
  1823	002707'	265340	761660	CHKBAT:	JSP	T2,SVOTAC	;SAVE P4,F,U & J.
  1824	002710'	402000	761742		SETZM	BATBAD		;CLEAR BAT PAGE BAD FLAG.
  1825	002711'	260040	761361		PUSHJ	P,GETBAT	;READ BOTH BAT PAGES & VERIFY THEM.
  1826	002712'	255000	000000		  JFCL			;ERROR(S)
  1827	002713'	336300	761515		SKIPN	T1,REDERR	;ANY ERRORS FOUND AT ALL IN EITHER BAT PAGE?
  1828	002714'	324740	761435		 PJRST	WTBOTH		;No, rewrite UNI field of self pointer
  1829	002715'	202300	761742		MOVEM	T1,BATBAD	;YES. BAD BAT PAGE.
  1830	002716'	332000	761743		SKIPE	BATMAN		;DO NOT GET TO REFRESH IF FORCED
  1831	002717'	263040	000000		 POPJ	P,		; (I.E. FROM FILMAN).
  1832					MOVEI	T1,[ASCIZ .
  1833				Do you want to initialize the BAT pages on this UNIT?
  1834	002720'	201300	763737	.]
  1835	002721'	205340	001713*		MOVSI	T2,UNPHWP
  1836	002722'	616345	002700*		TDNN	T2,UNIDES(U)	;DON'T INITIALIZE IF UNIT HARDWARE WRITE-PROTECT
  1837	002723'	260040	761622		 PUSHJ	P,ASKQUE	;TYPE QUESTION & GET USER'S RESPONSE
  1838	002724'	263040	000000		  POPJ	P,		;HE DOESN'T WANT TO
  1839					MOVEI	T1,[ASCIZ .
  1840				THIS is not normally done, are you SURE?
  1841	002725'	201300	763753	.]
  1842	002726'	260040	761622		PUSHJ	P,ASKQUE	;ASK AGAIN
  1843	002727'	263040	000000		  POPJ	P,		;HE SAVED HIMSELF SOME BOTHER
  1844	002730'	200400	000014		MOVE T3,P1		;GET CORE PNTR IN CORRECT AC.
  1845
  1846	002731'	201300	745000	BATREF:	MOVEI	T1,%BAT
  1847	002732'	260040	001721*		PUSHJ	P,CORZER	;
  1848	002733'	260040	761363		PUSHJ	P,SETBAT	;
  1849	002734'	202640	745000*		MOVEM	P2,%BAT+PAGNAM	;PUT SIXBIT 'BAT' IN THE PAGE.
  1850	002735'	205300	000000*		MOVSI	T1,-BRMAX	;SETUP AOBJN PTR. TO BE STORED IN PAGE
  1851	002736'	541300	000000*		HRRI	T1,BATREG
  1852	002737'	202300	745000*		MOVEM	T1,%BAT+BATFIR ;SAVE IT IN THE PAGE
  1853	002740'	202700	745000*		MOVEM	P3,%BAT+PAGCOD ;SAVE THE CODE FOR BAT PAGES IN THE PAGE
  1854	002741'	324740	761435		PJRST	WTBOTH		;
  1855
  1856	002742'	000000	000000	BATBAD:	0			;0 INDICATES VIRGIN BAT PAGES(INITIALIZED)
  1857								; LH = -1 INDICATES ERROR(S) DETECTED WHILE READING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 36-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1858								; RH = # BAD REGIONS ON UNIT
  1859	002743'	000000	000000	BATMAN:	0			;0=OPTIONAL, -1=MANDATORY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 37
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1860				;SUBROUTINE TO TYPE SIXBIT UNIT NAME FOLLOWED BY (ID)
  1861				; ENTER WITH U = UNIT DATA BLOCK ADR.
  1862
  1863	002744'	201600	763764	TYPUNI:	MOVEI	P1,[ASCIZ .,.]
  1864	002745'	200300	000014	TYPUN1:	MOVE	T1,P1		;GET MSG. ADR. INTO KOSHER AC
  1865	002746'	260040	002617*		PUSHJ	P,CONMES	;PUT "," OR MSG. IN BUFFER
  1866	002747'	322240	002621*		JUMPE	U,OPOUT	;JUST O/P MSG.
  1867	002750'	260040	761611		PUSHJ	P,SPUNAM	;PUT SIXBIT UNIT NAME IN BUFFER
  1868	002751'	201300	763765		MOVEI	T1,[ASCIZ .(.]
  1869	002752'	260040	002746*		PUSHJ	P,CONMES	;PUT "(" IN BUFFER
  1870	002753'	332345	002270*		SKIPE	T2,UNIHID(U)	;GET SIXBIT UNIT ID - IF ANY
  1871	002754'	260040	002612*		PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER
  1872	002755'	201300	763766		MOVEI	T1,[ASCIZ .).]
  1873	002756'	260040	002752*		PUSHJ	P,CONMES	;PUT ")" IN THE BUFFER
  1874	002757'	324740	002747*		PJRST	OPOUT		;O/P BUFFER
  1875
  1876				;SUBROUTINE TO TYPE STR NAME IN "SYS" SEARCH LIST.
  1877
  1878				TYPSYS:	MOVEI	T1,[ASCIZ .
  1879	002760'	201300	763767	STR IN "SYS" SEARCH LIST:.]
  1880	002761'	260040	761617		PUSHJ	P,CONOUT
  1881	002762'	260040	761610		PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1882	002763'	324740	002757*		PJRST	OPOUT		;O/P BUFFER & EXIT
  1883	002764'	324740	761620	TYPSR1:	PJRST	CRLFOP		;O/P CRLF
  1884
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 38
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1885				;SUBROUTINE TO TYPE ALL UNITS IN SYSTEM THAT ARE NOT IN ANY STR
  1886				; RETURN WITH P1,P4,F,U & J DESTROYED
  1887
  1888				TYPUNS:	MOVEI	P1,[ASCIZ .
  1889				UNITS NOT IN A FILE STRUCTURE:
  1890	002765'	201600	763775	.]
  1891	002766'	554240	002676*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1892	002767'	634740	000017		TDZA	P4,P4		;INDICATE UNIT ID TO BE TYPED IN TYPUNI
  1893	002770'	554245	002704*	TYPNS1:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1894	002771'	322240	001546*		JUMPE	U,CPOPJ		;EXIT IF NONE LEFT
  1895	002772'	332005	002266*		SKIPE	UNILOG(U)	;IS THIS UNIT IN A STR?
  1896	002773'	254000	761770		JRST	TYPNS1		;YES - CHECK NEXT UNIT
  1897	002774'	260040	761745		PUSHJ	P,TYPUN1	;NO - TYPE MSG., UNIT NAME & (ID)
  1898
  1899	002775'	554245	002770*	TYPNS2:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1900	002776'	322240	761764		JUMPE	U,TYPSR1	;O/P CRLF & EXIT IF NONE LEFT
  1901	002777'	336005	002772*		SKIPN	UNILOG(U)	;IS THIS UNIT IN A STR?
  1902	003000'	260040	761744		PUSHJ	P,TYPUNI	;YES - TYPE "," UNIT NAME & (ID)
  1903	003001'	254000	761775		JRST	TYPNS2		;REPEAT
  1904
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 39
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1905				;SUBROUTINE TO TYPE THE STR & ITS UNITS.
  1906				; RETURN WITH P1,P4,F,U & J DESTROYED
  1907
  1908	003002'	402000	000017	TYPSTR:	SETZM	P4		;INDICATE UNIT ID TO BE PRINTED IN TYPUNI
  1909	003003'	201640	002260*		MOVEI	P2,STRDDB	;ADR. OF STR DATA BLOCK.
  1910	003004'	336015	002610*		SKIPN	STRNAM(P2)	;ANY STR?
  1911	003005'	263040	000000		POPJ	P,		;NO.
  1912				    ;TYPE STR NAME & ALL ITS UNITS.
  1913
  1914	003006'	510355	002657*		HLLZ	T2,STRREF(P2)
  1915	003007'	322340	762012		JUMPE	T2,NOREF	;DOES STR NEED REFRESHING?
  1916	003010'	201300	764004		MOVEI	T1,[ASCIZ .NEEDS REFRESHING .]		;YES
  1917	003011'	260040	002756*		PUSHJ	P,CONMES	;PUT MSG IN BUFFER
  1918	003012'	260040	761610	NOREF:	PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1919	003013'	554255	002570*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT IN STR
  1920	003014'	322240	761620		JUMPE	U,CRLFOP	;IF NO UNITS IN STR - O/P BUFFER WITH CRLF & EXIT
  1921	003015'	260040	002763*		PUSHJ	P,OPOUT	;O/P BUFFER
  1922	003016'	201600	764010		MOVEI	P1,[ASCIZ .:.]
  1923	003017'	260040	761745		PUSHJ	P,TYPUN1	;TYPE ":" UNIT NAME & (ID) [IST. TIME THRU]
  1924	003020'	554245	002573*	TYPST1:	HLRZ	U,UNISTR(U)	;GET NEXT UNIT DATA BLOCK IN STR
  1925	003021'	322240	761764		JUMPE	U,TYPSR1	;IF NO MORE UNITS - ADD CRLF & EXIT
  1926	003022'	260040	761744		PUSHJ	P,TYPUNI	;TYPE "," UNIT NAME & (ID)
  1927	003023'	254000	762020		JRST	TYPST1		;REPEAT UNTIL NO MORE UNITS IN STR
  1928
  1929	003024'	260040	762002	TYPALL:	PUSHJ P,TYPSTR
  1930	003025'	260040	761765		PUSHJ P,TYPUNS
  1931	003026'	260040	761760		PUSHJ P,TYPSYS
  1932	003027'	254000	757325		JRST FILCMD
  1933
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 40
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1934				;ROUTINE TO TYPE VALUE AND MESSAGE OR ASK FOR NEW
  1935				;VALUE USING MIN AND MAX
  1936				;ONLY TYPE IF TYPONL NON-0
  1937				;DBLSTD MAY HAVE 2 VALUES TO TRY WITHOUT ASKING
  1938				;VALUE IN P1, MSG IN T1, RESULT IN T2
  1939				;NON-SKIP RETURN IF UNCHANGED OR ONLY TYPING
  1940
  1941	003030'	335000	762112	ASKQMM:	SKIPGE TYPONL
  1942	003031'	254000	761576		 JRST DECLOP	;JUST TYPE IT
  1943	003032'	202300	762107		MOVEM T1,MSGSAV	;SAVE MESSAGE
  1944	003033'	202600	762111		MOVEM P1,VALSAV	;AND VALUE
  1945	003034'	200340	762114		MOVE T2,MIN
  1946	003035'	316340	762113		CAMN T2,MAX
  1947	003036'	254000	762066		JRST RETFIX	;ONLY ONE POSSIBLE VALUE
  1948	003037'	331000	762110	ASKRPT:	SKIPL DBLSTD
  1949	003040'	254000	762072		JRST QSTSTD	;TRY A STANDARD ANSWER
  1950	003041'	260040	762126		PUSHJ P,FTYUNI	;FORCED TYPE OF UNIT?
  1951	003042'	254000	762045		 JRST KNNUNI	;NO
  1952	003043'	200300	762107		MOVE T1,MSGSAV
  1953	003044'	200600	762111		MOVE P1,VALSAV	;MAKE SURE RESTORED
  1954	003045'	260040	761576	KNNUNI:	PUSHJ P,DECLOP	;TYPE VALUE AND MESSAGE
  1955	003046'	201300	764011		MOVEI T1,[ASCIZ /MIN = /]
  1956	003047'	200600	762114		MOVE P1,MIN
  1957	003050'	260040	761605		PUSHJ P,TYPDEC
  1958	003051'	201300	764013		MOVEI T1,[ASCIZ / MAX = /]
  1959	003052'	200600	762113		MOVE P1,MAX
  1960	003053'	260040	761576		PUSHJ P,DECLOP
  1961	003054'	260040	002637*		PUSHJ P,GETLIN
  1962	003055'	254000	762076		 JRST KEPSAM	;DOES NOT WANT IT CHANGED
  1963	003056'	260040	000000*		PUSHJ P,DECIN
  1964	003057'	255000	000000		 JFCL
  1965	003060'	254000	762104		 JRST ASKRP1	;ASK FOR IT AGAIN, WAS BAD
  1966	003061'	306400	000055		CAIN	T3,"-"	;IS HYPHEN TERMINATOR?
  1967	003062'	254000	762104		JRST	ASKRP1	;YES, NEGATIVE RESPONSE ILLEGAL
  1968	003063'	317340	762113	CHKANS:	CAMG T2,MAX
  1969	003064'	315340	762114		CAMGE T2,MIN
  1970	003065'	254000	762100		JRST ASKRPQ	;NOT IN RANGE
  1971	003066'	312340	762111	RETFIX:	CAME T2,VALSAV
  1972	003067'	350001	000000		AOS (P)
  1973	003070'	476000	762110		SETOM DBLSTD	;SO NOTHING THERE NEXT TIME
  1974	003071'	263040	000000		POPJ P,
  1975
  1976	003072'	554340	762110	QSTSTD:	HLRZ T2,DBLSTD	;GET FIRST TRY
  1977	003073'	306340	377777		CAIN T2,377777
  1978	003074'	200340	762113		MOVE T2,MAX	;FLAG FOR MAX
  1979	003075'	254000	762063		JRST CHKANS
  1980
  1981	003076'	200340	762111	KEPSAM:	MOVE T2,VALSAV
  1982	003077'	254000	762063		JRST CHKANS
  1983
  1984				ASKRPQ:	MOVEI T1,[ASCIZ /
  1985	003100'	201300	764015	VALUE NOT IN PERMITTED RANGE/]
  1986	003101'	335000	762110		SKIPGE DBLSTD	;NO ERROR IF STANDARD SETTING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 40-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  1987	003102'	260040	761617		PUSHJ P,CONOUT	;PUT OUT THE MESSAGE
  1988	003103'	527000	762110		HRLOS DBLSTD	;TRY SECOND STANDARD IF PRESENT
  1989	003104'	200300	762107	ASKRP1:	MOVE T1,MSGSAV
  1990	003105'	200600	762111		MOVE P1,VALSAV
  1991	003106'	254000	762037		JRST ASKRPT	;TRY AGAIN
  1992
  1993	003107'	000000	000000	MSGSAV:	0
  1994	003110'	000000	000000	DBLSTD:	0
  1995	003111'	000000	000000	VALSAV:	0
  1996	003112'	000000	000000	TYPONL:	0
  1997	003113'	000000	000000	MAX:	0
  1998	003114'	000000	000000	MIN:	0
  1999	003115'	000000	000000	KNOUNI:	0
  2000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 41
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2001				COMMENT #
  2002				@@SUBROUTINE MAYREF
  2003				@@PURPOSE
  2004				SUBR TO TYPE WARNING THAT A CHANGE WILL CAUSE REFRESH.
  2005				@@ #
  2006
  2007	003116'	331000	762112	MAYREF:	SKIPL TYPONL
  2008	003117'	331000	762110		SKIPL DBLSTD
  2009	003120'	263040	000000		 POPJ P,		;ONLY TYPING, OR DOING STANDARD
  2010	003121'	322640	002771*		JUMPE P2,CPOPJ	;NO STR
  2011	003122'	510315	003006*		HLLZ T1,STRREF(P2)
  2012	003123'	326300	003121*		JUMPN T1,CPOPJ	;ALREADY SET FOR REFRESH
  2013					MOVEI T1,[ASCIZ /
  2014	003124'	201300	764024	CHANGE WILL CAUSE STR TO NEED REFRESHING/]
  2015	003125'	324740	761617		PJRST CONOUT
  2016
  2017
  2018
  2019
  2020				COMMENT #
  2021				@@SUBROUTINE FTYUNI
  2022				@@PURPOSE
  2023				LITTLE SUBR TO POSSIBLY TYPE A UNIT NAME.
  2024				@@ #
  2025
  2026	003126'	332000	762115	FTYUNI:	SKIPE KNOUNI	;KNOW WHAT UNIT?
  2027	003127'	263040	000000		 POPJ P,		;YES
  2028	003130'	260040	761611		PUSHJ P,SPUNAM
  2029	003131'	350001	000000		AOS (P)
  2030	003132'	476000	762115		SETOM KNOUNI
  2031	003133'	324740	761620		PJRST CRLFOP
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 42
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2032				COMMENT #
  2033				@@SUBROUTINE SPUCLC
  2034				@@PURPOSE
  2035				SUBR TO CALC THE NUMBER OF SATS FOR A UNIT, GIVEN THE NO. OF
  2036				PAGES ON THE UNIT.
  2037				@@ENTRY
  2038				EXPECTS U/ UNIT DB.
  2039				@@ACCUM
  2040				DESTROYS T2 AND T3.
  2041				@@EXIT
  2042				SETS UNYSPU.
  2043				@@ #
  2044
  2045	003134'	200345	002316*	SPUCLC:	MOVE	T2,UNIPPU(U)	;T2/ NO. OF PAGES ON THE UNIT.
  2046	003135'	275340	000001		SUBI	T2,1		;
  2047	003136'	231340	022000		IDIVI	T2,400*^D36	;DIVIDE BY NO. PAGES PER SAT.
  2048	003137'	271340	000001		ADDI	T2,1		;
  2049	003140'	137340	002274*		DPB	T2,UNYSPU	;SET ANSWER.
  2050	003141'	263040	000000		POPJ	P,
  2051
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 43
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2052				COMMENT #
  2053				@@SUBROUTINE UNITST
  2054				@@PURPOSE
  2055				SUBR TO CALC AND STORE THE NO. OF SATS ON A UNIT.  MAY FLAG
  2056				HOME PAGES NEED REWRITING.
  2057				@@ENTRY
  2058				EXPECTS U/ UNIT DB.
  2059				JUST RETURNS IF TYPONL IS < 0.
  2060				@@CALLS
  2061				SPUCLC AND SETCHG.
  2062				@@EXIT
  2063				STORES RESULT IN UNYSPU.
  2064				@@ #
  2065
  2066	003142'	335000	762112	UNITST:	SKIPGE	TYPONL
  2067	003143'	263040	000000		POPJ	P,
  2068	003144'	135400	003140*		LDB	T3,UNYSPU
  2069	003145'	260040	762134		PUSHJ	P,SPUCLC
  2070	003146'	312400	000007		CAME	T3,T2
  2071	003147'	324740	761624		PJRST	SETCHG
  2072	003150'	263040	000000		POPJ	P,
  2073
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 44
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2074				COMMENT #
  2075				@@SUBROUTINE UNITID
  2076				@@PURPOSE
  2077				SUBR TO SET THE UNIT ID.
  2078				@@ #
  2079
  2080	003151'	260040	762126	UNITID:	PUSHJ	P,FTYUNI
  2081	003152'	255000	000000		JFCL
  2082					MOVEI	T1,[ASCIZ /
  2083	003153'	201300	764035	UNIT ID IS /]
  2084	003154'	336605	002753*		SKIPN	P1,UNIHID(U)
  2085					MOVEI	T1,[ASCIZ /
  2086	003155'	201300	764040	ZERO UNIT ID - NEW ID NEEDED/]
  2087	003156'	260040	003011*		PUSHJ	P,CONMES
  2088	003157'	332340	000014		SKIPE	T2,P1		;PRINT IF NON-ZERO.
  2089	003160'	260040	002754*		PUSHJ	P,PRNAME
  2090	003161'	260040	761620		PUSHJ	P,CRLFOP
  2091	003162'	335000	762112		SKIPGE	TYPONL
  2092	003163'	263040	000000		POPJ	P,		;DONE IF ONLY PRINTING.
  2093	003164'	260040	003054*		PUSHJ	P,GETLIN
  2094	003165'	334345	003154*		  SKIPA	T2,UNIHID(U)	;NO CHANGE, GET BACK OLD.
  2095	003166'	260040	002641*		PUSHJ	P,CTEXT	;READ
  2096	003167'	322340	762151		JUMPE	T2,UNITID	;STILL 0, TRY AGAIN.
  2097	003170'	250345	003165*		EXCH	T2,UNIHID(U)
  2098	003171'	312345	003170*		CAME	T2,UNIHID(U)
  2099	003172'	324740	761624		PJRST	SETCHG		;CHANGED.
  2100	003173'	263040	000000		POPJ	P,		;NOT CHANGED
  2101
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 45
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2102				COMMENT #
  2103				@@SUBROUTINE STRTCH
  2104				@@PURPOSE
  2105				SUBR TO ALLOW THE REDEFINITION OF THE SIZE OF CRASH.SAV.
  2106				@@ #
  2107
  2108	003174'	402000	762114	STRTCH:	SETZM	MIN
  2109	003175'	200300	764047		MOVE	T1,[^D8192+2]	;(2**22)/512. (allow for EXE directory pages)
  2110	003176'	202300	762113		MOVEM	T1,MAX
  2111	003177'	260040	762116		PUSHJ	P,MAYREF
  2112	003200'	550615	002307*		HRRZ	P1,STRP4C(P2)
  2113	003201'	201300	764050		MOVEI	T1,[ASCIZ /PAGES FOR CRASH.SAV = /]
  2114	003202'	260040	762030		PUSHJ	P,ASKQMM
  2115	003203'	263040	000000		  POPJ	P,
  2116	003204'	542355	003200*		HRRM	T2,STRP4C(P2)
  2117	003205'	563015	003122*		HRROS	STRREF(P2)
  2118	003206'	200300	764055	CHGSTR:	MOVE	T1,[PUSHJ P,SETCHG]
  2119	003207'	324740	761570		PJRST	STOUNI
  2120
  2121
  2122
  2123				COMMENT #
  2124				@@SUBROUTINE
  2125				@@PURPOSE
  2126				SUBR TO ALLOW THE REDEFINITION OF THE NO. OF PAGES OF
  2127				OVERDRAW PER USER.
  2128				@@ #
  2129
  2130	003210'	402000	762114	STRTOV:	SETZM	MIN
  2131	003211'	200315	002320*		MOVE	T1,STRPPU(P2)
  2132	003212'	202300	762113		MOVEM	T1,MAX
  2133	003213'	201300	764056		MOVEI	T1,[ASCIZ /# OF PAGES ALLOWED FOR OVERDRAW PER USER = /]
  2134	003214'	214615	002322*		MOVM	P1,STROVR(P2)
  2135	003215'	260040	762030		PUSHJ	P,ASKQMM
  2136	003216'	263040	000000		POPJ	P,
  2137	003217'	212355	003214*		MOVNM	T2,STROVR(P2)
  2138	003220'	324740	762206		PJRST	CHGSTR
  2139
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 46
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2140				COMMENT #
  2141				@@SUBROUTINE STSDEF
  2142				@@PURPOSE
  2143				SUBR TO DEFINE A STR.
  2144				@@ENTRY
  2145				EXPECTS
  2146				@@ACCUM
  2147				DESTROYS
  2148				@@CALLS
  2149				CONOUT, GETLIN, CTEXT, FNDSTR, GETUNI, CMPLOG, SETCHG,
  2150				STRTOV, AND STRTCH.
  2151				(AND ITS INTERNAL SUBRS STSINS, UNICHK, AND UNICK1.).
  2152				@@ #
  2153
  2154	003221'	200300	764067	STSDEF:	MOVE	T1,[SIXBIT/DSKB/] ;ALL STR NAMES ARE DSKB.
  2155	003222'	260040	761260		PUSHJ	P,FNDSTR	;DOES THIS STR ALREADY EXIST?
  2156	003223'	334300	764074		  SKIPA	T1,[[ASCIZ /STR already exists/]] ;YES, THIS IS A NO-NO.
  2157	003224'	254000	762226		JRST	STSNEW		;NO, OKAY UNLESS ALREADY A STR.
  2158	003225'	324740	761617		PJRST	CONOUT
  2159
  2160	003226'	336015	003004*	STSNEW:	SKIPN	STRNAM(P2)	;DOES ANY STR EXIST?
  2161	003227'	254000	762232		 JRST	STSNE1		;NO, THIS IS IT.
  2162					MOVEI	T1,[ASCIZ /
  2163				Too many file structures!  Only one allowed!
  2164	003230'	201300	764075	/]
  2165	003231'	324740	761617		PJRST	CONOUT
  2166
  2167				    ;HERE WITH A GOOD STR NAME.
  2168	003232'	260040	762362	STSNE1:	PUSHJ	P,CLRSTR
  2169	003233'	202315	003226*		MOVEM	T1,STRNAM(P2)
  2170	003234'	563015	003205*		HRROS	STRREF(P2)	;NEED REFRESH.
  2171				    ;HERE TO PUT THE UNITS IN THE STR.
  2172	003235'	201300	764107	STSNE2:	MOVEI	T1,[ASCIZ /Type names of physical units in STR, extra CR when done/]
  2173	003236'	260040	761617		PUSHJ	P,CONOUT
  2174
  2175	003237'	201715	003013*		MOVEI	P3,STRUNI(P2)
  2176	003240'	400600	000000		SETZ	P1,
  2177	003241'	260040	761637	STSNXT:	PUSHJ	P,GETUNI	;GET A UNIT NAME
  2178					JRST	[CAIE P3,STRUNI(P2)  ;FINISHED GETTING UNIT NAMES.
  2179						  JRST STSFIN
  2180	003242'	254000	764123			 JRST STSNE2]
  2181	003243'	260040	762246		PUSHJ	P,STSINS	;INSERT UNIT.
  2182	003244'	254000	762241		  JRST	STSNXT		;ALREADY IN STR
  2183	003245'	254000	762241		JRST	STSNXT		;CONTINUE
  2184
  2185				    ;SUBR INTERNAL TO STSDEF TO INSERT A UNIT IN THE STR.
  2186	003246'	550305	003020*	STSINS:	HRRZ	T1,UNISTR(U)	;SEE IF THIS UNIT IS ALREADY IN A STR.
  2187	003247'	322300	762252		JUMPE	T1,STSUN2	;T1 = 0 IF IT ISN'T
  2188					MOVEI	T1,[ASCIZ .
  2189				Unit already in file structure
  2190	003250'	201300	764126	.]
  2191	003251'	324740	761617		PJRST	CONOUT		;TYPE MSG. & EXIT
  2192
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 46-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2193	003252'	506256	000000	STSUN2:	HRLM	U,(P3)		;LINK THIS UNIT DATA BLOCK TO PREVIOUS ONE
  2194	003253'	552645	003246*		HRRZM	P2,UNISTR(U)	;ATTACH THIS UNIT DATA BLOCK TO THIS STR
  2195	003254'	550315	002172*		HRRZ	T1,STRUNM(P2)	;GET LOGICAL UNIT # WITHIN STR
  2196	003255'	137300	002535*		DPB	T1,UNYLUN	;SAVE IT IN UNIT DATA BLOCK
  2197	003256'	260040	000000*		PUSHJ	P,CMPLOG	;COMPUTE SIXBIT LOGICAL UNIT NUM, STORE IN UNILOG
  2198	003257'	260040	761631		PUSHJ	P,SETPUB
  2199				PRINTF(<[All references to STRPPU should be eliminated]>)
  2200	003260'	200305	003134*		MOVE	T1,UNIPPU(U)
  2201	003261'	313315	003211*		CAMLE	T1,STRPPU(P2)
  2202	003262'	202315	003261*		 MOVEM	T1,STRPPU(P2)
  2203	003263'	302600	000000		CAIE P1,0
  2204	003264'	315314	003260*		 CAMGE	T1,UNIPPU(P1)	;COMPARE WITH SMALLEST SO FAR
  2205	003265'	200600	000005		MOVE	P1,U		;SAVE ADDR OF SMALLEST IN P1
  2206	003266'	350015	003254*		AOS	STRUNM(P2)	;INCREMENT # OF UNITS IN STR
  2207	003267'	260040	761624		PUSHJ	P,SETCHG	;FLAG THAT UNIT'S HOME PAGES MUST BE REWRITTEN
  2208	003270'	201705	003253*		MOVEI	P3,UNISTR(U)	;MAKE CURRENT UNIT PREDECESSOR
  2209	003271'	254000	002653*		JRST	CPOPJ1		;SKIP RETURN
  2210
  2211				    ;HERE TO FINISH UP.
  2212	003272'	554255	003237*	STSFIN:	HLRZ	U,STRUNI(P2)
  2213	003273'	554245	003270*		HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2214	003274'	326240	762273		JUMPN	U,.-1		;REPEAT IF ANY LEFT
  2215	003275'	402000	762112		SETZM	TYPONL		;JUST IN CASE.
  2216	003276'	200240	000014		MOVE	U,P1		;GET SMALLEST UNIT.
  2217	003277'	135600	000000*		LDB	P1,UNYKTP##	;Get Kontroller type
  2218	003300'	261040	000014		PUSH	P,P1		;SAVE IT.
  2219	003301'	200314	762322		MOVE	T1,OVRDEF(P1)
  2220	003302'	526300	762110		HRLOM	T1,DBLSTD
  2221	003303'	260040	762210		PUSHJ	P,STRTOV	;SET OVERDRAW.
  2222	003304'	200301	000000		MOVE	T1,(P)
  2223	003305'	200306	762332		MOVE	T1,P4CDEF(T1)	;Pages for CRASH.SAV based on kontroller type
  2224	003306'	526300	762110		HRLOM	T1,DBLSTD
  2225	003307'	260040	762174		PUSHJ	P,STRTCH	;SET DEFAULT SIZE OF CRASH.SAV.
  2226	003310'	262040	000014		POP	P,P1
  2227	003311'	200300	764135		MOVE	T1,[PUSHJ P,UNICK1]
  2228	003312'	260040	761570		PUSHJ	P,STOUNI	;CHECK SATS.
  2229	003313'	200300	764136		MOVE T1,[PUSHJ P,UNICHK]
  2230	003314'	324740	761570		PJRST STOUNI		;NOW DO ALL UNITS.
  2231
  2232				    ;A LITTLE INTERNAL STSDEF SUBR.
  2233	003315'	402000	762115	UNICHK:	SETZM KNOUNI		;DO NOT KNOW UNIT.
  2234	003316'	324740	760415		PJRST UNCHKA		;GO DO THE STANDARD STUFF.
  2235
  2236				    ;A LITTLE INTERNAL STSDEF SUBR.
  2237	003317'	402000	762115	UNICK1:	SETZM KNOUNI
  2238	003320'	402000	762112		SETZM TYPONL		;JUST TO MAKE SURE.
  2239	003321'	324740	762142		PJRST UNITST		;CHECK SATS.
  2240
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 47
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2241				;DEFAULT DEFS BY UNIT TYPE.
  2242
  2243				;Default overdraw in blocks
  2244	003322'	000000	000001	OVRDEF:	1	;0 DR (unused)
  2245	003323'	000000	000062		^D50	;1 FH (unused)
  2246	003324'	000000	000175		^D125	;2 DP (unused)
  2247	003325'	000000	000175		^D125	;3 MF (unused)
  2248	003326'	000000	000175		^D125	;4 3330
  2249	003327'	000000	000175		^D125	;5 RM03
  2250	003330'	000000	000175		^D125	;6 AP
  2251	003331'	000000	000175		^D125	;7    (unused)
  2252
  2253				;Default pages for CRASH.SAV
  2254	003332'	000000	000000	P4CDEF:	0	;0 DR (unused)
  2255	003333'	000000	000000		0	;1 FH (unused)
  2256	003334'	000000	001000		^D512	;2 DP (unused)
  2257	003335'	000000	001000		^D512	;3 MF (unused)
  2258	003336'	000000	020001		^D8192+1;4 3330 KI/KL with 4096K of memory = 8193 pages for CRASH.EXE
  2259	003337'	000000	001000		^D512	;5 RM03 KS-2020
  2260	003340'	000000	001000		^D512	;6 AP   Foonly
  2261	003341'	000000	001000		^D512	;7    (unused)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 48
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2262				COMMENT #
  2263				@@SUBROUTINE STSDSL
  2264				@@PURPOSE
  2265				SUBR TO DISSOLVE A STR.
  2266				CLEARS UNILOG, UNISTR, AND STRNAM AND FLAGS THAT ALL THE
  2267				STR'S UNITS' HOME PAGES NEED REWRITING.
  2268				@@ENTRY
  2269				EXPECTS
  2270				@@ACCUM
  2271				DESTROYS
  2272				@@CALLS
  2273				SETCHG.
  2274				@@ #
  2275
  2276	003342'	261040	000007	STSDSL:	PUSH	P,T2		;SAVE T2 AND
  2277	003343'	261040	000006		PUSH	P,T1		;T1.
  2278	003344'	201640	003003*		MOVEI	P2,STRDDB
  2279	003345'	554255	003272*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR.
  2280	003346'	322240	762356		JUMPE	U,DISST2	;JUST UNLINK STR IF IT HAS NO UNITS.
  2281	003347'	205300	002634*		MOVSI	T1,UNPPRV	;UNIT MAY BE GOING PRIVATE.
  2282	003350'	403405	002777*	DISST1:	SETZB	T3,UNILOG(U)	;CLEAR OUT NAME OF LOGICAL UNIT WITHIN STR.
  2283	003351'	250405	003273*		EXCH	T3,UNISTR(U)	;CLEAR OUT LINKS TO STR & NEXT UNIT DATA BLOCKS.
  2284	003352'	436300	002722*		IORM	T1,UNIDES	;UNIT IS NOW A PRIVATE PACK
  2285	003353'	260040	761624		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN.
  2286	003354'	554240	000010		HLRZ	U,T3		;GET NEXT UNIT DATA BLOCK ADR.
  2287	003355'	326240	762350		JUMPN	U,DISST1	;REPEAT IF THERE IS ONE.
  2288	003356'	260040	762362	DISST2:	PUSHJ	P,CLRSTR	;INDICATE STR NO LONGER EXISTS.
  2289	003357'	262040	000006		POP	P,T1		;RESTORE T1 AND
  2290	003360'	262040	000007		POP	P,T2		;T2.
  2291	003361'	263040	000000		POPJ	P,		;RETURN - DON'T WORRY ABOUT RETURING CORE
  2292								; AS RDHOME MUST BE CALLED AGAIN.
  2293
  2294
  2295
  2296				COMMENT #
  2297				@@SUBROUTINE CLRSTR
  2298				@@PURPOSE
  2299				LITTLE SUBR TO CLEAR OUT THE STR DB (SETTING STRNAM TO
  2300				ZERO INDICATES THAT THERE IS NO STR.).
  2301				@@ACCUM
  2302				DESTROYS NO ACS.
  2303				@@ #
  2304
  2305	003362'	261040	000006	CLRSTR:	PUSH	P,T1
  2306	003363'	261040	000000*		PUSH	P,STRDDB+STRBTS
  2307	003364'	402000	003344*		SETZM	STRDDB	
  2308	003365'	505300	003364*		HRLI	T1,STRDDB
  2309	003366'	541300	000001*		HRRI	T1,STRDDB+1
  2310	003367'	251300	000000*		BLT	T1,STRDDB+STRLEN-1
  2311	003370'	262040	000006		POP	P,T1
  2312	003371'	552300	000000*		HRRZM	T1,STRDDB+STRBTS
  2313	003372'	262040	000006		POP	P,T1
  2314	003373'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 48-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2315
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 49
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2316				COMMENT #
  2317				@@SUBROUTINE ADDUNI
  2318				@@PURPOSE
  2319				SUBR TO ADD A UNIT TO THE SYSTEM STR.
  2320				@@ENTRY
  2321				EXPECTS
  2322				@@CALLS
  2323
  2324				@@ACCUM
  2325				DESTROYS
  2326				@@EXIT
  2327
  2328				@@ #
  2329
  2330	003374'	201640	003365*	ADDUNI:	MOVEI	P2,STRDDB	;P2/ ADDR OF STR DB.
  2331	003375'	336015	003233*		SKIPN	STRNAM(P2)	;HAS THE STR BEEN DEFINED?
  2332	003376'	254000	762465		 JRST	ADDNOT		;NO, ILLEGAL TO ADD TO IT.
  2333	003377'	201300	764137		MOVEI	T1,[ASCIZ .Enter unit name to add.]
  2334	003400'	260040	761617		PUSHJ	P,CONOUT	;BY NOW P2=STR DDB.
  2335	003401'	260040	761637		PUSHJ	P,GETUNI	;GET A UNIT NAME.
  2336	003402'	254000	762467		  JRST	CANTAD		;NOT A UNIT, CAN NOT ADD.
  2337	003403'	322240	762467		JUMPE	U,CANTAD	;CAN NOT ADD ALL EITHER.
  2338	003404'	550305	003351*		HRRZ	T1,UNISTR(U)	;IS THE UNIT IN A STR ALREADY?
  2339	003405'	322300	762410		JUMPE	T1,ADDUN2	;NO.
  2340	003406'	201300	764144		MOVEI	T1,[ASCIZ .THAT unit is already in a structure.]
  2341	003407'	254000	761617		JRST	CONOUT
  2342
  2343				    ;HERE WHEN WE HAVE A UNIT TO ADD, AND THE UNIT IS NOT
  2344				    ;ALREADY IN A STR.
  2345	003410'	200305	003264*	ADDUN2:	MOVE	T1,UNIPPU(U)
  2346	003411'	313315	003262*		CAMLE	T1,STRPPU(P2)	;MUST NOT WANT TO CHANGE STRPPU
  2347	003412'	254000	762467		 JRST	CANTAD
  2348	003413'	402000	762112		SETZM	TYPONL
  2349	003414'	260040	760415		PUSHJ	P,UNCHKA	;SET UNIT ID AND NO. OF SATS PER UNIT.
  2350	003415'	550315	003266*		HRRZ	T1,STRUNM(P2)
  2351	003416'	135340	003255*		LDB	T2,UNYLUN
  2352	003417'	137300	003416*		DPB	T1,UNYLUN	;CHANGE THIS UNIT NUMBER
  2353	003420'	402007	002537*		SETZM	UNTTBL(T2)	;ZERO OLD CELL
  2354	003421'	200300	000007		MOVE	T1,T2
  2355	003422'	332006	777777*		SKIPE	UNTTBL-1(T1)
  2356	003423'	364300	762422		 SOJA	T1,.-1		;LOOK FOR ZERO
  2357	003424'	316300	000007		CAMN	T1,T2
  2358	003425'	254000	762432		 JRST	ADUNT
  2359	003426'	250246	003420*		EXCH	U,UNTTBL(T1)	;GET THAT ONE
  2360	003427'	137340	003417*		DPB	T2,UNYLUN	;CHANGE ITS NUMBER
  2361	003430'	250247	003426*		EXCH	U,UNTTBL(T2)	;AND STOR IN NEW PLACE (SETS U=0)
  2362	003431'	250246	003430*		EXCH	U,UNTTBL(T1)	;GET OLD U BACK
  2363	003432'	135300	003427*	ADUNT:	LDB	T1,UNYLUN	;AND OLD UNIT NUMBER
  2364	003433'	202246	003431*		MOVEM	U,UNTTBL(T1)	;STORE IN NEW PLACE
  2365	003434'	510315	003234*		HLLZ	T1,STRREF(P2)	;IS IT MARKED FOR REFRESH
  2366	003435'	326300	762445		JUMPN	T1,ADDUN4	;YES, DO NOT NEED TO REFRESH PACK
  2367	003436'	261040	000015		PUSH	P,P2		;SAVE THE STR POINTER.
  2368	003437'	260040	762707		PUSHJ	P,UPDHOM	;WRITE HOME PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 49-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2369	003440'	262040	000015		POP	P,P2		;RESTORE STR PTR.
  2370	003441'	205740	002624*		MOVSI	P4,UNPCHG
  2371	003442'	412745	003352*		ANDCAM	P4,UNIDES(U)	;PAKREF WILL READ HOME PAGES.
  2372	003443'	260040	000000*		PUSHJ	P,PAKREF	;REFRESH PACK.
  2373	003444'	254000	762467		  JRST	CANTAD		;COULD NOT DO IT.
  2374	003445'	350315	003415*	ADDUN4:	AOS	T1,STRUNM(P2)	;ONE MORE IN STR
  2375	003446'	275300	000001		SUBI	T1,1		;
  2376	003447'	552645	003404*		HRRZM	P2,UNISTR(U)	;LINK TO STR DDB
  2377	003450'	260040	003256*		PUSHJ	P,CMPLOG	;MAKE A LOGICAL UNIT NAME
  2378	003451'	554315	003345*		HLRZ	T1,STRUNI(P2)
  2379	003452'	554346	003447*	ADDUN5:	HLRZ	T2,UNISTR(T1)
  2380	003453'	322340	762456		JUMPE	T2,ADDUN7	;FIND END OF CURRENT LIST
  2381	003454'	200300	000007		MOVE	T1,T2
  2382	003455'	254000	762452		JRST	ADDUN5
  2383	003456'	261040	000006	ADDUN7:	PUSH	P,T1		;SAVE LAST UNIT.
  2384	003457'	506246	003452*		HRLM	U,UNISTR(T1)
  2385	003460'	260040	761624		PUSHJ	P,SETCHG	;MARK HOME PAGE CHANGED.
  2386	003461'	260040	761631		PUSHJ	P,SETPUB
  2387	003462'	262040	000005		POP	P,U		;WANT TO SET CHANGED HOME ON THIS ONE TOO.
  2388	003463'	260040	761624		PUSHJ	P,SETCHG
  2389	003464'	263040	000000		POPJ	P,
  2390
  2391	003465'	201300	764154	ADDNOT:	MOVEI T1,[ASCIZ .The SYSTEM structure has not been DEFINED yet.]
  2392	003466'	254000	761617		JRST CONOUT
  2393
  2394	003467'	513005	003457*	CANTAD:	HLLZS	UNISTR(U)	;
  2395	003470'	201300	764166		MOVEI	T1,[ASCIZ .Cannot add unit to structure.]
  2396	003471'	254000	761617		JRST	CONOUT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 50
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2397				;SUBR TO REFRESH A STR.
  2398
  2399	003472'	260040	762516	STSREF:	PUSHJ	P,GETDAT	;Get date (so HOME.SYS doesn't say 2-JAN-64)
  2400	003473'	201300	000000*		MOVEI	T1,UFDHSI	; RANNO already setup!
  2401	003474'	542300	000000*		HRRM	T1,STRHSH+STRDDB
  2402	003475'	336000	761230		SKIPN	RANHOM		; Is this a virgin pack set?
  2403	003476'	350000	761230		 AOS	RANHOM		; If so, prevent RDHOME from complaining.
  2404	003477'	260040	762677		PUSHJ	P,RWRHOM	;WRITE HOME PAGES.
  2405	003500'	402000	761743		SETZM	BATMAN
  2406	003501'	260040	760556		PUSHJ	P,RDHOME	; Read & Verify HOM pages
  2407	003502'	255000	000000		  JFCL			; Ignore "all" errors
  2408	003503'	255000	000000		  JFCL
  2409	003504'	200200	002370*		MOVE	F,DDSTAR
  2410	003505'	260040	000000*		PUSHJ	P,REFRSH	;REFRESH THE STR.
  2411	003506'	254000	762513		  JRST	CNTADS		;LOST.
  2412	003507'	260040	760556		PUSHJ	P,RDHOME	; Read & Verify new HOM pages
  2413	003510'	255000	000000		  JFCL			; Just to make sure.
  2414	003511'	255000	000000		  JFCL
  2415	003512'	263040	000000		POPJ P,
  2416
  2417	003513'	563015	003434*	CNTADS:	HRROS	STRREF(P2)	;MARK WE STILL NEED REFRESHING.
  2418	003514'	201300	764174		MOVEI	T1,[ASCIZ /The structure WAS NOT successfully refreshed./]
  2419	003515'	324740	761617		PJRST	CONOUT
  2420
  2421	003516'	331000	000067*	GETDAT:	SKIPL	THSDAT##	;Do nothing if date is valid
  2422	003517'	263040	000000		 POPJ	P,
  2423	003520'	265440	000000*		JSP	T4,SAVE4	;Save P2 and P4
  2424	003521'	261040	000002		PUSH	P,J
  2425	003522'	201100	000000		MOVEI	J,0		;Job 0 is local time zone
  2426	003523'	201300	764206	GETDT1:	MOVEI	T1,[ASCIZ /Enter date as MM-DD-YYYY /]
  2427	003524'	260040	002347*		PUSHJ	P,OCONM
  2428	003525'	260040	003015*		PUSHJ	P,OPOUT
  2429	003526'	260040	003164*		PUSHJ	P,GETLIN	;Get response
  2430	003527'	254000	762523		  JRST	GETDT1
  2431	003530'	260040	003056*		PUSHJ	P,DECIN		;	MM
  2432	003531'	254000	762523		  JRST	GETDT1
  2433	003532'	254000	762523		  JRST	GETDT1
  2434	003533'	201647	777777		MOVEI	P2,-1(T2)
  2435	003534'	221640	000037		IMULI	P2,^D31
  2436	003535'	260040	003530*		PUSHJ	P,DECIN		;	    DD
  2437	003536'	254000	762523		  JRST	GETDT1
  2438	003537'	254000	762523		  JRST	GETDT1
  2439	003540'	271647	777777		ADDI	P2,-1(T2)
  2440	003541'	260040	003535*		PUSHJ	P,DECIN		;		YYYY
  2441	003542'	254000	762523		  JRST	GETDT1
  2442	003543'	254000	762523		  JRST	GETDT1
  2443	003544'	275340	003654		SUBI	T2,^D1964
  2444	003545'	221340	000564		IMULI	T2,^D31*^D12
  2445	003546'	270340	000015		ADD	T2,P2
  2446	003547'	260040	000000*		PUSHJ	P,COMDAS##
  2447	003550'	254000	762523		  JRST	GETDT1
  2448	003551'	201300	764214	GETDT2:	MOVEI	T1,[ASCIZ /Enter time as HHMM /]
  2449	003552'	260040	003524*		PUSHJ	P,OCONM
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 50-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2450	003553'	260040	003525*		PUSHJ	P,OPOUT
  2451	003554'	260040	003526*		PUSHJ	P,GETLIN	;Get response
  2452	003555'	254000	762551		  JRST	GETDT2
  2453	003556'	260040	003541*		PUSHJ	P,DECIN		;4 digit number
  2454	003557'	254000	762551		  JRST	GETDT2
  2455	003560'	254000	762551		  JRST	GETDT2
  2456	003561'	200300	000007		MOVE	T1,T2		;SET TIME ACCORDING TO ARGUMENT
  2457	003562'	231300	000144		IDIVI	T1,^D100	;Seperate HH from MM
  2458	003563'	221300	000074		IMULI	T1,^D60		;
  2459	003564'	270300	000007		ADD	T1,T2		;COMPUTE MINUTES
  2460	003565'	260040	000000*		PUSHJ	P,COMTMS##
  2461	003566'	254000	762551		  JRST	GETDT2
  2462	003567'	262040	000002		POP	P,J
  2463	003570'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 51
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2464				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2465				;;									;;
  2466				;;	Routine SETRAN - Start timer for pseudo-random number		;;
  2467				;;									;;
  2468				;;	Called by CMDSCN whenever it prompts the operator for		;;
  2469				;;	anything during ONCE and ONCDSK.  Needed in conjunction		;;
  2470				;;	with GETRAN which reads the current timer value for the		;;
  2471				;;	REFRESH command.						;;
  2472				;;									;;
  2473				;;	Clobbers T1, T2  - depending upon processor			;;
  2474				;;									;;
  2475				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2476
  2477	762571			SETRAN:			; Entry point to start timer for random number
  2478				IFCPU (<KL,KS>),<
  2479				IFCPU (<KL>),<
  2480					EXTERN EPT
  2481					SETZM	EPT+EPTLTB	; Clear EPT locations (KL)
  2482					CONO	MTR,MO.TON	; Turn on MTR clock
  2483				>; END IFCPU (KL)
  2484				IFCPU (KS),<
  2485	003571'	403300	000007		SETZB	T1,T2		; Set the Time Base
  2486	003572'	702600	000006		WRTIME	T1		; To Zero.
  2487				>;END IFCPU (KS)
  2488	003573'	263040	000000		POPJ	P,		; Return.
  2489				>;END IFCPU(<KL,KS>)
  2490
  2491				IFCPU (<KI,F3>),<
  2492					MOVE	T1,[JRST CLKLVL]; New Clock-routine
  2493					EXCH	T1,CH7+1	; Set New/Save Old Value
  2494					MOVEM	T1,CLKRAN	; Store for later
  2495					SETZM	CLKCNT		; Reset time base
  2496					WRPI	1B25!1B35	; TURN ON CHANNEL SEVEN.
  2497				IFCPU (KI),<WRAPR 1B25!1B26!7B35>
  2498				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2499					POPJ	P,		; Return.
  2500				
  2501				CLKLVL:	AOS	CLKCNT		;
  2502				IFCPU (KI),<WRAPR 1B25!1B26!7B35>	;
  2503				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2504					JEN	@CH7
  2505				
  2506				CLKRAN:	Z			; Holder for old CH7+1
  2507				CLKCNT: 0			; Timer value
  2508				>;END IFCPU (<KI,F3>)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 52
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2509				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2510				;;									;;
  2511				;;	Routine GETRAN - Read the time-base or clock value		;;
  2512				;;									;;
  2513				;;	Called by CMDSCN in ONCE and ONCDSK each time the operator	;;
  2514				;;	is prompted for a response.  Updates RANNO## with a new		;;
  2515				;;	random seed used by REFSTR each time.				;;
  2516				;;									;;
  2517				;;	Clobbers T1.							;;
  2518				;;									;;
  2519				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2520
  2521				External RANNO			  ; Located in REFSTR, set here each cmd line
  2522
  2523	003574'	261040	000007	GETRAN:	PUSH	P,T2		  ; Save this register (T2)
  2524	003575'	702200	000006	IFCPU (<KL,KS>),<RDTIME	T1>	  ; Read time base setup earlier + counter
  2525				IFCPU (KL),<LSH T2,-^D12>	  ; Strip low order zero bits on KL
  2526				IFCPU (<KI,F3>),<
  2527					HRRZ T2,CLKCNT		  ; Read clock setup earlier + elapsed
  2528				IFCPU (KI),<WRAPR 1B24!7B35>	  ; Disable CLOCK now
  2529				IFCPU (F3),<WRAPR LP.CSF+LP.DSF+LP.CLK+7B35>
  2530					WRPI	1B26!1B35	  ; Turn OFF channel seven
  2531					MOVE	T1,CLKRAN	  ; Get previous channel 7
  2532					MOVEM	T1,CH7+1	  ; Reset
  2533				>;End IFCUP(<KI,F3>)
  2534	003576'	606340	777777		TRNN	T2,-1		  ; Make sure RH is neq 0
  2535	003577'	201340	434164		 MOVEI	T2,(SIXBIT /CAT/) ; If not, set to 'CAT'
  2536	003600'	552340	000000*		HRRZM	T2,RANNO	  ; Store for later
  2537	003601'	262040	000007		POP	P,T2		  ; Restore T2 from entry
  2538	003602'	263040	000000		POPJ	P,		  ; Return.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 53
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2539				;SUBR TO ALLOW OPER TO QUERY/SELECT DSKCLN TYPE
  2540				;
  2541				SPCDKN:	MOVEI	T1,[ASCIZ /
  2542	003603'	201300	764220	DSKCLN mode is: /]
  2543	003604'	260040	003552*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2544	003605'	260040	762670		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
  2545	003606'	205300	200000		MOVSI	T1,DCN.ON	;INDIC OPER HAS SEEN AND/OR
  2546	003607'	436300	001764*		IORM	T1,DCN		; SELECTED DSKCLN MODE
  2547	003610'	200347	762650		MOVE	T2,SCNDSK(T2)	;GET SIXBIT NAME OF CURRENT MODE
  2548	003611'	306400	000005		CAIN	T3,^L<(DCN.DF)>	;IS MODE DEFAULT?
  2549	003612'	200340	764224		 MOVE	T2,[SIXBIT /NULL/]	;YES, TELL THIS TO OPER
  2550	003613'	260040	003160*		PUSHJ	P,PRNAME	;BUFFER MODE NAME
  2551	003614'	260040	761620		PUSHJ	P,CRLFOP	;APPEND CRLF, DO CTY OUTPUT
  2552	003615'	201300	764225	SPCDK1:	MOVEI	T1,[ASCIZ /DSKCLN mode desired? /]
  2553	003616'	260040	003604*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2554	003617'	260040	003553*		PUSHJ	P,OPOUT		;DO CTY OUTPUT
  2555	003620'	260040	003554*		PUSHJ	P,GETLIN	;GET OPER'S RESPONSE
  2556	003621'	263040	000000		 POPJ	P,		;NULL, NO CHANGE IN MODE
  2557	003622'	201600	762650		MOVEI	P1,SCNDSK	; Get address of Scan Table
  2558	003623'	402000	757307		SETZM	CMDSCF		; Specify NO STR/UNIT stuff
  2559	003624'	260040	757211		PUSHJ	P,CMDSCN	; Call Scanning routine
  2560	003625'	254000	762630		  JRST	SPDKHP		; No good!
  2561	003626'	137700	757005		DPB	P3,DCNYON	;SAVE IN DCN
  2562	003627'	263040	000000	NULDSK:	POPJ	P,		;RETURN
  2563
  2564				SPDKHP:	MOVEI	T1,[ASCIZ \
  2565				Bad entry: Type 'FULL', 'FAST', 'NONE'
  2566	003630'	201300	764232	 or just <Return> for default (NO CHANGE)\]
  2567	003631'	260040	761617		PUSHJ	P,CONOUT	;TYPE ERROR MSG ON CTY
  2568	003632'	254000	762615		JRST	SPCDK1		;LET OPER TRY AGAIN
  2569
  2570				;MODE-MNEMONIC CORRESPONDENCE TABLE
  2571				;
  2572					DEFINE	MKDSK <
  2573					X NONE,0,Ab.Nak,
  2574					X FAST,0,Ab.Nak,
  2575					X ,0,Ab.Nak,
  2576					X ,0,Ab.Nak,
  2577					X ,0,Ab.Nak,
  2578					X ,0,Ab.Nak,
  2579					X ,0,Ab.Nak,
  2580					X FULL,0,Ab.Nak,
  2581				>
  2582
  2583	003633'	254000	762630		SCNTB	(SPDKHP,SPDKHP,DSK)
  2584	003634'	254000	762630
  2585	003635'	254000	762627
  2586	003636'	000000	000000
  2587	003637'	000000	000000
  2588	003640'	000000	000000
  2589	003641'	000000	000000
  2590	003642'	000000	000000
  2591	003643'	000000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 53-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2592	003644'	000000	000000
  2593	003645'	000000	000000
  2594	003646'	777770	762660
  2595	003647'	777770	762650
  2596	003650'	565756	450000
  2597	003651'	464163	640000
  2598	003652'	000000	000000
  2599	003653'	000000	000000
  2600	003654'	000000	000000
  2601	003655'	000000	000000
  2602	003656'	000000	000000
  2603	003657'	466554	540000
  2604	003660'	000000*	762660
  2605	003661'	000000*	762660
  2606	003662'	000000*	762660
  2607	003663'	000000*	762660
  2608	003664'	000000*	762660
  2609	003665'	000000*	762660
  2610	003666'	000000*	762660
  2611	003667'	000000*	762660
  2612
  2613				;ROUTINE TO GET/SET DSKCLN MODE AND DETERMINE WHO LAST SET IT
  2614				;
  2615	003670'	200340	003607*	SPCDKP:	MOVE	T2,DCN		;GET DSKCLN MODE WORD
  2616	003671'	243340	762672		JFFO	T2,.+1		;DETERMINE HIGHEST PRIORITY MODE
  2617	003672'	135350	757004		LDB	T2,DCNTAB(T3)	;FETCH IT
  2618	003673'	137340	757005		DPB	T2,DCNYON	;OPER HAS SEEN OR SELECTED THIS MODE
  2619	003674'	263040	000000		POPJ	P,		;RETURN
  2620
  2621				FILGO:	MOVEI T1,[Asciz\
  2622	003675'	201300	764253	Leaving the FILES dialogue...\]
  2623	003676'	260040	760544		PUSHJ P,LNGMES		; Let everyone know we're leaving!
  2624	003677'	205740	003441*	RWRHOM:	MOVSI P4,UNPCHG
  2625	003700'	554240	002766*		HLRZ U,SYSUNI		;FIRST UNIT
  2626	003701'	612745	003442*	CHGHOM:	TDNE P4,UNIDES(U)
  2627	003702'	260040	762707		PUSHJ P,UPDHOM		;REWRITE IF NEEDED.
  2628	003703'	412745	003701*		ANDCAM P4,UNIDES(U)
  2629	003704'	554245	002775*		HLRZ U,UNISYS(U)
  2630	003705'	326240	762701		JUMPN U,CHGHOM
  2631	003706'	263040	000000		POPJ P,
  2632
  2633
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 54
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2634				COMMENT #
  2635				@@SUBROUTINE UPDHOM
  2636				@@PURPOSE
  2637				SUBROUTINE TO READ A HOME PAGE, UPDATE IT FROM THE STR AND
  2638				UNIT DB, AND THEN WRITE IT OUT.
  2639				@@ENTRY
  2640				EXPECTS U/ UNIT DB AND F/ DDB.
  2641				@@ACCUM
  2642				DESTROYS
  2643				@@CALLS
  2644				SVOTAC, GETHOM, AND WTBOTH.
  2645				@@ #
  2646
  2647	003707'	265340	761660	UPDHOM:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  2648	003710'	476000	761517		SETOM	NOERH		;NO ERRORS PRINTED FOR HOME READ.
  2649	003711'	260040	761354		PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
  2650					  JRST	[MOVEI T1,%HOM
  2651						PUSHJ P,CORZER
  2652	003712'	254000	764262			JRST .+1]
  2653	003713'	202640	751000*		MOVEM	P2,%HOM+PAGNAM	;SAVE SIXBIT HOME PAGE IDENTIFIER
  2654	003714'	550645	003467*		HRRZ	P2,UNISTR(U)	;GET STR DATA BLOCK ADR.
  2655	003715'	200305	003171*		MOVE	T1,UNIHID(U)	;GET SIXBIT UNIT ID
  2656	003716'	202300	751000*		MOVEM	T1,%HOM+HOMHID	;SAVE IN HOME PAGE
  2657	003717'	554305	003714*		HLRZ	T1,UNISTR(U)	;GET NEXT UNIT DATA BLOCK ADR. IN STR
  2658	003720'	332000	000006		SKIPE	T1		;SAVE 0 IF LAST UNIT IN STR OR NOT IN A STR
  2659	003721'	200306	003715*		MOVE	T1,UNIHID(T1)	;GET ITS ID
  2660	003722'	202300	751000*		MOVEM	T1,%HOM+HOMNXT	;SAVE IN HOME PAGE
  2661	003723'	332300	000015		SKIPE	T1,P2		;SAVE 0 STR NAME IF UNIT NOT IN A STR
  2662	003724'	200315	003375*		MOVE	T1,STRNAM(P2)	;GET SIXBIT STR NAME
  2663	003725'	202300	751000*		MOVEM	T1,%HOM+HOMSNM	;SAVE IN HOME PAGE
  2664	003726'	322640	762751		JUMPE	P2,UPDHM3	;BYPASS ALL REFERENCES TO VALUES IN STR DATA BLOCK
  2665	003727'	554355	003451*		HLRZ	T2,STRUNI(P2)	;GET ADR. OF 1ST UNIT DATA BLOCK IN STR
  2666	003730'	200300	000007	UPDHM1:	MOVE	T1,T2		;CURRENT UNIT_NEXT UNIT
  2667	003731'	322300	762736		JUMPE	T1,UPDHM2	;IF NONE LEFT SAVE 0 IN HOMPRV
  2668	003732'	554346	003717*		HLRZ	T2,UNISTR(T1)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2669	003733'	200306	003721*		MOVE	T1,UNIHID(T1)	;GET CURRENT UNIT'S SIXBIT ID
  2670	003734'	312340	000005		CAME	T2,U		;IS ADR. OF NEXT UNIT DATA BLOCK SAME AS THIS ONE?
  2671	003735'	254000	762730		JRST	UPDHM1		;YES - PUT SIXBIT ID INTO THIS UNIT'S HOME PAGE
  2672	003736'	202300	751000*	UPDHM2:	MOVEM	T1,%HOM+HOMPRV	;SAVE IN HOME PAGE
  2673								; 0 OR SIXBIT UNIT ID OF PREVIOUS UNIT IN STR
  2674	003737'	510315	003513*		HLLZ	T1,STRREF(P2)	;GET 'REFRESH' FLAG
  2675	003740'	502300	751000*		HLLM	T1,%HOM+HOMREF	;SAVE IN HOME PAGE
  2676	003741'	550300	000000*		HRRZ	T1,STRDDB+STRHSH ;
  2677	003742'	516300	751000*		HRLZM	T1,%HOM+HOMHSH	;
  2678	003743'	550300	761230		HRRZ	T1,RANHOM	;Use Remembered HOMRAN value
  2679	003744'	542300	751000*		HRRM	T1,%HOM+HOMRAN	;
  2680	003745'	200315	003217*		MOVE	T1,STROVR(P2)	;GET -VE # PAGES USER IS ALLOWED TO OVERDRAW
  2681	003746'	202300	751000*		MOVEM	T1,%HOM+HOMOVR	;SAVE IN HOME PAGE
  2682	003747'	550315	003204*		HRRZ	T1,STRP4C(P2)	;GET # PAGES FOR CRASH.SAV
  2683	003750'	202300	751000*		MOVEM	T1,%HOM+HOMP4C	;SAVE IN HOME PAGE
  2684
  2685	003751'	200305	003350*	UPDHM3:	MOVE	T1,UNILOG(U)	;GET SIXBIT LOGICAL UNIT WITHIN STR
  2686	003752'	202300	751000*		MOVEM	T1,%HOM+HOMLOG	;SAVE IN HOME PAGE
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 54-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2687	003753'	135300	003432*		LDB	T1,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  2688	003754'	202300	751000*		MOVEM	T1,%HOM+HOMLUN	;SAVE IN HOME PAGE
  2689	003755'	135300	003144*		LDB	T1,UNYSPU	;GET # SAT BLOCKS PER UNIT
  2690	003756'	202300	751000*		MOVEM	T1,%HOM+HOMSPU	;SAVE IN HOME PAGE
  2691	003757'	201300	751001*		MOVEI	T1,%HOM+HOMEND+1 ;FIRST WORD TO CLEAR.
  2692	003760'	303300	750777*		CAILE	T1,%HOM+HOMDAT-1 ;SKIP IF AT LEAST ONE WORD.
  2693	003761'	254000	762770		JRST	UPDHM4
  2694	003762'	402006	000000		SETZM	(T1)		;CLEAR THE FIRST WORD
  2695	003763'	306300	750777*		CAIN	T1,%HOM+HOMDAT-1	;SKIP IF MORE
  2696	003764'	254000	762770		JRST	UPDHM4
  2697	003765'	505300	751001*		HRLI	T1,%HOM+HOMEND+1
  2698	003766'	541300	751002*		HRRI	T1,%HOM+HOMEND+2
  2699	003767'	251300	750777*		BLT	T1,%HOM+HOMDAT-1	;CLEAR UNUSED WORDS
  2700				    ;HERE TO WRITE OUT.
  2701	003770'	202700	751000*	UPDHM4:	MOVEM	P3,%HOM+PAGCOD	;SAVE CODE WORD IN HOME PAGE.
  2702	003771'	205640	505755		MOVSI	P2,(SIXBIT .HOM.) ;RESTORE ARG.
  2703	003772'	260040	761435		PUSHJ	P,WTBOTH	;WRITE OUT BOTH HOME PAGES
  2704	003773'	256000	757000		STOPCD
  2705	003774'	263040	000000		POPJ	P,		;RETURN
  2706
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 55
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2707				;PRINT OR CHANGE SAT+RIB PCBS
  2708	003775'	200600	000000*	TYPSPC:	MOVE	P1,NMSTPC
  2709	003776'	201300	764265		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2710	003777'	324740	761576		PJRST	DECLOP
  2711
  2712	004000'	201300	000005	CHGSPC:	MOVEI	T1,5
  2713	004001'	202300	762114		MOVEM	T1,MIN
  2714	004002'	201300	000050		MOVEI	T1,^D40		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2715	004003'	202300	762113		MOVEM	T1,MAX
  2716	004004'	201300	764265		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2717	004005'	200600	003775*		MOVE	P1,NMSTPC
  2718	004006'	260040	762030		PUSHJ	P,ASKQMM
  2719	004007'	263040	000000		 POPJ	P,
  2720	004010'	202340	004005*		MOVEM	T2,NMSTPC
  2721	004011'	263040	000000		POPJ	P,
  2722
  2723
  2724	004012'	200600	000000*	TYPRPC:	MOVE	P1,NMRBPC
  2725	004013'	201300	764272		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2726	004014'	324740	761576		PJRST	DECLOP
  2727
  2728	004015'	201300	000005	CHGRPC:	MOVEI	T1,5
  2729	004016'	202300	762114		MOVEM	T1,MIN
  2730	004017'	201300	000024		MOVEI	T1,^D20		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2731	004020'	202300	762113		MOVEM	T1,MAX
  2732	004021'	201300	764272		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2733	004022'	200600	004012*		MOVE	P1,NMRBPC
  2734	004023'	260040	762030		PUSHJ	P,ASKQMM
  2735	004024'	263040	000000		  POPJ	P,
  2736	004025'	202340	004022*		MOVEM	T2,NMRBPC
  2737	004026'	263040	000000		POPJ	P,
  2738
  2739				;CHANGE BAT BLOCKS
  2740
  2741	004027'	201300	764277	CHGBAT:	MOVEI	T1,[ASCIZ /Type unit name to refresh BAT pages  /]
  2742	004030'	260040	003156*		PUSHJ	P,CONMES
  2743	004031'	260040	003617*		PUSHJ	P,OPOUT
  2744	004032'	260040	761637		PUSHJ	P,GETUNI
  2745	004033'	263040	000000		  POPJ	P,
  2746	004034'	260040	761731		PUSHJ	P,BATREF
  2747	004035'	263040	000000		  POPJ	P,
  2748	004036'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 56
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2749				;TYPE BAT
  2750
  2751	004037'	201300	764307	TYPBAT:	MOVEI	T1,[ASCIZ /Type unit name  /]
  2752	004040'	260040	004030*		PUSHJ	P,CONMES
  2753	004041'	260040	004031*		PUSHJ	P,OPOUT
  2754	004042'	260040	761637		PUSHJ	P,GETUNI
  2755	004043'	263040	000000		  POPJ	P,
  2756	004044'	402000	761743		SETZM	BATMAN
  2757	004045'	260040	761707		PUSHJ	P,CHKBAT
  2758	004046'	255000	000000		  JFCL			;IGNORE ERRORS.
  2759	004047'	200345	002652*		MOVE	T2,UNINAM(U)	;Physical unit name
  2760	004050'	260040	003613*		PUSHJ	P,PRNAME
  2761	004051'	201400	000050		MOVEI	T3,"("
  2762	004052'	260040	001547*		PUSHJ	P,COMTYO
  2763	004053'	200345	003751*		MOVE	T2,UNILOG(U)	;Logical name (such as DSKB1)
  2764	004054'	260040	004050*		PUSHJ	P,PRNAME
  2765	004055'	201400	000072		MOVEI	T3,":"
  2766	004056'	260040	004052*		PUSHJ	P,COMTYO
  2767	004057'	200345	003733*		MOVE	T2,UNIHID(U)	;Home block ID
  2768	004060'	260040	004054*		PUSHJ	P,PRNAME
  2769	004061'	201400	000051		MOVEI	T3,")"
  2770	004062'	260040	004056*		PUSHJ	P,COMTYO
  2771	004063'	200340	745000*		MOVE	T2,%BAT+BATFIR	;Get AOBJN pointer
  2772	004064'	271340	745000		ADDI	T2,%BAT
  2773	004065'	403700	000014		SETZB	P3,P1		;P1 IS PAGE COUNT, P3 REGION COUNT.
  2774	004066'	336007	000000*	TYPBT1:	SKIPN	BATNBB(T2)
  2775	004067'	254000	763075		 JRST	TYPBT2		;DONE.
  2776	004070'	271700	000001		ADDI	P3,1		;1 REGION.
  2777	004071'	135300	000000*		LDB	T1,BAYNBB	;(uses T2 as index reg)
  2778	004072'	271606	000001		ADDI	P1,1(T1)	;THIS MANY PAGES.
  2779	004073'	252340	763075		AOBJP	T2,TYPBT2
  2780	004074'	253340	763066		AOBJN	T2,TYPBT1
  2781	004075'	201300	764313	TYPBT2:	MOVEI	T1,[ASCIZ /  (counts do not agree)/]
  2782	004076'	316600	745000*		CAMN	P1,%BAT+BATPAT	;Page total
  2783	004077'	312700	745000*		CAME	P3,%BAT+BATCNT	;Count of regions
  2784	004100'	260040	004040*		 PUSHJ	P,CONMES
  2785	004101'	200300	000014		MOVE	T1,P1
  2786	004102'	260040	763260		PUSHJ	P,PR6DIG	;Output number in 6-character field
  2787	004103'	201300	764320		MOVEI	T1,[ASCIZ / bad pages in /]
  2788	004104'	260040	004100*		PUSHJ	P,CONMES
  2789	004105'	200300	000016		MOVE	T1,P3
  2790	004106'	260040	000000*		PUSHJ	P,PRTDIG
  2791	004107'	201300	764323		MOVEI	T1,[ASCIZ / distinct regions./]
  2792	004110'	260040	761620		PUSHJ	P,CRLFOP
  2793	004111'	322700	763212		JUMPE	P3,TYPBT9	;Just CRLF if none
  2794	004112'	201300	764327		MOVEI	T1,[ASCIZ /Do you want a list of bad spots? /]
  2795	004113'	260040	002623*		PUSHJ	P,YESNO		;Skip if "Y"
  2796	004114'	263040	000000		  POPJ	P,		;Done if "N" or no bad spots
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2797				;Output the bad spots
  2798
  2799	004115'	200640	745000*		MOVE	P2,%BAT+BATFIR	;Reset AOBJN pointer
  2800	004116'	271640	745000		ADDI	P2,%BAT
  2801	004117'	336015	004066*	TYPBT3:	SKIPN	BATNBB(P2)	;Zero marks end
  2802	004120'	254000	763212		 JRST	TYPBT9
  2803	004121'	200340	000015		MOVE	T2,P2		;Set up T2 for BAYNBB
  2804	004122'	135300	004071*		LDB	T1,BAYNBB	;Get repeat count
  2805	004123'	326300	763127		JUMPN	T1,TYPBT4	;Zero means single page
  2806	004124'	201300	764336		MOVEI	T1,[ASCIZ / 1 page  at /]
  2807	004125'	260040	004104*		PUSHJ	P,CONMES
  2808	004126'	254000	763133		JRST	TYPBT5
  2809
  2810	004127'	271300	000001	TYPBT4:	ADDI	T1,1		;Add 1 to repeat count
  2811	004130'	260040	763270		PUSHJ	P,PR2DIG	;Output leading blank if needed
  2812	004131'	201300	764341		MOVEI	T1,[ASCIZ / pages at /]
  2813	004132'	260040	004125*		PUSHJ	P,CONMES
  2814
  2815	004133'	200315	000000*	TYPBT5:	MOVE	T1,BATELB(P2)	;Get page address
  2816	004134'	260040	000000*		PUSHJ	P,PRT22A	;19-bit octal number
  2817	004135'	200315	004133*		MOVE	T1,BATELB(P2)	;Page address
  2818	004136'	242300	000002		LSH	T1,P2BLSH	;Convert to blocks
  2819	004137'	135340	000000*		LDB	T2,UNYBPY	;Blocks per cylinder
  2820	004140'	230300	000007		IDIV	T1,T2
  2821	004141'	135400	000000*		LDB	T3,UNYBPT	;Blocks per track
  2822	004142'	230340	000010		IDIV	T2,T3
  2823	004143'	135440	000000*		LDB	T4,UNYBPR	;Blocks per record
  2824	004144'	336000	000011		SKIPN	T4		;If old monitor,
  2825	004145'	201440	000001		 MOVEI	T4,1		; formatted in blocks
  2826	004146'	230400	000011		IDIV	T3,T4
  2827	004147'	271340	000001		ADDI	T2,1		;SYSTAT and ERRCHK number heads starting at 1
  2828	004150'	271400	000001		ADDI	T3,1		;Everyone numbers records starting at 1
  2829	004151'	261040	000010		PUSH	P,T3		;Record (T4 = block in record = 0)
  2830	004152'	261040	000007		PUSH	P,T2		;Head
  2831	004153'	261040	000006		PUSH	P,T1		;Cyl
  2832	004154'	201300	764344		MOVEI	T1,[ASCIZ / = cylinder/]
  2833	004155'	260040	004132*		PUSHJ	P,CONMES
  2834	004156'	262040	000006		POP	P,T1
  2835	004157'	260040	763264		PUSHJ	P,PR4DIG
  2836	004160'	201300	764347		MOVEI	T1,[ASCIZ /, head/]
  2837	004161'	260040	004155*		PUSHJ	P,CONMES
  2838	004162'	262040	000006		POP	P,T1
  2839	004163'	260040	763266		PUSHJ	P,PR3DIG
  2840	004164'	201300	764351		MOVEI	T1,[ASCIZ /, record/]	;Entire page is 1 record if in pages
  2841	004165'	331005	000000*		SKIPL	UNICHR(U)		;If formatted in blocks,
  2842	004166'	201300	764353		 MOVEI	T1,[ASCIZ /, records/]	; all 4 blocks are marked as unuseable
  2843	004167'	260040	004161*		PUSHJ	P,CONMES
  2844	004170'	200301	000000		MOVE	T1,(P)
  2845	004171'	260040	763266		PUSHJ	P,PR3DIG
  2846	004172'	262040	000006		POP	P,T1
  2847	004173'	335005	004165*		SKIPGE	UNICHR(U)	;Formatted in pages?
  2848	004174'	254000	763204		 JRST	TYPBT6		;Yes, done
  2849	004175'	201400	000055		MOVEI	T3,"-"		;No, output range of blocks
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-2
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2850	004176'	260040	004062*		PUSHJ	P,COMTYO
  2851	004177'	271300	000003		ADDI	T1,3		;4th block in page
  2852	004200'	135340	004141*		LDB	T2,UNYBPT
  2853	004201'	313300	000007		CAMLE	T1,T2		;If end block is past # of blocks per track
  2854	004202'	274300	000007		 SUB	T1,T2		; then it is on the next track
  2855	004203'	260040	763270		PUSHJ	P,PR2DIG	;Output ending block number
  2856	004204'	260040	763273	TYPBT6:	PUSHJ	P,SPACE3
  2857	004205'	550355	004117*		HRRZ	T2,BATNBB(P2)	;Get date
  2858	004206'	260040	763215		PUSHJ	P,TYPDAT	;Convert and output it
  2859	004207'	260040	002620*		PUSHJ	P,CRLF
  2860	004210'	252640	003123*		AOBJP	P2,CPOPJ	;Increment by 2
  2861	004211'	253640	763117		AOBJN	P2,TYPBT3	;Loop
  2862
  2863	004212'	332000	745000*	TYPBT9:	SKIPE	%BAT+BATCNT	;If any were found,
  2864	004213'	260040	004207*		 PUSHJ	P,CRLF		; output a blank link
  2865	004214'	263040	000000		POPJ	P,		;End of TYPBAT
  2866
  2867				;Routine to output the date
  2868
  2869	004215'	322340	763240	TYPDAT:	JUMPE	T2,NODATE	;Call with 14-bit TYMSHARE date in T2
  2870	004216'	201300	000000		MOVEI	T1,0		;No time-of-day
  2871	004217'	205740	400020		MOVSI	P4,400020	;Convert from TYM-GMT to DEC-local
  2872	004220'	260040	000000*		PUSHJ	P,DATCOM	;Returns 15-bit date in T2
  2873	004221'	263040	000000		  POPJ	P,		;Illegal date
  2874	004222'	231340	000564		IDIVI	T2,^D<31*12>	;T2/Year
  2875	004223'	271340	000100		ADDI	T2,^D64
  2876	004224'	261040	000007		PUSH	P,T2
  2877	004225'	231400	000037		IDIVI	T3,^D31		;T3/Month, T4/Day
  2878	004226'	261040	000010		PUSH	P,T3
  2879	004227'	201311	000001		MOVEI	T1,1(T4)
  2880	004230'	260040	763270		PUSHJ	P,PR2DIG	;Day (with leading blank if needed)
  2881	004231'	262040	000006		POP	P,T1
  2882	004232'	200306	763244		MOVE	T1,MONTAB(T1)	;"-Mmm-"
  2883	004233'	202300	763242		MOVEM	T1,DATBLK+0	;DATBLK+1 has 0 in bits 0-6
  2884	004234'	201300	763242		MOVEI	T1,DATBLK+0
  2885	004235'	260040	004167*		PUSHJ	P,CONMES	;Output month
  2886	004236'	262040	000006		POP	P,T1
  2887	004237'	324000	763270		PJRST	P,PR2DIG	;Year
  2888
  2889	004240'	201300	764355	NODATE:	MOVEI	T1,[ASCIZ /(no date)/]
  2890	004241'	324740	004235*		PJRST	CONMES
  2891
  2892	763242			DATBLK:	BLOCK	2
  2893					EXTERN	DATCOM
  2894	004244'	266254	167132	MONTAB:	ASCII/-Jan--Feb--Mar--Apr--May--Jun--Jul--Aug--Sep--Oct--Nov--Dec-/
	004245'	266154	561132
	004246'	266334	171132
	004247'	266036	071132
	004250'	266334	174532
	004251'	266256	567132
	004252'	266256	566132
	004253'	266036	563532
	004254'	266474	570132
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-3
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

	004255'	266374	372132
	004256'	266355	773132
	004257'	266114	561532
  2895
  2896				;Decimal output routines
  2897
  2898	004260'	305300	303240	PR6DIG:	CAIGE	T1,^D100000	;Output leading blanks if not 6 digits
  2899	004261'	260040	002126*		 PUSHJ	P,PRSPC
  2900	004262'	305300	023420	PR5DIG:	CAIGE	T1,^D10000
  2901	004263'	260040	004261*		 PUSHJ	P,PRSPC
  2902	004264'	305300	001750	PR4DIG:	CAIGE	T1,^D1000
  2903	004265'	260040	004263*		 PUSHJ	P,PRSPC
  2904	004266'	305300	000144	PR3DIG:	CAIGE	T1,^D100
  2905	004267'	260040	004265*		 PUSHJ	P,PRSPC
  2906	004270'	305300	000012	PR2DIG:	CAIGE	T1,^D10
  2907	004271'	260040	004267*		 PUSHJ	P,PRSPC##
  2908	004272'	254000	004106*		JRST	PRTDIG##
  2909
  2910	004273'	201300	764357	SPACE3:	MOVEI	T1,[ASCIZ /   /];3 blanks
  2911	004274'	324740	004241*		PJRST	CONMES
  2912
  2913	763275				VAR
  2914	763275			ONDLIT:	LIT
  2915	004275'	064250	551244
  2916	004276'	476452	320356
  2917	004277'	643234	364100
  2918	004300'	703454	573312
  2919	004301'	673504	061344
  2920	004302'	647354	764734
  2921	004303'	635016	464312
  2922	004304'	203477	171750
  2923	004305'	627324	052640
  2924	004306'	000000	000000
  2925	004307'	064250	664730
  2926	004310'	625016	372344
  2927	004311'	727076	472744
  2928	004312'	625011	642612
  2929	004313'	422464	071312
  2930	004314'	633454	571720
  2931	004315'	647354	700000
  2932	004316'	064251	544634
  2933	004317'	476444	042644
  2934	004320'	512372	251500
  2935	004321'	265010	271322
  2936	004322'	673164	071762
  2937	004323'	717514	566500
  2938	004324'	526404	060734
  2939	004325'	747574	174576
  2940	004326'	200000	000000
  2941	004327'	001600	746000*
  2942	004330'	747000	747001
  2943	004331'	747400	747401
  2944	004332'	777400	747000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-4
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2945	004333'	301400	000040
  2946	004334'	263040	000000
  2947	004335'	211700	000001
  2948	004336'	254000	003271*
  2949	004337'	211700	000002
  2950	004340'	254000	004336*
  2951	004341'	211700	000003
  2952	004342'	254000	004340*
  2953	004343'	201740	000001
  2954	004344'	254000	757252
  2955	004345'	064241	505202
  2956	004346'	713124	074736
  2957	004347'	725012	352644
  2958	004350'	425017	167752
  2959	004351'	203574	167350
  2960	004352'	203515	720310
  2961	004353'	675016	464322
  2962	004354'	715764	000000
  2963	004355'	064250	567350
  2964	004356'	627455	167316
  2965	004357'	203515	062500
  2966	004360'	432231	442646
  2967	004361'	203115	160730
  2968	004362'	677176	562534
  2969	004363'	271341	505100
  2970	004364'	202517	170312
  2971	004365'	201050	747504
  2972	004366'	203515	720344
  2973	004367'	627516	571334
  2974	004370'	203515	720236
  2975	004371'	472070	527000
  2976	004372'	064244	020250
  2977	004373'	747414	520104
  2978	004374'	442131	450104
  2979	004375'	203155	771100
  2980	004376'	605015	464746
  2981	004377'	721015	763100
  2982	004400'	677416	464736
  2983	004401'	673465	606424
  2984	004402'	000000	000000
  2985	004403'	064250	644630
  2986	004404'	426465	220000
  2987	004405'	201010	444646
  2988	004406'	516371	453212
  2989	004407'	203236	320346
  2990	004410'	703135	466312
  2991	004411'	621016	764750
  2992	004412'	641016	473736
  2993	004413'	201052	321312
  2994	004414'	715341	505000
  2995	004415'	064252	474740
  2996	004416'	625004	252262
  2997	004417'	502124	044212
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-5
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  2998	004420'	462404	220314
  2999	004421'	677444	060500
  3000	004422'	663236	372100
  3001	004423'	677144	067740
  3002	004424'	723235	767346
  3003	004425'	270321	200000
  3004	004426'	064252	474740
  3005	004427'	625004	241620
  3006	004430'	406350	742500
  3007	004431'	442131	450104
  3008	004432'	203155	771100
  3009	004433'	605015	464746
  3010	004434'	721015	763100
  3011	004435'	677416	464736
  3012	004436'	673465	606424
  3013	004437'	000000	000000
  3014	004440'	064252	474740
  3015	004441'	625004	252262
  3016	004442'	502124	072734
  3017	004443'	647505	567302
  3018	004444'	667124	044212
  3019	004445'	462404	220314
  3020	004446'	677444	060500
  3021	004447'	663236	372100
  3022	004450'	677144	067740
  3023	004451'	723235	767346
  3024	004452'	270000	000000
  3025	004453'	064252	474740
  3026	004454'	625004	241620
  3027	004455'	406350	742500
  3028	004456'	727355	172132
  3029	004457'	673035	562500
  3030	004460'	442131	450104
  3031	004461'	203155	771100
  3032	004462'	605015	464746
  3033	004463'	721015	763100
  3034	004464'	677416	464736
  3035	004465'	673465	600000
  3036	004466'	064252	474740
  3037	004467'	625004	252262
  3038	004470'	502124	071750
  3039	004471'	711335	660732
  3040	004472'	625011	042630
  3041	004473'	501044	063336
  3042	004474'	711014	120330
  3043	004475'	647476	420336
  3044	004476'	631015	770350
  3045	004477'	647375	671534
  3046	004500'	000000	000000
  3047	004501'	064252	474740
  3048	004502'	625004	241620
  3049	004503'	406350	742500
  3050	004504'	717516	226734
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-6
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3051	004505'	607334	520220
  3052	004506'	426312	021100
  3053	004507'	633376	220302
  3054	004510'	203315	171750
  3055	004511'	203374	620336
  3056	004512'	703515	167734
  3057	004513'	715340	000000
  3058	004514'	203236	320336
  3059	004515'	633145	566322
  3060	004516'	673120	000000
  3061	004517'	422364	054636
  3062	004520'	525012	740634
  3063	004521'	521011	152100
  3064	004522'	522364	041212
  3065	004523'	201425	153644
  3066	004524'	446510	526612
  3067	004525'	472030	246212
  3068	004526'	421304	047644
  3069	004527'	201445	153644
  3070	004530'	446510	526640
  3071	004531'	512372	442606
  3072	004532'	522130	437500
  3073	004533'	242513	150212
  3074	004534'	201065	106424
  3075	004535'	000000	000000
  3076	004536'	466232	351622
  3077	004537'	472164	047644
  3078	004540'	202231	641636
  3079	004541'	472471	151650
  3080	004542'	426352	420220
  3081	004543'	406471	020206
  3082	004544'	476352	352202
  3083	004545'	472504	043236
  3084	004546'	511012	547222
  3085	004547'	521000	000000
  3086	004550'	466232	351622
  3087	004551'	472164	047644
  3088	004552'	202231	641636
  3089	004553'	472471	151650
  3090	004554'	426352	420240
  3091	004555'	406071	320246
  3092	004556'	426504	044610
  3093	004557'	202151	751100
  3094	004560'	526351	152100
  3095	004561'	000000	000000
  3096	004562'	064250	444646
  3097	004563'	455010	647644
  3098	004564'	466032	420210
  3099	004565'	476132	320234
  3100	004566'	476504	046602
  3101	004567'	522071	020212
  3102	004570'	542410	541650
  3103	004571'	426104	043236
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-7
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3104	004572'	512330	152100
  3105	004573'	476344	052634
  3106	004574'	446504	000000
  3107	004575'	064251	547644
  3108	004576'	425012	444202
  3109	004577'	471011	747212
  3110	004600'	202310	151650
  3111	004601'	202531	644650
  3112	004602'	202231	620246
  3113	004603'	522444	000000
  3114	004604'	064252	447636
  3115	004605'	202330	147262
  3116	004606'	202472	451116
  3117	004607'	515000	000000
  3118	004610'	267374	663330
  3119	004611'	647354	526500
  3120	004612'	201000	000000
  3121	004613'	727355	172100
  3122	004614'	627456	267744
  3123	004615'	201000	000000
  3124	004616'	613034	420314
  3125	004617'	677455	560750
  3126	004620'	201000	000000
  3127	004621'	667035	167350
  3128	004622'	627354	167306
  3129	004623'	625000	000000
  3130	004624'	243355	720310
  3131	004625'	647475	324500
  3132	004626'	201000	000000
  3133	004627'	243234	767336
  3134	004630'	713134	424500
  3135	004631'	201000	000000
  3136	004632'	064251	440646
  3137	004633'	521012	547222
  3138	004634'	521012	740646
  3139	004635'	471172	420214
  3140	004636'	476531	642100
  3141	004637'	446344	051650
  3142	004640'	511000	000000
  3143	004641'	064252	453636
  3144	004642'	202311	743622
  3145	004643'	416031	420252
  3146	004644'	472232	420000
  3147	004645'	236464	043236
  3148	004646'	526350	420222
  3149	004647'	471012	352244
  3150	004650'	200000	000000
  3151	004651'	064251	447616
  3152	004652'	446070	146100
  3153	004653'	526351	152100
  3154	004654'	000000	000000
  3155	004655'	202331	151646
  3156	004656'	446350	720214
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-8
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3157	004657'	512371	520246
  3158	004660'	522444	000000
  3159	004661'	064247	747236
  3160	004662'	202473	151650
  3161	004663'	426324	051650
  3162	004664'	512530	352252
  3163	004665'	512120	000000
  3164	004666'	202232	320256
  3165	004667'	512232	442500
  3166	004670'	502451	752212
  3167	004671'	416510	542000
  3168	004672'	064240	000000
  3169	004673'	202232	320236
  3170	004674'	432145	546222
  3171	004675'	472120	000000
  3172	004676'	000000*	000000*
  3173	004677'	000000*	000000*
  3174	004700'	202410	143612
  3175	004701'	202210	151210
  3176	004702'	536032	242500
  3177	004703'	512130	142100
  3178	004704'	426452	247644
  3179	004705'	000000	000000
  3180	004706'	634164	000000
  3181	004707'	202410	143612
  3182	004710'	202071	747246
  3183	004711'	446472	442634
  3184	004712'	416624	042644
  3185	004713'	512372	200000
  3186	004714'	442032	242256
  3187	004715'	406450	520256
  3188	004716'	512232	442500
  3189	004717'	426452	247644
  3190	004720'	000000	000000
  3191	004721'	202151	151246
  3192	004722'	521000	000000
  3193	004723'	202470	541636
  3194	004724'	472104	000000
  3195	004725'	000000	763723
  3196	004726'	700600	002562*
  3197	004727'	263040	000000
  3198	004730'	472372	420202
  3199	004731'	202411	054646
  3200	004732'	446070	146100
  3201	004733'	526351	152132
  3202	004734'	522453	120202
  3203	004735'	436031	147000
  3204	004736'	000000	763730
  3205	004737'	064250	467500
  3206	004740'	747376	520356
  3207	004741'	607356	420350
  3208	004742'	675015	167322
  3209	004743'	723234	166322
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-9
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3210	004744'	753124	072320
  3211	004745'	625010	240650
  3212	004746'	203414	163712
  3213	004747'	715015	767100
  3214	004750'	723215	171500
  3215	004751'	526351	152176
  3216	004752'	064240	000000
  3217	004753'	064252	444222
  3218	004754'	515015	171500
  3219	004755'	673376	420334
  3220	004756'	677455	560730
  3221	004757'	663624	062336
  3222	004760'	673125	420302
  3223	004761'	713124	074736
  3224	004762'	725012	352644
  3225	004763'	425761	505000
  3226	004764'	260000	000000
  3227	004765'	240000	000000
  3228	004766'	244000	000000
  3229	004767'	064252	352244
  3230	004770'	202231	620104
  3231	004771'	516632	321100
  3232	004772'	516130	151206
  3233	004773'	441011	444646
  3234	004774'	521640	000000
  3235	004775'	064252	547222
  3236	004776'	522464	047236
  3237	004777'	521011	147100
  3238	005000'	405010	644630
  3239	005001'	425012	352244
  3240	005002'	526072	452644
  3241	005003'	425641	505000
  3242	005004'	472130	542246
  3243	005005'	202450	543244
  3244	005006'	426471	044634
  3245	005007'	435000	000000
  3246	005010'	350000	000000
  3247	005011'	466231	620172
  3248	005012'	200000	000000
  3249	005013'	202330	154100
  3250	005014'	365000	000000
  3251	005015'	064252	640630
  3252	005016'	526124	047236
  3253	005017'	521011	147100
  3254	005020'	502132	246622
  3255	005021'	522510	542100
  3256	005022'	512031	643612
  3257	005023'	000000	000000
  3258	005024'	064250	344202
  3259	005025'	472170	520256
  3260	005026'	446311	420206
  3261	005027'	406532	342500
  3262	005030'	516512	220250
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-10
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3263	005031'	475011	642612
  3264	005032'	421012	242614
  3265	005033'	512132	344222
  3266	005034'	472160	000000
  3267	005035'	064252	547222
  3268	005036'	521011	142100
  3269	005037'	446464	000000
  3270	005040'	064253	242644
  3271	005041'	475012	547222
  3272	005042'	521011	142100
  3273	005043'	265011	642656
  3274	005044'	202230	420234
  3275	005045'	426130	442610
  3276	005046'	000000	000000
  3277	005047'	000000	020002
  3278	005050'	502030	742646
  3279	005051'	202151	751100
  3280	005052'	416450	151620
  3281	005053'	272470	153100
  3282	005054'	365000	000000
  3283	005055'	260040	761624
  3284	005056'	215011	743100
  3285	005057'	502030	742646
  3286	005060'	202031	446236
  3287	005061'	536130	420214
  3288	005062'	476444	047654
  3289	005063'	426450	451202
  3290	005064'	535012	042644
  3291	005065'	202532	342644
  3292	005066'	201724	000000
  3293	005067'	446353	420000
  3294	005070'	516512	220302
  3295	005071'	663454	560710
  3296	005072'	745014	574322
  3297	005073'	717516	300000
  3298	005074'	000000	764070
  3299	005075'	064252	467736
  3300	005076'	203334	167362
  3301	005077'	203155	166312
  3302	005100'	203476	471352
  3303	005101'	617516	571312
  3304	005102'	715024	020236
  3305	005103'	673317	120336
  3306	005104'	673124	060730
  3307	005105'	663376	762710
  3308	005106'	204321	200000
  3309	005107'	523636	062500
  3310	005110'	673035	562746
  3311	005111'	203374	620340
  3312	005112'	643636	364706
  3313	005113'	607304	072734
  3314	005114'	647516	320322
  3315	005115'	671012	352244
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-11
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3316	005116'	261014	574350
  3317	005117'	713024	041644
  3318	005120'	203575	062734
  3319	005121'	203115	767312
  3320	005122'	000000	000000
  3321	005123'	302715	003727*
  3322	005124'	254000	762272
  3323	005125'	254000	762235
  3324	005126'	064252	567322
  3325	005127'	721014	166344
  3326	005130'	627034	474500
  3327	005131'	647344	063322
  3328	005132'	663124	071750
  3329	005133'	713534	372352
  3330	005134'	713121	505000
  3331	005135'	260040	762317
  3332	005136'	260040	762315
  3333	005137'	427356	462744
  3334	005140'	203535	664750
  3335	005141'	203354	166712
  3336	005142'	203515	720302
  3337	005143'	623100	000000
  3338	005144'	522210	152100
  3339	005145'	727355	172100
  3340	005146'	647464	060730
  3341	005147'	713134	162362
  3342	005150'	203235	620302
  3343	005151'	203476	471352
  3344	005152'	617516	571312
  3345	005153'	000000	000000
  3346	005154'	523214	520246
  3347	005155'	546472	442632
  3348	005156'	203476	471352
  3349	005157'	617516	571312
  3350	005160'	203214	171500
  3351	005161'	673376	420304
  3352	005162'	627135	620210
  3353	005163'	426151	147212
  3354	005164'	421017	162750
  3355	005165'	000000	000000
  3356	005166'	417035	667336
  3357	005167'	721014	162310
  3358	005170'	203535	664750
  3359	005171'	203515	720346
  3360	005172'	723456	561750
  3361	005173'	727454	500000
  3362	005174'	523214	520346
  3363	005175'	723456	561750
  3364	005176'	727454	520256
  3365	005177'	406464	047236
  3366	005200'	521016	372706
  3367	005201'	617136	371714
  3368	005202'	727315	474500
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-12
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3369	005203'	713134	671312
  3370	005204'	717214	562134
  3371	005205'	000000	000000
  3372	005206'	427356	462744
  3373	005207'	203114	172312
  3374	005210'	203036	320232
  3375	005211'	465330	442132
  3376	005212'	546633	154500
  3377	005213'	000000	000000
  3378	005214'	427356	462744
  3379	005215'	203515	166712
  3380	005216'	203036	320220
  3381	005217'	442331	520000
  3382	005220'	064250	451626
  3383	005221'	416311	620332
  3384	005222'	677114	520322
  3385	005223'	715644	000000
  3386	005224'	566554	540000
  3387	005225'	422471	341630
  3388	005226'	471015	567710
  3389	005227'	625014	462746
  3390	005230'	647454	562176
  3391	005231'	200000	000000
  3392	005232'	064250	260710
  3393	005233'	203135	672344
  3394	005234'	745644	052362
  3395	005235'	703124	023614
  3396	005236'	526311	423530
  3397	005237'	201170	640646
  3398	005240'	521165	420116
  3399	005241'	472371	642516
  3400	005242'	064244	067744
  3401	005243'	203256	571750
  3402	005244'	201712	262750
  3403	005245'	727455	637100
  3404	005246'	633376	220310
  3405	005247'	627154	172730
  3406	005250'	721005	047236
  3407	005251'	202071	040634
  3408	005252'	436125	100000
  3409	005253'	064251	462702
  3410	005254'	733235	663500
  3411	005255'	723214	520214
  3412	005256'	446310	551500
  3413	005257'	623234	166336
  3414	005260'	637534	527134
  3415	005261'	270000	000000
  3416	005262'	201300	751000
  3417	005263'	260040	002732*
  3418	005264'	254000	762713
  3419	005265'	472531	541212
  3420	005266'	511011	743100
  3421	005267'	516032	420240
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-13
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3422	005270'	416052	320172
  3423	005271'	200000	000000
  3424	005272'	472531	541212
  3425	005273'	511011	743100
  3426	005274'	512230	220240
  3427	005275'	416052	320172
  3428	005276'	200000	000000
  3429	005277'	523636	062500
  3430	005300'	727355	172100
  3431	005301'	673035	562500
  3432	005302'	723364	071312
  3433	005303'	633454	571720
  3434	005304'	202050	152100
  3435	005305'	703034	762746
  3436	005306'	201000	000000
  3437	005307'	523636	062500
  3438	005310'	727355	172100
  3439	005311'	673035	562500
  3440	005312'	200000	000000
  3441	005313'	201005	061736
  3442	005314'	727356	471500
  3443	005315'	623364	067336
  3444	005316'	721014	163744
  3445	005317'	627125	100000
  3446	005320'	203054	162100
  3447	005321'	703034	762746
  3448	005322'	203235	620000
  3449	005323'	203115	171750
  3450	005324'	647354	372100
  3451	005325'	713134	764736
  3452	005326'	673465	600000
  3453	005327'	423364	074736
  3454	005330'	725016	760734
  3455	005331'	721014	120330
  3456	005332'	647476	420336
  3457	005333'	631014	260710
  3458	005334'	203476	067750
  3459	005335'	715764	000000
  3460	005336'	201424	070302
  3461	005337'	637124	020302
  3462	005340'	721000	000000
  3463	005341'	203414	163712
  3464	005342'	715014	172100
  3465	005343'	000000	000000
  3466	005344'	201724	061762
  3467	005345'	663235	662312
  3468	005346'	710000	000000
  3469	005347'	261015	062702
  3470	005350'	620000	000000
  3471	005351'	261016	262706
  3472	005352'	677454	400000
  3473	005353'	261016	262706
  3474	005354'	677454	471400
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 57-14
ONCDSK.MAC	14-APR-88 23:38		CHECK ON DISK CAPACITY

  3475	005355'	243355	720310
  3476	005356'	607514	524400
  3477	005357'	201004	000000
  3478
  3479
  3480			005361	ONDLNR==.-%OND+1
  3481			006000	ONDLNP==<ONDLNR!777>+1
  3482
  3483				ONSZCK(ONCDSK,OND)	;CHECK TO SEE IF ENOUGH PAGES ALLOCATED
  3484
  3485	005360'			DEPHASE
  3486
  3487	005360'			ONDEND:	END		;Cannot use $END in PHASEd code
  3488
NO ERRORS DETECTED
PROGRAM BREAK IS 005360
11K CORE USED
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 58
ONCDSK.MAC	14-APR-88 23:38		SYMBOL TABLE

AB.ACK		000000	EXT	CMDSC3		757237		DCSIZ		000003	SPD	GETSRB		757177	
AB.CVR		000266'	EXT	CMDSC4		757252		DCXX		000006	SPD	GETUNI		761637	
AB.NAK		000242'	EXT	CMDSC5		757256		DDBLEN		000000	EXT	HLPCHG		760234	
AB.TCV		000273'	EXT	CMDSCF		757307	INT	DDSTAR		003504'	EXT	HLPFIL		757322	
AB.VER		000264'	EXT	CMDSCN		757211	INT	DDTX		000362'	EXT	HLPSRP		760433	
ADDNOT		762465		CMPLOG		003450'	EXT	DECIN		003556'	EXT	HLPTY1		757323	
ADDUN2		762410		CNTADS		762513		DECLOP		761576	INT	HLPTYP		760051	
ADDUN4		762445		CODBAT		002364'	EXT	DEVIOS		000002	SIN	HLPUIP		760362	
ADDUN5		762452		CODHOM		002355'	EXT	DIE		000000'	EXT	HMBOK		760727	
ADDUN7		762456		CODRIB		000203'	EXT	DISST1		762350		HMBOK2		760735	
ADDUNI		762374		COMDAS		003547'	EXT	DISST2		762356		HMBOK3		760754	
ADUNT		762432		COMTMS		003565'	EXT	DSKCPY		761554		HOMDAT		000000	EXT
ASKQMM		762030	INT	COMTYO		004176'	EXT	DSKDDB		000000	EXT	HOMDCT		000000	EXT
ASKQUE		761622		CONCHK		761416		DSKPIF		002555'	EXT	HOMDCV		001761'	EXT
ASKRP1		762104		CONMES		004274'	EXT	DSKPIN		004726'	EXT	HOMEND		000000	EXT
ASKRPQ		762100		CONOUT		761617		DSKPPU		002013'	EXT	HOMFEP		000000	EXT
ASKRPT		762037		CORZER		005263'	EXT	DSPCHG		760241		HOMHID		000000	EXT
BADDIS		760033		CPOPJ		004210'	EXT	DSPDSK		762636		HOMHSH		000000	EXT
BATBAD		761742		CPOPJ1		004342'	EXT	DSPFIL		757352		HOMLOG		000000	EXT
BATCNT		000000	EXT	CPUF3		000004	SPD	DSPSRP		760442		HOMLUN		000000	EXT
BATELB		004135'	EXT	CPUKI		000001	SPD	DSPTYP		760056		HOMMFD		000000	EXT
BATFIR		000000	EXT	CPUKL		000002	SPD	DSPUIP		760371		HOMNXT		000000	EXT
BATMAN		761743		CPUKS		000003	SPD	ERRHM2		761227		HOMOVR		000000	EXT
BATNBB		004205'	EXT	CPUTYP		000003	SPD	ERRHOM		761226		HOMP4C		000000	EXT
BATPAT		000000	EXT	CPYWAT		761565		EVASIZ		000315'	EXT	HOMPRV		000000	EXT
BATREF		761731		CPZZ		000000	SPD	EVMALC		002062'	EXT	HOMRAN		000000	EXT
BATREG		002736'	EXT	CRESTT		761055		F		000004	INT	HOMREF		000000	EXT
BAYNBB		004122'	EXT	CRLF		004213'	EXT	FILCMD		757325		HOMSAT		000000	EXT
BRMAX		000000	EXT	CRLFOP		761620		FILGO		762675		HOMSNM		000000	EXT
CANTAD		762467		CTEXT		003166'	EXT	FILHL1		757343		HOMSPU		000000	EXT
CCOD		000000	EXT	CTYDO		000270'	EXT	FILHLP		757342		HOMSUF		000000	EXT
CH7		000000	EXT	CWCOD		002560'	EXT	FILMAN		757012	INT	ICPFAC		000000	EXT
CHGBAT		763027		DATBLK		763242		FILOPT		757312	INT	INLMES		001556'	EXT
CHGCMD		757325		DATCOM		004220'	EXT	FIROK		761372		INSERT		761043	
CHGHL1		760230		DBLSTD		762110		FLGDN1		760651		IOSEL		002563'	EXT
CHGHLP		760227		DC.SIZ		000003	SIN	FLGDN2		760657		J		000002	INT
CHGHOM		762701		DCFAST		000052'	EXT	FLGDN3		760661		JFYSEC		000000	EXT
CHGIT		760220		DCN		003670'	EXT	FLGDN4		760662		KEPSAM		762076	
CHGRPC		763015		DCN.DF		010000	SIN	FLGDN5		760671		KNNUNI		762045	
CHGSPC		763000		DCN.HM		020000	SIN	FLGDWN		760650		KNOUNI		762115	
CHGSTR		762206		DCN.MN		040000	SIN	FNDSTR		761260		KONCPY		000000	EXT
CHKANS		762063		DCN.ON		200000	SIN	FNDUN1		761652		KONDWN		001643'	EXT
CHKBAT		761707		DCN.OP		400000	SIN	FNDUNI		761651		KONLTM		000000	EXT
CHKFLG		761434		DCN.UR		100000	SIN	FSTERR		761502		KONTOK		760645	
CHKHOM		760715		DCNDFT		030000	SIN	FTYUNI		762126		KONUPA		001631'	EXT
CHKUN1		761214		DCNTAB		757004		GETBAT		761361	INT	KOPDWN		001642'	EXT
CHKUNI		761175		DCNUM		000006	SPD	GETDAT		762516		LI.PIN		000200	SPD
CLRDDB		001602'	EXT	DCNYDF		757011	INT	GETDT1		762523		LINKIT		761035	
CLRSND		002615'	EXT	DCNYHM		757010	INT	GETDT2		762551		LINKT1		761041	
CLRSTR		762362		DCNYMN		757007	INT	GETHOM		761354	INT	LIT$0		762660	SPD
CMDMSG		757306		DCNYON		757005	INT	GETLIN		003620'	EXT	LIT$1		762660	SPD
CMDSC1		757227		DCNYOP		757004	INT	GETPEV		002437'	EXT	LIT$10		757633	SPD
CMDSC2		757233		DCNYUR		757006	INT	GETRAN		762574		LIT$11		757704	SPD
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 58-2
ONCDSK.MAC	14-APR-88 23:38		SYMBOL TABLE

LIT$12		757753	SPD	NULTYP		760051		PRCOL		002131'	EXT	RWRHOM		762677	
LIT$13		757767	SPD	NULUIP		760362		PRNAME		004060'	EXT	S$ENTR	777777	777775	SIN
LIT$14		760007	SPD	OCONM		003616'	EXT	PRNAMF		002141'	EXT	S$HALT	777777	777777	SIN
LIT$2		762660	SPD	OCTIN		002254'	EXT	PRSPC		004271'	EXT	S$NAME		757000	SPD
LIT$3		762660	SPD	OFLTAB		761146		PRT22A		004134'	EXT	S$NONA		000000	SIN
LIT$4		762660	SPD	OHTINI		002533'	EXT	PRTDIG		004272'	EXT	S$TEMP		000000	SPD
LIT$5		762660	SPD	OHTNUM		002551'	EXT	QSTSTD		762072		S$XCT	777777	777776	SIN
LIT$6		762660	SPD	OLDST0		760773		RADX10		002607'	EXT	SATCNT		000141'	EXT
LIT$7		762660	SPD	OLDST1		760775		RANHOM		761230		SAVE4		003520'	EXT
LNGMES		760544	INT	OLDST2		760767		RANNO		003600'	EXT	SCNBAT		000000	EXT
LNGMS1		760545		OLDST4		760777		RBINDX		000000	EXT	SCNCHG		760247	
LP2BAT		004677'	EXT	OLDST5		761007		RBLVPR		000000	EXT	SCNDSK		762650	
LP2HOM		004676'	EXT	OLDST6		761001		RBLVSP		000000	EXT	SCNFIL		757371	
LPNBAT		000000	EXT	OLDST8		761011		RBMASK		000000	EXT	SCNSD2		761221	
LPNHOM		000000	EXT	OLDSTR		760757		RBREAL		002442'	EXT	SCNSRP		760450	
LSTRED		761173		ONCDDB		001603'	EXT	RBSPAR		000000	EXT	SCNST2		761165	
LSTUNI		761030		ONCDSK		757000	ENT	RBYPNO		002445'	EXT	SCNSTD		761217	
MANCM1		757017		ONCMOD		000000'	ENT	RBYUN1		000103'	EXT	SCNSTR		761154	
MANCOM		757020		ONDEND		005360'		RBYUN4		000000	EXT	SCNTYP		760067	
MANOK		757027		ONDLIT		763275		RBYUNI		002443'	EXT	SCNUIP		760375	
MANOK1		757043		ONDLNP		006000	SIN	RDBAT1		761700		SCNUN1		761071	
MANOK2		757056		ONDLNR		005361	SIN	RDBAT6		761704		SCNUNI		760623	
MANQST		757024		ONDSTT		000000'	INT	RDBNON		761405		SETBAT		761363	
MANREF		757022		OPAGIN		761520	INT	RDBOTH		761370		SETCHG		761624	
MAX		762113	INT	OPAGIO		761525		RDBSKP		761404		SETDDO		001605'	EXT
MAYREF		762116		OPAGOT		761523	INT	RDCHEK		761407		SETPRV		761634	
MCKKON		761235		OPOUT		004041'	EXT	RDHOM1		760614		SETPUB		761631	
MFDRIB		002315'	EXT	OVRDEF		762322		RDHOM2		760617		SETRAN		762571	
MIN		762114	INT	P		000001	INT	RDHOME		760556		SETUNT		761104	
MISUNI		761205		P1		000014	INT	RDRBS2		757072		SETUTS		761113	
MONTAB		763244		P2		000015	INT	RDRBS3		757075		SIZCHG		000004	SPD
MOVSTR		761304		P2BLSH		000002	SPD	RDSATS		757120		SIZDSK		000010	SPD
MOVUNI		761265		P3		000016	INT	RDST45		757135		SIZFIL		000015	SPD
MSGLNG		761326		P4		000017	INT	RDSTS1		757122		SIZOND		000007	SIN
MSGSAV		762107		P4CDEF		762332		RDSTS4		757123		SIZSRP		000004	SPD
MSGSTR		761336		PAGCOD		002422'	EXT	RDSTS5		757153		SIZTYP		000007	SPD
MSGUNI		761345		PAGIN		002520'	EXT	RDSTS6		757165		SIZUIP		000002	SPD
NAMFLO		761343		PAGNAM		002421'	EXT	RDTIME	702200	000000		SPACE3		763273	
NASTYP		761237		PAGOUT		002523'	EXT	RDWMSG		761465		SPCDK1		762615	
NLSUNI		761033		PAGSLF		002446'	EXT	RE.DCD		001750'	EXT	SPCDKN		762603	
NMRBPC		004025'	EXT	PAKREF		003443'	EXT	REDBAT		761676		SPCDKP		762670	
NMSTPC		004010'	EXT	PCBPAG		002530'	EXT	REDERR		761515		SPDKHP		762630	
NODATE		763240		PCISTS		002544'	EXT	REDSEC		761377		SPSNAM		761610	
NODIE		000000	EXT	PG		000003	INT	REFLAG		000034'	EXT	SPUCLC		762134	
NOERH		761517		PGYERR		002547'	EXT	REFRSH		003505'	EXT	SPUNAM		761611	
NOREF		762012		PGYPNO		002534'	EXT	REFSAV		761657		SRPCMD		757325	
NOSTR		761047		PGYUNI		002540'	EXT	REONCE		757003	INT	SRPHL1		760427	
NOTPRV		760756		PJRST	324740	000000		REPSID		001745'	EXT	SRPHLP		760426	
NTISTR		761054		PR2DIG		763270		RETFIX		762066		SRPNDS		000054'	EXT
NULCHG		760234		PR3DIG		763266		RIBEXT		000000	EXT	SRPREF		000032'	EXT
NULDSK		762627		PR4DIG		763264		RIBLST		000075'	EXT	STDREA		002521'	EXT
NULFIL		757325		PR5DIG		763262		RIBNAM		002420'	EXT	STDWRT		002524'	EXT
NULSRP		760433		PR6DIG		763260		RIBPFS		000070'	EXT	STOUN1		761572	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89 PAGE 58-3
ONCDSK.MAC	14-APR-88 23:38		SYMBOL TABLE

STOUNI		761570		TXTCHG		760337		UNILOG		004053'	EXT	%OFLRS		000004	SIN
STRBTS		000000	EXT	TXTDSK		762660		UNINAM		004047'	EXT	%OND		757000	SIN
STRDDB		003374'	EXT	TXTFIL		760016		UNIONC		002132'	EXT	%STA		747000	SIN
STRFIX		761005	INT	TXTSRP		760535		UNIPPU		003410'	EXT	%STA.P		000146'	EXT
STRHSH		001771'	EXT	TXTTYP		760211		UNISTR		003732'	EXT	%STR		746000	SIN
STRLEN		000000	EXT	TXTUIP		760413		UNISTS		002565'	EXT	%STR.P		000205'	EXT
STRNAM		003724'	EXT	TYPALL		762024		UNISTT		002063'	EXT	
STRNXT		000000	EXT	TYPBAT		763037		UNISYS		003704'	EXT	
STROVR		003745'	EXT	TYPBT1		763066		UNITAL		000162'	EXT	
STRP4C		003747'	EXT	TYPBT2		763075		UNITID		762151		
STRPID		000000	EXT	TYPBT3		763117		UNITST		762142		
STRPPU		003411'	EXT	TYPBT4		763127		UNPCHG		003677'	EXT	
STRREF		003737'	EXT	TYPBT5		763133		UNPHWP		002721'	EXT	
STRSID		000000	EXT	TYPBT6		763204		UNPMSB		002275'	EXT	
STRTAL		000000	EXT	TYPBT9		763212		UNPOFL		002677'	EXT	
STRTCH		762174		TYPCMD		757325		UNPPRV		003347'	EXT	
STRTOV		762210		TYPDAT		763215		UNTLEN		000000	EXT	
STRTPA		760541		TYPDEC		761605		UNTTBL		003433'	EXT	
STRUNI		005123'	EXT	TYPHL1		760045		UNVRSF		000154'	EXT	
STRUNM		003445'	EXT	TYPHLP		760044		UNYBPR		004143'	EXT	
STSDEF		762221		TYPIT		760035		UNYBPT		004200'	EXT	
STSDSL		762342		TYPMSN		761601		UNYBPY		004137'	EXT	
STSFIN		762272		TYPNS1		761770		UNYKTP		003277'	EXT	
STSINS		762246		TYPNS2		761775		UNYLN1		002035'	EXT	
STSNE1		762232		TYPONL		762112	INT	UNYLUN		003753'	EXT	
STSNE2		762235		TYPRPC		763012		UNYPUN		002124'	EXT	
STSNEW		762226		TYPSPC		762775		UNYSPU		003755'	EXT	
STSNXT		762241		TYPSR1		761764		UPDHM1		762730		
STSREF		762472		TYPSRP		760420		UPDHM2		762736		
STSUN2		762252		TYPST1		762020		UPDHM3		762751		
STTFPC		000142'	EXT	TYPSTR		762002		UPDHM4		762770		
STTLEN		002057'	EXT	TYPSYS		761760		UPDHOM		762707		
STTPTR		000144'	EXT	TYPUI0		761117		VALSAV		762111		
SVMOT2		761613		TYPUI1		761143		WCKUNI		760702		
SVMOTE		761614		TYPUID		761120		WHICH		761516		
SVMOUT		761616		TYPUIP		760343		WRPI	700600	000000		
SVOTAC		761660		TYPUN1		761745		WRPUNM		761231		
SVP2		757310		TYPUNI		761744		WRTIME	702600	000000		
SVU		757311		TYPUNS		761765		WRTRN1		761441		
SYSBTS		000364'	EXT	U		000005	INT	WTBOTH		761435	INT	
SYSRIB		002312'	EXT	UFDHSI		003473'	EXT	WTCHEK		761456		
SYSSIZ		000000	EXT	UIPHL1		760356		YESNO		004113'	EXT	
SYSUNI		003700'	EXT	UIPHLP		760355		$XZ		000010	SPD	
T1		000006	INT	UIPSVU		760354		%%ZZQ		761146	SPD	
T2		000007	INT	UNCHKA		760415		%BAT		745000	SIN	
T3		000010	INT	UNICHK		762315		%BAT.P		002366'	EXT	
T4		000011	INT	UNICHN		001676'	EXT	%D	777777	021000'	SPD	
THSDAT		003516'	EXT	UNICHR		004173'	EXT	%HOM		751000	SIN	
TPOPJ		002575'	EXT	UNICK1		762317		%HOM.P		002357'	EXT	
TRYKON		760631		UNIDES		003703'	EXT	%OFLER		000001	SIN	
TSTCHK		761430		UNIERR		000000	EXT	%OFLFM		000002	SIN	
TSTSUP		000363'	EXT	UNIFEP		002302'	EXT	%OFLIG		000005	SIN	
TXTCHG		760337		

ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

AB.ACK	   317%	   573	   574	   580	   581	   583	   584	   662	   718	   764	   824
AB.CVR	   317%	   405
AB.NAK	   317%	   384	   572	   575	   576	   577	   578	   579	   582	   656	   657	   658	   659	   660
	   661	   715	   716	   717	   763	   821	   822	   823	  2604	  2605	  2606	  2607	  2608	  2609
	  2610	  2611
AB.TCV	   317%	   410	   763	   821	   822	   823
AB.VER	   317%	   403	   572	   575	   577	   578	   579	   580	   581	   582	   715	   716	   717	   763
	   821	   822	   823
ADDNOT	  2332	  2391#
ADDUN2	  2339	  2345#
ADDUN4	  2366	  2374#
ADDUN5	  2379#	  2382
ADDUN7	  2380	  2383#
ADDUNI	   520	  2330#
ADUNT	  2358	  2363#
ASKQMM	    18	  1941#	  2114	  2135	  2718	  2734
ASKQUE	   132	  1721#	  1837	  1842
ASKRP1	  1965	  1967	  1989#
ASKRPQ	  1970	  1984#
ASKRPT	  1948#	  1991
BADDIS	   521	   586#
BATBAD	  1824	  1829	  1856#
BATCNT	    32%	  2783	  2863
BATELB	    42%	  2815	  2817
BATFIR	    42%	  1852	  2771	  2799
BATMAN	   116	   436	  1830	  1859#	  2405	  2756
BATNBB	    42%	  2774	  2801	  2857
BATPAT	    32%	  2782
BATREF	  1846#	  2746
BATREG	    42%	  1851
BAYNBB	    42%	  2777	  2804
BRMAX	    38%	  1850
CANTAD	  2336	  2337	  2347	  2373	  2394#
CCOD	    46%
CH7	    67%
CHGBAT	   700	  2741#
CHGCMD	   450#	   670	   675
CHGHL1	   672#	   674
CHGHLP	   671#	   701
CHGHOM	  2626#	  2630
CHGIT	   519	   664#
CHGRPC	   699	  2728#
CHGSPC	   698	  2712#
CHGSTR	  2118#	  2138
CHKANS	  1968#	  1979	  1982
CHKBAT	  1799	  1823#	  2757
CHKFLG	  1463	  1470	  1480	  1482	  1486#
CHKHOM	   954	   964	   968#
CHKUN1	  1196	  1199	  1207#
CHKUNI	  1188#	  1208
CLRDDB	    46%	   262	   864
CLRSND	    39%	  1322	  1558	  1698	  1715
CLRSTR	   869	  2168	  2288	  2305#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

CMDMSG	   401	   425#
CMDSC1	   363	   373#
CMDSC2	   377#	   380
CMDSC3	   381#	   394
CMDSC4	   385	   389	   391	   393#
CMDSC5	   382	   397#
CMDSCF	    18	   362	   426#	   462	   591	   666	   723	   772	  2558
CMDSCN	    18	   354#	   463	   592	   667	   724	   773	  2559
CMPLOG	    39%	  2197	  2377
CNTADS	  2411	  2417#
CODBAT	    43%	  1395
CODHOM	    43%	  1360
CODRIB	    43%	   283
COMDAS	  2446%	  2446
COMTMS	  2460%	  2460
COMTYO	    38%	   835	  2762	  2766	  2770	  2850
CONCHK	  1467	  1471#
CONMES	    33%	   122	   903	  1151%	  1151	  1251	  1567	  1573	  1702	  1717	  1865	  1869	  1873	  1917
	  2087	  2742	  2752	  2784	  2788	  2807	  2813	  2833	  2837	  2843	  2885	  2890	  2911
CONOUT	   435	  1254	  1717#	  1880	  1987	  2015	  2158	  2165	  2173	  2191	  2334	  2341	  2392	  2396
	  2419	  2567
CORZER	    34%	   973	  1847	  2651
CPOPJ	    36%	   834	  1894	  2010	  2012	  2860
CPOPJ1	    36%	   360	   367	   371	   402	   404	   409	   414	   422	  1260	  1631	  1754	  1760	  2209
CPUF3	   911	  2491	  2526
CPUKI	  1638	  1659	  2491	  2526
CPUKL	  1638	  1659	  2478	  2479	  2524	  2525
CPUKS	  2478	  2484	  2524
CPUTYP	   911	  1638	  1659	  2478	  2479	  2484	  2491	  2524	  2525	  2526
CPYWAT	  1656#	  1657
CPZZ	   911#	   911	  1638#	  1638	  1659#	  1659	  2478#	  2478	  2479#	  2479	  2484#	  2484	  2491#	  2491
	  2524#	  2524	  2525#	  2525	  2526#	  2526
CRESTT	  1077	  1089#
CRLF	    33%	  1718	  2859	  2864
CRLFOP	   899	   904	  1105	  1106	  1134	  1252	  1334	  1574	  1695	  1718#	  1883	  1920	  2031	  2090
	  2551	  2792
CTEXT	    33%	   355	  1749	  2095
CTYDO	   407%	   407
CWCOD	    46%	  1651
DATBLK	  2883	  2884	  2892#
DATCOM	  2872	  2893%
DBLSTD	   458	  1948	  1973	  1976	  1986	  1988	  1994#	  2008	  2220	  2224
DC.SIZ	    97
DCFAST	   156%	   156
DCN	    65%	    99	   100	   101	   102	   103	   104	   162	  1003	  1014	  2546	  2615
DCN.DF	   104#	   105	   113	   154	  2548
DCN.HM	   103#	   104	   113	  1012
DCN.MN	   102#	   103	   995	  1002
DCN.ON	   100#	   101	  2545
DCN.OP	    99#	   100
DCN.UR	   101#	   102	   995	  1001
DCNDFT	   112	   113#
DCNTAB	    99#	  2617
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

DCNUM	    99#	    99	   100	   101	   102	   103	   104
DCNYDF	   104#	   105
DCNYHM	   103#	   104	  1005	  1010
DCNYMN	   102#	   103
DCNYON	   100#	   101	   160	   161	  2561	  2618
DCNYOP	    99#	   100
DCNYUR	   101#	   102
DCSIZ	    97#	    99	   100	   101	   102	   103	   104
DCXX	    99#	    99	   100	   100#	   101	   101#	   102	   102#	   103	   103#	   104	   104#	   105	   105#
DDBLEN	    43%
DDSTAR	    43%	   261	   863	   866	  1422	  2409
DDTX	   525%	   525
DECIN	    33%	  1963	  2431	  2436	  2440	  2453
DECLOP	    18	  1693#	  1942	  1954	  1960	  2710	  2726
DEVIOS	   861
DIE	    74	    74%	    75
DISST1	  2282#	  2287
DISST2	  2280	  2288#
DSKCPY	   916	  1646#
DSKDDB	    33%	   861
DSKPIF	  1647%	  1647
DSKPIN	  1649%	  1649	  1653%	  1653
DSKPPU	  1040%	  1040
DSPCHG	   669	   698#	   702
DSPDSK	  2586#	  2594
DSPFIL	   465	   517#	   530
DSPSRP	   775	   805#	   809
DSPTYP	   594	   630#	   637
DSPUIP	   727	   754#	   756
ERRHM2	   879	  1217	  1222#	  1331	  1341	  1713
ERRHOM	   878	  1215	  1221#	  1330	  1340	  1714
EVASIZ	    45%	   437
EVMALC	  1094%	  1094
F	   261	   863	  1422	  1770	  1778	  2409
FILCMD	   453#	   460	   466	   471	   728	   735	  1932
FILGO	   528	  2621#
FILHL1	   468#	   470
FILHLP	   467#	   529
FILMAN	    17	   116#	   124
FILOPT	    17	   123	   432#
FIROK	  1424#	  1436
FLGDN1	   923#	   927
FLGDN2	   925	   930#
FLGDN3	   928	   932#
FLGDN4	   933#	   936
FLGDN5	   940#	   943
FLGDWN	   884	   907	   922#
FNDSTR	   365	   988	  1276#	  2155
FNDUN1	  1759#	  1762
FNDUNI	   368	  1752	  1758#
FSTERR	  1563	  1566#
FTYUNI	  1950	  2026#	  2080
GETBAT	    19	  1382#	  1825
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

GETDAT	  2399	  2421#
GETDT1	  2426#	  2430	  2432	  2433	  2437	  2438	  2441	  2442	  2447
GETDT2	  2448#	  2452	  2454	  2455	  2461
GETHOM	    19	   279	   968	  1359#	  2649
GETLIN	    33%	   459	  1255	  1747	  1961	  2093	  2429	  2451	  2555
GETPEV	    41%	  1471	  1510
GETRAN	   356	  2523#
GETSRB	   167	   279#
GETUNI	  1747#	  1756	  2177	  2335	  2744	  2754
HLPCHG	   668	   677#
HLPFIL	   443#	   464	   514	   515
HLPSRP	   774	   783#	   802	   803
HLPTY1	   446#	   588	   606	   680	   742	   788
HLPTYP	   593	   603#
HLPUIP	   725	   737#	   751	   752
HMBOK	   970	   982#
HMBOK2	   988#
HMBOK3	   998	  1004#
HOMDAT	    48%	  2692	  2695	  2699
HOMDCT	    65%	  1004	  1013
HOMDCV	    65%	  1011
HOMEND	    48%	  2691	  2697	  2698
HOMFEP	    50%	  1295
HOMHID	    49%	  1285	  2656
HOMHSH	    48%	  1015	  2677
HOMLOG	    49%	  1283	  2686
HOMLUN	    49%	  1287	  2688
HOMMFD	    48%	  1307
HOMNXT	    49%	  1045	  2660
HOMOVR	    49%	  1313	  2681
HOMP4C	    49%	  1302	  2683
HOMPRV	    50%	  2672
HOMRAN	    48%	   996	  1025	  2679
HOMREF	    50%	  1315	  2675
HOMSAT	    50%	   281
HOMSNM	    50%	   986	  1082	  1300	  2663
HOMSPU	    50%	  1289	  2690
HOMSUF	    32%	  1304
ICPFAC	    44%
INLMES	    38%	   857%	   857
INSERT	  1069	  1073#
IOSEL	    46%	  1654
J	   881	   882	   883	   885	   887	   906	  1646	  1772	  1776	  2424	  2425	  2462
JFYSEC	    44%
KEPSAM	  1962	  1981#
KNNUNI	  1951	  1954#
KNOUNI	   457	  1999#	  2026	  2030	  2233	  2237
KONCPY	    44%
KONDWN	    44%	   906
KONLTM	    44%
KONTOK	   886	   889	   910#
KONUPA	    44%	   883	   887
KOPDWN	    44%	   905
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

LI.PIN	   862
LINKIT	  1067#	  1072
LINKT1	  1065	  1071#
LISTSN	     3	     6
LIT$0	   545#	   572	   646#	   656	   708#	   715	   760#	   763	   815#	   821	  2604#	  2604
LIT$1	   547#	   573	   647#	   657	   709#	   716	   761#	   764	   816#	   822	  2604#	  2605
LIT$10	   561#	   580
LIT$11	   564#	   581
LIT$12	   567#	   582
LIT$13	   568#	   583
LIT$14	   570#	   584
LIT$2	   549#	   574	   648#	   658	   710#	   717	   817#	   823	  2604#	  2606
LIT$3	   551#	   575	   649#	   659	   711#	   718	   819#	   824	  2604#	  2607
LIT$4	   553#	   576	   650#	   660	  2604#	  2608
LIT$5	   554#	   577	   651#	   661	  2604#	  2609
LIT$6	   556#	   578	   652#	   662	  2604#	  2610
LIT$7	   558#	   579	  2604#	  2611
LNGMES	    18	   416	   469	   598	   673	   733	   779	   832#	  2623
LNGMS1	   833#	   837	   841
LP2BAT	    45%	  1396
LP2HOM	    45%	  1361
LPNBAT	    45%	  1396
LPNHOM	    45%	  1361
LSTRED	  1171	  1186#
LSTUNI	  1048	  1057#
MANCM1	   122#	   128
MANCOM	   123#	   133
MANOK	   118	   134#
MANOK1	   146	   149#
MANOK2	   155	   161#
MANQST	   119	   130#
MANREF	   126#	   136
MAX	    18	  1946	  1959	  1968	  1978	  1997#	  2110	  2132	  2715	  2731
MAYREF	  2007#	  2111
MCKKON	  1241#
MFDRIB	    36%	  1309
MIN	    18	  1945	  1956	  1969	  1998#	  2108	  2130	  2713	  2729
MISUNI	  1191	  1198#	  1205
MONTAB	  2882	  2894#
MOVSTR	   993	  1300#
MOVUNI	   977	   984	  1283#
MSGLNG	  1195	  1204	  1319#
MSGSAV	  1943	  1952	  1989	  1993#
MSGSTR	  1052	  1174	  1328#
MSGUNI	  1024	  1035	  1043	  1337#
NAMFLO	  1083	  1333#	  1343
NASTYP	  1230	  1244#
NLSUNI	  1046	  1064#
NMRBPC	    36%	  2724	  2733	  2736
NMSTPC	    38%	  2708	  2717	  2720
NODATE	  2869	  2889#
NODIE	    74%
NOERH	   287	  1438	  1553	  1584#	  2648
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

NOREF	  1915	  1918#
NOSTR	   991	  1079#
NOTPRV	   989	  1006#
NTISTR	   978	   987	  1037	  1088#
NULCHG	   676#	   697
NULDSK	  2562#	  2585
NULFIL	   452#	   516
NULSRP	   782#	   804
NULTYP	   602#	   629
NULUIP	   736#	   753
OCONM	    33%	   446	   455	  1081	  1247	  1329	  1339	  2427	  2449	  2543	  2553
OCTIN	    33%	  1257
OFLTAB	  1150	  1155#
OHTINI	    40%	  1616
OHTNUM	    40%	  1630
OLDST0	  1018	  1021#
OLDST1	  1016	  1023#
OLDST2	  1017#
OLDST4	  1020	  1022	  1025#
OLDST5	  1026	  1034#
OLDST6	  1027#
OLDST8	  1009	  1030	  1032	  1036#
OLDSTR	  1009#
ONCDDB	    43%	   865
ONCDSK	    74	    75#	    78	    81
ONCMOD	    68	    70#
ONDEND	  3487#
ONDLIT	  2914#
ONDLNP	    17	  3481#	  3483
ONDLNR	    17	  3480#	  3481
ONDSTT	    17	    72#	    81
OPAGIN	    18	   214	  1465	  1602#
OPAGIO	  1604	  1610#
OPAGOT	    18	   230	  1527	  1607#
OPOUT	    33%	   447	   456	   839	  1149	  1152	  1324	  1700	  1719	  1866	  1874	  1882	  1921	  2428
	  2450	  2554	  2743	  2753
OVRDEF	  2219	  2244#
P	    75	   117	   122	   123	   132	   134	   150	   153	   167	   214	   224	   230	   262	   263
	   279	   280	   282	   354	   355	   356	   358	   365	   368	   396	   416	   420	   435	   438
	   441	   446	   447	   455	   456	   459	   463	   469	   517	   520	   522	   523	   524	   525
	   526	   592	   598	   630	   631	   632	   633	   634	   667	   673	   698	   699	   700	   724
	   733	   754	   767	   773	   779	   805	   806	   826	   827	   835	   838	   839	   840	   857
	   864	   867	   869	   887	   899	   901	   903	   904	   916	   958	   968	   973	   976	   977
	   983	   984	   988	   993	  1006	  1024	  1035	  1043	  1049	  1052	  1053	  1081	  1083	  1089
	  1094	  1102	  1105	  1106	  1134	  1137	  1139	  1140	  1144	  1148	  1151	  1174	  1195	  1204
	  1214	  1216	  1218	  1219	  1245	  1246	  1247	  1249	  1250	  1251	  1252	  1253	  1254	  1255
	  1256	  1257	  1258	  1259	  1279	  1280	  1297	  1317	  1320	  1322	  1323	  1324	  1325	  1329
	  1333	  1338	  1339	  1342	  1382	  1398	  1426	  1433	  1437	  1439	  1465	  1469	  1471	  1479
	  1483	  1484	  1510	  1520	  1524	  1525	  1527	  1529	  1532	  1533	  1554	  1556	  1557	  1558
	  1560	  1567	  1571	  1572	  1573	  1574	  1575	  1576	  1610	  1616	  1622	  1623	  1624	  1629
	  1632	  1650	  1654	  1678	  1684	  1685	  1694	  1698	  1699	  1702	  1715	  1717	  1718	  1733
	  1740	  1744	  1747	  1748	  1749	  1752	  1755	  1763	  1768	  1769	  1770	  1771	  1772	  1773
	  1775	  1776	  1777	  1778	  1779	  1780	  1781	  1799	  1803	  1825	  1831	  1837	  1838	  1842
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

	  1843	  1847	  1848	  1865	  1867	  1869	  1871	  1873	  1880	  1881	  1897	  1902	  1911	  1917	  1918
	  1921	  1923	  1926	  1929	  1930	  1931	  1950	  1954	  1957	  1960	  1961	  1963	  1972	  1974
	  1987	  2009	  2027	  2028	  2029	  2050	  2067	  2069	  2072	  2080	  2087	  2089	  2090	  2092
	  2093	  2095	  2100	  2111	  2114	  2115	  2118	  2135	  2136	  2155	  2168	  2173	  2177	  2181
	  2197	  2198	  2207	  2218	  2221	  2222	  2225	  2226	  2227	  2228	  2229	  2276	  2277	  2285
	  2288	  2289	  2290	  2291	  2305	  2306	  2311	  2313	  2314	  2334	  2335	  2349	  2367	  2368
	  2369	  2372	  2377	  2383	  2385	  2386	  2387	  2388	  2389	  2399	  2404	  2406	  2410	  2412
	  2415	  2422	  2424	  2427	  2428	  2429	  2431	  2436	  2440	  2446	  2449	  2450	  2451	  2453
	  2460	  2462	  2463	  2488	  2523	  2537	  2538	  2543	  2544	  2550	  2551	  2553	  2554	  2555
	  2556	  2559	  2562	  2567	  2619	  2623	  2627	  2631	  2649	  2651	  2703	  2705	  2718	  2719
	  2721	  2734	  2735	  2737	  2742	  2743	  2744	  2745	  2746	  2747	  2748	  2752	  2753	  2754
	  2755	  2757	  2760	  2762	  2764	  2766	  2768	  2770	  2784	  2786	  2788	  2790	  2792	  2795
	  2796	  2807	  2811	  2813	  2816	  2829	  2830	  2831	  2833	  2834	  2835	  2837	  2838	  2839
	  2843	  2844	  2845	  2846	  2850	  2855	  2856	  2858	  2859	  2864	  2865	  2872	  2873	  2876
	  2878	  2880	  2881	  2885	  2886	  2887	  2899	  2901	  2903	  2905	  2907
P1	   373	   374	   397	   398	   461	   467	   590	   596	   665	   671	   722	   731	   771	   777
	   888	   900	  1188	  1189	  1190	  1198	  1200	  1227	  1248	  1511	  1518	  1703	  1844	  1863
	  1864	  1888	  1922	  1944	  1953	  1956	  1959	  1990	  2084	  2088	  2112	  2134	  2176	  2203
	  2204	  2205	  2216	  2217	  2218	  2219	  2226	  2557	  2708	  2717	  2724	  2733	  2773	  2778
	  2782	  2785
P2	   179	   193	   195	   197	   284	   373	   383	   393	   398	   399	   400	   403	   405	   410
	   415	   720	   721	   726	   974	   985	   990	  1009	  1017	  1019	  1037	  1047	  1058	  1059
	  1064	  1074	  1167	  1168	  1170	  1175	  1182	  1186	  1276	  1278	  1301	  1303	  1311	  1312
	  1314	  1316	  1332	  1359	  1394	  1472	  1473	  1474	  1568	  1569	  1683	  1709	  1767	  1849
	  1909	  1910	  1914	  1919	  2010	  2011	  2112	  2116	  2117	  2131	  2134	  2137	  2160	  2169
	  2170	  2175	  2178	  2194	  2195	  2201	  2202	  2206	  2212	  2278	  2279	  2330	  2331	  2346
	  2350	  2365	  2367	  2369	  2374	  2376	  2378	  2417	  2434	  2435	  2439	  2445	  2653	  2654
	  2661	  2662	  2664	  2665	  2674	  2680	  2682	  2702	  2799	  2800	  2801	  2803	  2815	  2817
	  2857	  2860	  2861
P2BLSH	  2818
P3	   156	   160	   180	   196	   209	   210	   225	   227	   232	   283	   359	   366	   370	   374
	   381	   386	   392	   394	   395	   397	   399	   421	   465	   467	   468	   470	   594	   596
	   597	   599	   669	   671	   672	   674	   727	   731	   732	   734	   775	   777	   778	   780
	   975	  1090	  1091	  1092	  1093	  1099	  1360	  1395	  1475	  1853	  2175	  2178	  2193	  2208
	  2561	  2701	  2773	  2776	  2783	  2789	  2793
P4	   174	   183	   184	   194	   201	   375	   390	   392	   395	  1187	  1189	  1190	  1198	  1361
	  1396	  1425	  1432	  1516	  1519	  1522	  1768	  1780	  1796	  1797	  1892	  1908	  2370	  2371
	  2624	  2626	  2628	  2871
P4CDEF	  2223	  2254#
PAGCOD	    42%	   975	  1475	  1853	  2701
PAGIN	    40%	  1602
PAGNAM	    42%	   974	  1474	  1849	  2653
PAGOUT	    40%	  1607
PAGSLF	    42%	  1518
PAKREF	    41%	  2372
PCBPAG	    41%	  1613
PCISTS	    40%	  1612	  1625
PG	   213	   229	   285	  1362	  1397	  1556	  1575	  1610	  1611	  1613	  1629
PGYERR	    40%	  1615	  1628
PGYPNO	    40%	  1617
PGYUNI	    40%	  1621
PR2DIG	  2811	  2855	  2880	  2887	  2906#
PR3DIG	  2839	  2845	  2904#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

PR4DIG	  2835	  2902#
PR5DIG	  2900#
PR6DIG	  2786	  2898#
PRCOL	  1140%	  1140
PRNAME	    39%	   901	  1139%	  1139	  1249	  1333	  1560	  1571	  1711	  1871	  2089	  2550	  2760	  2764
	  2768
PRNAMF	  1144%	  1144	  1148%	  1148
PRSPC	  1137%	  1137	  2899	  2901	  2903	  2905	  2907%	  2907
PRT22A	    32%	  2816
PRTDIG	  2790	  2908%	  2908
QSTSTD	  1949	  1976#
RADX10	    39%	  1704
RANHOM	   144	   148	   870	  1027	  1029	  1224#	  2402	  2403	  2678
RANNO	  2521%	  2536
RBINDX	    52%	   186
RBLVPR	    53%
RBLVSP	    53%
RBMASK	    52%	   192
RBREAL	    52%	   187	   192	  1305	  1308	  1514
RBSPAR	    52%	   186
RBYPNO	    53%	   212	   228	  1517
RBYUN1	    53%	   189
RBYUN4	    53%
RBYUNI	    53%	  1515
RDBAT1	  1797#	  1802
RDBAT6	  1798	  1801#
RDBNON	  1434	  1438#
RDBOTH	  1363	  1383	  1422#
RDBSKP	  1428	  1437#
RDCHEK	   288	  1426	  1433	  1463#
RDHOM1	   874#	   876
RDHOM2	   872	   877#
RDHOME	   117	   438	   857#	  2406	  2412
RDRBS2	   178#	   200
RDRBS3	   183#	   196
RDSATS	   203	   207#
RDST45	   216	   220#
RDSTS1	   209#	   248
RDSTS4	   210#	   233
RDSTS5	   211	   236#
RDSTS6	   244	   247#
RDWMSG	  1469	  1479	  1532	  1553#
RE.DCD	    65%	  1000
REDBAT	   134	   441	  1795#
REDERR	  1423	  1481	  1508	  1523	  1564	  1566	  1578#	  1827
REDSEC	  1427	  1431#
REFLAG	   139%	   139
REFRSH	    46%	  2410
REFSAV	  1319	  1328	  1337	  1767#
REONCE	    98	    98#	   994
REPSID	    65%	   997
RETFIX	  1947	  1971#
RIBEXT	    52%	   169
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

RIBLST	    52%	   183
RIBNAM	    52%	  1473
RIBPFS	    52%	   174
RWRHOM	  2404	  2624#
S$ENTR	    74	    80	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
S$HALT	    74	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
S$NAME	    78#	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
S$NONA	    77	    80	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
S$TEMP	    74#	    74	   168#	   168	   185#	   185	   188#	   188	   191#	   191	   202#	   202	   231#	   231
	   868#	   868	  1084#	  1084	  2704#	  2704
S$XCT	    80	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
SATCNT	    35%	   224
SAVE4	    46%	  2423
SCNBAT	    34%
SCNCHG	   665	   703	   704#
SCNDSK	  2547	  2557	  2595	  2596#
SCNFIL	   461	   531	   532#
SCNSD2	  1209	  1215#
SCNSRP	   771	   810	   811#
SCNST2	  1177#	  1179
SCNSTD	  1169	  1212#
SCNSTR	  1117	  1167#
SCNTYP	   590	   638	   639#
SCNUIP	   722	   757	   758#
SCNUN1	   948	  1102#
SCNUNI	   881#	  1104
SETBAT	  1382	  1394#	  1848
SETCHG	   976	   983	  1729#	  2071	  2099	  2118	  2207	  2285	  2385	  2388
SETDDO	    46%	   867
SETPRV	  1742#
SETPUB	  1006	  1738#	  2198	  2386
SETRAN	   354	  2477#
SETUNT	  1117#	  1123	  1128
SETUTS	  1119	  1125#
SIZCHG	   702#	   702	   703
SIZDSK	  2594#	  2594	  2595
SIZFIL	   530#	   530	   531
SIZOND	  3483
SIZSRP	   809#	   809	   810
SIZTYP	   637#	   637	   638
SIZUIP	   756#	   756	   757
SPACE3	  2856	  2910#
SPCDK1	  2552#	  2568
SPCDKN	   517	  2541#
SPCDKP	   153	  2544	  2615#
SPDKHP	  2560	  2564#	  2583	  2584
SPSNAM	  1709#	  1881	  1918
SPUCLC	  1089	  2045#	  2069
SPUNAM	  1710#	  1867	  2028
SRPCMD	   451#	   776	   781	   828
SRPHL1	   778#	   780
SRPHLP	   777#	   808
SRPNDS	    55%	   158
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

SRPREF	   137%	   137
STDREA	    40%	  1603	  1626
STDWRT	    41%	  1608	  1626
STOUN1	  1685#	  1687
STOUNI	  1683#	  2119	  2228	  2230
STRBTS	    57%	   138	   157	  2306	  2312
STRDDB	    55%	   135	   138	   143	   149	   157	   166	   175	   207	   208	   245	  1167	  1276	  1909
	  2278	  2306	  2307	  2308	  2309	  2310	  2312	  2330	  2401	  2676
STRFIX	  1028	  1031#
STRHSH	    56%	  1017	  1019	  2401	  2676
STRLEN	    55%	  2310
STRNAM	    56%	   990	  1168	  1278	  1301	  1332	  1709	  1910	  2160	  2169	  2331	  2662
STRNXT	    56%
STROVR	    57%	  1314	  2134	  2137	  2680
STRP4C	    56%	  1303	  2112	  2116	  2682
STRPID	    57%	    65%	   149
STRPPU	    57%	  1311	  1312	  2131	  2201	  2202	  2346
STRREF	    56%	   135	  1316	  1767	  1914	  2011	  2117	  2170	  2365	  2417	  2674
STRSID	    57%
STRTAL	    57%	   207	   245
STRTCH	   806	   827	  2108#	  2225
STRTOV	   805	   826	  2130#	  2221
STRTPA	   807	   826#
STRUNI	    56%	   143	   166	   175	   208	  1064	  1175	  1186	  1683	  1919	  2175	  2178	  2212	  2279
	  2378	  2665
STRUNM	    56%	  1047	  1058	  1059	  1170	  1182	  2195	  2206	  2350	  2374
STSDEF	   523	  2154#
STSDSL	   522	  2276#
STSFIN	  2179	  2212#
STSINS	  2181	  2186#
STSNE1	  2161	  2168#
STSNE2	  2172#	  2180
STSNEW	  2157	  2160#
STSNXT	  2177#	  2182	  2183
STSREF	   524	  2399#
STSUN2	  2187	  2193#
STTFPC	    34%	   225
STTLEN	    35%	   195	   232	  1091
STTPTR	    34%	   193	   197	   210	   227
SVMOT2	  1214	  1713#
SVMOTE	  1714#
SVMOUT	  1716#	  1755
SVOTAC	  1131	  1244	  1555	  1693	  1697	  1716	  1721	  1768#	  1823	  2647
SVP2	   428#
SVU	   364	   372	   429#
SYSBTS	   527%	   527
SYSRIB	  1306%	  1306
SYSSIZ	    45%
SYSUNI	    45%	   257	   871	   877	   922	  1115	  1758	  1795	  1891	  2625
T1	   120	   126	   130	   135	   136	   137	   138	   144	   145	   147	   148	   149	   157	   158
	   161	   162	   169	   171	   172	   173	   184	   186	   187	   192	   193	   218	   219	   221
	   222	   223	   236	   237	   239	   240	   241	   242	   245	   256	   258	   361	   377	   378
	   387	   415	   417	   432	   443	   453	   468	   586	   597	   603	   672	   677	   732	   737
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

	   740	   778	   783	   786	   832	   833	   838	   840	   865	   866	   880	   881	   885	   902	   905
	   906	   923	   924	   930	   931	   934	   935	   937	   938	   941	   942	   944	   945	   946
	   947	   951	   952	   962	   963	   972	   986	   987	   996	   997	   999	  1001	  1002	  1003
	  1004	  1005	  1010	  1011	  1013	  1015	  1016	  1019	  1021	  1023	  1025	  1026	  1029	  1031
	  1034	  1038	  1047	  1048	  1050	  1070	  1071	  1072	  1073	  1079	  1095	  1096	  1097	  1098
	  1099	  1100	  1111	  1112	  1113	  1116	  1120	  1121	  1123	  1141	  1150	  1170	  1171	  1172
	  1177	  1178	  1179	  1180	  1181	  1182	  1194	  1203	  1212	  1228	  1241	  1250	  1253	  1277
	  1278	  1283	  1284	  1285	  1286	  1287	  1288	  1289	  1290	  1293	  1295	  1296	  1300	  1301
	  1302	  1303	  1304	  1305	  1306	  1307	  1308	  1309	  1310	  1311	  1312	  1313	  1314	  1315
	  1316	  1320	  1321	  1325	  1468	  1478	  1513	  1515	  1530	  1557	  1561	  1565	  1572	  1603
	  1608	  1612	  1614	  1615	  1618	  1619	  1620	  1621	  1651	  1652	  1655	  1657	  1684	  1703
	  1729	  1732	  1751	  1753	  1827	  1829	  1832	  1839	  1846	  1850	  1851	  1852	  1864	  1868
	  1872	  1878	  1916	  1943	  1952	  1955	  1958	  1984	  1989	  2011	  2012	  2013	  2082	  2085
	  2109	  2110	  2113	  2118	  2131	  2132	  2133	  2154	  2156	  2162	  2169	  2172	  2186	  2187
	  2188	  2195	  2196	  2200	  2201	  2202	  2204	  2219	  2220	  2222	  2223	  2224	  2227	  2229
	  2277	  2281	  2284	  2289	  2305	  2308	  2309	  2310	  2311	  2312	  2313	  2333	  2338	  2339
	  2340	  2345	  2346	  2350	  2352	  2354	  2355	  2356	  2357	  2359	  2362	  2363	  2364	  2365
	  2366	  2374	  2375	  2378	  2379	  2381	  2383	  2384	  2391	  2395	  2400	  2401	  2418	  2426
	  2448	  2456	  2457	  2458	  2459	  2485	  2486	  2524	  2541	  2545	  2546	  2552	  2564	  2621
	  2650	  2655	  2656	  2657	  2658	  2659	  2660	  2661	  2662	  2663	  2666	  2667	  2668	  2669
	  2672	  2674	  2675	  2676	  2677	  2678	  2679	  2680	  2681	  2682	  2683	  2685	  2686	  2687
	  2688	  2689	  2690	  2691	  2692	  2694	  2695	  2697	  2698	  2699	  2709	  2712	  2713	  2714
	  2715	  2716	  2725	  2728	  2729	  2730	  2731	  2732	  2741	  2751	  2777	  2778	  2781	  2785
	  2787	  2789	  2791	  2794	  2804	  2805	  2806	  2810	  2812	  2815	  2817	  2818	  2820	  2831
	  2832	  2834	  2836	  2838	  2840	  2842	  2844	  2846	  2851	  2853	  2854	  2870	  2879	  2881
	  2882	  2883	  2884	  2886	  2889	  2898	  2900	  2902	  2904	  2906	  2910
T2	   170	   171	   172	   210	   227	   238	   239	   357	   361	   381	   388	   900	   922	   923
	   926	   927	   931	   932	   933	   934	   938	   939	   940	   941	   945	   960	   994	   995
	  1000	  1012	  1014	  1017	  1018	  1021	  1027	  1031	  1040	  1041	  1042	  1044	  1049	  1053
	  1057	  1058	  1068	  1082	  1093	  1097	  1098	  1100	  1125	  1126	  1131	  1132	  1133	  1135
	  1136	  1138	  1143	  1145	  1146	  1147	  1244	  1248	  1291	  1292	  1294	  1319	  1328	  1332
	  1337	  1342	  1473	  1474	  1475	  1511	  1514	  1518	  1555	  1559	  1568	  1570	  1611	  1613
	  1622	  1624	  1693	  1697	  1709	  1710	  1716	  1721	  1751	  1759	  1773	  1823	  1835	  1836
	  1870	  1914	  1915	  1945	  1946	  1968	  1969	  1971	  1976	  1977	  1978	  1981	  2045	  2046
	  2047	  2048	  2049	  2070	  2088	  2094	  2096	  2097	  2098	  2116	  2137	  2276	  2290	  2351
	  2353	  2354	  2357	  2360	  2361	  2379	  2380	  2381	  2434	  2439	  2443	  2444	  2445	  2456
	  2459	  2485	  2523	  2534	  2535	  2536	  2537	  2547	  2549	  2615	  2616	  2617	  2618	  2647
	  2665	  2666	  2668	  2670	  2720	  2736	  2759	  2763	  2767	  2771	  2772	  2774	  2779	  2780
	  2803	  2819	  2820	  2822	  2827	  2830	  2852	  2853	  2854	  2857	  2869	  2874	  2875	  2876
T3	   154	   189	   190	   357	   376	   377	   378	   379	   380	   383	   384	   386	   387	   388
	   833	   834	   836	   873	   874	   955	   982	  1067	  1068	  1192	  1201	  1245	  1321	  1428
	  1434	  1436	  1466	  1476	  1481	  1523	  1531	  1559	  1602	  1607	  1623	  1625	  1626	  1628
	  1631	  1738	  1739	  1742	  1743	  1769	  1779	  1844	  1966	  2068	  2070	  2282	  2283	  2286
	  2548	  2617	  2761	  2765	  2769	  2821	  2822	  2826	  2828	  2829	  2849	  2877	  2878
T4	   178	   190	   212	   225	   226	   228	   281	   917	   953	  1064	  1070	  1071	  1075	  1225
	  1243	  1246	  1425	  1432	  1516	  1517	  1617	  1730	  1731	  2423	  2823	  2824	  2825	  2826
	  2879
THSDAT	   170%	   170	   173%	   173	  2421%	  2421
TPOPJ	    39%	  1688
TRYKON	   887#	   959	   961
TSTCHK	  1477	  1481#
TSTSUP	   526%	   526
TXTCHG	   702	   715#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

TXTDSK	  2594	  2604#
TXTFIL	   530	   572#
TXTSRP	   809	   821#
TXTTYP	   637	   656#
TXTUIP	   756	   763#
TYPALL	   635	  1929#
TYPBAT	   632	  2751#
TYPBT1	  2774#	  2780
TYPBT2	  2775	  2779	  2781#
TYPBT3	  2801#	  2861
TYPBT4	  2805	  2810#
TYPBT5	  2808	  2815#
TYPBT6	  2848	  2856#
TYPBT9	  2793	  2802	  2863#
TYPCMD	   449#	   595	   600
TYPDAT	  2858	  2869#
TYPDEC	  1323	  1694	  1699	  1702#	  1957
TYPHL1	   597#	   599
TYPHLP	   596#	   636
TYPIT	   518	   589#
TYPMSN	  1697#
TYPNS1	  1893#	  1896
TYPNS2	  1899#	  1903
TYPONL	    17	   412	   589	   664	   739	   785	  1941	  1996#	  2007	  2066	  2091	  2215	  2238	  2348
TYPRPC	   634	  2724#
TYPSPC	   633	  2708#
TYPSR1	  1883#	  1900	  1925
TYPSRP	   628	   696	   771#
TYPST1	  1924#	  1927
TYPSTR	   630	  1908#	  1929
TYPSYS	  1878#	  1931
TYPUI0	   860	  1130#	  1132
TYPUI1	  1142	  1150#
TYPUID	  1102	  1131#
TYPUIP	   627	   695	   720#
TYPUN1	  1864#	  1897	  1923
TYPUNI	  1863#	  1902	  1926
TYPUNS	   631	  1888#	  1930
U	   143	   151	   152	   166	   175	   179	   199	   200	   208	   209	   226	   236	   241	   243
	   247	   248	   257	   258	   259	   260	   364	   372	   720	   766	   871	   872	   874	   875
	   876	   877	   882	   888	   917	   924	   932	   935	   939	   942	   947	   952	   963	  1041
	  1042	  1073	  1074	  1075	  1088	  1095	  1103	  1104	  1115	  1117	  1118	  1120	  1122	  1126
	  1127	  1138	  1141	  1143	  1145	  1175	  1177	  1178	  1186	  1207	  1208	  1227	  1284	  1286
	  1292	  1294	  1296	  1310	  1338	  1466	  1476	  1531	  1619	  1620	  1646	  1648	  1652	  1656
	  1683	  1686	  1687	  1710	  1731	  1732	  1739	  1743	  1750	  1758	  1759	  1761	  1762	  1771
	  1777	  1795	  1797	  1801	  1802	  1836	  1866	  1870	  1891	  1893	  1894	  1895	  1899	  1900
	  1901	  1919	  1920	  1924	  1925	  2045	  2084	  2094	  2097	  2098	  2186	  2193	  2194	  2200
	  2205	  2208	  2212	  2213	  2214	  2216	  2279	  2280	  2282	  2283	  2286	  2287	  2337	  2338
	  2345	  2359	  2361	  2362	  2364	  2371	  2376	  2384	  2387	  2394	  2625	  2626	  2628	  2629
	  2630	  2654	  2655	  2657	  2670	  2685	  2759	  2763	  2767	  2841	  2847
UFDHSI	    35%	  2400
UIPHL1	   732#	   734
UIPHLP	   731#	   755
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

UIPSVU	   721	   726	   729#
UNCHKA	   766#	  2234	  2349
UNICHK	  2229	  2233#
UNICHN	    63%	   940	   941	   944	   945
UNICHR	    32%	  2841	  2847
UNICK1	  2227	  2237#
UNIDES	    59%	   258	   874	   947	   952	   963	  1292	  1294	  1731	  1732	  1739	  1743	  1797	  1836
	  2284	  2371	  2626	  2628
UNIERR	    59%
UNIFEP	    59%	  1296
UNIHID	    59%	   766	  1143	  1286	  1870	  2084	  2094	  2097	  2098	  2655	  2659	  2669	  2767
UNIKON	    63%	   882	   933	   934	   937	   938	  1646
UNILOG	    63%	  1088	  1118	  1145	  1284	  1895	  1901	  2282	  2685	  2763
UNINAM	    60%	   888	  1138	  1227	  1338	  1466	  1476	  1531	  1710	  1759	  2759
UNIONC	    62%	   917	  1141
UNIPPU	    59%	   236	  1041	  1042	  1310	  2045	  2200	  2204	  2345
UNISTR	    60%	   151	   199	   247	   720	  1070	  1073	  1074	  1178	  1207	  1686	  1924	  2186	  2194
	  2208	  2213	  2283	  2338	  2376	  2379	  2384	  2394	  2654	  2657	  2668
UNISTS	    63%	  1648	  1652	  1656
UNISTT	    60%	   179	   209	  1095
UNISYS	    59%	   259	   875	   922	   923	   926	   930	   931	  1103	  1122	  1127	  1761	  1801	  1893
	  1899	  2629
UNITAL	    61%	   226	   241	   243
UNITID	   754	   767	  2080#	  2096
UNITST	   768	  2066#	  2239
UNPCHG	    61%	   256	  1729	  2370	  2624
UNPHWP	    61%	   951	   962	  1730	  1835
UNPMSB	    61%	  1291
UNPOFL	    61%	   946	  1730	  1796
UNPPRV	    63%	   873	  1738	  1742	  2281
UNTLEN	    34%	  1113	  1116
UNTTBL	    34%	  1110	  1111	  1112	  1113	  1120	  1126	  1619	  1620	  2353	  2355	  2359	  2361	  2362
	  2364
UNVRSF	    61%	   237
UNYBPR	    32%	  2823
UNYBPT	    32%	  2821	  2852
UNYBPY	    32%	  2819
UNYKTP	  2217%	  2217
UNYLN1	    62%	  1067
UNYLUN	    62%	   178	  1044	  1121	  1125	  1180	  1188	  1288	  1513	  1618	  2196	  2351	  2352	  2360
	  2363	  2687
UNYPUN	  1135%	  1135
UNYSPU	    62%	   180	   238	  1090	  1290	  2049	  2068	  2689
UPDHM1	  2666#	  2671
UPDHM2	  2667	  2672#
UPDHM3	  2664	  2685#
UPDHM4	  2693	  2696	  2701#
UPDHOM	   150	  2368	  2627	  2647#
VALSAV	  1944	  1953	  1971	  1981	  1990	  1995#
WCKUNI	   918	   951#
WHICH	   286	  1424	  1431	  1509	  1521	  1562	  1581#
WRPUNM	   958	  1225#
WRTRN1	  1513#	  1522
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Symbol cross reference

WTBOTH	    19	  1508#	  1828	  1854	  2703
WTCHEK	  1520	  1527#
YESNO	    46%	   420	  1722	  2795
$XZ	   545#	   545	   547	   547#	   549	   549#	   551	   551#	   553	   553#	   554	   554#	   556	   556#
	   558	   558#	   561	   561#	   564	   564#	   567	   567#	   568	   568#	   570	   570#	   572	   572#
	   573	   573#	   574	   574#	   575	   575#	   576	   576#	   577	   577#	   578	   578#	   579	   579#
	   580	   580#	   581	   581#	   582	   582#	   583	   583#	   584	   584#	   585	   585#	   646#	   646
	   647	   647#	   648	   648#	   649	   649#	   650	   650#	   651	   651#	   652	   652#	   656	   656#
	   657	   657#	   658	   658#	   659	   659#	   660	   660#	   661	   661#	   662	   662#	   663	   663#
	   708#	   708	   709	   709#	   710	   710#	   711	   711#	   715	   715#	   716	   716#	   717	   717#
	   718	   718#	   719	   719#	   760#	   760	   761	   761#	   763	   763#	   764	   764#	   765	   765#
	   815#	   815	   816	   816#	   817	   817#	   819	   819#	   821	   821#	   822	   822#	   823	   823#
	   824	   824#	   825	   825#	  2604#	  2604	  2605	  2605#	  2606	  2606#	  2607	  2607#	  2608	  2608#
	  2609	  2609#	  2610	  2610#	  2611	  2611#	  2612	  2612#
%%ZZQ	  1154#	  1162
%BAT	  1846	  1849	  1852	  1853	  2771	  2772	  2782	  2783	  2799	  2800	  2863
%BAT.P	    37%	  1397
%D	    81#
%HOM	   281	   972	   974	   975	   986	   996	  1004	  1013	  1015	  1025	  1045	  1082	  1283	  1285
	  1287	  1289	  1295	  1300	  1302	  1304	  1307	  1313	  1315	  2650	  2653	  2656	  2660	  2663
	  2672	  2675	  2677	  2679	  2681	  2683	  2686	  2688	  2690	  2691	  2692	  2695	  2697	  2698
	  2699	  2701
%HOM.P	    37%	  1362
%OFLER	  1157#
%OFLFM	  1158#
%OFLIG	  1161#
%OFLMT	  1159#
%OFLRS	  1160#
%OND	    72	  3480
%STA	   217	   218	   219	   220	   221	   222	   223
%STA.P	    37%	   213	   229
%STR	   169	   184	   201
%STR.P	    37%	   285
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 09:33  6-NOV-89
ONCDSK.MAC	14-APR-88 23:38		Macro/Opdef cross reference

DCNDEF	    85#	    98
DSKOFF	  1635#	  1647
DSKON	  1636#	  1649	  1653
IFCPU	   911	  1638	  1659	  2478	  2479	  2484	  2491	  2524	  2525	  2526
MKCHG	   682#	   698	   704	   708	   715
MKDSK	  2572#	  2586	  2596	  2604
MKFIL	   473#	   517	   532	   545	   572
MKSRP	   790#	   805	   811	   815	   821
MKTYP	   608#	   630	   639	   646	   656
MKUIP	   744#	   754	   758	   760	   763
ONSZCK	  3483
PFALL	   203	   964
PJRST	   288	   768	  1149	  1152	  1230	  1334	  1343	  1363	  1383	  1695	  1700	  1704	  1711	  1719
	  1722	  1828	  1854	  1874	  1882	  1883	  2015	  2031	  2071	  2099	  2119	  2138	  2158	  2165
	  2191	  2230	  2234	  2239	  2419	  2710	  2726	  2887	  2890	  2911
PRINTF	    10#	  1108	  2199
RDTIME	  2524
SCAN	   291#	   461	   590	   665	   771
SCNTB	   318#	   514	   627	   695	   751	   802	  2583
STOPCD	    73	   168	   185	   188	   191	   202	   231	   868	  1084	  2704
WRPI	   862	  1647	  1649	  1653
WRTIME	  2486
X	   514#	   517	   518	   519	   520	   521	   522	   523	   524	   525	   526	   527	   528	   529
	   532#	   532	   533	   534	   535	   536	   537	   538	   539	   540	   541	   542	   543	   544
	   545#	   545	   547	   549	   551	   553	   554	   556	   558	   561	   564	   567	   568	   570
	   572#	   572	   573	   574	   575	   576	   577	   578	   579	   580	   581	   582	   583	   584
	   627#	   630	   631	   632	   633	   634	   635	   636	   639#	   639	   640	   641	   642	   643
	   644	   645	   646#	   646	   647	   648	   649	   650	   651	   652	   656#	   656	   657	   658
	   659	   660	   661	   662	   695#	   698	   699	   700	   701	   704#	   704	   705	   706	   707
	   708#	   708	   709	   710	   711	   715#	   715	   716	   717	   718	   751#	   754	   755	   758#
	   758	   759	   760#	   760	   761	   763#	   763	   764	   802#	   805	   806	   807	   808	   811#
	   811	   812	   813	   814	   815#	   815	   816	   817	   819	   821#	   821	   822	   823	   824
	  2583#	  2586	  2587	  2588	  2589	  2590	  2591	  2592	  2593	  2596#	  2596	  2597	  2598	  2599
	  2600	  2601	  2602	  2603	  2604#	  2604	  2605	  2606	  2607	  2608	  2609	  2610	  2611	  3483#
XZ$	   545#	   545	   547	   549	   551	   553	   554	   556	   558	   561	   564	   567	   568	   570
	   572#	   572	   573	   574	   575	   576	   577	   578	   579	   580	   581	   582	   583	   584
	   646#	   646	   647	   648	   649	   650	   651	   652	   656#	   656	   657	   658	   659	   660
	   661	   662	   708#	   708	   709	   710	   711	   715#	   715	   716	   717	   718	   760#	   760
	   761	   763#	   763	   764	   815#	   815	   816	   817	   819	   821#	   821	   822	   823	   824
	  2604#	  2604	  2605	  2606	  2607	  2608	  2609	  2610	  2611    !@(z